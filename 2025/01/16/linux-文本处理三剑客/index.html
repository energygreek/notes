
<!doctype html>
<html lang="zh" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
        <link rel="canonical" href="https://energygreek.github.io/notes/2025/01/16/linux-%E6%96%87%E6%9C%AC%E5%A4%84%E7%90%86%E4%B8%89%E5%89%91%E5%AE%A2/">
      
      
        <link rel="prev" href="../../../../2024/12/18/%E8%BF%9E%E8%AF%8D%E5%92%8C%E5%A4%8D%E5%90%88%E5%8F%A5/">
      
      
        <link rel="next" href="../../../02/07/difference-of-lxc-container-and-docker-container/">
      
      
        <link rel="alternate" type="application/rss+xml" title="RSS 订阅" href="../../../../feed_rss_created.xml">
        <link rel="alternate" type="application/rss+xml" title="已更新内容的 RSS 订阅" href="../../../../feed_rss_updated.xml">
      
      <link rel="icon" href="../../../../assets/logo.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.22">
    
    
      
        <title>Linux 文本处理三剑客 - Some Notes</title>
      
    
    
      <link rel="stylesheet" href="../../../../assets/stylesheets/main.84d31ad4.min.css">
      
        
        <link rel="stylesheet" href="../../../../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
    <script>__md_scope=new URL("../../../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="green" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#linux" class="md-skip">
          跳转至
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow md-header--lifted" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="页眉">
    <a href="../../../.." title="Some Notes" class="md-header__button md-logo" aria-label="Some Notes" data-md-component="logo">
      
  <img src="../../../../assets/bird.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Some Notes
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Linux 文本处理三剑客
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme="default" data-md-color-primary="green" data-md-color-accent="indigo"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 6H7c-3.31 0-6 2.69-6 6s2.69 6 6 6h10c3.31 0 6-2.69 6-6s-2.69-6-6-6m0 10H7c-2.21 0-4-1.79-4-4s1.79-4 4-4h10c2.21 0 4 1.79 4 4s-1.79 4-4 4M7 9c-1.66 0-3 1.34-3 3s1.34 3 3 3 3-1.34 3-3-1.34-3-3-3"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme="slate" data-md-color-primary="gray" data-md-color-accent="blue"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 7H7a5 5 0 0 0-5 5 5 5 0 0 0 5 5h10a5 5 0 0 0 5-5 5 5 0 0 0-5-5m0 8a3 3 0 0 1-3-3 3 3 0 0 1 3-3 3 3 0 0 1 3 3 3 3 0 0 1-3 3"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="搜索" placeholder="搜索" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="查找">
        
        <button type="reset" class="md-search__icon md-icon" title="清空当前内容" aria-label="清空当前内容" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            正在初始化搜索引擎
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
  </nav>
  
    
      
<nav class="md-tabs" aria-label="标签" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
    
  
  
    <li class="md-tabs__item md-tabs__item--active">
      <a href="../../../.." class="md-tabs__link">
        
  
  
    
  
  Welcome

      </a>
    </li>
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../../../../tags/" class="md-tabs__link">
        
  
  
    
  
  Tags

      </a>
    </li>
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../../archive/2025/" class="md-tabs__link">
          
  
  
    
  
  归档

        </a>
      </li>
    
  

      
    </ul>
  </div>
</nav>
    
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
                
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" hidden>
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="导航栏" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../../.." title="Some Notes" class="md-nav__button md-logo" aria-label="Some Notes" data-md-component="logo">
      
  <img src="../../../../assets/bird.png" alt="logo">

    </a>
    Some Notes
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
    
  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      <a href="../../../.." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Welcome
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../tags/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Tags
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" >
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    归档
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            归档
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="../../../../archive/2025/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    2025
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="../../../../archive/2024/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    2024
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="../../../../archive/2023/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    2023
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="../../../../archive/2022/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    2022
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="../../../../archive/2021/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    2021
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="../../../../archive/2020/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    2020
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="../../../../archive/2019/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    2019
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
                
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="目录">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      目录
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#sed-vmstatcsv" class="md-nav__link">
    <span class="md-ellipsis">
      sed 将vmstat的输出转成csv
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#awk" class="md-nav__link">
    <span class="md-ellipsis">
      awk 遍历
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#python-openpyxl-excel" class="md-nav__link">
    <span class="md-ellipsis">
      使用python库 openpyxl 处理excel
    </span>
  </a>
  
    <nav class="md-nav" aria-label="使用python库 openpyxl 处理excel">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_1" class="md-nav__link">
    <span class="md-ellipsis">
      插入图片
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#xlwings" class="md-nav__link">
    <span class="md-ellipsis">
      xlwings
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#libreoffice" class="md-nav__link">
    <span class="md-ellipsis">
      Libreoffice
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Libreoffice">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#libreoffice-python" class="md-nav__link">
    <span class="md-ellipsis">
      libreoffice 也支持 python
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
  <div class="md-content md-content--post" data-md-component="content">
    <div class="md-sidebar md-sidebar--post" data-md-component="sidebar" data-md-type="navigation">
      <div class="md-sidebar__scrollwrap">
        <div class="md-sidebar__inner md-post">
          <nav class="md-nav md-nav--primary">
            <div class="md-post__back">
              <div class="md-nav__title md-nav__container">
                <a href="../../../.." class="md-nav__link">
                  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
                  <span class="md-ellipsis">
                    回到主页
                  </span>
                </a>
              </div>
            </div>
            
            <ul class="md-post__meta md-nav__list">
              <li class="md-nav__item md-nav__item--section">
                <div class="md-post__title">
                  <span class="md-ellipsis">
                    元数据
                  </span>
                </div>
                <nav class="md-nav">
                  <ul class="md-nav__list">
                    <li class="md-nav__item">
                      <div class="md-nav__link">
                        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 19H5V8h14m-3-7v2H8V1H6v2H5c-1.11 0-2 .89-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2V5a2 2 0 0 0-2-2h-1V1m-1 11h-5v5h5z"/></svg>
                        <time datetime="2025-01-16 00:00:00+00:00" class="md-ellipsis">2025年1月16日</time>
                      </div>
                    </li>
                    
                    
                    
                      
                      <li class="md-nav__item">
                        <div class="md-nav__link">
                          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 20a8 8 0 0 0 8-8 8 8 0 0 0-8-8 8 8 0 0 0-8 8 8 8 0 0 0 8 8m0-18a10 10 0 0 1 10 10 10 10 0 0 1-10 10C6.47 22 2 17.5 2 12A10 10 0 0 1 12 2m.5 5v5.25l4.5 2.67-.75 1.23L11 13V7z"/></svg>
                          <span class="md-ellipsis">
                            
                              需要 3 分钟阅读时间
                            
                          </span>
                        </div>
                      </li>
                    
                  </ul>
                </nav>
              </li>
            </ul>
            
          </nav>
          
        </div>
      </div>
    </div>
    <article class="md-content__inner md-typeset">
      
        
  


  <nav class="md-tags" >
    
      
      
      
        <a href="../../../../tags/#tag:linux" class="md-tag">linux</a>
      
    
      
      
      
        <a href="../../../../tags/#tag:tool" class="md-tag">tool</a>
      
    
  </nav>



<h1 id="linux">Linux 文本处理三剑客<a class="headerlink" href="#linux" title="Permanent link">&para;</a></h1>
<p>grep awk sed</p>
<h2 id="sed-vmstatcsv">sed 将vmstat的输出转成csv<a class="headerlink" href="#sed-vmstatcsv" title="Permanent link">&para;</a></h2>
<p>vmstat的输出如下，空格分割的。sed命令<code>sed 's/^  *//;s/  */,/g'  vmstat.dat &gt; vmstat.02.csv</code>做了两件事：
1. 将行首的空格去掉
2. 将其他空格转成','符合csv的格式</p>
<p>多个sed命令用';'分隔，且共用/g命令</p>
<p><div class="highlight"><pre><span></span><code>procs -----------memory---------- ---swap-- -----io---- -system-- -------cpu-------
 r  b   swpd   free   buff  cache   si   so    bi    bo   in   cs us sy id wa st gu
 1  0 999208 3603968 353020 8258580    0    0    22   166 1016    2  4  1 94  0  0  0
</code></pre></div>
处理后
<div class="highlight"><pre><span></span><code>procs,-----------memory----------,---swap--,-----io----,-system--,-------cpu-------
r,b,swpd,free,buff,cache,si,so,bi,bo,in,cs,us,sy,id,wa,st,gu
1,0,999208,3603968,353020,8258580,0,0,22,166,1016,2,4,1,94,0,0,0
</code></pre></div></p>
<h2 id="awk">awk 遍历<a class="headerlink" href="#awk" title="Permanent link">&para;</a></h2>
<p>我之前的awk通常用来打印某一列的内容，例如<code>cat vmstat.dat | awk -F' ' '{print $1}'</code> 打印$1第一列, -F设定分隔符。除此之外还能遍历查找。
例如查找'TARGET'
<div class="highlight"><pre><span></span><code>awk<span class="w"> </span><span class="s1">&#39;{for(i=1;i&lt;=NF;i++)if($i==&quot;TARGET&quot;){print &quot;TARGET located at row: &quot; NR &quot; col: &quot; i }}&#39;</span><span class="w"> </span>
</code></pre></div></p>
<p>这里NR表示当前的<code>行</code>， NF代表当前的<code>列</code>。 NR还可以用来指定要处理的行号，例如vmstat中有两个header。例如
1. 只打印第二行的命令是<code>awk '(NR==2){print $0}'</code>
2. 要知道'id'在哪一列，则遍历第二行的每一列数据 <code>awk '(NR==2){for(i=1;i&lt;NF;i++) if($i=="id"){print i}'</code> 会打印'15'
3. 要打印id这列的第一行的值, <code>awk '(NR==2){for(i=1;i&lt;NF;i++) if($i=="id"){getline; print $i}'</code> 会打印'94'</p>
<p>要打印id这列的第N行的值时，就循环调用getline N次。</p>
<h2 id="python-openpyxl-excel">使用python库 openpyxl 处理excel<a class="headerlink" href="#python-openpyxl-excel" title="Permanent link">&para;</a></h2>
<p>体验了 openpyxl, 接口设计非常自然， 功能也非常全， 包括合并格子、字体、颜色。典型用法如下
<div class="highlight"><pre><span></span><code><span class="kn">import</span><span class="w"> </span><span class="nn">openpyxl</span>


<span class="n">workbook</span> <span class="o">=</span> <span class="n">openpyxl</span><span class="o">.</span><span class="n">load_workbook</span><span class="p">(</span><span class="s1">&#39;output.xlsx&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">workbook</span><span class="o">.</span><span class="n">sheetnames</span><span class="p">)</span>

<span class="n">sheet</span> <span class="o">=</span> <span class="n">workbook</span><span class="p">[</span><span class="s1">&#39;Sheet&#39;</span><span class="p">]</span>
<span class="nb">print</span><span class="p">(</span><span class="n">sheet</span><span class="o">.</span><span class="n">max_row</span><span class="p">)</span> <span class="c1">#总行数</span>
<span class="nb">print</span><span class="p">(</span><span class="n">sheet</span><span class="o">.</span><span class="n">max_column</span><span class="p">)</span> <span class="c1">#总列数</span>
<span class="nb">print</span><span class="p">(</span><span class="n">sheet</span><span class="o">.</span><span class="n">dimensions</span><span class="p">)</span> <span class="c1">#左上角:右下角</span>

<span class="n">cell1</span> <span class="o">=</span> <span class="n">sheet</span><span class="p">[</span><span class="s1">&#39;A1&#39;</span><span class="p">]</span>
<span class="nb">print</span><span class="p">(</span><span class="n">cell1</span><span class="o">.</span><span class="n">row</span><span class="p">)</span> <span class="c1">#1</span>
<span class="nb">print</span><span class="p">(</span><span class="n">cell1</span><span class="o">.</span><span class="n">column</span><span class="p">)</span> <span class="c1">#A</span>
<span class="nb">print</span><span class="p">(</span><span class="n">cell1</span><span class="o">.</span><span class="n">coordinate</span><span class="p">)</span> <span class="c1">#A1</span>

<span class="c1"># 单元格的内容</span>
<span class="nb">print</span><span class="p">(</span><span class="n">cell1</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>

<span class="c1"># 遍历</span>
<span class="c1">#先行后列</span>
<span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">sheet</span><span class="o">.</span><span class="n">iter_rows</span><span class="p">():</span>
  <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">row</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;[</span><span class="si">{</span><span class="n">c</span><span class="o">.</span><span class="n">row</span><span class="si">}</span><span class="s2">][</span><span class="si">{</span><span class="n">c</span><span class="o">.</span><span class="n">column</span><span class="si">}</span><span class="s2">] = </span><span class="si">{</span><span class="n">c</span><span class="o">.</span><span class="n">value</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="c1">#先列后行</span>
<span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">sheet</span><span class="o">.</span><span class="n">iter_cols</span><span class="p">():</span>
  <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="n">col</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;[</span><span class="si">{</span><span class="n">r</span><span class="o">.</span><span class="n">row</span><span class="si">}</span><span class="s2">][</span><span class="si">{</span><span class="n">r</span><span class="o">.</span><span class="n">column</span><span class="si">}</span><span class="s2">] = </span><span class="si">{</span><span class="n">r</span><span class="o">.</span><span class="n">value</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="c1"># 保存</span>
<span class="n">workbook</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="s1">&#39;test.xlsx&#39;</span><span class="p">)</span>
</code></pre></div></p>
<h3 id="_1">插入图片<a class="headerlink" href="#_1" title="Permanent link">&para;</a></h3>
<p>openpyxl还能插入图片，感觉非常棒</p>
<p><div class="highlight"><pre><span></span><code><span class="kn">from</span><span class="w"> </span><span class="nn">openpyxl</span><span class="w"> </span><span class="kn">import</span> <span class="n">Workbook</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">openpyxl.drawing.image</span><span class="w"> </span><span class="kn">import</span> <span class="n">Image</span>

<span class="n">wb</span> <span class="o">=</span> <span class="n">Workbook</span><span class="p">()</span>
<span class="n">ws</span> <span class="o">=</span> <span class="n">wb</span><span class="o">.</span><span class="n">active</span>
<span class="n">ws</span><span class="p">[</span><span class="s1">&#39;A1&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;You should see three logos below&#39;</span>

<span class="c1"># create an image</span>
<span class="n">img</span> <span class="o">=</span> <span class="n">Image</span><span class="p">(</span><span class="s1">&#39;logo.png&#39;</span><span class="p">)</span>

<span class="c1"># add to worksheet and anchor next to cells</span>
<span class="n">ws</span><span class="o">.</span><span class="n">add_image</span><span class="p">(</span><span class="n">img</span><span class="p">,</span> <span class="s1">&#39;A1&#39;</span><span class="p">)</span>
<span class="n">wb</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="s1">&#39;logo.xlsx&#39;</span><span class="p">)</span>
</code></pre></div>
https://openpyxl.readthedocs.io/en/stable/images.html</p>
<h2 id="xlwings">xlwings<a class="headerlink" href="#xlwings" title="Permanent link">&para;</a></h2>
<p>Currently, xlwings can only run as a remote interpreter on Linux, see: https://docs.xlwings.org/en/stable/remote_interpreter.html
There are plans to add read/write capabilities, but for now you have to use one of OpenPyXL, XlsxWriter, or pyxlsb,</p>
<h2 id="libreoffice">Libreoffice<a class="headerlink" href="#libreoffice" title="Permanent link">&para;</a></h2>
<p>类比Excel使用vba来编程，Libreoffice sheet使用Basic，同时也支持 <a href="https://help.libreoffice.org/latest/lo/text/sbasic/python/python_programming.html?&amp;DbPAR=BASIC&amp;System=UNIX">python</a></p>
<p>在chatgpt帮助下写了个url转图片的BASIC脚本
<div class="highlight"><pre><span></span><code><span class="c1">REM  *****  BASIC  *****</span>
<span class="vg">Option</span><span class="w"> </span><span class="vg">Explicit</span>

<span class="vg">Sub</span><span class="w"> </span><span class="vg">InsertAndResizeImages</span><span class="p">()</span><span class="w">                </span>
<span class="w">    </span><span class="vg">Dim</span><span class="w"> </span><span class="vg">oSheet</span><span class="w"> </span><span class="vg">As</span><span class="w"> </span><span class="vg">Object</span>
<span class="w">    </span><span class="kd">DIM</span><span class="w"> </span><span class="vg">oCell</span><span class="w"> </span><span class="vg">as</span><span class="w"> </span><span class="vg">Object</span><span class="w"> </span>
<span class="w">    </span><span class="vg">Dim</span><span class="w"> </span><span class="vg">oGraphic</span><span class="w"> </span><span class="vg">As</span><span class="w"> </span><span class="vg">Object</span>
<span class="w">    </span><span class="vg">Dim</span><span class="w"> </span><span class="vg">i</span><span class="w"> </span><span class="vg">As</span><span class="w"> </span><span class="vg">Long</span>
<span class="w">    </span><span class="vg">Dim</span><span class="w"> </span><span class="vg">imageURL</span><span class="w"> </span><span class="vg">As</span><span class="w"> </span><span class="vg">String</span>
<span class="w">    </span><span class="vg">Dim</span><span class="w"> </span><span class="vg">oSize</span><span class="w"> </span><span class="vg">As</span><span class="w"> </span><span class="vg">New</span><span class="w"> </span><span class="vg">com</span><span class="o">.</span><span class="vg">sun</span><span class="o">.</span><span class="vg">star</span><span class="o">.</span><span class="vg">awt</span><span class="o">.</span><span class="vg">Size</span>
<span class="w">      </span><span class="vg">Dim</span><span class="w"> </span><span class="vg">oColumns</span><span class="w"> </span><span class="vg">as</span><span class="w"> </span><span class="vg">Object</span>
<span class="w">      </span><span class="vg">Dim</span><span class="w"> </span><span class="vg">oRows</span><span class="w"> </span><span class="vg">As</span><span class="w"> </span><span class="vg">Object</span>


<span class="w">    </span><span class="vg">oSheet</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="vg">ThisComponent</span><span class="o">.</span><span class="vg">CurrentController</span><span class="o">.</span><span class="vg">getActiveSheet</span><span class="p">()</span>

<span class="w">    </span><span class="vg">oColumns</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="vg">oSheet</span><span class="o">.</span><span class="vg">getColumns</span><span class="p">()</span>
<span class="w">    </span><span class="vg">oColumns</span><span class="o">.</span><span class="vg">getByIndex</span><span class="p">(</span><span class="il">0</span><span class="p">)</span><span class="o">.</span><span class="vg">Width</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="il">3200</span>


<span class="w">    </span><span class="vg">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="il">160</span>
<span class="w">    </span><span class="vg">Do</span>

<span class="w">        </span><span class="vg">oCell</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="vg">oSheet</span><span class="o">.</span><span class="vg">getCellByPosition</span><span class="p">(</span><span class="il">0</span><span class="p">,</span><span class="w"> </span><span class="vg">i</span><span class="p">)</span>
<span class="w">        </span><span class="vg">oRows</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="vg">oSheet</span><span class="o">.</span><span class="vg">getRows</span><span class="p">()</span>
<span class="w">        </span><span class="vg">oRows</span><span class="o">.</span><span class="vg">getByIndex</span><span class="p">(</span><span class="vg">i</span><span class="p">)</span><span class="o">.</span><span class="vg">Height</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="il">3200</span>

<span class="w">        </span><span class="vg">imageURL</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="vg">oCell</span><span class="o">.</span><span class="vg">String</span>
<span class="w">        </span><span class="vg">If</span><span class="w"> </span><span class="vg">imageURL</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;&quot;</span><span class="w"> </span><span class="vg">Then</span><span class="w"> </span><span class="vg">Exit</span><span class="w"> </span><span class="vg">Do</span>
<span class="w">        </span><span class="c1">&#39;Debug.Print oCell.String</span>
<span class="w">        </span><span class="c1">&#39;MsgBox imageURL</span>

<span class="w">        </span><span class="vg">On</span><span class="w"> </span><span class="vg">Error</span><span class="w"> </span><span class="vg">GoTo</span><span class="w"> </span><span class="vg">NextImage</span>
<span class="w">        </span><span class="vg">oGraphic</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="vg">ThisComponent</span><span class="o">.</span><span class="vg">createInstance</span><span class="p">(</span><span class="s2">&quot;com.sun.star.drawing.GraphicObjectShape&quot;</span><span class="p">)</span><span class="w"> </span>
<span class="w">        </span><span class="vg">oGraphic</span><span class="o">.</span><span class="vg">GraphicURL</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="vg">imageURL</span>
<span class="w">        </span><span class="vg">oGraphic</span><span class="o">.</span><span class="vg">Position</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="vg">oCell</span><span class="o">.</span><span class="vg">Position</span>

<span class="w">        </span><span class="vg">oSheet</span><span class="o">.</span><span class="vg">DrawPage</span><span class="o">.</span><span class="vg">add</span><span class="p">(</span><span class="vg">oGraphic</span><span class="p">)</span>

<span class="w">        </span><span class="vg">oSize</span><span class="o">.</span><span class="vg">Width</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="il">3200</span>
<span class="w">        </span><span class="vg">oSize</span><span class="o">.</span><span class="vg">Height</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="il">3200</span>
<span class="w">        </span><span class="vg">oGraphic</span><span class="o">.</span><span class="vg">Size</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="vg">oSize</span>

<span class="w">        </span><span class="vg">Wait</span><span class="w"> </span><span class="il">500</span><span class="w">  </span><span class="c1">&#39; Pauses for 0.5 seconds</span>

<span class="w">    </span><span class="vg">Exit</span><span class="w"> </span><span class="vg">Do</span>
<span class="nl">NextImage:</span>
<span class="w">        </span><span class="vg">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="vg">i</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="il">1</span>
<span class="w">    </span><span class="vg">Loop</span>

<span class="vg">End</span><span class="w"> </span><span class="vg">Sub</span>
</code></pre></div></p>
<h3 id="libreoffice-python">libreoffice 也支持 python<a class="headerlink" href="#libreoffice-python" title="Permanent link">&para;</a></h3>
<p>libreoffice 的UNO API是独立于编程语言的，BASIC可以直接用 <code>ThisComponent</code>，而python需要通过'XSCRIPTCONTEXT'来用，获取sheet的BOOK对象方法是<code>doc = XSCRIPTCONTEXT.getDocument()</code></p>
<p>有个Basic和Python的<a href="https://help.libreoffice.org/latest/lo/text/sbasic/guide/read_write_values.html?DbPAR=BASIC#bm_id41582391760114">对比写法</a>，总结是很相似。用python重写BASIC代码就是</p>
<div class="highlight"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">insert_and_resize_images</span><span class="p">():</span>
    <span class="kn">from</span><span class="w"> </span><span class="nn">com.sun.star.awt</span><span class="w"> </span><span class="kn">import</span> <span class="n">Size</span>
    <span class="kn">import</span><span class="w"> </span><span class="nn">time</span>

    <span class="n">doc</span> <span class="o">=</span> <span class="n">XSCRIPTCONTEXT</span><span class="o">.</span><span class="n">getDocument</span><span class="p">()</span>
    <span class="n">sheet</span> <span class="o">=</span> <span class="n">doc</span><span class="o">.</span><span class="n">CurrentController</span><span class="o">.</span><span class="n">ActiveSheet</span>

    <span class="n">columns</span> <span class="o">=</span> <span class="n">sheet</span><span class="o">.</span><span class="n">getColumns</span><span class="p">()</span>
    <span class="n">columns</span><span class="o">.</span><span class="n">getByIndex</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">Width</span> <span class="o">=</span> <span class="mi">3200</span>

    <span class="n">i</span> <span class="o">=</span> <span class="mi">160</span>
    <span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
        <span class="n">cell</span> <span class="o">=</span> <span class="n">sheet</span><span class="o">.</span><span class="n">getCellByPosition</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">i</span><span class="p">)</span>
        <span class="n">rows</span> <span class="o">=</span> <span class="n">sheet</span><span class="o">.</span><span class="n">getRows</span><span class="p">()</span>
        <span class="n">rows</span><span class="o">.</span><span class="n">getByIndex</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">.</span><span class="n">Height</span> <span class="o">=</span> <span class="mi">3200</span>

        <span class="n">image_url</span> <span class="o">=</span> <span class="n">cell</span><span class="o">.</span><span class="n">String</span>
        <span class="k">if</span> <span class="n">image_url</span> <span class="o">==</span> <span class="s2">&quot;&quot;</span><span class="p">:</span>
            <span class="k">break</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="n">graphic</span> <span class="o">=</span> <span class="n">doc</span><span class="o">.</span><span class="n">createInstance</span><span class="p">(</span><span class="s2">&quot;com.sun.star.drawing.GraphicObjectShape&quot;</span><span class="p">)</span>
            <span class="n">graphic</span><span class="o">.</span><span class="n">GraphicURL</span> <span class="o">=</span> <span class="n">image_url</span>
            <span class="n">graphic</span><span class="o">.</span><span class="n">Position</span> <span class="o">=</span> <span class="n">cell</span><span class="o">.</span><span class="n">Position</span>

            <span class="n">sheet</span><span class="o">.</span><span class="n">DrawPage</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">graphic</span><span class="p">)</span>

            <span class="n">size</span> <span class="o">=</span> <span class="n">Size</span><span class="p">()</span>
            <span class="n">size</span><span class="o">.</span><span class="n">Width</span> <span class="o">=</span> <span class="mi">3200</span>
            <span class="n">size</span><span class="o">.</span><span class="n">Height</span> <span class="o">=</span> <span class="mi">3200</span>
            <span class="n">graphic</span><span class="o">.</span><span class="n">Size</span> <span class="o">=</span> <span class="n">size</span>

            <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mf">0.5</span><span class="p">)</span>  <span class="c1"># 0.5 seconds pause</span>

        <span class="k">except</span><span class="p">:</span>
            <span class="k">pass</span>  <span class="c1"># Continue on error</span>

        <span class="n">i</span> <span class="o">+=</span> <span class="mi">1</span>
</code></pre></div>
<p>无论是excel的xlwings还是libreoffice sheet的pyUNO, 都不能独立使用，都要安装套件。 </p>







  
  




  



  <h2 id="__comments">评论</h2>
  <script src="https://giscus.app/client.js"
        data-repo="energygreek/notes"
        data-repo-id="R_kgDOLsTfag"
        data-category="Show and tell"
        data-category-id="DIC_kwDOLsTfas4ClMDg"
        data-mapping="pathname"
        data-strict="0"
        data-reactions-enabled="1"
        data-emit-metadata="0"
        data-input-position="bottom"
        data-theme="preferred_color_scheme"
        data-lang="zh-CN"
        data-loading="lazy"
        crossorigin="anonymous"
        async>
  </script>

  <!-- Synchronize Giscus theme with palette -->
  <script>
    var giscus = document.querySelector("script[src*=giscus]")

    // Set palette on initial load
    var palette = __md_get("__palette")
    if (palette && typeof palette.color === "object") {
      var theme = palette.color.scheme === "slate"
        ? "transparent_dark"
        : "light"

      // Instruct Giscus to set theme
      giscus.setAttribute("data-theme", theme) 
    }

    // Register event handlers after documented loaded
    document.addEventListener("DOMContentLoaded", function() {
      var ref = document.querySelector("[data-md-component=palette]")
      ref.addEventListener("change", function() {
        var palette = __md_get("__palette")
        if (palette && typeof palette.color === "object") {
          var theme = palette.color.scheme === "slate"
            ? "transparent_dark"
            : "light"

          // Instruct Giscus to change theme
          var frame = document.querySelector(".giscus-frame")
          frame.contentWindow.postMessage(
            { giscus: { setConfig: { theme } } },
            "https://giscus.app"
          )
        }
      })
    })
  </script>

      
    </article>
  </div>

          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
    
      
        
      
      <nav class="md-footer__inner md-grid" aria-label="页脚" >
        
          
          <a href="../../../../2024/12/18/%E8%BF%9E%E8%AF%8D%E5%92%8C%E5%A4%8D%E5%90%88%E5%8F%A5/" class="md-footer__link md-footer__link--prev" aria-label="上一页: 连词和复合句">
            <div class="md-footer__button md-icon">
              
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
            </div>
            <div class="md-footer__title">
              <span class="md-footer__direction">
                上一页
              </span>
              <div class="md-ellipsis">
                连词和复合句
              </div>
            </div>
          </a>
        
        
          
          <a href="../../../02/07/difference-of-lxc-container-and-docker-container/" class="md-footer__link md-footer__link--next" aria-label="下一页: difference of lxc container and docker container">
            <div class="md-footer__title">
              <span class="md-footer__direction">
                下一页
              </span>
              <div class="md-ellipsis">
                difference of lxc container and docker container
              </div>
            </div>
            <div class="md-footer__button md-icon">
              
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11z"/></svg>
            </div>
          </a>
        
      </nav>
    
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
      <div class="md-progress" data-md-component="progress" role="progressbar"></div>
    
    
    
      
      <script id="__config" type="application/json">{"base": "../../../..", "features": ["navigation.tabs", "navigation.indexes", "navigation.tabs.sticky", "navigation.instant", "navigation.instant.progress", "navigation.footer", "toc.follow", "content.code.copy", "content.action.view"], "search": "../../../../assets/javascripts/workers/search.973d3a69.min.js", "tags": null, "translations": {"clipboard.copied": "\u5df2\u590d\u5236", "clipboard.copy": "\u590d\u5236", "search.result.more.one": "\u5728\u8be5\u9875\u4e0a\u8fd8\u6709 1 \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.more.other": "\u5728\u8be5\u9875\u4e0a\u8fd8\u6709 # \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.none": "\u6ca1\u6709\u627e\u5230\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.one": "\u627e\u5230 1 \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.other": "# \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.placeholder": "\u952e\u5165\u4ee5\u5f00\u59cb\u641c\u7d22", "search.result.term.missing": "\u7f3a\u5c11", "select.version": "\u9009\u62e9\u5f53\u524d\u7248\u672c"}, "version": null}</script>
    
    
      <script src="../../../../assets/javascripts/bundle.f55a23d4.min.js"></script>
      
        <script src="../../../../js/tex-mml-chtml.js"></script>
      
        <script src="../../../../js/mermaid.min.js"></script>
      
    
  </body>
</html>