{"config":{"lang":["en"],"separator":"[\\s\\u200b\\u3000\\-\u3001\u3002\uff0c\uff0e\uff1f\uff01\uff1b]+","pipeline":["stemmer"],"fields":{"title":{"boost":1000.0},"text":{"boost":1.0},"tags":{"boost":1000000.0}}},"docs":[{"location":"","title":"Welcome to my blog","text":"<p>A self-host blog backup, built with mkdocs, is compatible with either Obsidian or Vscode&amp;Foam.   - Blog - Status Page - Email to Me - RSS</p>"},{"location":"tags/","title":"Tags","text":""},{"location":"tags/#tag:51\u5355\u7247\u673a","title":"51\u5355\u7247\u673a","text":"<ul> <li>            \u5728Linux\u4e0b\u4f7f\u7528sdcc\u8fdb\u884c\u5355\u7247\u673a\u7f16\u8bd1          </li> </ul>"},{"location":"tags/#tag:cmsg","title":"CMSG","text":"<ul> <li>            \u83b7\u53d6\u5176\u4ed6\u8fdb\u7a0b\u6253\u5f00\u7684\u6587\u4ef6\u63cf\u8ff0\u7b26          </li> </ul>"},{"location":"tags/#tag:dp","title":"DP","text":"<ul> <li>            DP \u56db\u677f\u65a7          </li> </ul>"},{"location":"tags/#tag:english","title":"English","text":"<ul> <li>            \u8fde\u8bcd\u548c\u590d\u5408\u53e5          </li> </ul>"},{"location":"tags/#tag:gpio","title":"GPIO","text":"<ul> <li>            Learn GPIO          </li> </ul>"},{"location":"tags/#tag:linux","title":"Linux","text":"<ul> <li>            Linux \u4e2d\u65ad\u8bf7\u6c42          </li> </ul>"},{"location":"tags/#tag:ncm-gadget","title":"NCM Gadget","text":"<ul> <li>            Ethernet over USB          </li> </ul>"},{"location":"tags/#tag:usb","title":"USB","text":"<ul> <li>            Ethernet over USB          </li> </ul>"},{"location":"tags/#tag:aarch64","title":"aarch64","text":"<ul> <li>            Install KVM on Debian of aarch64 architecture          </li> </ul>"},{"location":"tags/#tag:android","title":"android","text":"<ul> <li>            adb remote forward          </li> <li>            huawei unlock bootloader          </li> </ul>"},{"location":"tags/#tag:api","title":"api","text":"<ul> <li>            system calls method          </li> </ul>"},{"location":"tags/#tag:apple","title":"apple","text":"<ul> <li>            download music to ipod shuffle 4          </li> </ul>"},{"location":"tags/#tag:arduino","title":"arduino","text":"<ul> <li>            arduino-cli \u4f7f\u7528          </li> <li>            connect raspberry and arduino via i2c          </li> <li>            \u73a9\u8f6cESP32          </li> </ul>"},{"location":"tags/#tag:aria2","title":"aria2","text":"<ul> <li>            aria2c usage          </li> </ul>"},{"location":"tags/#tag:asm","title":"asm","text":"<ul> <li>            c \u4e2d register \u5173\u952e\u5b57          </li> </ul>"},{"location":"tags/#tag:atomic","title":"atomic","text":"<ul> <li>            CPP\u539f\u5b50\u64cd\u4f5c          </li> </ul>"},{"location":"tags/#tag:bash","title":"bash","text":"<ul> <li>            bash learning          </li> <li>            bash safety          </li> </ul>"},{"location":"tags/#tag:buffer","title":"buffer","text":"<ul> <li>            \u8f93\u51fa\u7f13\u51b2\u548cstdbuf          </li> </ul>"},{"location":"tags/#tag:c","title":"c","text":"<ul> <li>            c \u4e2d register \u5173\u952e\u5b57          </li> <li>            c++ \u4fe1\u53f7\u548c\u5f02\u5e38          </li> <li>            c\u8bed\u8a00\u4e2dpointer\u548carray\u7684\u533a\u522b          </li> <li>            gcc \u4f1a\u4f18\u5316\u5f88\u591a\u5185\u5b58\u76f8\u5173\u7684\u8c03\u7528          </li> <li>            gdb\u8c03\u8bd5\u5bb9\u5668\u5185\u7684\u8fdb\u7a0b          </li> <li>            grpc callback api          </li> <li>            grpc \u5b66\u4e60          </li> <li>            mutex error          </li> <li>            static compile warning if namespace resolving function used          </li> <li>            \u4e50\u89c2\u9501\u60b2\u89c2\u9501          </li> <li>            \u5728c\u8bed\u8a00\u4e2d\u6253\u5370\u652f\u6301\u4e0d\u540c\u7c7b\u578b\u53d8\u91cf          </li> <li>            \u7f16\u7a0b\u8bed\u8a00\u4e2d\u5c0f\u6570\u7cbe\u5ea6\u95ee\u9898          </li> <li>            \u8fdb\u4f4d\u4f4d\u548c\u6ea2\u51fa\u4f4d(carry bit/overflow bit)          </li> </ul>"},{"location":"tags/#tag:c","title":"c,","text":"<ul> <li>            c++ \u5b58\u50a8\u5468\u671f\u3001\u94fe\u63a5\u548c\u4f5c\u7528\u57df          </li> </ul>"},{"location":"tags/#tag:ccpp","title":"c/cpp","text":"<ul> <li>            C++ \u5c0f\u6280\u5de7          </li> <li>            CPP\u539f\u5b50\u64cd\u4f5c          </li> <li>            advanced marco in c          </li> <li>            \u6a21\u677f\u7f16\u7a0b          </li> </ul>"},{"location":"tags/#tag:clang","title":"clang","text":"<ul> <li>            ways of generating compile command json file          </li> </ul>"},{"location":"tags/#tag:cmake","title":"cmake","text":"<ul> <li>            cmake learning          </li> <li>            cmake precompile header          </li> <li>            cmake \u4f7f\u7528\u7b2c\u4e09\u65b9\u5e93          </li> </ul>"},{"location":"tags/#tag:compile","title":"compile","text":"<ul> <li>            static compile warning if namespace resolving function used          </li> </ul>"},{"location":"tags/#tag:cpp","title":"cpp","text":"<ul> <li>            c \u4e2d register \u5173\u952e\u5b57          </li> <li>            c++ \u4fe1\u53f7\u548c\u5f02\u5e38          </li> <li>            c++ \u5b58\u50a8\u5468\u671f\u3001\u94fe\u63a5\u548c\u4f5c\u7528\u57df          </li> <li>            c++\u7684basic_string\u4f18\u5316          </li> <li>            gcc \u4f1a\u4f18\u5316\u5f88\u591a\u5185\u5b58\u76f8\u5173\u7684\u8c03\u7528          </li> <li>            gdb\u8c03\u8bd5\u5bb9\u5668\u5185\u7684\u8fdb\u7a0b          </li> <li>            grpc callback api          </li> <li>            grpc \u5b66\u4e60          </li> <li>            mutex error          </li> <li>            spdlog learning          </li> <li>            static compile warning if namespace resolving function used          </li> <li>            \u4e50\u89c2\u9501\u60b2\u89c2\u9501          </li> <li>            \u53f3\u503c, \u4e34\u65f6\u53d8\u91cf\u4e0e\u5f15\u7528          </li> <li>            \u667a\u80fd\u6307\u9488          </li> </ul>"},{"location":"tags/#tag:c-libdl","title":"c\uff0c libdl","text":"<ul> <li>            live c program          </li> </ul>"},{"location":"tags/#tag:ddns","title":"ddns","text":"<ul> <li>            \u963f\u91cc\u4e91\u52a8\u6001\u8bbe\u7f6e dns          </li> </ul>"},{"location":"tags/#tag:debian","title":"debian","text":"<ul> <li>            \u968f\u8eabwifi\u5de5\u5177\u5237\u673a          </li> </ul>"},{"location":"tags/#tag:debug","title":"debug","text":"<ul> <li>            segfault in dmesg          </li> <li>            udp \u67e5\u770b\u7edf\u8ba1\u7684\u65b9\u6cd5          </li> </ul>"},{"location":"tags/#tag:dev-tool","title":"dev-tool","text":"<ul> <li>            ways of generating compile command json file          </li> </ul>"},{"location":"tags/#tag:dns","title":"dns","text":"<ul> <li>            \u4e3apve\u914d\u7f6edns          </li> </ul>"},{"location":"tags/#tag:docker","title":"docker","text":"<ul> <li>            Dockerfile \u4e2dENTRYPOINT\u548cCMD\u7684\u533a\u522b          </li> <li>            difference of lxc container and docker container          </li> <li>            docker network          </li> <li>            docker overlay filesystem          </li> <li>            docker storage          </li> <li>            \u5bb9\u5668\u7684\u547d\u540d\u7a7a\u95f4          </li> <li>            \u642d\u5efak8s\u96c6\u7fa4          </li> </ul>"},{"location":"tags/#tag:dp","title":"dp","text":"<ul> <li>            \u80cc\u5305\u95ee\u9898          </li> </ul>"},{"location":"tags/#tag:dpdk","title":"dpdk","text":"<ul> <li>            dpdk-testpmd to test NIC speed          </li> <li>            pci passthrough          </li> </ul>"},{"location":"tags/#tag:email","title":"email","text":"<ul> <li>            Linux\u4e0b\u7684\u90ae\u4ef6\u914d\u7f6e          </li> </ul>"},{"location":"tags/#tag:epoll","title":"epoll","text":"<ul> <li>            \u5c0f\u5fc3\u4f7f\u7528 epoll \u8d1f\u8f7d\u5747\u8861          </li> </ul>"},{"location":"tags/#tag:esp","title":"esp","text":"<ul> <li>            \u73a9\u8f6cESP32          </li> </ul>"},{"location":"tags/#tag:esp32","title":"esp32","text":"<ul> <li>            Learn GPIO          </li> </ul>"},{"location":"tags/#tag:exception","title":"exception","text":"<ul> <li>            c++ \u4fe1\u53f7\u548c\u5f02\u5e38          </li> </ul>"},{"location":"tags/#tag:exec","title":"exec","text":"<ul> <li>            linux\u5b50\u8fdb\u7a0b\u4f7f\u7528\u65b9\u6cd5          </li> </ul>"},{"location":"tags/#tag:ffmpeg","title":"ffmpeg","text":"<ul> <li>            Notes          </li> <li>            libavcodec\u4f7f\u7528          </li> <li>            streaming h264 with rtp          </li> </ul>"},{"location":"tags/#tag:file","title":"file","text":"<ul> <li>            shell \u4e2d\u6587\u4ef6\u64cd\u4f5c\u63a5\u53e3          </li> <li>            \u83b7\u53d6\u5176\u4ed6\u8fdb\u7a0b\u6253\u5f00\u7684\u6587\u4ef6\u63cf\u8ff0\u7b26          </li> </ul>"},{"location":"tags/#tag:filesystem","title":"filesystem","text":"<ul> <li>            docker overlay filesystem          </li> <li>            setup sftp service          </li> <li>            \u5728\u6587\u4ef6\u7cfb\u7edf\u4e4b\u4e0a\u518d\u521b\u4e00\u4e2a\u6587\u4ef6\u7cfb\u7edf          </li> </ul>"},{"location":"tags/#tag:firefox","title":"firefox","text":"<ul> <li>            firefox \u542f\u7528\u624b\u52a8\u6dfb\u52a0\u641c\u7d22\u5f15\u64ce          </li> </ul>"},{"location":"tags/#tag:flask","title":"flask","text":"<ul> <li>            \u8bb0\u5f55\u5728\u90e8\u7f72\u4e00\u4e2anginx fastcgi \u9879\u76ee\u65f6\u5931\u8d25\uff0c fastcgi \u901a\u8fc7unix socket \u901a\u8baf          </li> </ul>"},{"location":"tags/#tag:fork","title":"fork","text":"<ul> <li>            linux\u5b50\u8fdb\u7a0b\u4f7f\u7528\u65b9\u6cd5          </li> </ul>"},{"location":"tags/#tag:gcc","title":"gcc","text":"<ul> <li>            gcc \u4f1a\u4f18\u5316\u5f88\u591a\u5185\u5b58\u76f8\u5173\u7684\u8c03\u7528          </li> </ul>"},{"location":"tags/#tag:gdb","title":"gdb","text":"<ul> <li>            gdb\u4e2d\u6253\u5370optarg\u6c38\u8fdc\u662f0x0, \u4f46\u662f\u4f9d\u7136\u80fd\u4f20\u9012\u53c2\u6570          </li> <li>            gdb\u8c03\u8bd5\u5bb9\u5668\u5185\u7684\u8fdb\u7a0b          </li> </ul>"},{"location":"tags/#tag:git","title":"git","text":"<ul> <li>            Git\u7684\u91cd\u8981\u64cd\u4f5c          </li> </ul>"},{"location":"tags/#tag:golang","title":"golang","text":"<ul> <li>            go \u5b66\u4e60\u7b14\u8bb0          </li> </ul>"},{"location":"tags/#tag:gparted","title":"gparted","text":"<ul> <li>            pve\u4e2d\u7ed9windows\u6269\u5bb9          </li> </ul>"},{"location":"tags/#tag:grammar","title":"grammar","text":"<ul> <li>            \u8bed\u6cd5\u89c4\u5219-\u540d\u8bcd\u4fee\u9970\u540d\u8bcd          </li> </ul>"},{"location":"tags/#tag:grpc","title":"grpc","text":"<ul> <li>            grpc callback api          </li> <li>            grpc \u5b66\u4e60          </li> </ul>"},{"location":"tags/#tag:grub","title":"grub","text":"<ul> <li>            crash boot          </li> </ul>"},{"location":"tags/#tag:guitar","title":"guitar","text":"<ul> <li>            \u5409\u4ed6\u5b66\u4e60          </li> </ul>"},{"location":"tags/#tag:i2c","title":"i2c","text":"<ul> <li>            connect raspberry and arduino via i2c          </li> </ul>"},{"location":"tags/#tag:ibus","title":"ibus","text":"<ul> <li>            ibus-setup          </li> </ul>"},{"location":"tags/#tag:ipsec","title":"ipsec","text":"<ul> <li>            ipsec \u548c vowifi          </li> </ul>"},{"location":"tags/#tag:iptables","title":"iptables","text":"<ul> <li>            Linux\u521b\u5efa\u70ed\u70b9          </li> <li>            \u4f7f\u7528iwd\u521b\u5efaap\u70ed\u70b9          </li> </ul>"},{"location":"tags/#tag:irc","title":"irc","text":"<ul> <li>            weechat \u4f7f\u7528\u65b9\u6cd5          </li> </ul>"},{"location":"tags/#tag:k8s","title":"k8s","text":"<ul> <li>            \u642d\u5efak8s\u96c6\u7fa4          </li> </ul>"},{"location":"tags/#tag:lineage","title":"lineage","text":"<ul> <li>            huawei unlock bootloader          </li> </ul>"},{"location":"tags/#tag:linux","title":"linux","text":"<ul> <li>            LVM \u529f\u80fd\u4ecb\u7ecd          </li> <li>            Linux \u6587\u672c\u5904\u7406\u4e09\u5251\u5ba2          </li> <li>            Linux\u521b\u5efa\u70ed\u70b9          </li> <li>            Linux\u5b9a\u65f6\u5668          </li> <li>            buffer-cache too high          </li> <li>            crash boot          </li> <li>            ibus-setup          </li> <li>            linux\u5b50\u8fdb\u7a0b\u4f7f\u7528\u65b9\u6cd5          </li> <li>            pci passthrough          </li> <li>            rhel\u7cfb\u5217\u4fee\u6539\u5bc6\u7801          </li> <li>            sed\u548cvim\u66ff\u6362\u6587\u672c\u7684\u5c0f\u533a\u522b          </li> <li>            setup sftp service          </li> <li>            shell \u4e2d\u6587\u4ef6\u64cd\u4f5c\u63a5\u53e3          </li> <li>            system calls method          </li> <li>            udp \u67e5\u770b\u7edf\u8ba1\u7684\u65b9\u6cd5          </li> <li>            urxvt\u914d\u7f6e          </li> <li>            \u4f7f\u7528iwd\u521b\u5efaap\u70ed\u70b9          </li> <li>            \u521b\u5efa systemd \u670d\u52a1          </li> <li>            \u5728\u6587\u4ef6\u7cfb\u7edf\u4e4b\u4e0a\u518d\u521b\u4e00\u4e2a\u6587\u4ef6\u7cfb\u7edf          </li> <li>            \u83b7\u53d6\u5176\u4ed6\u8fdb\u7a0b\u6253\u5f00\u7684\u6587\u4ef6\u63cf\u8ff0\u7b26          </li> <li>            \u8bb0\u5f55\u4e00\u4e0brhce8\u4e0a\u8bfe\u7b14\u8bb0          </li> <li>            \u8f93\u51fa\u7f13\u51b2\u548cstdbuf          </li> </ul>"},{"location":"tags/#tag:llm","title":"llm","text":"<ul> <li>            run vllm Qwen3 locally          </li> </ul>"},{"location":"tags/#tag:lock","title":"lock","text":"<ul> <li>            \u4e50\u89c2\u9501\u60b2\u89c2\u9501          </li> </ul>"},{"location":"tags/#tag:lvm","title":"lvm","text":"<ul> <li>            LVM \u529f\u80fd\u4ecb\u7ecd          </li> </ul>"},{"location":"tags/#tag:lxc","title":"lxc","text":"<ul> <li>            difference of lxc container and docker container          </li> </ul>"},{"location":"tags/#tag:malloc","title":"malloc","text":"<ul> <li>            \u6d45\u8c08\u5185\u5b58\u7ba1\u7406          </li> </ul>"},{"location":"tags/#tag:math","title":"math","text":"<ul> <li>            \u6307\u6570\u548c\u5bf9\u6570          </li> </ul>"},{"location":"tags/#tag:mdns","title":"mdns","text":"<ul> <li>            \u4f7f\u7528avahi\u5c06\u4f20\u7edf\u6253\u5370\u673a\u652f\u6301\u65e0\u7ebf\u6253\u5370          </li> <li>            \u4f7f\u7528systemd-resolved\u7684mdns          </li> </ul>"},{"location":"tags/#tag:media","title":"media","text":"<ul> <li>            amrnb\u548camrwb\u7684\u7f16\u89e3\u7801          </li> </ul>"},{"location":"tags/#tag:memory","title":"memory","text":"<ul> <li>            buffer-cache too high          </li> <li>            \u6d45\u8c08\u5185\u5b58\u7ba1\u7406          </li> </ul>"},{"location":"tags/#tag:music","title":"music","text":"<ul> <li>            download music to ipod shuffle 4          </li> </ul>"},{"location":"tags/#tag:mutex","title":"mutex","text":"<ul> <li>            mutex error          </li> </ul>"},{"location":"tags/#tag:mutt","title":"mutt","text":"<ul> <li>            Linux\u4e0b\u7684\u90ae\u4ef6\u914d\u7f6e          </li> </ul>"},{"location":"tags/#tag:mysql","title":"mysql","text":"<ul> <li>            mysql sql\u8bed\u53e5\u4f18\u5148\u7ea7          </li> </ul>"},{"location":"tags/#tag:namespace","title":"namespace","text":"<ul> <li>            \u5bb9\u5668\u7684\u547d\u540d\u7a7a\u95f4          </li> </ul>"},{"location":"tags/#tag:nat","title":"nat","text":"<ul> <li>            \u963f\u91cc\u4e91\u52a8\u6001\u8bbe\u7f6e dns          </li> </ul>"},{"location":"tags/#tag:netowrk","title":"netowrk","text":"<ul> <li>            Ethernet over USB          </li> </ul>"},{"location":"tags/#tag:network","title":"network","text":"<ul> <li>            defualt route in linux          </li> <li>            docker network          </li> <li>            \u4f7f\u7528systemd-resolved\u7684mdns          </li> </ul>"},{"location":"tags/#tag:printer","title":"printer","text":"<ul> <li>            \u4f7f\u7528avahi\u5c06\u4f20\u7edf\u6253\u5370\u673a\u652f\u6301\u65e0\u7ebf\u6253\u5370          </li> </ul>"},{"location":"tags/#tag:pve","title":"pve","text":"<ul> <li>            change hostname of pve and vm          </li> <li>            difference of lxc container and docker container          </li> <li>            lxc enable tun device          </li> <li>            pci passthrough          </li> <li>            pve\u4e2d\u7ed9windows\u6269\u5bb9          </li> <li>            pve\u5165\u95e8          </li> <li>            tailscale \u4f7f\u7528\u8bb0\u5f55          </li> <li>            \u4e3apve\u914d\u7f6edns          </li> </ul>"},{"location":"tags/#tag:python","title":"python","text":"<ul> <li>            python arguement types          </li> <li>            python decoder \u4ecb\u7ecd          </li> <li>            python \u5305\u7684\u7ba1\u7406          </li> </ul>"},{"location":"tags/#tag:raspberrypi","title":"raspberryPi","text":"<ul> <li>            wpa\u7ba1\u7406wifi\u63a5\u53e3          </li> </ul>"},{"location":"tags/#tag:rhce","title":"rhce","text":"<ul> <li>            rhel\u7cfb\u5217\u4fee\u6539\u5bc6\u7801          </li> <li>            \u8bb0\u5f55\u4e00\u4e0brhce8\u4e0a\u8bfe\u7b14\u8bb0          </li> </ul>"},{"location":"tags/#tag:route","title":"route","text":"<ul> <li>            defualt route in linux          </li> </ul>"},{"location":"tags/#tag:rtp","title":"rtp","text":"<ul> <li>            streaming h264 with rtp          </li> </ul>"},{"location":"tags/#tag:safety","title":"safety","text":"<ul> <li>            Non-constant time comparison bug          </li> <li>            \u4e3b\u8981\u6536\u96c6\u4e00\u4e9b\u5e38\u89c1\u7f3a\u9677\u548c\u52a0\u56fa\u65b9\u6cd5          </li> </ul>"},{"location":"tags/#tag:sctp","title":"sctp","text":"<ul> <li>            \u83b7\u53d6\u5176\u4ed6\u8fdb\u7a0b\u6253\u5f00\u7684\u6587\u4ef6\u63cf\u8ff0\u7b26          </li> </ul>"},{"location":"tags/#tag:seralize","title":"seralize","text":"<ul> <li>            \u5e8f\u5217\u5316\u548c\u53cd\u5e8f\u5217\u5316          </li> </ul>"},{"location":"tags/#tag:shell","title":"shell","text":"<ul> <li>            shell \u7b14\u8bb0          </li> </ul>"},{"location":"tags/#tag:signal","title":"signal","text":"<ul> <li>            c++ \u4fe1\u53f7\u548c\u5f02\u5e38          </li> </ul>"},{"location":"tags/#tag:socket","title":"socket","text":"<ul> <li>            udp \u7684\u7aef\u53e3\u590d\u7528\u5b9e\u73b0\u8d1f\u8f7d\u5747\u8861          </li> </ul>"},{"location":"tags/#tag:socketopt","title":"socketopt","text":"<ul> <li>            udp \u7684\u7aef\u53e3\u590d\u7528\u5b9e\u73b0\u8d1f\u8f7d\u5747\u8861          </li> </ul>"},{"location":"tags/#tag:sql","title":"sql","text":"<ul> <li>            SQL\u4f18\u5148\u7ea7\u95ee\u9898          </li> <li>            \u6570\u636e\u5e93\u4f18\u5316\u603b\u7ed3          </li> </ul>"},{"location":"tags/#tag:stdbuf","title":"stdbuf","text":"<ul> <li>            \u8f93\u51fa\u7f13\u51b2\u548cstdbuf          </li> </ul>"},{"location":"tags/#tag:string","title":"string","text":"<ul> <li>            c++\u7684basic_string\u4f18\u5316          </li> </ul>"},{"location":"tags/#tag:systemd","title":"systemd","text":"<ul> <li>            \u521b\u5efa systemd \u670d\u52a1          </li> </ul>"},{"location":"tags/#tag:tailcale","title":"tailcale","text":"<ul> <li>            tailscale \u4f7f\u7528\u8bb0\u5f55          </li> </ul>"},{"location":"tags/#tag:template-programing","title":"template programing","text":"<ul> <li>            \u6a21\u677f\u7f16\u7a0b          </li> </ul>"},{"location":"tags/#tag:terminal","title":"terminal","text":"<ul> <li>            urxvt\u914d\u7f6e          </li> </ul>"},{"location":"tags/#tag:tool","title":"tool","text":"<ul> <li>            Git\u7684\u91cd\u8981\u64cd\u4f5c          </li> <li>            Linux \u6587\u672c\u5904\u7406\u4e09\u5251\u5ba2          </li> <li>            add printer in linux          </li> <li>            oauth2 \u8ba4\u8bc1\u8bf4\u660e          </li> <li>            sed\u548cvim\u66ff\u6362\u6587\u672c\u7684\u5c0f\u533a\u522b          </li> <li>            weechat \u4f7f\u7528\u65b9\u6cd5          </li> <li>            yt-dlp downloads qq mv          </li> <li>            \u4f7f\u7528\u6b63\u5219\u6765\u6821\u9a8c\u8f93\u5165\u5408\u6cd5\u6027          </li> <li>            \u968f\u8eabwifi\u5de5\u5177\u5237\u673a          </li> </ul>"},{"location":"tags/#tag:udp","title":"udp","text":"<ul> <li>            udp \u7684\u7aef\u53e3\u590d\u7528\u5b9e\u73b0\u8d1f\u8f7d\u5747\u8861          </li> </ul>"},{"location":"tags/#tag:unittest","title":"unittest","text":"<ul> <li>            \u8bb0\u4e00\u4e2aFakeIt\u4f7f\u7528\u95ee\u9898          </li> </ul>"},{"location":"tags/#tag:urxvt","title":"urxvt","text":"<ul> <li>            urxvt\u914d\u7f6e          </li> </ul>"},{"location":"tags/#tag:virtio","title":"virtio","text":"<ul> <li>            virtio nic configure multi-queue          </li> </ul>"},{"location":"tags/#tag:vnc","title":"vnc","text":"<ul> <li>            pve\u4e2d\u7ed9windows\u6269\u5bb9          </li> </ul>"},{"location":"tags/#tag:vowifi","title":"vowifi","text":"<ul> <li>            ipsec \u548c vowifi          </li> </ul>"},{"location":"tags/#tag:webcrawler","title":"webcrawler","text":"<ul> <li>            \u722c\u866b          </li> </ul>"},{"location":"tags/#tag:webserver","title":"webserver","text":"<ul> <li>            \u8bb0\u5f55\u5728\u90e8\u7f72\u4e00\u4e2anginx fastcgi \u9879\u76ee\u65f6\u5931\u8d25\uff0c fastcgi \u901a\u8fc7unix socket \u901a\u8baf          </li> </ul>"},{"location":"tags/#tag:wiki","title":"wiki","text":"<ul> <li>            database acronyms          </li> </ul>"},{"location":"tags/#tag:wordpress","title":"wordpress","text":"<ul> <li>            \u5b89\u88c5wordpress\u8bb0\u5f55          </li> </ul>"},{"location":"tags/#tag:yt-dlp","title":"yt-dlp","text":"<ul> <li>            yt-dlp downloads qq mv          </li> </ul>"},{"location":"tags/#tag:\u5185\u6838\u539f\u7406","title":"\u5185\u6838\u539f\u7406","text":"<ul> <li>            Linux \u4e2d\u65ad\u8bf7\u6c42          </li> </ul>"},{"location":"tags/#tag:\u5305\u7ba1\u7406","title":"\u5305\u7ba1\u7406","text":"<ul> <li>            python \u5305\u7684\u7ba1\u7406          </li> </ul>"},{"location":"tags/#tag:\u67e5\u627e","title":"\u67e5\u627e","text":"<ul> <li>            \u5b50\u4e32\u67e5\u627e\u7b97\u6cd5          </li> </ul>"},{"location":"tags/#tag:\u6811\u8393\u6d3e","title":"\u6811\u8393\u6d3e","text":"<ul> <li>            Ethernet over USB          </li> </ul>"},{"location":"tags/#tag:\u7b97\u6cd5","title":"\u7b97\u6cd5","text":"<ul> <li>            DP \u56db\u677f\u65a7          </li> <li>            binary tree traversal          </li> <li>            \u5355\u5411\u94fe\u8868\u7ffb\u8f6c\u7b97\u6cd5          </li> <li>            \u5806\u6392\u5e8f          </li> <li>            \u5b50\u4e32\u67e5\u627e\u7b97\u6cd5          </li> <li>            \u80cc\u5305\u95ee\u9898          </li> </ul>"},{"location":"tags/#tag:\u97f3\u89c6\u9891","title":"\u97f3\u89c6\u9891","text":"<ul> <li>            libavcodec\u4f7f\u7528          </li> <li>            streaming h264 with rtp          </li> </ul>"},{"location":"blog/","title":"Recent Blog","text":""},{"location":"blog/ethernet-over-usb/","title":"Ethernet over USB","text":"<p>NCM \u5168\u79f0\u201cNetwork Control Model\u201d\uff0c\u662fUSB\u5b9a\u4e49\u7684\u7528\u6765\u4ea4\u6362\u4ee5\u592a\u7f51\u5e27\u3002\u4e5f\u5c31\u662fUSB\u7f51\u5361\uff0c\u4f46\u662f\u76f8\u6bd4Windows\u7684RNDS,\u901f\u5ea6\u5feb\u591a\u4e86\u3002\u5b9e\u6d4b\u5728300MBps\u4ee5\u4e0a\u3002\u800c\u4e14\u542c\u8bf4\u662f\u4e0d\u5b89\u5168\u5bfc\u81f4Linux\u5e9f\u5f03\u4e86RNDS\u7684\u652f\u6301\u3002</p>","tags":["netowrk","USB","NCM Gadget","\u6811\u8393\u6d3e"]},{"location":"blog/ethernet-over-usb/#_1","title":"\u6811\u8393\u6d3e","text":"<p>\u5728\u7f51\u4e0a\u4e70\u4e86\u4e00\u4e2aUSB\u4f9b\u7535\u677f\uff0c\u514d\u710a\u63a5\u7684\u3002\u7528\u5927\u6a21\u578b\u751f\u6210\u4e86USB\u7f51\u5361\u914d\u7f6e\u811a\u672c <pre><code>#!/bin/bash\nset -ex\n\nCONFIGFS=/sys/kernel/config\nGADGET=usb_gadget/g1\nGADGET_DIR=$CONFIGFS/$GADGET\nUDC=$(ls /sys/class/udc | head -n1)\n\n# 1. Load libcomposite and mount configfs\nmodprobe libcomposite\nmount -t configfs none $CONFIGFS || true\n\n# 2. Create gadget directory\nmkdir -p \"$GADGET_DIR\"\ncd \"$GADGET_DIR\"\n\n# 3. Set vendor/product IDs (example values\u2014you can adjust)\necho 0x1d6b &gt; idVendor     # Linux Foundation\necho 0x0104 &gt; idProduct    # Multifunction Composite Gadget\n\n# 4. Create English strings\nmkdir -p strings/0x409\necho \"serial1234\" &gt; strings/0x409/serialnumber\necho \"MyManuf\" &gt; strings/0x409/manufacturer\necho \"My NCM Gadget\" &gt; strings/0x409/product\n\n# 5. Add NCM function\nmkdir -p functions/ncm.usb0\n# You may optionally set MACs, interface name, qmult, etc.\n# echo \"12:34:56:78:9a:bc\" &gt; functions/ncm.usb0/host_addr\n# echo \"12:34:56:78:9a:bd\" &gt; functions/ncm.usb0/dev_addr\n# echo \"usb0\" &gt; functions/ncm.usb0/ifname\n\n#!/bin/bash\nset -ex\n\nCONFIGFS=/sys/kernel/config\nGADGET=usb_gadget/g1\nGADGET_DIR=$CONFIGFS/$GADGET\nUDC=$(ls /sys/class/udc | head -n1)\n\n# 1. Load libcomposite and mount configfs\nmodprobe libcomposite\nmount -t configfs none $CONFIGFS || true\n\n# 2. Create gadget directory\nmkdir -p \"$GADGET_DIR\"\ncd \"$GADGET_DIR\"\n\n# 3. Set vendor/product IDs (example values\u2014you can adjust)\necho 0x1d6b &gt; idVendor     # Linux Foundation\necho 0x0104 &gt; idProduct    # Multifunction Composite Gadget\n\n# 4. Create English strings\nmkdir -p strings/0x409\necho \"serial1234\" &gt; strings/0x409/serialnumber\necho \"MyManuf\" &gt; strings/0x409/manufacturer\necho \"My NCM Gadget\" &gt; strings/0x409/product\n\n# 5. Add NCM function\nmkdir -p functions/ncm.usb0\n# You may optionally set MACs, interface name, qmult, etc.\n# echo \"12:34:56:78:9a:bc\" &gt; functions/ncm.usb0/host_addr\n# echo \"12:34:56:78:9a:bd\" &gt; functions/ncm.usb0/dev_addr\n# echo \"usb0\" &gt; functions/ncm.usb0/ifname\n\n# 6. Create config and assign function\nmkdir -p configs/c.1\nmkdir -p configs/c.1/strings/0x409\necho \"Config NCM\" &gt; configs/c.1/strings/0x409/configuration\nln -s functions/ncm.usb0 configs/c.1/\n\n# 7. Bind to UDC (activate gadget)\necho \"$UDC\" &gt; UDC\n\necho \"NCM gadget activated\"\n\n# Wait for interface to appear\nfor i in {1..10}; do\n    if ip link show usb0 &amp;&gt;/dev/null; then\n        break\n    fi\n    sleep 0.5\ndone\n\n# move to usb_ncm_up.service\n#nmcli connection up usb0-shared || true\n</code></pre></p>","tags":["netowrk","USB","NCM Gadget","\u6811\u8393\u6d3e"]},{"location":"blog/ethernet-over-usb/#networkmanager","title":"NetworkManager \u914d\u7f6e","text":"<pre><code>nmcli connection add type ethernet ifname usb0 con-name usb0-shared ipv4.method shared\nnmcli connection up usb0-shared\n</code></pre>","tags":["netowrk","USB","NCM Gadget","\u6811\u8393\u6d3e"]},{"location":"blog/ethernet-over-usb/#systemd","title":"\u914d\u7f6esystemd\u81ea\u52a8\u8fd0\u884c\u548c\u62c9\u8d77\u7f51\u53e3","text":"<p>\u8bbe\u5907\u4e0a\u7684USB\u7f51\u5361\u914d\u7f6e\u811a\u672c\u8981\u5728NetworkManager\u542f\u52a8\u524d\u6267\u884c\uff0c\u800c\u62c9\u8d77\u8bbe\u5907\u8981\u5728\u542f\u52a8NetworkManager\u540e\u6267\u884c\uff0c\u6240\u4ee5\u5206\u62c6\u6210\u4e24\u4e2a\u670d\u52a1\u3002</p> <p>usb_ncm_gadget.service <pre><code>[Unit]\nDescription=Setup USB NCM Gadget\nBefore=NetworkManager.service\nAfter=local-fs.target sysfs.mount\n\n[Service]\nType=oneshot\nExecStart=/usr/local/bin/usb_ncm_gadget.sh\nRemainAfterExit=yes\n\n[Install]\nWantedBy=multi-user.target\n</code></pre></p> <p>\u7b49NetworkManager\u542f\u52a8\u540e\uff0c\u62c9\u8d77\u7f51\u53e3</p> <p>usb_ncm_gadget_up.service <pre><code>[Unit]\nDescription=Bring Up NM connection for usb0\nAfter=NetworkManager.service\nRequires=NetworkManager.service\nRequires=usb_ncm_gadget.service\nWants=sys-subsystem-net-devices-usb0.device\nAfter=sys-subsystem-net-devices-usb0.device\n\n[Service]\nType=oneshot\nExecStart=/usr/bin/nmcli connection up usb0-shared\n\n[Install]\nWantedBy=multi-user.target\n</code></pre></p>","tags":["netowrk","USB","NCM Gadget","\u6811\u8393\u6d3e"]},{"location":"blog/install-kvm-on-debian-of-aarch64-architecture/","title":"Install KVM on Debian of aarch64 architecture","text":"<p>\u516c\u53f8\u6709\u53f0arm64\u4f4d\u7684\u8bbe\u5907\uff0c\u5b89\u88c5\u7684\u94f6\u6cb3\u9e92\u9e9f\u7cfb\u7edf\uff0c\u7ecf\u9a8c\u8bc1\u5c31\u662fdebian 9\u3002 \u73b0\u5728\u9700\u8981\u8fd0\u884c\u66f4\u591aarm64\u865a\u62df\u673a\u3002</p>","tags":["aarch64"]},{"location":"blog/install-kvm-on-debian-of-aarch64-architecture/#_1","title":"\u5b89\u88c5\u6b65\u9aa4","text":"","tags":["aarch64"]},{"location":"blog/install-kvm-on-debian-of-aarch64-architecture/#sudoer","title":"\u914d\u7f6e\u514d\u5bc6sudoer","text":"<p>\u8fd9\u91cc\u8bb0\u4e00\u4e2a\u5751\uff0c \u7b2c\u4e00\u6b21\u914d\u7f6e\u65f6\u62fc\u5199\u9519\u8bef\uff0c\u5bfc\u81f4sudo \u547d\u4ee4\u6267\u884c\u5931\u8d25\u3002\u9700\u8981\u91cd\u7f6e\u5bc6\u7801\uff0c\u6240\u4ee5\u5f88\u9ebb\u70e6\u3002  \u7136\u540e\u63a8\u8350\u4f7f\u7528 <code>sudo visudo</code> \u547d\u4ee4\u6765\u4fee\u6539sudoer\u914d\u7f6e\u6587\u4ef6\uff0c\u8fd9\u4e2a\u547d\u4ee4\u5728\u7f16\u8f91\u7ed3\u675f\u540e\u6821\u9a8c\u914d\u7f6e\u6587\u4ef6\uff0c\u907f\u514d\u51fa\u73b0\u7f16\u8f91\u9519\u8bef\u5bfc\u81f4\u65e0\u6cd5\u4f7f\u7528sudo\u7684\u60c5\u51b5\u3002  </p> <pre><code>kylin@Kylin:~$ cat /etc/sudoers.d/kylin \nkylin   ALL=(ALL:ALL) NOPASSWD:ALL\n</code></pre>","tags":["aarch64"]},{"location":"blog/install-kvm-on-debian-of-aarch64-architecture/#_2","title":"\u914d\u7f6e\u8f6f\u4ef6\u6e90","text":"<p>\u7b2c\u4e00\u4e2a\u662f\u672c\u5730iso, \u4e0b\u9762\u7684\u662f\u4e2d\u79d1\u5927\u7684\u955c\u50cf\u6e90\u3002 \u6bcf\u4e2a\u90fd\u8bbe\u7f6e\u4e86trust\u514d\u6821\u9a8cgpg</p> <pre><code>deb [trusted=yes] file:///mnt/iso/ juniper main multiverse restricted universe\ndeb [trusted=yes] http://ftp.cn.debian.org/debian/ stretch main contrib non-free\ndeb [trusted=yes] http://ftp.cn.debian.org/debian/ stretch-updates main contrib non-free\ndeb [trusted=yes] http://mirrors.ustc.edu.cn/debian-security/ stretch/updates main contrib non-free\ndeb [trusted=yes] http://ftp.cn.debian.org/debian/ stretch-backports main contrib non-free \n</code></pre>","tags":["aarch64"]},{"location":"blog/install-kvm-on-debian-of-aarch64-architecture/#_3","title":"\u5b89\u88c5\u865a\u62df\u5de5\u5177","text":"<p>\u5b89\u88c5 qemu, libvirt, virt-manager</p> <pre><code>sudo apt install  qemu  libvirt virt-manager\n</code></pre>","tags":["aarch64"]},{"location":"blog/install-kvm-on-debian-of-aarch64-architecture/#libvirt","title":"libvirt \u6ca1\u6709\u7f51\u7edc","text":"<p>\u6267\u884c<code>virsh net-list -all</code> \u53d1\u73b0default \u7f51\u7edc\u5904\u4e8e\u672a\u6fc0\u6d3b\u72b6\u6001\uff0c \u4e8e\u662f\u6267\u884c <code>systemctl status libvirtd</code> \u53d1\u73b0</p> <p><pre><code>10\u6708 30 15:46:27 Kylin libvirtd[16741]: 2020-10-30 07:46:27.262+0000: 16764: error : virFileReadAll:1420 : \u6253\u5f00\u6587\u4ef6 '/sys/class/net/virbr0-nic/operstate' \u5931\u8d25: \u6ca1\u6709\u90a3\u4e2a\u6587\u4ef6\u6216\u76ee\u5f55\n10\u6708 30 15:46:27 Kylin libvirtd[16741]: 2020-10-30 07:46:27.262+0000: 16764: error : virNetDevGetLinkInfo:2530 : unable to read: /sys/class/net/virbr0-nic/operstate: \u6ca1\u6709\u90a3\u4e2a\u6587\u4ef6\u6216\u76ee\u5f55\n10\u6708 30 15:46:54 Kylin libvirtd[16741]: 2020-10-30 07:46:54.710+0000: 16745: error : virFirewallApply:916 : \u5185\u90e8\u9519\u8bef\uff1aFailed to initialize a valid firewall backend\n</code></pre> \u9700\u8981\u5b89\u88c5\u4ee5\u4e0b\u7ec4\u4ef6\uff0c\u7136\u540e\u91cd\u542flibvirtd\uff0c\u8fd9\u662f\u56e0\u4e3alibvirt\u7684\u7f51\u7edc\u4f9d\u8d56\u8fd9\u51e0\u4e2a\u7ec4\u4ef6\u6765\u521b\u5efanat \u7f51\u7edc</p> <pre><code>sudo apt install ebtables iptables dnsmasq\nsystemctl restart libvirtd\n</code></pre>","tags":["aarch64"]},{"location":"blog/install-kvm-on-debian-of-aarch64-architecture/#virt-manager-aarch64-uefi","title":"virt-manager \u63d0\u793aaarch64 \u5b89\u88c5 uefi \u9519\u8bef","text":"<p>\u76f4\u63a5\u5b89\u88c5 qemu-efi <pre><code>apt install qemu-efi\n</code></pre></p>","tags":["aarch64"]},{"location":"blog/install-kvm-on-debian-of-aarch64-architecture/#virt-manager-root","title":"virt-manager \u5141\u8bb8\u975eroot\u7528\u6237\u8bbf\u95ee","text":"<p>\u56e0\u4e3a\u5f53\u4ee5\u666e\u901a\u7528\u6237\u8fd0\u884c virt-manager \u65f6\uff0cqemu\u7684\u8fde\u63a5\u6307\u5411\u975eqemu:///system\uff0c \u8fd9\u65f6\u770b\u5230\u7684\u865a\u62df\u673a\u548croot\u770b\u5230\u7684\u4e0d\u4e00\u6837\uff0c\u6240\u4ee5\u5fc5\u987b\u4f7f\u7528sudo\u8fd0\u884c\u3002 \u901a\u8fc7\u4fee\u6539\u914d\u7f6e\u6765\u542f\u7528\u666e\u901a\u7528\u6237\u4e5f\u8bbf\u95ee<code>qemu:///system</code>\uff0c \u5c06uri_defualt \u7684\u6ce8\u91ca\u53bb\u6389\u3002</p> <pre><code>vim /etc/libvirt/libvirt.conf \n\n#\n# These can be used in cases when no URI is supplied by the application\n# (@uri_default also prevents probing of the hypervisor driver).\n#\nuri_default = \"qemu:///system\"\n</code></pre>","tags":["aarch64"]},{"location":"blog/install-kvm-on-debian-of-aarch64-architecture/#virt-managerx86","title":"\u8fd9\u6837\u5c31\u53ef\u4ee5\u4f7f\u7528virt-manager\u6765\u521b\u5efa\u865a\u62df\u673a\u4e86\uff0c\u8ddfx86\u7684\u4f7f\u7528\u4e00\u6837\u3002","text":"<p>\u987a\u4fbf\u8bb0\u4e00\u4e0bvnc\u7684\u914d\u7f6e\uff0c \u56e0\u4e3a\u673a\u5668\u5728\u673a\u623f\u91cc\uff0c \u901a\u8fc7tigervnc\u6765\u4f7f\u7528\u684c\u9762\u3002 \u53e6\u5916\u63d0\u793a\u4e00\u4e0b\uff0cvirt-manager \u914d\u7f6e\u597d\u540e\uff0c\u53ef\u4ee5\u76f4\u63a5\u8fde\u63a5\u8fdc\u7a0b\u7684virt-manager,\u975e\u5e38\u65b9\u4fbf\u3002</p> <p>\u4f7f\u7528tigervnc \u8fde\u63a5\u9700\u8981\u5728\u8fdc\u7a0b\u4e3b\u673a\u5b89\u88c5 tigervnc-server \u548c tigervnc-password\u3002 \u4f7f\u7528\u666e\u901a\u7528\u6237\u6267\u884c <code>tigervnc-password</code> \u8bbe\u7f6e\u8bbf\u95ee\u5bc6\u7801\uff0c\u7136\u540e\u76f4\u63a5\u6267\u884c<code>tigervnc-server</code>\u3002</p> <p>\u8fd9\u65f6\u5019vnc\u53ea\u63a5\u53d7\u672c\u5730\u8fde\u63a5\uff0c \u5982\u679c\u8fdc\u7a0b\u8bbf\u95ee\uff0c\u8981\u4f7f\u7528ssh \u672c\u5730\u8f6c\u53d1\u6765\u5b9e\u73b0\u3002 \u8fd9\u4e5f\u662fvnc\u63a8\u8350\u7684\u65b9\u5f0f\u3002</p> <p>\u73b0\u5728\u672c\u5730\u5141\u8bb8\u672c\u5730\u8f6c\u53d1\u547d\u4ee4\uff0c \u76d1\u542c\u672c\u5730\u7aef\u53e3 9302, \u8f6c\u53d1\u5230\u8fdc\u7a0b\u7684 9300 <pre><code>ssh -L 9302:localhost:9300   -N -f  ssh-kylin\n</code></pre></p> <p>\u7136\u540e\u6267\u884c <code>vncviewer  127.0.0.1:9302</code> \uff0c\u8f93\u5165\u5bc6\u7801\u5c31\u80fd\u6253\u5f00\u8fdc\u7a0b\u684c\u9762\u4e86\u3002</p>","tags":["aarch64"]},{"location":"blog/%E8%BF%9E%E8%AF%8D%E5%92%8C%E5%A4%8D%E5%90%88%E5%8F%A5/","title":"\u8fde\u8bcd\u548c\u590d\u5408\u53e5","text":"<p>\u82f1\u8bed\u4e2d\uff0c\u53e5\u5b50(sentence)\u901a\u5e38\u7531\u597d\u4e2a\u5b50\u53e5\u5b50\u7ec4\u6210\uff0c\u8fd9\u53eb\u590d\u5408\u53e5(compound sentense), \u7531\u8fde\u8bcd\u548c\u5b50\u8bed\u53e5(Clause)\u3001\u77ed\u8bed(Phase)\u3001\u5355\u8bcd(Word)\u7ec4\u6210\u3002</p>","tags":["English"]},{"location":"blog/%E8%BF%9E%E8%AF%8D%E5%92%8C%E5%A4%8D%E5%90%88%E5%8F%A5/#_2","title":"\u5b50\u53e5\u548c\u77ed\u8bed","text":"<p>\u5b50\u53e5\u5305\u542b\u5b8c\u6574\u7684\u4e3b\u8c13\uff0c \u4f46\u77ed\u8bed\u6ca1\u6709\u4e3b\u548c\u8c13\uff0c \u6709\u597d\u591a\u4e2aphase\u7ec4\u6210\u3002\u6bd4\u8f83\u957f\u5ea6 Clause &gt; Phase &gt; Word, word\u5f88\u597d\u533a\u522b\u3002 \u77ed\u8bed\u662f\u4e0d\u5b8c\u6574\u7684\uff0c \u800c\u5b50\u8bed\u53e5\u5305\u542b\u4e86\u5b8c\u6574\u7684\u4e3b\u8c13\uff08\u5bbe\uff09\u3002 <pre><code>Phrase: Meows so loudly\nClause: That cat meows so loudly\n</code></pre></p>","tags":["English"]},{"location":"blog/%E8%BF%9E%E8%AF%8D%E5%92%8C%E5%A4%8D%E5%90%88%E5%8F%A5/#_3","title":"\u5b50\u53e5\u5f53\u540d\u8bcd","text":"<ul> <li>She completely understood <code>everything he said</code>. \u62c6\u6210\u4e3b\u8c13\u5bbe'She understood XXX',  'everything he said' \u662f\u5bbe\u8bedXXX\uff0c \u662f\u4e00\u4e2a\u540d\u8bcd</li> <li>They remembered <code>what the keynote speaker covered</code>. \u540c\u4e0a</li> </ul>","tags":["English"]},{"location":"blog/%E8%BF%9E%E8%AF%8D%E5%92%8C%E5%A4%8D%E5%90%88%E5%8F%A5/#_4","title":"\u5b50\u53e5\u5f53\u526f\u8bcd","text":"<ul> <li>She fixed the sink <code>without facing difficulty</code>. \u62c6\u6210\u4e3b\u8c13\u5bbe'She fixed XXX'\u3002'without facing difficulty'\u4fee\u9970\u52a8\u8bcd'fix'\uff0c \u662f\u526f\u8bcd</li> <li>The pool was installed <code>after they built the deck</code>. \u62c6\u6210\u4e3b\u8c13 'The poll was adj'\u3002 'after they built the deck'\u662f\u4fee\u9970\u5f62\u5bb9\u8bcd\uff08\u6216was\uff09\uff0c \u662f\u526f\u8bcd</li> </ul>","tags":["English"]},{"location":"blog/%E8%BF%9E%E8%AF%8D%E5%92%8C%E5%A4%8D%E5%90%88%E5%8F%A5/#_5","title":"\u5b50\u53e5\u5f53\u5f62\u5bb9\u8bcd","text":"<ul> <li>My friend <code>who rides a motorcycle</code> said it\u2019s a great weekend to ride. \u62c6\u6210\u4e3b\u8c13\u5bbe'XXX said XXX'\u3002 'who rides a motorcycle' \u5f62\u5bb9\u8bcd\uff0c\u5f62\u5bb9'My Friend'</li> <li>No matter what time of day we visit, we always run into the dog <code>that barks</code>. \u540c\u4e0a, \u5f62\u5bb9'dog'</li> </ul> <p>\u5b50\u53e5\u5f53\u540d\u8bcd\u548c\u5f62\u5bb9\u8bcd\u65f6\uff0c\u6bd4\u8f83\u597d\u770b\u51fa\u5b50\u53e5\u7684\u4e3b\u8c13\uff08\u5bbe\uff09\uff0c \u800c\u5f53\u526f\u8bcd</p>","tags":["English"]},{"location":"blog/%E8%BF%9E%E8%AF%8D%E5%92%8C%E5%A4%8D%E5%90%88%E5%8F%A5/#_6","title":"\u77ed\u53e5\u662f\u51e0\u4e2a\u5355\u8bcd\u7ec4\u6210\uff0c\u53ef\u4ee5\u5f53\u5f88\u591a\u6210\u5206","text":"<ul> <li>She runs <code>every Sunday</code>. \u5f53\u526f\u8bcd</li> <li>She was <code>taller than all of her classmates</code>. \u5f53\u5f62\u5bb9\u8bcd</li> <li><code>My small dog</code> barks at ducks. \u540d\u8bcd</li> </ul>","tags":["English"]},{"location":"blog/%E8%BF%9E%E8%AF%8D%E5%92%8C%E5%A4%8D%E5%90%88%E5%8F%A5/#_7","title":"\u8fde\u63a5\u8bcd","text":"<p>\u8fde\u63a5\u8bcd\u7528\u6765\u8fde\u63a5\u5b50\u53e5\u548c\u77ed\u8bed</p>","tags":["English"]},{"location":"blog/%E8%BF%9E%E8%AF%8D%E5%92%8C%E5%A4%8D%E5%90%88%E5%8F%A5/#_8","title":"\u4e00\u81f4\u5173\u7cfb","text":"<p>for, and, nor, but, or, yet, so</p> <p></p>","tags":["English"]},{"location":"blog/%E8%BF%9E%E8%AF%8D%E5%92%8C%E5%A4%8D%E5%90%88%E5%8F%A5/#_9","title":"\u914d\u5bf9\u5173\u7cfb\uff0c \u642d\u914d\u7528","text":"<p>both/and, either/or, neither/nor, not only/but, whether/or</p>","tags":["English"]},{"location":"blog/%E8%BF%9E%E8%AF%8D%E5%92%8C%E5%A4%8D%E5%90%88%E5%8F%A5/#_10","title":"\u4e3b\u4ece\u5173\u7cfb","text":"<p>after, although, as, as if, as long as, as much as, as soon as, as though, because, before, by the time, even if, even though, if, in order that, in case, in the event that, lest, now that, once, only, only if, provided that, since, so, supposing, that, than, though, till, unless, until, when, whenever, where, whereas, wherever, whether or not, while</p>","tags":["English"]},{"location":"blog/%E8%BF%9E%E8%AF%8D%E5%92%8C%E5%A4%8D%E5%90%88%E5%8F%A5/#_11","title":"\u6309\u529f\u80fd\u5206\u8fde\u63a5\u8bcd","text":"","tags":["English"]},{"location":"blog/%E8%BF%9E%E8%AF%8D%E5%92%8C%E5%A4%8D%E5%90%88%E5%8F%A5/#_12","title":"\u8868\u793a\u5f3a\u8c03","text":"<p>indeed</p>","tags":["English"]},{"location":"blog/%E8%BF%9E%E8%AF%8D%E5%92%8C%E5%A4%8D%E5%90%88%E5%8F%A5/#_13","title":"\u8868\u793a\u9012\u8fdb","text":"<p>what's more, furthermore</p>","tags":["English"]},{"location":"blog/%E8%BF%9E%E8%AF%8D%E5%92%8C%E5%A4%8D%E5%90%88%E5%8F%A5/#_14","title":"\u8868\u793a\u8f6c\u6298","text":"<p>however, but</p>","tags":["English"]},{"location":"blog/%E8%BF%9E%E8%AF%8D%E5%92%8C%E5%A4%8D%E5%90%88%E5%8F%A5/#_15","title":"\u8868\u793a\u539f\u56e0\u7ed3\u679c","text":"<p>because, as a result</p>","tags":["English"]},{"location":"blog/%E8%BF%9E%E8%AF%8D%E5%92%8C%E5%A4%8D%E5%90%88%E5%8F%A5/#yet","title":"yet \u76f8\u5173","text":"<p>yet \u4e00\u76f4\u8ba9\u6211\u8111\u5b50\u8f6c\u4e0d\u8fc7\u5f2f\uff0c \u4e0d\u77e5\u9053\u600e\u4e48\u7ffb\u8bd1\u6210\u4e2d\u6587\u3002\u4f8b\u5982\u6b4c\u540d'Are you bored yet?'\uff0c \u6ca1yet\u662f\u2018\u4f60\u65e0\u804a\u5417\uff1f\u2019\u3002 \u5f53\u6709yet\u65f6\u6211\u4ee5\u4e3a\u7ffb\u8bd1\u6210\u2019\u4f60\u8fd8\u65e0\u804a\u5417\uff1f\u2018\uff0c \u800c\u7ed3\u679c\u7ffb\u8bd1\u6210\u2018\u4f60\u89c9\u5f97\u65e0\u804a\u4e86\u5417\uff1f\u2019 </p> <p>gptchat\u89e3\u91ca\u201cyet\u8868\u793a\u63d0\u95ee\u8005\u9884\u671f\u5982\u6b64\uff0c\u4e5f\u5c31\u662f\u63d0\u95ee\u8005\u9884\u671f\u88ab\u63d0\u95ee\u8005\u65e0\u804a\u4e86\u3002\u201d\uff0c \u6240\u4ee5\u6b63\u786e\u7406\u89e3\u5e94\u8be5\u662f\uff1a \u201c\u4f60\u5e94\u8be5\u65e0\u804a\u4e86\u5427\uff1f\u201d \u663e\u7136\u8fd9\u91ccyet\u662f\u526f\u8bcd\uff0c\u4fee\u9970bored\u3002</p>","tags":["English"]},{"location":"blog/%E8%BF%9E%E8%AF%8D%E5%92%8C%E5%A4%8D%E5%90%88%E5%8F%A5/#_16","title":"\u5f53\u526f\u8bcd, \u4fee\u9970\u5f62\u5bb9\u8bcd\u548c\u52a8\u8bcd","text":"<p>any yet \u4f46\u662f nor yet \u4e5f\u4e0d ; \u53c8\u4e0d ; \u4e5f\u6ca1\u6709 but yet \u4f46\u8fd8\u662f not yet \u8fd8\u6ca1 why is there yet another problem</p>","tags":["English"]},{"location":"blog/%E8%BF%9E%E8%AF%8D%E5%92%8C%E5%A4%8D%E5%90%88%E5%8F%A5/#_17","title":"\u5f53\u8fde\u8bcd\uff0c \u8fde\u63a5\u5b50\u53e5\u548c\u77ed\u8bed","text":"<p>Yet she \u800c\u5979\u5df2\u7ecf Yet Moralistic \u4f46\u6ce8\u91cd\u9053\u5fb7</p>","tags":["English"]},{"location":"blog/%E8%BF%9E%E8%AF%8D%E5%92%8C%E5%A4%8D%E5%90%88%E5%8F%A5/#_18","title":"\u53c2\u8003","text":"<p>https://www.grammarly.com/blog/parts-of-speech/conjunctions/ https://www.grammarly.com/blog/sentences/phrases/ https://www.grammarly.com/blog/grammar/clauses/</p>","tags":["English"]},{"location":"blog/learn-gpio/","title":"Learn GPIO","text":"<p>GPIO\u662f\u901a\u7528\u76ee\u7684\u7684\u8f93\u5165\u8f93\u51fa\u5f15\u811a\uff0c\u53ef\u4ee5\u914d\u7f6e\u5f88\u591a\u529f\u80fd\uff0c\u56e0\u4e3a\u6bcf\u4e2aGPIO\u5f15\u811a\u90fd\u6709\u8bb8\u591a\u5bc4\u5b58\u5668\uff0c\u4f8b\u59824\u4e2a\u63a7\u5236\u5bc4\u5b58\u5668\uff0c2\u4e2a\u6570\u636e\u5bc4\u5b58\u5668\uff0c1\u4e2a\u590d\u4f4d\u5bc4\u5b58\u5668\uff0c1\u4e2a\u65f6\u949f\u5bc4\u5b58\u5668\uff0c2\u4e2a\u590d\u7528\u529f\u80fd\u5bc4\u5b58\u5668\u3002 \u6811\u8393\u6d3e\uff0cESP32, arduino\uff08Atmel328p\uff09\u90fd\u6709GPIO\u5f15\u811a\u3002</p>","tags":["GPIO","esp32"]},{"location":"blog/learn-gpio/#gpio","title":"GPIO \u7684\u51e0\u79cd\u6a21\u5f0f","text":"<ul> <li>\u8f93\u51fa\uff1a \u70b9\u4eae\u706f\u6ce1\u3002\u53c8\u5206\u4e3a\u63a8\u633d\uff08PUSH_PULL\uff09 \u8fd9\u662f\u9ed8\u8ba4\u7684\u8f93\u51fa\u6a21\u5f0f\uff08\u9ad8/\u4f4e\u7535\u5e73\uff09\uff1b \u5f00\u6f0f\uff08OPEN_DRAIN\uff09\u7528\u5f97\u5c11\uff0c\u8fd9\u662f\u53ea\u80fd\u5c06\u5f15\u811a\u8bbe\u7f6e\u6210\u4f4e\u7535\u5e73\uff0c\u8981\u9760\u5916\u90e8\u7535\u8def\u5b9e\u73b0\u9ad8\u7535\u5e73\uff0c\u5e94\u7528\u5728\u4f8b\u5982i2c\u603b\u7ebf\u3002</li> <li>\u8f93\u5165\uff1a \u6309\u94ae\u63a7\u5236\u3002\u53c8\u5206\u4e3a\u5185\u90e8\u4e0a\u62c9 PULL_UP \u5f15\u811a\u9ed8\u8ba4\u9ad8\u7535\u5e73\uff1b \u5185\u90e8\u4e0b\u62c9 PULL_DOWN \u5f15\u811a\u9ed8\u8ba4\u4f4e\u7535\u5e73\u3002</li> </ul>","tags":["GPIO","esp32"]},{"location":"blog/learn-gpio/#gpio-pwm","title":"GPIO \u8f93\u51fa\u6570\u5b57\u4fe1\u53f7\u548cPWM","text":"<p>\u65e0\u8bba\u662fPUSH_PULL\u8fd8\u662fOPEN_DRAIN\uff0cGPIO\u5f15\u811a\u53ea\u6709\u9ad8\u7535\u5e73\u548c\u4f4e\u7535\u5e73\u4e24\u79cd\u72b6\u6001\uff0c\u8fd9\u4e5f\u53eb\u6570\u5b57\u4fe1\u53f7\uff0c\u4f8b\u5982\u4e0b\u9762\u7684\u53d1\u9001\u6469\u65af\u7801\u3002 PWM\u4fe1\u53f7\u5b9e\u9645\u662f\u9ad8\u4f4e\u7535\u5e73\u7684\u4e32\u884c\u4fe1\u53f7\u7ec4\uff08\u4f8b\u5982__------\uff09\uff0cESP32\u7684\u6240\u6709GPIO\u652f\u6301\u8f93\u51faPWM\u4fe1\u53f7\uff0c\u4f46\u63a8\u8350\u4f7f\u7528 GPIO 4, 5, 12\u201314, 18\u201319, 21\u201323, 25\u201327, 32\u201333\u3002 PWD\u4fe1\u53f7\u7528\u6765\u9a71\u52a8\u6b65\u8fdb\u7535\u673a\u3002</p>","tags":["GPIO","esp32"]},{"location":"blog/learn-gpio/#gpio_1","title":"GPIO \u8f93\u51fa\u6a21\u62df\u4fe1\u53f7","text":"<p>\u6a21\u62df\u4fe1\u53f7\uff08analog\uff09\u53ef\u4ee5\u9a71\u52a8\u5587\u53ed\u64ad\u653e\u58f0\u97f3\uff0cESP32\u4e2d\u53ea\u6709GPIO 25-26 \u652f\u6301\u8f93\u51fa\u6a21\u62df\u4fe1\u53f7\u3002 <pre><code>from machine import DAC, Pin\n\ndac = DAC(Pin(25))     # Use GPIO25\ndac.write(128)         # Output ~1.65V (128/255 \u00d7 3.3V)\n</code></pre></p>","tags":["GPIO","esp32"]},{"location":"blog/learn-gpio/#gpio_2","title":"GPIO \u6309\u94ae\u5b9e\u73b0\u53d1\u9001\u6469\u65af\u7801","text":"<pre><code>from machine import Pin\nimport time\n\nbutton = Pin(15, Pin.IN, Pin.PULL_UP)\nmorse = \"\"\npress_start = 0\nlast_event_time = time.ticks_ms()\n\nMORSE_TABLE = {\n    \".-\":\"A\",\"-...\":\"B\",\"-.-.\":\"C\",\"-..\":\"D\",\".\":\"E\",\n    \"..-.\":\"F\",\"--.\":\"G\",\"....\":\"H\",\"..\":\"I\",\".---\":\"J\",\n    \"-.-\":\"K\",\".-..\":\"L\",\"--\":\"M\",\"-.\":\"N\",\"---\":\"O\",\n    \".--.\":\"P\",\"--.-\":\"Q\",\".-.\":\"R\",\"...\":\"S\",\"-\":\"T\",\n    \"..-\":\"U\",\"...-\":\"V\",\".--\":\"W\",\"-..-\":\"X\",\"-.--\":\"Y\",\n    \"--..\":\"Z\", \"\": \" \"\n}\n\ndef decode(morse_code):\n    return MORSE_TABLE.get(morse_code, \"?\")\n\nwhile True:\n    now = time.ticks_ms()\n\n    if button.value() == 0:  # Press detected\n        press_start = now\n        while button.value() == 0:\n            time.sleep(0.01)\n        press_duration = time.ticks_diff(time.ticks_ms(), press_start)\n        symbol = \".\" if press_duration &lt; 300 else \"-\"\n        morse += symbol\n        last_event_time = time.ticks_ms()\n        print(\"Symbol:\", symbol)\n\n    # Check for end of character\n    if morse and time.ticks_diff(now, last_event_time) &gt; 1000:\n        char = decode(morse)\n        print(\"Char:\", char)\n        morse = \"\"\n\n    time.sleep(0.01)\n</code></pre>","tags":["GPIO","esp32"]},{"location":"blog/learn-gpio/#_1","title":"\u5f15\u7528","text":"<p>https://blog.51cto.com/u_4029519/13530340 https://blog.csdn.net/makeryzx/article/details/78915955</p>","tags":["GPIO","esp32"]},{"location":"blog/linux-%E4%B8%AD%E6%96%AD%E8%AF%B7%E6%B1%82/","title":"Linux \u4e2d\u65ad\u8bf7\u6c42","text":"<p>\u4e2d\u65ad\u8bf7\u6c42\u7684\u82f1\u6587\u662fIRQ\uff08Interrupt Request\uff09,\u662f\u7528\u6765\u9a71\u52a8CPU\u6b63\u5e38\u5de5\u4f5c\u7684\u91cd\u8981\u673a\u5236\u3002 \u4e2d\u65ad\u6839\u636e\u6e90\u5934\u5206\u7c7b\u6210\uff1a \u7531\u5916\u8bbe\u53d1\u51fa\u7684\u786c\u4ef6\u4e2d\u65ad\uff0c\u8f6f\u4ef6\u53d1\u51fa\u7684\u8f6f\u4e2d\u65ad\uff0c\u4ee5\u53ca\u5f02\u5e38\u7ec4\u6210\u3002</p> <p>\u4ee5\u524d\uff0c\u6bcf\u4e2a\u5916\u8bbe\u90fd\u8fde\u63a5\u4e00\u6839\u7ebf\u5230PIC(programmable Interrupt circuit)\u82af\u7247\uff0c\u6709PIC\u82af\u7247\u6765\u53d1\u751f\u6570\u636e\u5230CPU,\u5e76\u5c06CPU\u7684INTR\u5f15\u811a\u7f6e\u4f4d\u3002 \u73b0\u5728\uff0cCPU\u96c6\u6210\u4e86PIC\u6210\u4e3aAPIC(Advanced PIC)\u3002</p>","tags":["Linux","\u5185\u6838\u539f\u7406"]},{"location":"blog/linux-%E4%B8%AD%E6%96%AD%E8%AF%B7%E6%B1%82/#_1","title":"\u4e2d\u65ad\u5206\u7c7b","text":"<p>\u4e2d\u65ad\u5206\u4e3a3\u7c7b\u578b</p>","tags":["Linux","\u5185\u6838\u539f\u7406"]},{"location":"blog/linux-%E4%B8%AD%E6%96%AD%E8%AF%B7%E6%B1%82/#_2","title":"\u786c\u4ef6\u4e2d\u65ad","text":"<p>\u9f20\u6807\u548c\u952e\u76d8\uff0c\u8fd8\u6709IO\u8bbe\u5907\u90fd\u4f1a\u53d1\u51fa\u786c\u4ef6\u4e2d\u65ad\uff0c\u4f8b\u5982\u7f51\u5361\u7684\u6570\u636e\u5230\u4e86\uff0c\u5c31\u4f1a\u51fa\u53d1\u4e2d\u65ad\u8bf7\u6c42\uff08IRQ\uff09\uff0c \u8fd9\u4e2a\u8bf7\u6c42\u4f1a\u89e6\u53d1CPU\u53bb\u6267\u884cISR, \u800c\u8fd9\u4e2aISR\u9700\u8981\u5728\u7cfb\u7edf\u542f\u52a8\u7684\u65f6\u5019\u6ce8\u518c\u7684\u3002\u4e00\u4e2aVector\u8868\u3002</p>","tags":["Linux","\u5185\u6838\u539f\u7406"]},{"location":"blog/linux-%E4%B8%AD%E6%96%AD%E8%AF%B7%E6%B1%82/#_3","title":"\u8f6f\u4ef6\u4e2d\u65ad","text":"<p>\u5f53\u64ad\u653e\u7535\u5f71\u7684\u65f6\u5019\uff0c\u58f0\u97f3\u548c\u753b\u9762\u7684\u540c\u6b65\u975e\u5e38\u91cd\u8981\uff0c\u8fd9\u662f\u7531\u7cfb\u7edf\u7684\u5b9a\u65f6\u5668jiffies\u6765\u4e0d\u505c\u5730\u8c03\u5ea6\u58f0\u97f3\u64ad\u653e\u5668\u6765\u51c6\u786e\u64ad\u653e\u5bf9\u5e94\u7684\u58f0\u97f3\u3002 \u8f6f\u4e2d\u65ad\u5728\u5b9e\u65f6\u64cd\u4f5c\u7cfb\u7edf\u7684\u4f5c\u7528\u4e5f\u975e\u5e38\u91cd\u8981\u3002</p>","tags":["Linux","\u5185\u6838\u539f\u7406"]},{"location":"blog/linux-%E4%B8%AD%E6%96%AD%E8%AF%B7%E6%B1%82/#_4","title":"\u5f02\u5e38\u4e2d\u65ad","text":"<p>\u5f02\u5e38\u4e2d\u65ad\u53c8\u5206\u4e3a3\u7c7b\uff1a \u7f3a\u9875\u5f02\u5e38(Faults)\uff0c\u9677\u5165\u5f02\u5e38(Traps)\uff0c\u5f02\u5e38\u9000\u51fa(Aborts)</p> <p>\u4f8b\u5982\u5f53\u7a0b\u5e8f\u7684\u5185\u5b58\u88abswap\u5230\u786c\u76d8\u4e86\u6216\u8005\u4e00\u6bb5\u52a8\u6001\u94fe\u63a5\u5e93\u8fd8\u6ca1\u6709\u8f7d\u5165\u5230\u5185\u5b58\u91cc\u6765\uff0c\u5728\u7a0b\u5e8f\u8d70\u5230\u8fd9\u4e2a\u4f4d\u7f6e\u4e4b\u524d\uff0c \u7a0b\u5e8f\u5c31\u4f1a\u63d0\u524d\u53d1\u51fa\u7f3a\u9875\u5f02\u5e38\uff0c\u5f53\u7cfb\u7edf\u68c0\u67e5\u4e86\u6743\u9650\u548c\u5730\u5740\u6709\u6548\u540e\uff08\u5730\u5740\u6709\u6548\u8868\u793a\u5728\u903b\u8f91\u5730\u5740\u8303\u56f4\u5185\uff09\uff0c CPU\u5f00\u59cb\u4e3a\u7a0b\u5e8f\u6267\u884c\u52a0\u8f7d\u9700\u8981\u7684\u6570\u636e\uff0c\u5e76\u6e05\u9664\u8fd9\u4e2a\u5f02\u5e38\u3002 \u6240\u4ee5\u8fd9\u4e2a\u5f02\u5e38\u662f\u53ef\u4ee5\u4fee\u6b63\u7684\uff0c\u8fd9\u4e2a\u8bf7\u6c42\u5fc5\u987b\u63d0\u524d\u53d1\u51fa\u3002</p> <p>\u5f53GDB\u8c03\u8bd5\u7684\u65f6\uff0c\u8bbe\u7f6e\u65ad\u70b9\u4f1a\u63d2\u5165\u4e00\u6761\u7279\u6b8a\u7684\u6307\u4ee4\u5230\u7a0b\u5e8f\u91cc\uff0c\u5f53\u6267\u884c\u5230\u65ad\u70b9\u4f4d\u7f6e\u5c31\u4f1a\u51fa\u53d1Traps\u8bf7\u6c42\uff0c\u8f6f\u4ef6\u7684\u4e3b\u5bfc\u6743\u7531CPU\u4ea4\u7ed9GDB\u3002</p> <p>\u5f53\u7a0b\u5e8f\u89e6\u53d1\u4e00\u4e2a\u5f02\u5e38\u4f8b\u59820/0\u65f6\uff0c\u4f1a\u51fa\u53d1\u9000\u51fa\u5f02\u5e38\uff0c\u7531cpu\u6765\u6e05\u7406\u5806\u6808\u3002</p>","tags":["Linux","\u5185\u6838\u539f\u7406"]},{"location":"blog/linux-%E4%B8%AD%E6%96%AD%E8%AF%B7%E6%B1%82/#_5","title":"\u8bf7\u6c42\u7684\u53ef\u963b\u585e\u6027","text":"<p>\u5bf9\u4e8e\u786c\u4ef6\u4e2d\u65ad\u8bf7\u6c42\uff0cCPU\u7684\u51b3\u7b56\u662f\u7acb\u5373\u6267\u884c\uff0c\u5bf9\u4e8e\u8f6f\u4e2d\u65ad\u548c\u5f02\u5e38\uff0cCPU\u91c7\u7528\u5c3d\u91cf\u5ef6\u540e\u7684\u7b56\u7565\u3002</p>","tags":["Linux","\u5185\u6838\u539f\u7406"]},{"location":"blog/linux-%E4%B8%AD%E6%96%AD%E8%AF%B7%E6%B1%82/#_6","title":"\u67e5\u770b\u7cfb\u7edf\u7684\u4e2d\u65ad","text":"<p>\u5728\u4e2d\u65ad\u6267\u884c <code>watch -n1 \"cat /proc/interrupts\"</code>\u53ef\u4ee5\u5b9a\u65f6\u66f4\u65b0\u4e2d\u65ad\u7684\u6b21\u6570</p> <p>\u5217\u7684\u542b\u4e49\u4ece\u5de6\u81f3\u53f3\u4ee5\u6b64\u4e3a\uff1a <pre><code> IRQ vector, interrupt count per CPU (0 .. n), the hardware source, the hardware source's channel information, and the name of the device that caused the IRQ.\n</code></pre></p>","tags":["Linux","\u5185\u6838\u539f\u7406"]},{"location":"blog/non-constant-time-comparison-bug/","title":"Non-constant time comparison bug","text":"<p>Tailscale \u7ed9\u6211\u53d1\u7684\u90ae\u4ef6\u8bf4\u5230\u4e86\u8fd9\u4e2aBUG, \u53d1\u73b0\u633a\u6709\u8da3\u7684\u3002</p> <p>Hello, We recently fixed an insecure non-constant time comparison bug in the Tailscale DERP server that could have caused DERP servers to leak their private mesh keys via a timing side channel. We have deployed this fix to all Tailscale-operated DERP servers and rotated their mesh keys. </p>","tags":["safety"]},{"location":"blog/non-constant-time-comparison-bug/#bug","title":"BUG\u539f\u56e0","text":"<p>\u975e\u56fa\u5b9a\u65f6\u957f\u7684\u6bd4\u8f83\uff0c\u5c31\u662f\u6bd4\u8f83\u6b21\u6570\u7ea6\u591a\uff0c\u8017\u65f6\u8d8a\u957f\uff0c\u4f8b\u5982\u5e38\u89c1for\u5faa\u73af\uff0c\u8fd8\u6709'memncmp'\u3002\u5229\u7528\u8fd9\u4e2a\u65f6\u95f4\u5dee\u5f02\uff0c\u4e5f\u8bb8\u80fd\u591f\u731c\u5230\u5bc6\u7801\u3002 <pre><code>for (i = 0; i &lt; len; i++) {\n    if (a[i] != b[i]) return false;\n}\n</code></pre></p>","tags":["safety"]},{"location":"blog/non-constant-time-comparison-bug/#_1","title":"\u89e3\u51b3\u529e\u6cd5","text":"<p>\u4f7f\u7528\u56fa\u5b9a\u65f6\u95f4\uff08constant time\uff09\u7684\u6bd4\u8f83\u51fd\u6570\uff0c\u4f8b\u5982\u6539\u6210</p> <pre><code>flag = true\nfor (i = 0; i &lt; len; i++) {\n    if (a[i] != b[i]) flag = false;\n}\nreturn flag;\n</code></pre>","tags":["safety"]},{"location":"blog/%E8%AE%B0%E4%B8%80%E4%B8%AAfakeit%E4%BD%BF%E7%94%A8%E9%97%AE%E9%A2%98/","title":"FakeIt","text":"<p>FakeIt\u662f\u4e00\u4e2a\u5355\u5143\u6d4b\u8bd5\u5de5\u5177\uff0c\u7c7b\u6bd4gmock, \u4f46\u662f\u6bd4gmock\u66f4modern\u548c\u8f7b\u91cf\uff0c\u56e0\u4e3a\u5b83\u652f\u6301c++11\u548cheader-only</p>","tags":["unittest"]},{"location":"blog/%E8%AE%B0%E4%B8%80%E4%B8%AAfakeit%E4%BD%BF%E7%94%A8%E9%97%AE%E9%A2%98/#_1","title":"\u4f7f\u7528\u65b9\u6cd5","text":"<p>FakeIt\u548cgmock\u90fd\u63d0\u4f9bMock\u548c\u8c03\u7528\u8ba1\u6570\u529f\u80fd\uff0cMock\u901a\u5e38\u7528\u4e8e\u63a5\u53e3\u7c7b\uff0c\u7528\u6765\u5b9a\u4e49\u5e76\u5b9e\u4f8b\u5316\u63a5\u53e3\u7c7b\u5bf9\u8c61\u3002gmock\u548cFakeIt\u90fd\u80fd\u5bf9\u8c03\u7528\u53c2\u6570\u8fdb\u884c\u6821\u9a8c\uff0c\u4f46FakeIt\u7684Verify\u51fd\u6570\u8fd8\u63d0\u4f9b\u5728\u6821\u9a8c\u5931\u8d25\u65f6\u6253\u5370\u53c2\u6570\u503c\uff0c\u8fd9\u662fgmock\u4e0d\u5177\u5907\u7684</p> <pre><code>struct IAppManager {\n  // inotify calls when new event\n  virtual void notify_add_event(EventType event_type,\n                                const std::string&amp; filepath) = 0;\n  virtual void notify_rename_event(EventType event_type,\n                                   const std::string&amp; filepath,\n                                   const std::string&amp; filepath_new) = 0;\n\n  virtual ~IAppManager() = default;\n};\n\nTEST_CASE(\"Test Inotify\") {\n  Mock&lt;IAppManager&gt; appmanager_mock;\n  Fake(Dtor(appmanager_mock));\n  Fake(Method(appmanager_mock, notify_add_event));\n  Fake(Method(appmanager_mock, notify_rename_event));\n\n  auto&amp; app_manager = appmanager_mock.get();\n  SECTION(\"test add\") {\n    std::thread t1([&amp;app_manager](){\n      app_manager.notify_add_event(EventType::File, \"filename\");\n      app_manager.notify_add_event(EventType::File, \"filename\");\n      app_manager.notify_add_event(EventType::File, \"filename\");\n    });\n    t1.join();\n    Verify(Method(appmanager_mock, notify_add_event)).Exactly(2);\n  }\n}\n</code></pre> <p>\u8fd9\u91cc\u6ca1\u6709\u5bf9\u8c03\u7528\u53c2\u6570\u6821\u9a8c\uff0c\u800c\u4ec5\u5bf9\u8c03\u7528\u6b21\u6570\u9a8c\u8bc1\uff0c\u53ef\u4ee5\u9884\u89c1\uff0c\u7ed3\u679c\u5931\u8d25\uff0c\u56e0\u4e3a\u8c03\u7528\u4e863\u6b21\u3002</p>","tags":["unittest"]},{"location":"blog/%E8%AE%B0%E4%B8%80%E4%B8%AAfakeit%E4%BD%BF%E7%94%A8%E9%97%AE%E9%A2%98/#_2","title":"\u95ee\u9898","text":"<p>\u4e0a\u9762\u7684\u6d4b\u8bd5\u7528\u4f8b\u4f1a\u5931\u8d25\uff0c\u56e0\u4e3a\u6b21\u6570\u4e0d\u5339\u914d\u3002\u800c\u8fd9\u65f6FakeIt\u4f1a\u6253\u5370\u6240\u6709\u8c03\u7528\u7684\u53c2\u6570\u503c\uff0c\u4f46\u53c2\u6570\u7531\u4e8e\u662f\u4e2a\u5f15\u7528\uff0c\u800c\u4e14\u5f15\u7528\u5728\u7ebf\u7a0b\u9000\u51fa\u65f6\u88ab\u91ca\u653e\uff0c\u6253\u5370\u4e00\u4e2a\u65e0\u6548\u5f15\u7528\u5bfc\u81f4\u4f1a\u629b\u5f02\u5e38 <pre><code>due to a fatal error condition:                                                                 \n  SIGSEGV - Segmentation violation signal \n</code></pre></p>","tags":["unittest"]},{"location":"blog/%E8%AE%B0%E4%B8%80%E4%B8%AAfakeit%E4%BD%BF%E7%94%A8%E9%97%AE%E9%A2%98/#_3","title":"\u89e3\u51b3\u529e\u6cd5","text":"<p>\u5bf9\u4e8e\u672c\u6d4b\u8bd5\u800c\u8a00\uff0c\u89e3\u51b3\u529e\u6cd5\u5c31\u662f\u5c06\u4f20\u53c2\u6240\u5f15\u7528\u7684\u5bf9\u8c61duration\u6539\u5927\uff0c\u5982\u5168\u5c40\u53d8\u91cf\u6216\u8005static\uff0c\u6216\u8005\u5728\u7ebf\u7a0b\u5916\u5b9a\u4e49\u5b83</p> <p><pre><code>TEST_CASE(\"Test Inotify\") {\n  Mock&lt;IAppManager&gt; appmanager_mock;\n  Fake(Dtor(appmanager_mock));\n  Fake(Method(appmanager_mock, notify_add_event));\n  Fake(Method(appmanager_mock, notify_rename_event));\n\n  auto&amp; app_manager = appmanager_mock.get();\n  SECTION(\"test add\") {\n    std::string filename = \"asd\";\n    std::thread t1([&amp;app_manager, &amp;filename](){\n      app_manager.notify_add_event(EventType::File, filename);\n      app_manager.notify_add_event(EventType::File, filename);\n      app_manager.notify_add_event(EventType::File, filename);\n    });\n    t1.join();\n    Verify(Method(appmanager_mock, notify_add_event)).Exactly(2);\n  }\n}\n</code></pre> \u4fee\u6539\u4e4b\u540e\uff0c\u4e0d\u4f1a\u89e6\u53d1SIGSEGV\u5f02\u5e38, \u800c\u662f\u80fd\u6b63\u786e\u6253\u5370\u51fa\u8c03\u7528\u53c2\u6570</p> <pre><code>  Expected pattern: appmanager_mock.notify_add_event( Any arguments )\n  Expected matches: exactly 2\n  Actual matches  : 3\n  Actual sequence : total of 3 actual invocations:                             \n    appmanager_mock.notify_add_event(?, asd)\n    appmanager_mock.notify_add_event(?, asd)\n    appmanager_mock.notify_add_event(?, asd) \n</code></pre> <p>\u4f46\u5bf9\u4e8e\u95f4\u63a5\u8c03\u7528\u7684\u63a5\u53e3\uff0c\u4e14\u5728\u5355\u5143\u6d4b\u8bd5\u91cc\u65e0\u6cd5\u63a7\u5236\u53d8\u91cf\u7c7b\u578b\uff0c\u5219\u6ca1\u6709\u4ec0\u4e48\u529e\u6cd5\uff0c\u53ea\u80fd\u4fdd\u8bc1Extractly\u51c6\u786e\u800c\u4e0d\u7528\u6253\u5370\u53c2\u6570\u503c</p>","tags":["unittest"]},{"location":"blog/%E8%AE%B0%E4%B8%80%E4%B8%AAfakeit%E4%BD%BF%E7%94%A8%E9%97%AE%E9%A2%98/#gmock","title":"gmock\u7684\u65b9\u5f0f","text":"<p>gmock\u4f7f\u7528\u9884\u5148\u8bbe\u5b9a\u8c03\u7528\u53c2\u6570\uff0c\u5728\u8c03\u7528\u65f6\u518d\u5224\u65ad\uff0c\u6240\u4ee5\u4e0d\u4f1a\u51fa\u73b0\u65e0\u6548\u5f15\u7528\u7684\u95ee\u9898</p>","tags":["unittest"]},{"location":"blog/database-acronyms/","title":"database acronyms","text":"<p>\u5e38\u5e38\u88ab\u51e0\u4e2a\u7f29\u5199\u641e\u6655\uff0c\u4eca\u5929\u6709\u7a7a\u597d\u597d\u67e5\u4e86\u4e0b\u3002</p>","tags":["wiki"]},{"location":"blog/database-acronyms/#crud","title":"CRUD \u589e\u5220\u6539\u67e5","text":"<p>web\u540e\u7aef\u4ee3\u540d\u8bcd\uff0cCREATE READ UPDATE DELETE</p>","tags":["wiki"]},{"location":"blog/database-acronyms/#acid","title":"ACID \u4e8b\u7269\u64cd\u4f5c\u7684\u56db\u4e2a\u7279\u6027","text":"<p>Atomic \u539f\u5b50\u6027\uff0c\u4e00\u6b21\u4e8b\u7269\u5305\u542b\u591a\u4e2a\u64cd\u4f5c\uff0c\u8fd9\u4e9b\u64cd\u4f5c\u8981\u4e48\u90fd\u6210\u529f\uff0c\u8981\u4e48\u90fd\u5931\u8d25\u3002 Consistency \u4e00\u81f4\u6027 Isolation \u9694\u79bb\u6027\uff0c\u591a\u4e2a\u4e8b\u7269\u4e4b\u95f4\u6309\u4f18\u5148\u7ea7\u5e76\u53d1\uff0c\u4e92\u4e0d\u5f71\u54cd Durability \u6301\u4e45\u6027\uff0c\u6570\u636e\u50a8\u6301\u4e45\u5316\uff0c\u5b58\u50a8\u5728\u78c1\u76d8\u4e0a\u800c\u975e\u5185\u5b58\u4e2d</p>","tags":["wiki"]},{"location":"blog/database-acronyms/#cap","title":"CAP \u5206\u5e03\u5f0f\u7cfb\u7edf\u7684\u4e0d\u53ef\u80fd\u4e09\u89d2\u7684\u5b9a\u7406","text":"<p>Consistency \u4e00\u81f4\u6027\uff0c\u4fdd\u8bc1\u6240\u6709\u8282\u70b9\u7684\u6570\u636e\u72b6\u6001\u90fd\u4e00\u81f4 Availbility \u53ef\u7528\u6027\uff0c\u4fdd\u8bc1\u80fd\u5bf9\u5916\u670d\u52a1 Partition tolerance \u5206\u533a\u5bb9\u5fcd\u6027\uff0c\u53ef\u4ee5\u63a5\u53d7\u7cfb\u7edf\u51fa\u73b0\u5206\u533a\uff0c\u4fd7\u79f0\u8111\u88c2\u3002</p> <p>CAP\u662f\u88ab\u8bc1\u660e\u7684\u5b9a\u7406\uff0c\u4e0d\u53ef\u80fd\u4e09\u89d2\u8868\u793a\u540c\u65f6\u6700\u591a\u53ea\u80fd\u4fdd\u8bc1\u4e24\u4e2a\uff0c\u800c\u4e0d\u80fd\u4fdd\u8bc1\u4e09\u4e2a\u3002\u4e09\u79cd\u60c5\u51b5\u89e3\u91ca\u5982\u4e0b\uff1a 1. \u591a\u8282\u70b9\u7684\u7cfb\u7edf\u4e0d\u80fd\u4fdd\u8bc1\u6ca1\u6709\u6545\u969c\uff0c\u5c31\u9700\u8981\u7cfb\u7edf\u80fd\u63a5\u53d7\u7cfb\u7edf\u51fa\u73b0\u5206\u533a\uff08\u8111\u88c2\uff09\u3002\u5f53\u51fa\u73b0\u5206\u533a\u65f6\uff0c\u9700\u8981\u4eceC\u4e00\u81f4\u6027\u548cA\u53ef\u7528\u6027\u4e2d\u4e8c\u9009\u4e00\uff0c\u5f53\u9009\u62e9\u4e00\u81f4\u6027\u65f6\uff0c\u5c31\u653e\u5f03\u53ef\u7528\u6027\u3002\u56e0\u4e3a\u7f51\u7edc\u6709\u5206\u533a\u65e0\u6cd5\u4fdd\u8bc1\u67e5\u8be2\u4fe1\u606f\u662f\u4e00\u81f4\u7684\uff0c\u6240\u4ee5\u8bf7\u6c42\u5c06\u8fd4\u56de\u5931\u8d25\u3002 2. \u5f53\u9009\u62e9\u53ef\u7528\u6027\u65f6\uff0c\u7cfb\u7edf\u5c06\u6bcf\u6b21\u90fd\u5c1d\u8bd5\u8fd4\u56de\u6700\u65b0\u7684\u7ed3\u679c\uff0c\u5373\u4f7f\u7531\u4e8e\u5206\u533a\u5bfc\u81f4\u6570\u636e\u4e0d\u4e00\u5b9a\u662f\u6700\u65b0\u7684\u3002 3. \u800c\u5f53\u6ca1\u6709\u51fa\u73b0\u5206\u533a\u65f6\uff0c\u53ef\u4ee5\u540c\u65f6\u4fdd\u8bc1\u4e00\u81f4\u6027\u548c\u53ef\u7528\u6027\u3002</p> <p>\u7b80\u800c\u8a00\u4e4b1\u4fdd\u8bc1\u4e86C+P\uff0c2\u4fdd\u8bc1\u4e86A+P\uff0c3\u4fdd\u8bc1\u4e86C+A</p>","tags":["wiki"]},{"location":"blog/adb-remote-forward/","title":"adb remote forward","text":"<p>\u8fde\u63a5\u5b89\u5353\u8bbe\u5907\u540e\uff0c\u901a\u8fc7adb\u8fde\u63a5\u5b9e\u73b0\u8fdc\u7a0b\u684c\u9762\u7684\u65b9\u6cd5</p> <ol> <li>\u9996\u5148\u8df3\u677f\u673a\u8fde\u63a5\u5b89\u5353\uff0c\u8fd9\u91cc\u662fwifi\u65b9\u5f0f\uff0cadb connect 192.168.0.32:5555</li> <li>\u542f\u52a8\u96a7\u9053\u8f6c\u53d1\uff0cssh -vCN -L5038:localhost:5037 -L27183:localhost:27183 adb@SERVER -p PORT</li> <li>\u5728\u53e6\u4e00\u53f0\u8bbe\u5907\u4e0a\u4f7f\u7528scrcpy\u8fdc\u7a0b\u5b89\u5353  <pre><code>user@client:~$ export ADB_SERVER_SOCKET=tcp:localhost:5038\nuser@client:~$ scrcpy --force-adb-forward -b2M -m800 --max-fps=15\n</code></pre></li> </ol>","tags":["android"]},{"location":"blog/adb-remote-forward/#adb","title":"\u5bf9\u4e8e\u4e0d\u80fd\u6709\u7ebf\u8fde\u63a5\u8bbe\u5907\u7684\u60c5\u51b5\uff0c\u901a\u8fc7\u4e0b\u9762\u547d\u4ee4\u5f00\u542f\u65e0\u7ebfadb","text":"<p>\u5728adb shell\u4e2d\u64cd\u4f5c</p> <pre><code># This line enables adbd to run as tcpip by default\nroot@device:~$ echo \"service.adb.tcp.port=5555\" &gt;&gt; /system/build.prop\n\n# This line enables adbd to accept input from keyboard &amp; mouse using scrcpy\nroot@device:~$ echo \"persist.security.adbinput=1\" &gt;&gt; /system/build.prop\n\n# This line enables adbd\nroot@device:~$ echo \"persist.service.adb.enable=1\" &gt;&gt; /system/build.prop\n\n# After that, just reboot the DEVICE\nroot@device:~$ reboot\n</code></pre>","tags":["android"]},{"location":"blog/adb-remote-forward/#_1","title":"\u53c2\u8003","text":"<p>https://psabadac.medium.com/ssh-adb-9d92c676d8c0</p>","tags":["android"]},{"location":"blog/add-printer-in-linux/","title":"linux \u6dfb\u52a0\u6253\u5370\u673a","text":"<p>\u8bb0\u4e00\u6b21arch \u4e0a\u6dfb\u52a0\u6253\u5370\u673a\u7684\u8fc7\u7a0b\uff0c \u516c\u53f8\u6709\u4e00\u4e2aRicoh c5503 \u7684\u6253\u5370\u673a\uff0cip <code>192.168.4.99</code> \u901a\u8fc7nmap\u8fd9\u4e2a\u5730\u5740\u53ef\u4ee5\u53d1\u73b0\u5f00\u4e86\u4e0d\u5c11\u7aef\u53e3</p> <pre><code>PORT     STATE SERVICE\n21/tcp   open  ftp\n23/tcp   open  telnet\n80/tcp   open  http\n139/tcp  open  netbios-ssn\n514/tcp  open  shell\n515/tcp  open  printer\n631/tcp  open  ipp\n7443/tcp open  oracleas-https\n8080/tcp open  http-proxy\n9100/tcp open  jetdirect\n</code></pre>","tags":["tool"]},{"location":"blog/add-printer-in-linux/#avahi-daemon","title":"\u542f\u52a8avahi-daemon \u670d\u52a1","text":"<p>\u8fd9\u4e2a\u670d\u52a1\u63d0\u4f9bmDNS\u529f\u80fd\uff0c \u53ef\u4ee5\u53d1\u73b0\u5c40\u57df\u7f51\u5185\u7684\u4e3b\u673a\u63d0\u4f9b\u7684\u670d\u52a1\uff0c\u4f8b\u5982\u6253\u5370\u670d\u52a1\uff0cssh\u3002 \u5404\u4e2a\u4e3b\u673a\u901a\u8fc7<code>224.0.0.251</code> \u5730\u5740\u591a\u64ad\u81ea\u5df1\u63d0\u4f9b\u7684\u670d\u52a1 \u4e3b\u673a\u4e5f\u53ef\u4ee5\u914d\u7f6e\u81ea\u5df1\u60f3\u5e7f\u544a\u7684\u670d\u52a1\uff0c\u8fd9\u662f\u7528\u6237\u53ef\u9009\u7684\u3002 \u5177\u4f53\u770bwiki </p> <p>\u901a\u8fc7\u6267\u884c\u4e00\u4e0b\u547d\u4ee4\u53ef\u4ee5\u770b\u5230\u6253\u5370\u670d\u52a1 <pre><code> avahi-browse --all --ignore-local --resolve --terminate \n</code></pre></p> <p>\u627e\u5230\u6709\u7528\u7684\u4fe1\u606f\u5982\u4e0b: <pre><code>+    br0 IPv4 RICOH MP C4503 [002673734B1D]                 Web Site             local\n=    br0 IPv4 RICOH MP C4503 [002673734B1D]                 Web Site             local\n   hostname = [RNP002673734B1D.local]\n   address = [192.168.4.99]\n   port = [80]\n   txt = [\"path=/\"]\n</code></pre></p>","tags":["tool"]},{"location":"blog/add-printer-in-linux/#cupsd","title":"\u5b89\u88c5cupsd","text":"<p>\u542f\u52a8<code>cups-browsed.service</code>\u670d\u52a1\u540e\uff0c \u53ef\u4ee5\u901a\u8fc7\u7f51\u9875\u4e5f\u914d\u7f6e\u6253\u5370\u673a\uff0c \u5305\u62ec\u5206\u4eab\u81ea\u5df1\u7684\u6253\u5370\u673a\u548c\u6dfb\u52a0\u522b\u4eba\u7684\u6253\u5370\u673a\u3002  \u6211\u8fd9\u91cc\u9700\u8981\u6dfb\u52a0\u6253\u5370\u673a\u670d\u52a1</p> <ol> <li>\u6d4f\u89c8\u5668\u8f93\u5165<code>http://localhost:631/</code> \u53ef\u4ee5\u6253\u5f00\u7f51\u9875  </li> <li>administrator -&gt; add printer \u8f93\u5165root\u548c\u5bc6\u7801  </li> <li>\u6709\u4ee5\u4e0b\u9009\u9879 <pre><code>Backend Error Handler\nInternet Printing Protocol (ipp)\nLPD/LPR Host or Printer\nInternet Printing Protocol (ipps)\nAppSocket/HP JetDirect\nInternet Printing Protocol (http)\nInternet Printing Protocol (https)\nWindows Printer via SAMBA \n</code></pre></li> <li>\u6211\u8fd9\u91cc\u9009\u62e9\u7684<code>AppSocket/HP JetDirect</code>\uff0c \u56e0\u4e3anmap\u663e\u793a\u662f\u652f\u6301<code>jetdirect</code>\u7684\u3002 </li> <li>\u8f93\u5165\u5730\u5740<code>socket://192.168.4.99:9100</code></li> <li>\u8f93\u5165\u81ea\u5b9a\u4e49\u7684\u6253\u5370\u673a\u540d\u79f0\u548c\u8def\u5f84<code>/</code></li> </ol> <p>\u81f3\u6b64\uff0c\u6d4f\u89c8\u5668\u6253\u5370\u9875\u9762\u5c31\u53ef\u4ee5\u770b\u5230\u6dfb\u52a0\u7684\u6253\u5370\u673a\u4e86</p>","tags":["tool"]},{"location":"blog/add-printer-in-linux/#_1","title":"\u5206\u4eab\u6253\u5370\u673a","text":"<p>\u6ca1\u6709\u5206\u4eab\u7684\u65f6\u5019\uff0c\u53ea\u6709\u672c\u673a\u53ef\u4ee5\u4f7f\u7528\uff0c\u5f53\u60f3\u8981\u7ed9\u624b\u673a\u4f7f\u7528\u65f6\uff0c\u53ef\u4ee5\u52fe\u9009\u5206\u4eab\u3002\u6b64\u65f6CUPS\u4f1a\u4f7f\u7528mdns\u5e7f\u64ad\u6253\u5370\u673a\u670d\u52a1\u5230\u4e3b\u673a\u6240\u5904\u7684\u7f51\u6bb5\uff0c\u6240\u4ee5\u624b\u673a\u4e5f\u5fc5\u987b\u5728\u8fd9\u4e2a\u7f51\u6bb5\u91cc\u3002 </p>","tags":["tool"]},{"location":"blog/add-printer-in-linux/#_2","title":"\u66f4\u65b0","text":"<p>\u5f00\u59cb\u65f6\u6211\u8d70\u7684ipp\u534f\u8bae\uff0c\u6253\u5370\u673a\u5730\u5740\u4e3a'ipp://192.168.4.99:631/ipp', \u540e\u6765\u8fde\u4e0d\u4e0a\u6253\u5370\u673a  </p> <p>\u901a\u8fc7\u67e5\u7aef\u53e3\u53d1\u73b0\u6709\u7ef4\u62a4\u4eba\u5458\u4fee\u6539\u4e86\u6253\u5370\u673a\u7aef\u53e3\u4fe1\u606f, 631\u548c80\u7aef\u53e3\u90fd\u88ab\u5c01\u4e86\uff0c\u53ef\u80fd\u662f\u51fa\u4e8e\u5b89\u5168\u8003\u8651 <pre><code>PORT      STATE    SERVICE\n21/tcp    open     ftp\n23/tcp    open     telnet\n80/tcp    filtered http\n139/tcp   open     netbios-ssn\n514/tcp   open     shell\n515/tcp   open     printer\n631/tcp   filtered ipp\n7443/tcp  open     oracleas-https\n8080/tcp  open     http-proxy\n9100/tcp  open     jetdirect\n65000/tcp open     unknown\n</code></pre> 631\u6ca1\u6709\u5f00\u653e\uff0c\u53c2\u8003windows\u7684\u540c\u4e8b\u914d\u7f6e\uff0c\u53d1\u73b0\u4ed6\u4eec\u7528\u76849100\u7aef\u53e3(9100\u662f\u8d70socket\u534f\u8bae)\uff0c\u6240\u4ee5\u9700\u8981\u91cd\u65b0\u6dfb\u52a0\u6253\u5370\u673a \u65b0\u7684\u7f51\u7edc\u5730\u5740\u5373\u4e3a'socket://127.0.0.1:9100'</p>","tags":["tool"]},{"location":"blog/add-printer-in-linux/#2","title":"\u66f4\u65b02","text":"<p>\u4e4b\u524d\u662f\u81ea\u5df1\u6413\u7684\u684c\u9762\u73af\u5883\uff0c\u9700\u8981\u624b\u52a8\u5728CUPS\u7684web\u754c\u9762\u6dfb\u52a0\u6253\u5370\u673a\u3002\u800c\u81ea\u4ece\u4f7f\u7528\u4e86\u5b8c\u6574\u684c\u9762GNOME\u53d1\u73b0\u975e\u5e38\u7b80\u5355\u3002GNOME\u81ea\u5e26\u6709\u6253\u5370\u673a\u914d\u7f6e\u5de5\u5177\uff0c\u53ea\u9700\u8981\u586b\u5165\u6253\u5370\u673a\u7684IP\uff08\u4e5f\u8bb8\u7531\u4e8e\u4e0d\u5728\u4e00\u4e2a\u7f51\u6bb5\uff09\uff0c\u5c31\u4f1a\u81ea\u52a8\u68c0\u6d4b\u652f\u6301\u7684\u534f\u8bae\u5e76\u914d\u7f6e\u597d\u3002</p> <p></p>","tags":["tool"]},{"location":"blog/advanced-marco-in-c/","title":"C\u7684\u5b8f\u5b9a\u4e49","text":"<p>\u5b8f\u5b9a\u4e49\u662f\u5728c/c++\u91cc\u7279\u6709\u7684\u65b9\u5f0f\uff0c \u50cf\u53d8\u91cf\u4e00\u6837\uff0c \u53c8\u50cf\u6a21\u677f\u7f16\u7a0b\u4e00\u6837\uff0c \u4f46\u6700\u5e38\u89c1\u7684\u7528\u6cd5\u8fd8\u662f\u505a\u5934\u6587\u4ef6\u7684\u552f\u4e00\u6027\u4fdd\u8bc1  </p> <p>\u5728\u6bcf\u4e00\u4e2a\u5934\u6587\u4ef6\u90fd\u5957\u7528\u8fd9\u79cd\u683c\u5f0f\uff0c\u5c31\u53ef\u4ee5\u907f\u514d\u591a\u6b21\u5f15\u5165\u5934\u6587\u4ef6\u800c\u5bfc\u81f4\u7684\u91cd\u590d\u5b9a\u4e49\u62a5\u9519</p> <pre><code>#ifdef FILE_NAME\n#def FILE_NAME\n\n// \u4ee3\u7801\n\n#endif FILE_NAME\n</code></pre>","tags":["c/cpp"]},{"location":"blog/advanced-marco-in-c/#_1","title":"\u539f\u7406","text":"<p>\u5b8f\u5b9a\u4e49\u4e0e\u53d8\u91cf\u3001\u6a21\u677f\u7684\u6700\u5927\u533a\u522b\u5728\u4e0e\u5904\u7406\u7684\u65f6\u671f\uff0c \u5b8f\u5b9a\u4e49\u5728\u9884\u7f16\u8bd1\u65f6\u5904\u7406\uff0c \u800c\u53d8\u91cf\u548c\u6a21\u677f\u51fd\u6570\u5219\u662f\u5728\u7f16\u8bd1\u671f\u5904\u7406\u3002 \u67e5\u770b\u9884\u7f16\u8bd1\u540e\u7684\u4ee3\u7801\u53ef\u4ee5\u4f7f\u7528\u547d\u4ee4<code>gcc -E</code> \u6216\u8005 <code>cpp</code>\uff0c \u5b9e\u9645\u4e0a\u662f\u524d\u8005\u662f\u8c03\u7528\u4e86\u540e\u8005</p> <pre><code>NAME\n       cpp - The C Preprocessor\n</code></pre>","tags":["c/cpp"]},{"location":"blog/advanced-marco-in-c/#_2","title":"\u7528\u6cd5","text":"<p>\u9664\u4e86<code>#ifdef</code> \u7684\u7528\u6cd5\uff0c\u5b8f\u5b9a\u4e49\u53ef\u4ee5\u5206\u4e24\u79cd\u7c7b\u578b\uff0c\u53d8\u91cf\u578b\u548c\u51fd\u6570\u578b</p>","tags":["c/cpp"]},{"location":"blog/advanced-marco-in-c/#_3","title":"\u53d8\u91cf\u578b","text":"<p>\u8fd9\u4e2a\u6700\u7b80\u5355\uff0c\u5c31\u50cf\u4f7f\u7528\u53d8\u91cf\u4e00\u6837\uff0c\u5148define \u7136\u540e\u518d\u4f7f\u7528</p> <p><pre><code># marco.c\n#define BUFFER_SIZE 1024\n\nint main(){\n    foo = (char *) malloc (BUFFER_SIZE);\n}\n</code></pre> \u6267\u884c <code>gcc -E marco.c</code> \u5f97\u5230 <pre><code>foo = (char *) malloc (1024);\n</code></pre></p> <p>\u591a\u884c\u4f7f\u7528 '\\' \u6765\u8fde\u63a5 <pre><code>#include &lt;stdio.h&gt;\n#define GREETING_STR \\\n  \"hello \\\nworld\"\n</code></pre></p> <ul> <li>\u6ce8\u610f, \u5b8f\u5b9a\u4e49\u7684\u5b9a\u4e49\u4e0d\u5206\u524d\u540e\uff0c \u4e5f\u4e0d\u50cf\u53d8\u91cf\u90a3\u6837\u5148\u5b9a\u4e49\u518d\u4f7f\u7528\uff0c \u5b8f\u5b9a\u4e49\u53ef\u4ee5\u5148\u4f7f\u7528\u540e\u5b9a\u4e49  </li> </ul> <p>\u4ee5\u4e0b\u4e24\u79cd\u65b9\u5f0f\u7684\u6548\u679c\u76f8\u540c</p> <pre><code>#define GREETING_NAME \"wayou\"\n\n#define GREETING \"hello,\" GREETING_NAME\n\nint main() {\nprintf(GREETING);\nreturn 0;\n}\n</code></pre> <pre><code>+#define GREETING \"hello,\" GREETING_NAME\n\n#define GREETING_NAME \"wayou\"\n\n-#define GREETING \"hello,\" GREETING_NAME\n\nint main() {\nprintf(GREETING);\nreturn 0;\n}\n</code></pre>","tags":["c/cpp"]},{"location":"blog/advanced-marco-in-c/#_4","title":"\u51fd\u6570\u578b","text":"<p>\u51fd\u6570\u7c7b\u578b\u7684\u5b8f\uff0c\u53ef\u4ee5\u50cf\u6b63\u5e38\u51fd\u6570\u4e00\u6837\u6307\u5b9a\u5165\u53c2\uff0c\u5165\u53c2\u9700\u4e3a\u9017\u53f7\u5206\u9694\u5408\u6cd5\u7684 C \u5b57\u9762\u91cf\u3002 \u5b8f\u7684\u53c2\u6570\u5fc5\u987b\u8981\u7528\u62ec\u53f7\u5305\u8d77\u6765\uff0c\u5426\u5219\u5f53\u53c2\u6570\u4e3a\u8868\u8fbe\u5f0f\u65f6\uff0c\u4f1a\u51fa\u9519</p> <pre><code>#define min(X, Y)  ((X) &lt; (Y) ? (X) : (Y))\n  x = min(a, b);          \u2192  x = ((a) &lt; (b) ? (a) : (b));\n  y = min(1, 2);          \u2192  y = ((1) &lt; (2) ? (1) : (2));\n  z = min(a + 28, *p);    \u2192  z = ((a + 28) &lt; (*p) ? (a + 28) : (*p));\n ```\n\n### \u5b8f\u5b9a\u4e49\u5b57\u7b26\u4e32\u5316\n\n\u5f53\u5b8f\u5b9a\u4e49\u7684\u53c2\u6570\u88ab\u5f15\u53f7\u5305\u8d77\u6765\u65f6\uff0c \u4e0d\u4f1a\u8fdb\u884c\u66ff\u6362\uff0c\u5982\u4e0b\n```c\n#define foo(x) x, \"x\"\nfoo(bar)        \u2192 bar, \"x\"\n</code></pre> <p>\u52a0\u5165\u9700\u8981\u5c06\u53c2\u6570\u66ff\u6362\u5230\u5b57\u7b26\u4e32\u91cc\uff0c \u53ef\u4ee5\u4f7f\u7528'#'  </p> <pre><code>#define WARN_IF(EXP) \\\ndo { if (EXP) \\\n        fprintf (stderr, \"Warning: \" #EXP \"\\n\"); } \\\nwhile (0)\nWARN_IF (x == 0);\n     \u2192 do { if (x == 0)\n           fprintf (stderr, \"Warning: \" \"x == 0\" \"\\n\"); } while (0);\n</code></pre> <p>\u800c\u5f53 \u8fd9\u91cc\u7684x \u4e5f\u662f\u5b8f\u5b9a\u4e49\u65f6\uff0c \u53ea\u6709if\u91cc\u7684x\u4f1a\u66ff\u6362\uff0c \u5b57\u7b26\u4e32\u91cc\u7684x\u5219\u4e0d\u4f1a\u66ff\u6362  </p> <p><pre><code>#define X ( 1 - 1 )\nWARN_IF ( X == 0);\n</code></pre> \u4f1a\u88ab\u66ff\u6362\u4e3a  </p> <pre><code>do { if (( 1 - 1 ) == 0) fprintf (\nstderr\n, \"Warning: \" \"X == 0\" \"\\n\"); } while (0);\n</code></pre>","tags":["c/cpp"]},{"location":"blog/advanced-marco-in-c/#_5","title":"\u62fc\u63a5","text":"<p>\u901a\u8fc7 ## \u53ef\u5c06\u4e24\u4e2a\u5b8f\u5c55\u5f00\u6210\u4e00\u4e2a\uff0c\u5373\u5c06\u4e24\u8005\u8fdb\u884c\u4e86\u62fc\u63a5\uff0c\u5b8f\u62fc\u63a5\u4e00\u822c\u7528\u5728\u9700\u8981\u62fc\u63a5\u7684\u5b8f\u662f\u6765\u81ea\u5b8f\u53c2\u6570\u7684\u60c5\u51b5\uff0c \u5176\u4ed6\u60c5\u51b5\uff0c\u5927\u53ef\u76f4\u63a5\u5c06\u4e24\u4e2a\u5b8f\u5199\u5728\u4e00\u8d77\u5373\u53ef</p> <p>\u5f53\u6709\u4ee5\u4e0b\u60c5\u51b5\u65f6\u975e\u5e38\u6709\u7528 <pre><code>struct command\n{\n  char *name;\n  void (*function) (void);\n};\n\nstruct command commands[] =\n{\n{ \"quit\", quit_command },\n{ \"help\", help_command },\n\u2026\n};\n</code></pre></p> <p>\u53ef\u4ee5\u4f7f\u7528\u5982\u4e0b\uff1a <pre><code>#define COMMAND(NAME)  { #NAME, NAME ## _command }\n\nstruct command commands[] =\n{\nCOMMAND (quit),\nCOMMAND (help),\n\u2026\n};\n</code></pre></p>","tags":["c/cpp"]},{"location":"blog/advanced-marco-in-c/#_6","title":"\u4e0d\u5b9a\u53c2\u6570\u548c\u6df7\u5408\u53c2\u6570","text":"<p>\u5b8f\u5b9a\u4e49\u4e5f\u53ef\u4ee5\u4f7f\u7528\u4e0d\u5b9a\u53c2\u6570 <pre><code>#define eprintf(args\u2026) fprintf (stderr, args)\n// or\n#define eprintf(\u2026) fprintf (stderr, __VA_ARGS__)\n</code></pre></p> <p>\u4e5f\u53ef\u4ee5\u4f7f\u7528\u6df7\u5408\u53c2\u6570 <pre><code>#define eprintf(format, args...) fprintf (stderr, format, args)\n</code></pre> \u8fd9\u4e2a\u53ef\u4ee5\u5e38\u5728\u683c\u5f0f\u5316\u6253\u5370\u65f6\u7528\u5230\uff0c \u4f8b\u5982 <code>spdlog</code> \u5e93  </p> <pre><code>#define SPDLOG_LOGGER_CALL(logger, level, ...)                                                                                             \\\n    if (logger-&gt;should_log(level))                                                                                                         \\\n    logger-&gt;log(spdlog::source_loc{SPDLOG_FILE_BASENAME(__FILE__), __LINE__, SPDLOG_FUNCTION}, level, __VA_ARGS__)\n\n#if SPDLOG_ACTIVE_LEVEL &lt;= SPDLOG_LEVEL_TRACE\n#define SPDLOG_LOGGER_TRACE(logger, ...) SPDLOG_LOGGER_CALL(logger, spdlog::level::trace, __VA_ARGS__)\n#define SPDLOG_TRACE(...) SPDLOG_LOGGER_TRACE(spdlog::default_logger_raw(), __VA_ARGS__)\n#else\n#define SPDLOG_LOGGER_TRACE(logger, ...) (void)0\n#define SPDLOG_TRACE(...) (void)0\n#endif\n\n#if SPDLOG_ACTIVE_LEVEL &lt;= SPDLOG_LEVEL_DEBUG\n#define SPDLOG_LOGGER_DEBUG(logger, ...) SPDLOG_LOGGER_CALL(logger, spdlog::level::debug, __VA_ARGS__)\n#define SPDLOG_DEBUG(...) SPDLOG_LOGGER_DEBUG(spdlog::default_logger_raw(), __VA_ARGS__)\n#else\n#define SPDLOG_LOGGER_DEBUG(logger, ...) (void)0\n#define SPDLOG_DEBUG(...) (void)0\n#endif\n</code></pre>","tags":["c/cpp"]},{"location":"blog/advanced-marco-in-c/#_7","title":"\u91cd\u590d\u548c\u8986\u76d6","text":"<p>\u8fd9\u4e9b\u662f\u76f8\u4f3c\u7684\uff1a <pre><code>#define FOUR (2 + 2)\n#define FOUR         (2    +    2)\n#define FOUR (2 /* two */ + 2)\n</code></pre></p> <p>\u4ee5\u4e0b\u90fd\u662f\u4e0d\u540c\u7684\u5b8f <pre><code>#define FOUR (2 + 2)\n#define FOUR ( 2+2 ) // \u7a7a\u767d\u4f4d\u7f6e\u4e0d\u4e00\u6837 \n#define FOUR (2 * 2) // \u5b8f\u7684\u5185\u5bb9\u4e0d\u4e00\u6837\n#define FOUR(score,and,seven,years,ago) (2 + 2) // \u5165\u53c2\u4e0d\u4e00\u6837\n</code></pre></p> <p>\u5bf9\u4e8e\u4f7f\u7528\u4e86 <code>#undef</code> \u6ce8\u9500\u8fc7\u7684\u5b8f\uff0c\u518d\u6b21\u5b9a\u4e49\u540c\u540d\u7684\u5b8f\u65f6\uff0c\u8981\u6c42\u65b0\u5b9a\u4e49\u7684\u5b8f\u4e0d\u4e0e\u8001\u7684\u76f8\u4f3c\u3002</p> <p>\u800c\u5982\u679c\u8bf4\u4e00\u4e2a\u5df2\u7ecf\u5b58\u5728\u7684\u5b8f\uff0c\u5e76\u6ca1\u6709\u6ce8\u9500\uff0c\u91cd\u590d\u5b9a\u4e49\u65f6\uff0c\u5982\u679c\u76f8\u4f3c\uff0c\u5219\u65b0\u7684\u5b9a\u4e49\u4f1a\u5ffd\u7565\uff0c\u5982\u679c\u4e0d\u76f8\u4f3c\uff0c\u7f16\u8bd1\u5668\u4f1a\u62a5\u8b66\u544a\u540c\u65f6\u4f7f\u7528\u65b0\u5b9a\u4e49\u7684\u5b8f\u3002\u8fd9\u5141\u8bb8\u5728\u591a\u4e2a\u6587\u4ef6\u4e2d\u5b9a\u4e49\u540c\u4e00\u4e2a\u5b8f\u3002</p>","tags":["c/cpp"]},{"location":"blog/advanced-marco-in-c/#_8","title":"\u6700\u540e","text":"<p>\u53ef\u4ee5\u67e5\u770b\u66f4\u591a\u5185\u7f6e\u5b8f\u5b9a\u4e49</p>","tags":["c/cpp"]},{"location":"blog/%E9%98%BF%E9%87%8C%E4%BA%91%E5%8A%A8%E6%80%81%E8%AE%BE%E7%BD%AE-dns/","title":"\u963f\u91cc\u4e91\u52a8\u6001\u8bbe\u7f6e dns","text":"<p>\u5982\u679c\u670d\u52a1\u5668\u7684\u516c\u7f51ip\u52a8\u6001\u53d8\u5316\u7684\u60c5\u51b5\u4e0b\uff0c\u5982\u4f55\u8bbf\u95ee\uff0c\u751a\u81f3\u5982\u4f55\u901a\u8fc7\u57df\u540d\u8bbf\u95ee\uff1f </p> <p>\u4f8b\u5982\u516c\u53f8\u81ea\u5df1\u642d\u5efa\u7684\u670d\u52a1\u5668\u5982\u4f55\u66b4\u9732\u5728\u516c\u7f51\u4e0a\uff0c \u5982\u679c\u8bf7\u6c42\u56fa\u5b9aip\u542c\u8bf4\u5f88\u8d35\uff0c \u8fd8\u53ef\u4ee5\u901a\u8fc7<code>frp</code>\u5b9e\u73b0, \u8fd9\u91cc\u4ecb\u7ecd2\u79cd\u65b9\u6848</p>","tags":["ddns","nat"]},{"location":"blog/%E9%98%BF%E9%87%8C%E4%BA%91%E5%8A%A8%E6%80%81%E8%AE%BE%E7%BD%AE-dns/#dns_1","title":"\u52a8\u6001dns","text":"<p>\u524d\u63d0\u662f\u670d\u52a1\u5668\u6709\u51fa\u53e3ip, \u800c\u4e0d\u662f\u5728\u8def\u7531\u5668\u4e0b\u3002    * \u5982\u679c\u670d\u52a1\u5668\u5728\u8def\u7531\u5668\u4e0b\uff0c \u901a\u8fc7\u8bbe\u7f6enat,\u5c06\u5916\u7f51\u8bbf\u95ee\u7684\u8bf7\u6c42\u7684\u76ee\u7684ip\u8f6c\u6362\u4e3a\u5c40\u57df\u7f51'192.168..'\uff0c\u4e5f\u80fd\u5b9e\u73b0\u516c\u7f51\u8bf7\u6c42\u5c40\u57df\u7f51\u7684\u670d\u52a1\u5668</p> <p>\u963f\u91cc\u4e91\uff08\u76f8\u4fe1\u5927\u591a\u6570\u4e91\u5382\u5546\u90fd\u652f\u6301\uff09 \u53ef\u4ee5\u652f\u6301\u52a8\u6001\u6539\u53d8dns\u7684\u89e3\u6790\u5730\u5740\uff0c\u5373\u901a\u8fc7api\u8c03\u7528\u5c31\u80fd\u6539\u53d8dns\u7684\u89e3\u6790\uff0c \u8fd9\u6837\u5f53\u51fa\u53e3ip\u53d8\u5316\u65f6\uff0c \u7acb\u5373\u8c03\u7528api\u6765\u4fee\u6539dns\u89e3\u6790  </p> <p>\u5b9e\u73b0\u539f\u7406:</p> <ol> <li>\u5b9a\u65f6\u68c0\u6d4b\u51fa\u53e3ip, \u4f8b\u5982\u6bcf5\u5206\u949f\u6267\u884c\u4e00\u6b21\u3002 \u53ef\u4ee5\u901a\u8fc7crontab\u548c\u4ee5\u4e0b\u547d\u4ee4\u5b9e\u73b0 <pre><code>curl https://httpbin.org/ip\n</code></pre></li> <li>\u901a\u8fc7\u963f\u91cc\u4e91\u7684api\u64cd\u4f5cdns</li> <li>\u5982\u679c\u670d\u52a1\u5668\u5728\u5185\u7f51\uff0c\u6dfb\u52a0nat\u89c4\u5219\uff0c\u5c06\u76ee\u7684ip\u8f6c\u6362\u4e3a\u5185\u7f51ip</li> </ol> <p>\u8fd9\u91cc\u6709\u4e2a\u73b0\u6210\u7684\u9879\u76ee</p>","tags":["ddns","nat"]},{"location":"blog/%E9%98%BF%E9%87%8C%E4%BA%91%E5%8A%A8%E6%80%81%E8%AE%BE%E7%BD%AE-dns/#frp","title":"frp","text":"<p>frp \u5c31\u662f\u5185\u7f51\u7a7f\u900f\u4e86\uff0c \u6ca1\u6709\u51fa\u53e3ip\u7684\u60c5\u51b5\u4e0b\uff0c\u4f8b\u5982\u5728\u8def\u7531\u5668\u4e0b\u4e14\u8def\u7531\u5668\u4e0d\u652f\u6301nat\u7684\u65f6\u5019\uff0c \u6216\u8005\u662f\u5728\u8fd0\u8425\u5546\u7ea7NAT\u7684\u6a21\u5f0f\u4e0b\uff0c\u5c31\u53ef\u4ee5\u91c7\u53d6\u8fd9\u4e2d\u65b9\u5f0f\u3002 \u4f46\u662f\u524d\u63d0\u662f\u9700\u8981\u6709\u516c\u7f51\u7684\u670d\u52a1\u5668</p> <p>\u5b9e\u73b0\u539f\u7406\uff1a</p> <ol> <li>\u901a\u8fc7\u5728\u516c\u7f51\u670d\u52a1\u5668\u8fd0\u884cfrp \u670d\u52a1\u7aef\uff0c \u5728\u6ca1\u6709\u51fa\u53e3ip\u7684\u5c40\u57df\u7f51\u670d\u52a1\u5668\u4e0a\u8fd0\u884cfrp\u5ba2\u6237\u7aef</li> <li>\u5ba2\u6237\u7aef\u4e3b\u52a8\u53bb\u8fde\u63a5\u670d\u52a1\u7aef\uff0c \u8fde\u63a5\u4e0a\u4e4b\u540e\uff0c \u670d\u52a1\u7aef\u4f1a\u4e3a\u5ba2\u6237\u7aef\u521b\u5efa\u4e00\u4e2a\u7aef\u53e3\uff0c \u6240\u6709\u7684\u5411\u8fd9\u4e2a\u7aef\u53e3\u7684\u8bf7\u6c42\u90fd\u88ab\u8f6c\u53d1\u5230\u5c40\u57df\u7f51\u7684\u670d\u52a1\u5668\uff0c\u5b9e\u73b0\u516c\u7f51\u8bbf\u95ee\u5c40\u57df\u7f51\u7684\u670d\u52a1\u5668</li> </ol>","tags":["ddns","nat"]},{"location":"blog/%E9%98%BF%E9%87%8C%E4%BA%91%E5%8A%A8%E6%80%81%E8%AE%BE%E7%BD%AE-dns/#wireguard","title":"wireguard","text":"<p>wireguard\u7684\u529f\u80fd\u66f4\u52a0\u5f3a\u5927\uff0c\u914d\u5bf9\u540e\u5c31\u76f8\u5f53\u4e8e\u4e92\u8fde\u4e86\uff0c\u4e0d\u9700\u8981frp\u90a3\u6837\u914d\u7f6e\u7aef\u53e3\u670d\u52a1\u3002\u800c\u4e14\u81ea\u5e26\u52a0\u5bc6\uff0c\u66f4\u5b89\u5168\u3002</p>","tags":["ddns","nat"]},{"location":"blog/%E9%98%BF%E9%87%8C%E4%BA%91%E5%8A%A8%E6%80%81%E8%AE%BE%E7%BD%AE-dns/#zero-trust","title":"zero-trust","text":"<p>\u7814\u7a76\u8fc7\u4e00\u4f1a\uff0c\u53d1\u73b0\u8fd9\u4e2a\u548cwireguard\u975e\u5e38\u7c7b\u4f3c\u7684\u529f\u80fd\u3002\u800c\u4e14zero-trust\u6709cloudflare\u63d0\u4f9b\u4e86\u516c\u7f51\u63a5\u5165\u70b9\uff0c\u6240\u4ee5\u516c\u7f51\u670d\u52a1\u5668\u7684\u94b1\u4e5f\u7701\u4e86, \u518d\u52a0\u4e0azero-trust\u81ea\u5e26\u7684\u52a0\u5bc6\uff0c\u6240\u4ee5\u662f\u8fdecloudflare\u4e5f\u4e0d\u80fd\u4fb5\u5165\u3002\u8fd9\u5c31\u6bd4\u56fd\u5185\u7684NAT\u670d\u52a1\u5b89\u5168\u591a\u4e86\u3002\u552f\u4e00\u7f3a\u70b9\u4f30\u8ba1\u662fzero-trust\u7684\u516c\u7f51\u63a5\u5165\u70b9\u90fd\u5728\u56fd\u5916\uff0c\u6240\u4ee5\u5ef6\u8fdf\u4f1a\u9ad8\u4e9b\u3002</p>","tags":["ddns","nat"]},{"location":"blog/%E9%98%BF%E9%87%8C%E4%BA%91%E5%8A%A8%E6%80%81%E8%AE%BE%E7%BD%AE-dns/#_1","title":"\u603b\u7ed3","text":"<p>\u5982\u679c\u6709\u51fa\u53e3ip, \u5373\u4f7f\u7ecf\u5e38\u53d8\u5316\uff0c \u53ef\u4ee5\u4f7f\u7528\u52a8\u6001dns\u7684\u6280\u672f\u5b9e\u73b0\u66b4\u9732\u5230\u516c\u7f51\uff0c \u6210\u672c\u4f4e\u5ec9\u3002 \u5426\u5219\u4f7f\u7528frp,\u9700\u8981\u989d\u5916\u8d2d\u4e70\u670d\u52a1\u5668\uff0c\u6216\u8005\u4f7f\u7528\u82b1\u751f\u58f3\u7c7b\u4f3c\u7684\u7a7f\u900f\u6280\u672f\uff0c \u4f46\u662f\u6709\u88ab\u638f\u88e4\u88c6\u7684\u98ce\u9669\u3002 \u6709\u516c\u7f51\u670d\u52a1\u5668\u5c31\u7528wireguard\uff0c \u5426\u5219\u7528zero-trust\u3002</p>","tags":["ddns","nat"]},{"location":"blog/amrnb%E5%92%8Camrwb%E7%9A%84%E7%BC%96%E8%A7%A3%E7%A0%81/","title":"\u76ee\u7684","text":"<p>\u6700\u8fd1\u5728\u516c\u53f8\u5f00\u53d1\u4e00\u4e2aamrnb/amrwb\u7684\u8f6c\u7801\u5de5\u5177\uff0c\u5728\u7f51\u4e0a\u770b\u4e86\u5f88\u591a\u8d44\u6599\uff0c\u4e3b\u8981\u662f\u8fd9\u7bc7AMR\u5728IP\u57df\u4e2d\u7684\u7f16\u7801(rfc3267,4867) \u5bf9\u6211\u5e2e\u52a9\u5f88\u5927\u3002 \u8fd9\u91cc\u8865\u5145\u4e00\u4e0b\u7f3a\u5c11\u548c\u6211\u81ea\u5df1\u7684\u7406\u89e3\u3002</p>","tags":["media"]},{"location":"blog/amrnb%E5%92%8Camrwb%E7%9A%84%E7%BC%96%E8%A7%A3%E7%A0%81/#amr","title":"AMR\u7f16\u7801\u4ecb\u7ecd","text":"<p>AMR\u662f3GPP\u7ec4\u7ec7\u7684\u4e00\u4e2a\u97f3\u9891\u7f16\u7801\u89c4\u8303\uff0c\u76ee\u524d\u7684\u624b\u673a\u90fd\u4f7f\u7528AMR, \u6bd4\u5982\u516c\u53f8\u7684\u6d4b\u8bd5\u673a\u534e\u4e3a\u3001\u5c0f\u7c73\u53ea\u652f\u6301amrnb/amrwb\u3002amrnb\u662f\u5bf9\u7a84\u5e26\u4fe1\u53f7\u8fdb\u884c\u7f16\u7801\uff08200\u20133400 Hz\uff09\uff0camrwb\u662f\u5bf9\u66f4\u5bbd\u7684\u9891\u7387\u8303\u56f4\u8fdb\u884c\u7f16\u7801\uff0850\u20137000 Hz\uff09\u3002  \u6839\u636e\u9999\u519c\u7406\u8bba\uff0c\u91c7\u6837\u9891\u7387\u8981\u662f\u76ee\u6807\u9891\u7387\u7684\u4e24\u500d\uff0c\u6240\u4ee5\u5411\u4e0a\u53d6\u6574\u7684amrnb\u7684\u91c7\u6837\u9891\u7387\u662f8000Hz, amrwb\u7684\u91c7\u6837\u9891\u7387\u662f16000Hz\u3002</p>","tags":["media"]},{"location":"blog/amrnb%E5%92%8Camrwb%E7%9A%84%E7%BC%96%E8%A7%A3%E7%A0%81/#bitrate","title":"bitrate","text":"<p>amrnb\u548camrwb\u6709\u591a\u79cd\u7f16\u7801\u901f\u7387\uff08bitrate\uff09\uff0c\u5e76\u652f\u6301\u5728\u901a\u8bdd\u8fc7\u7a0b\u4e2d\u901a\u8fc7CMR\uff08codec mode request\uff09\u534f\u5546\u6765\u53d8\u5316\u7f16\u7801\u901f\u7387\uff0c\u4e0d\u540c\u4e8e\u4e00\u822c\u7684\u7f16\u7801\u5668\u56fa\u5b9a\u4e00\u79cd\u6bd4\u7279\u7387\u3002\u9664\u6b64\u4e4b\u5916\uff0c\u8fd8\u6709\u6ca1\u6709\u4eba\u58f0\u65f6\u7684SID\uff08\u8212\u9002\u566a\u97f3\uff09\u6a21\u5f0f\u3002\u8fd9\u65f6\u53ea\u9700\u8981\u53d1\u9001\u4e00\u4e2aMode\u800c\u4e0d\u662f\u53d1\u9001\u65e0\u58f0\u7684\u5305\uff0c\u4ece\u800c\u6765\u964d\u4f4e\u5e26\u5bbd\u5360\u7528\u3002</p>","tags":["media"]},{"location":"blog/amrnb%E5%92%8Camrwb%E7%9A%84%E7%BC%96%E8%A7%A3%E7%A0%81/#amrnb","title":"amrnb \u4e0d\u540c\u6bd4\u7279\u7387\u65f6\u7684\u8bed\u97f3\u5e27\u5927\u5c0f","text":"Index Mode Class A bits total speech bits 0 4.75 42 95 1 5.15 49 103 2 5.9 55 118 3 6.7 58 134 4 7.4 61 148 5 7.95 75 159 6 10.2 65 204 7 12.2 81 244","tags":["media"]},{"location":"blog/amrnb%E5%92%8Camrwb%E7%9A%84%E7%BC%96%E8%A7%A3%E7%A0%81/#amrwb","title":"amrwb \u4e0d\u540c\u6bd4\u7279\u7387\u7684\u8bed\u97f3\u5e27\u5927\u5c0f","text":"Index AMR-WB codec mode Total number of bits Class A Class B Class C 0 6.60 132 54 78 0 1 8.85 177 64 113 0 2 12.65 253 72 181 0 3 14.25 285 72 213 0 4 15.85 317 72 245 0 5 18.25 365 72 293 0 6 19.85 397 72 325 0 7 23.05 461 72 389 0 8 23.85 477 72 405 0","tags":["media"]},{"location":"blog/amrnb%E5%92%8Camrwb%E7%9A%84%E7%BC%96%E8%A7%A3%E7%A0%81/#payload-type","title":"payload type","text":"<p>amrnb\u548camrwb\u4f7f\u7528\u7684\u52a8\u6001payload type, \u6240\u4ee5\u5728\u7528wireshark\u5206\u6790\u65f6\uff0c\u9700\u8981\u7ecf\u5e38\u8c03\u6574payload-type\u503c</p>","tags":["media"]},{"location":"blog/amrnb%E5%92%8Camrwb%E7%9A%84%E7%BC%96%E8%A7%A3%E7%A0%81/#align-mode","title":"align mode","text":"<p>amrnb\u548camrwb\u5728SIP\u534f\u5546\u4e2d\u6709\u4e24\u79cdalign mode\uff0c\u5bf9\u9f50\u6a21\u5f0f\u548c\u8282\u7701\u5e26\u5feb\u6a21\u5f0f\u3002\u603b\u7ed3\u6709\u51e0\u4e2a\u533a\u522b *  \u5bf9\u9f50\u6a21\u5f0f\u4e0bCMR\u53608\u4f4d\uff0c\u6bcf\u4e2aTOC\u53608\u4f4d\uff0c\u7136\u540e\u6bcf\u4e2a\u8bed\u97f3\u5e27\u8865\u9f50\u4e3a\u6574\u5b57\u8282\u3002 *  \u8282\u7701\u5e26\u5bbd\u6a21\u5f0f\u4e0b\uff0cCMR\u53604\u4f4d\uff0c\u6bcf\u4e2aTOC\u53606\u4f4d\uff0c\u7136\u540eCMR + TOC + \u6240\u6709\u8bed\u97f3\u5e27\u52a0\u8d77\u6765\uff0c\u6700\u540e\u8865\u9f50\u4e3a\u6574\u5b57\u8282\u3002</p> <p>\u4ee5\u5355\u5e27\u768412.2kbps\u4e3a\u4f8b * \u8bed\u97f3\u5e27\u4e3a244\u4f4d\uff0c\u5bf9\u9f50\u4e4b\u540e\u4e3a<code>(244 + 8 - 1)/8 = 31</code>\u5b57\u8282\u3002\u52a0\u4e0a1\u5b57\u8282\u7684CMR\u548c1\u5b57\u8282\u7684TOC, \u4e00\u517133\u5b57\u8282\u3002 * \u8bed\u97f3\u5e27\u4e3a244\u4f4d\uff0c\u52a0\u4e0a4\u4f4dCMR\u548c6\u4f4dTOC\uff0c\u4e00\u5171\u4e3a254\u4f4d\uff0c\u5bf9\u9f50\u540e\u4e3a<code>(254 + 8-1)/8</code>\uff0c\u4e00\u79cd32\u5b57\u8282\u5b57\u8282\u3002</p> <p>\u4ee5\u4e24\u5e27\u768412.2kbps\u4e3a\u4f8b * \u4e24\u4e2a\u8bed\u97f3\u5e27\u5206\u522b\u5360\u752831\u5b57\u8282\uff0c\u52a0\u4e0a1\u5b57\u8282\u7684CMR\u548c2\u5b57\u8282\u7684TOC, \u4e00\u5171 65\u5b57\u8282\u3002 * \u4e24\u4e2a\u8bed\u97f3\u5e27\u5206\u522b\u5360\u7528244\u4f4d\uff0c \u52a0\u4e0a4\u4f4d\u7684CMR\u548c6 * 2\u4f4d\u7684TOC, \u5bf9\u9f50\u540e\u4e3a<code>( 488 + 4 + 12  + 8 - 1)/8</code>\uff0c\u4e00\u517163\u5b57\u8282\u3002</p> <p>\u603b\u4e4b\uff0c\u5bf9\u9f50\u6a21\u5f0f\u662f\u5148\u5bf9\u9f50\u6210\u5b57\u8282\u518d\u6c42\u548c\uff0c\u8282\u7701\u5e26\u5bbd\u6a21\u5f0f\u662f\u5148\u8ba1\u7b97<code>\u4f4d\u548c</code>\u518d\u5bf9\u9f50\u6210\u5b57\u8282\u3002\u7279\u522b\u662f\u591a\u5e27\u7684\u65f6\u5019\uff0c\u8282\u7701\u5e26\u5bbd\u6a21\u5f0f\u7b97\u8d77\u6765\u66f4\u590d\u6742\u3002\u597d\u5728\u5b9e\u9645\u60c5\u51b5\u90fd\u662f1\u5e27\u3002</p>","tags":["media"]},{"location":"blog/amrnb%E5%92%8Camrwb%E7%9A%84%E7%BC%96%E8%A7%A3%E7%A0%81/#opencore-amr","title":"\u57fa\u4e8eopencore-amr\u7684\u7f16\u89e3\u7801","text":"<p>\u5f00\u59cb\u7528FFmpeg\u7684\u5e93\u6765\u505a\u8f6c\u7801\u548c\u63a8\u6d41\uff0c\u540e\u6765\u53d1\u73b0\u4e0d\u652f\u6301\u8282\u7701\u5e26\u5bbd\u6a21\u5f0f\uff0c\u800c\u4e14\u8fd8\u6709\u4e2aBUG\uff0c\u6240\u4ee5\u540e\u9762\u81ea\u5df1\u57fa\u4e8eopencore\u7684\u5e93\u5199\u7684\u8f6c\u7801\u529f\u80fd\u3002</p>","tags":["media"]},{"location":"blog/arduino-cli-%E4%BD%BF%E7%94%A8/","title":"arduino-cli \u4f7f\u7528","text":"<p>\u5728esp32\u4e2d\uff0c\u4f7f\u7528\u4e86arduino-cli\u6765\u7f16\u8bd1\u548c\u4e0a\u4f20\u4ee3\u7801\u3002\u8fd9\u91cc\u8bb0\u5f55\u4e0barduino-cli\u64cd\u4f5carduino nano\u7684\u65b9\u6cd5\u548c\u95ee\u9898</p>","tags":["arduino"]},{"location":"blog/arduino-cli-%E4%BD%BF%E7%94%A8/#_1","title":"\u7f16\u8bd1","text":"<p>\u8bf4\u4e5f\u975e\u5e38\u5947\u602a\uff0cLinux\u7684java GUI\u7248\u672carduino\u7f16\u8bd1\u63d0\u793a\u627e\u4e0d\u5230\u5934\u6587\u4ef6'SoftwareSerial.h'\uff0c \u8fd9\u4e2a\u5e93\u662farduino\u81ea\u5e26\u7684\u3002\u4f46\u662f\u4e0d\u4f7f\u7528GUI\u7684\u7f16\u8bd1\u6309\u94ae\u800c\u7528GUI\u7684\u8f93\u51fa\u4e2d\u7684\u547d\u4ee4\u7f16\u8bd1\u53c8\u6b63\u5e38\u3002 </p> <p>\u8fd9\u662f\u4eceGUI\u7684IDE\u7684\u7f16\u8bd1\u4e0a\u4f20\u7684\u8f93\u51fa\u65e5\u5fd7\uff0c\u5f97\u5230\u7684\u7f16\u8bd1\u4e0a\u4f20\u547d\u4ee4\uff0c \u624b\u52a8\u6267\u884c\u5374\u6b63\u5e38\u3002 <pre><code>cd ~/Arduino\nBUILD_PATH=$(mktemp -d)\narduino-builder -verbose -compile -hardware /usr/share/arduino/hardware -tools /usr/share/arduino/hardware/tools/avr -libraries /\n./Arduino/libraries  -build-cache ./arduino_cache -build-path $BUILD_PATH  -fqbn=arduino:avr:uno  -prefs=build.warn_data_percentage=75 ./TestSerial/TestSerial.ino\navrdude -C/etc/avrdude.conf -v -patmega328p -carduino -P/dev/ttyUSB0 -b115200 -D -Uflash:w:${BUILD_PATH}/TestSerial.ino.hex:i \n</code></pre></p> <p>\u7528arduino-cli\u7f16\u8bd1\u4e5f\u6b63\u5e38 <pre><code>arduino-cli compile --fqbn  arduino:avr:nano   TestSerial \n</code></pre></p>","tags":["arduino"]},{"location":"blog/arduino-cli-%E4%BD%BF%E7%94%A8/#_2","title":"\u4e0a\u4f20\u5931\u8d25","text":"<p>\u4f46\u662f\u7528arduino-cli\u7f16\u8bd1\u6b63\u5e38\uff0c\u4e0a\u4f20\u5931\u8d25\uff0c\u63d0\u793a <pre><code>arduino-cli upload --fqbn arduino:avr:uno --port /dev/ttyUSB0 TestSerial\navrdude: error at /etc/avrdude.conf:402: syntax error                                                                                                                                           \navrdude: error reading system wide configuration file \"/etc/avrdude.conf\"                                                                                                                       \nFailed uploading: uploading error: exit status 1   \n</code></pre></p> <p>\u540e\u6765\u7528verbos\u8f93\u51fa\u5bf9\u6bd4GUI\u7248\u672c\u7684\u547d\u4ee4\uff0c\u53d1\u73b0\u4e24\u4e2a\u547d\u4ee4\u7528\u7684avrdude\u4e0d\u4e00\u6837\u3002 \u4e00\u4e2a\u662f/usr/bin/avrdude\uff0c \u4e00\u4e2a\u662f$HOME/.arduino15/packages/arduino/tools/avrdude/6.3.0-arduino17/bin/avrdude\u3002\u4e24\u4e2a\u7684\u7248\u672c\u4e0d\u4e00\u6837\uff0c \u800c\u540e\u8005\u4f7f\u7528\u4e86\u524d\u8005\u7684\u914d\u7f6e\u6587\u4ef6 /etc/avrdude.conf\u3002\u6240\u4ee5\u51fa\u73b0<code>syntax error</code> <pre><code>arduino-cli upload -v  --fqbn arduino:avr:uno --port /dev/ttyUSB0 TestSerial\n\"/home/jimery/.arduino15/packages/arduino/tools/avrdude/6.3.0-arduino17/bin/avrdude\" \"-C/etc/avrdude.conf\" -v -V -patmega328p -carduino \"-P/dev/ttyUSB0\" -b115200 -D \"-Uflash:w:/home/jimery/.ca\nche/arduino/sketches/57AA4FA906132DC236F48CCE34943FA0/TestSerial.ino.hex:i\"                                                                                                                     \n\navrdude: Version 6.3-20190619                                                                                                                                                                   \n         Copyright (c) 2000-2005 Brian Dean, http://www.bdmicro.com/                                                                                                                            \n         Copyright (c) 2007-2014 Joerg Wunsch                                                   \n\n         System wide configuration file is \"/etc/avrdude.conf\"                                                                                                                                  \navrdude: error at /etc/avrdude.conf:402: syntax error                                                                                                                                           \navrdude: error reading system wide configuration file \"/etc/avrdude.conf\"                                                                                                                       \nFailed uploading: uploading error: exit status 1 \n</code></pre></p> <p>\u6700\u540e\u5168\u90e8\u5378\u8f7d\u4e86GUI\u5305\u62ecavrdude\uff0c \u518d\u5c06$HOME\u76ee\u5f55\u7684avrdude\u914d\u7f6e\u590d\u5236\u5230/etc/avrdude.conf\uff0c \u95ee\u9898\u89e3\u51b3\u4e86\u3002</p>","tags":["arduino"]},{"location":"blog/arduino-cli-%E4%BD%BF%E7%94%A8/#archarduino-cliarduino-nano","title":"Arch\u4e0b\u4f7f\u7528arduino-cli\u7ed9arduino nano\u70e7\u4ee3\u7801","text":"<p>arch\u4e0a\u7684arduino ide \u662f2\u7248\u672c\uff0c\u57fa\u4e8eelectron\u7684\uff0c\u4f46\u662f\u6ca1\u6709\u627e\u5230\u9002\u5408arduino nano\u7684\u9a71\u52a8\u3002 \u800c1\u7248\u672c\u662f\u57fa\u4e8ejava\u7684\u5728sway\u4e0b\uff0c\u83dc\u5355\u90fd\u8dd1\u5230\u5c4f\u5e55\u5916\u9762\u4e86\uff0c\u6ca1\u6cd5\u7528\u3002\u8fd8\u662f\u56de\u5230\u4e86arduino-cli</p>","tags":["arduino"]},{"location":"blog/arduino-cli-%E4%BD%BF%E7%94%A8/#_3","title":"\u5b89\u88c5\u914d\u7f6e","text":"<p>\u5b89\u88c5\u5f88\u7b80\u5355\uff0c\u6700\u65b0\u7248\u5c31\u5728github\u4e0a\u4e0b\u8f7d\u7f16\u8bd1\u597d\u7684\u4e8c\u8fdb\u5236\u6587\u4ef6\u3002\u6216\u8005\u7528\u5305\u7ba1\u7406\u5668\u4e0b\u8f7d\u3002 \u518d\u751f\u6210\u914d\u7f6e\u6587\u4ef6 'arduino-cli config init'\uff0c\u4f1a\u751f\u6210\u6587\u4ef6 $HOME/.arduino15/arduino-cli.yaml\uff0c\u50cf\u4e4b\u524d\u63d0\u5230\u7684\u7528esp32</p>","tags":["arduino"]},{"location":"blog/arduino-cli-%E4%BD%BF%E7%94%A8/#arduino-nano","title":"\u4e3aarduino nano\u521b\u5efa\u9879\u76ee","text":"<p>\u8fd9\u91cc\u82b1\u4e86\u5f88\u591a\u65f6\u95f4\uff0c\u56e0\u4e3a\u867d\u7136\u80fd\u67e5\u5230nano\u7684\u677f\uff0c\u4f46\u5b89\u88c5\u4e0d\u4e86arduino:avr\u7684\u9a71\u52a8\uff0c\u7f16\u8bd1\u4e0a\u4f20\u90fd\u4e0d\u884c <pre><code>$ arduino-cli board listall avr | grep nano\nArduino Nano                     arduino:avr:nano\n</code></pre></p> <pre><code>$ arduino-cli core install arduino:avr\nInvalid argument passed: Platform 'arduino:avr' not found\n$ arduino-cli core install arduino:avr::nano\nInvalid argument passed: invalid item arduino:avr::nano\n</code></pre> <p>\u5982\u679c\u76f4\u63a5\u7f16\u8bd1Sketch,\u5219\u63d0\u793a <pre><code>$ arduino-cli compile MyFirstSketch\narduino-cli compile Couldn't determine program size\n</code></pre></p>","tags":["arduino"]},{"location":"blog/arduino-cli-%E4%BD%BF%E7%94%A8/#-profile","title":"\u89e3\u51b3\u529e\u6cd5 \u4f7f\u7528'--profile'","text":"<p>\u5728\u65b0\u5efa\u7684Sketch\u76ee\u5f55\u521b\u5efa\u6587\u4ef6sketch.yaml\uff0c\u8f93\u5165\u4e0b\u9762\u7684\u5185\u5bb9 <pre><code>profiles:\n  nano:\n    notes: testing the limit of the AVR platform, may be unstable\n    fqbn: arduino:avr:nano\n    platforms:\n      - platform: arduino:avr (1.8.4)\n    libraries:\n      - VitconMQTT (1.0.1)\n      - Arduino_ConnectionHandler (0.6.4)\n      - TinyDHT sensor library (1.1.0)\n    port: /dev/ttyUSB0\n    port_config:\n      baudrate: 115200\n</code></pre></p> <p>\u6267\u884c\u7f16\u8bd1\u547d\u4ee4\uff0c\u6307\u5b9anano\u7684\u914d\u7f6e\uff0c \u4f1a\u81ea\u52a8\u4e0b\u8f7d\u5404\u79cd\u5de5\u5177avr-gcc avr-g++\u7b49 <pre><code>arduino-cli compile --profile nano MyFirstSketch      \n</code></pre></p> <p>\u4e0a\u4f20 <pre><code>arduino-cli upload  --fqbn arduino:avr:nano --port /dev/ttyUSB0 MyFirstSketch\n</code></pre></p>","tags":["arduino"]},{"location":"blog/arduino-cli-%E4%BD%BF%E7%94%A8/#arduino-cli_1","title":"arduino-cli\u7684\u53c2\u8003","text":"<p>https://arduino.github.io/arduino-cli/1.2/sketch-project-file/</p>","tags":["arduino"]},{"location":"blog/aria2c-usage/","title":"aria2c usage","text":"<p>aria2c\u652f\u6301\u5f88\u591a\u7c7b\u578b\u7684\u534f\u8bae\u4e0b\u8f7d\uff0chttp, bt\u7b49\uff0c\u652f\u6301\u4efb\u52a1\u5217\u8868\uff0c\u652f\u6301\u524d\u53f0\u8fd0\u884c\u548c\u540e\u53f0\u8fd0\u884c\uff0c \u8fd8\u652f\u6301\u5e76\u53d1\u4e0b\u8f7d\uff08\u5355\u8fde\u63a5\u9650\u901f\uff09\u548c\u65ad\u70b9\u7eed\u4f20\uff08\u524d\u63d0\u662f\u670d\u52a1\u5668\u652f\u6301\uff09\u3002\u56e0\u4e3a\u73b0\u4ee3\u6d4f\u89c8\u5668\u666e\u904d\u4e5f\u652f\u6301\u65ad\u70b9\u7eed\u4f20\u548c\u5e76\u53d1\u4e0b\u8f7d\uff0c\u6240\u4ee5aria2\u66f4\u9002\u5408\u7528\u6765\u6279\u91cf\u4e0b\u8f7d\u3002</p>","tags":["aria2"]},{"location":"blog/aria2c-usage/#_1","title":"\u524d\u53f0\u8fd0\u884c","text":"<p>\u5c31\u7c7b\u4f3cwget fcurl * \u5355\u4e2a\u6587\u4ef6\u4e0b\u8f7d aria2c \"\u4e0b\u8f7d\u94fe\u63a5\" * \u6587\u4ef6\u5217\u8868\u4e0b\u8f7d aria2c -i list.txt </p>","tags":["aria2"]},{"location":"blog/aria2c-usage/#_2","title":"\u540e\u53f0\u8fd0\u884c","text":"<p>aria2c \u672c\u8eab\u4e0d\u652f\u6301\u7c7b\u4f3c<code>-d/--daemon</code>\u53c2\u6570\uff0c\u6240\u4ee5\u8981\u4e48\u5728\u7ec8\u7aef\u6267\u884c\u4e0b\u9762\u7684\u547d\u4ee4\uff0c\u8981\u4e48\u7528systed\u6765\u8fd0\u884c\u3002 * \u540e\u53f0\u8fd0\u884c aria2c -c -i list.txt -j4 --load-cookies=rapidshare &gt; /tmp/aria2c.log 2&gt;&amp;1 &amp; * \u67e5\u770b\u65e5\u5fd7 tail -f /var/log/aria2c.log</p>","tags":["aria2"]},{"location":"blog/aria2c-usage/#systemd-webrpc","title":"systemd \u548c web/rpc \u63a7\u5236","text":"<p>\u521b\u5efa\u6587\u4ef6~/.config/systemd/user/aria2cd.service\uff0c\u5185\u5bb9\u5982\u4e0b\u3002\u8fd9\u65f6\u53ea\u80fd\u901a\u8fc7rpc\u534f\u8bae\u548caria2c\u4ea4\u4e92\uff0c\u53ef\u4ee5\u7528curl\u548cweb\u6765\u53d1\u9001rpc\u3002 <pre><code>[Unit]\nDescription=Aria2 Daemon\n\n[Service]\nType=simple\nExecStart=/usr/bin/aria2c --conf-path=/etc/aria2/aria2.conf\n\n[Install]\nWantedBy=default.target\n</code></pre> \u6211\u8ba4\u4e3a\u6700\u597d\u7684\u7eaf\u9759\u6001\u524d\u7aefYAAW for Chrome</p>","tags":["aria2"]},{"location":"blog/aria2c-usage/#_3","title":"\u914d\u7f6e\u4ee3\u7406","text":"<p>\u6709\u65f6aria2c\u8fd0\u884c\u5728\u6ca1\u6709\u7f51\u7edc\u7684\u670d\u52a1\u5668\u4e0a\uff0c\u9700\u8981\u4ee3\u7406\u8fd0\u884c\uff0c\u5982\u4e0b\u6dfb\u52a0http\u4ee3\u7406 <pre><code>all-proxy=http://ip:port\nhttp-proxy=http://ip:port\nhttps-proxy=http://ip:port\n</code></pre></p>","tags":["aria2"]},{"location":"blog/aria2c-usage/#_4","title":"\u53c2\u8003","text":"<p>https://www.linuxquestions.org/questions/linux-software-2/putting-aria2c-in-background-769997/</p>","tags":["aria2"]},{"location":"blog/bash-learning/","title":"bash\u4f7f\u7528\u6280\u5de7\u6536\u96c6","text":"<p>Linux\u7684\u547d\u4ee4\u884c\u662f\u975e\u5e38\u5f3a\u5927\u7684\u751f\u4ea7\u5de5\u5177\uff0c\u73b0\u5b9e\u4e2d\u7684\u95ee\u9898\u597d\u591a\u53ef\u4ee5\u4e0d\u5199\u590d\u6742\u7684\u7f16\u7a0b\u4ee3\u7801\u800c\u901a\u8fc7\u547d\u4ee4\u6765\u89e3\u51b3, \u800c\u4e14\u4e0d\u8fc7\u51e0\u884c\u4ee3\u7801\u800c\u5df2  </p>","tags":["bash"]},{"location":"blog/bash-learning/#shell","title":"shell \u5185\u5efa\u547d\u4ee4","text":"<p>\u5f53\u6267\u884cwhich\u7684\u65f6\u5019\uff0c\u6bd4\u5982<code>which echo</code> \u4f1a\u8f93\u51fa'shell built-in command'\u800c\u4e0d\u662f\u8fd4\u56de\u8def\u5f84\uff0c\u5c31\u8bf4\u660e\u8fd9\u4e2a\u547d\u4ee4\u662f\u5185\u5efa\u547d\u4ee4 shell\u5728\u6267\u884c\u5185\u5efa\u547d\u4ee4\u65f6\u662f\u76f4\u63a5\u6267\u884c\uff0c\u800c\u975e\u5185\u5efa\u547d\u4ee4\u5219fork\u4e00\u4e2a\u5b50\u8fdb\u7a0b\u6765\u6267\u884c</p>","tags":["bash"]},{"location":"blog/bash-learning/#buffpipedelimiter","title":"\u547d\u4ee4\u884c\u7684\u95ee\u9898\u5f88\u591a\u4e0e\u7f13\u51b2buff\u3001\u91cd\u5b9a\u5411pipe\u3001delimiter\u5206\u5272\u7b26\u6709\u5173","text":"","tags":["bash"]},{"location":"blog/bash-learning/#_1","title":"\u6280\u5de7, \u7528\u547d\u4ee4\u4ee3\u66ff\u7f16\u7a0b","text":"","tags":["bash"]},{"location":"blog/bash-learning/#xargs","title":"\u4f7f\u7528xargs\u521b\u5efa\u591a\u8fdb\u7a0b\u5e76\u53d1","text":"<p>xargs\u53ef\u4ee5\u5c06\u8f93\u5165\u591a\u8fdb\u7a0b\u5e76\u53d1\u5904\u7406\uff0c\u914d\u5408<code>find</code> \u975e\u5e38\u5389\u5bb3\u3002 \u914d\u5408wget\u5c31\u662f\u4e00\u4e2a\u5e76\u53d1\u722c\u866b\u4e86</p> <pre><code>EXAMPLES\n       find /tmp -name core -type f -print | xargs /bin/rm -f\n\n       Find files named core in or below the directory /tmp and delete them.  Note that this will work incorrectly if there are any filenames containing newlines or spaces.\n\n       find /tmp -name core -type f -print0 | xargs -0 /bin/rm -f\n\n       Find files named core in or below the directory /tmp and delete them, processing filenames in such a way that file or directory names containing spaces or newlines  are  correctly\n       handled.\n\n       find /tmp -depth -name core -type f -delete\n\n       Find  files  named  core in or below the directory /tmp and delete them, but more efficiently than in the previous example (because we avoid the need to use fork(2) and exec(2) to\n       launch rm and we don't need the extra xargs process).\n\n       cut -d: -f1 &lt; /etc/passwd | sort | xargs echo\n\n       Generates a compact listing of all the users on the system.\n</code></pre>","tags":["bash"]},{"location":"blog/bash-learning/#find-exec","title":"find -exec \u7528\u6cd5","text":"<p><pre><code>find . -exec grep chrome {} \\;\nfind . -exec grep chrome {} +\n</code></pre> 1. \\; \u662f\u8f6c\u4e49; 2. {} \u4f1a\u66ff\u6362\u6210 find\u51fa\u7684\u6587\u4ef6\u540d\u3002 2. ; \u548c + \u7684\u533a\u522b\u662f\uff1a \u5f53;\u65f6\uff0cgrep\u547d\u4ee4\u4f1a\u5728\u6bcf\u4e2a\u6587\u4ef6\u540d\u4e0a\u6267\u884c\u4e00\u6b21\uff0cgrep\u6267\u884c\u591a\u6b21\uff0c \u4f46+\u65f6\uff0c\u6240\u6709\u7684\u6587\u4ef6\u540d\u4f1a\u5c06\u6240\u6709\u7684\u6587\u4ef6\u540d\u4e00\u6b21\u8fdb\u884cgrep\uff0cgrep\u6267\u884c\u4e00\u6b21\u3002</p>","tags":["bash"]},{"location":"blog/bash-learning/#awk-ors","title":"\u4f7f\u7528awk ORS \u5206\u5272\u7ed3\u679c","text":"<p>ls \u672c\u6765\u662f\u884c\u5206\u9694\u7684 awk\u5c06ls\u7684\u6362\u884c\u7b26\u53d8\u4e3a|\u5206\u5272 <pre><code>ls | awk '{ ORS=\"|\"; print; }'\n</code></pre> \u800c<code>echo $(ls)</code> \u5219\u628als\u7684\u6362\u884c\u7b26\u53d8\u4e3a\u7a7a\u683c</p>","tags":["bash"]},{"location":"blog/bash-learning/#declare","title":"\u4f7f\u7528declare \u58f0\u660e\u53d8\u91cf\u7684\u7c7b\u578b\u548c\u5c5e\u6027","text":"<p>declare\u53ef\u4ee5\u6307\u5b9a\u53d8\u91cf\u7684\u7c7b\u578b'-i'\u4e3a\u6574\u5f62\uff0c'-r'\u5236\u5ea6(\u7b49\u540cshell\u7684readonly)\uff0c'-g'\u5168\u5c40\u53d8\u91cf shell\u9ed8\u8ba4\u662f\u5b57\u7b26\u4e32\uff0c\u4f7f\u7528'-i'\u540e\uff0c\u6570\u5b66\u8fd0\u7b97\u4e0d\u9700\u8981<code>let</code></p> <pre><code>#retry=0\ndeclare -i retry=0\nwhile [ $retry -lt 30 ] ; do\nps aux --cols=1024 | grep xxx\nif [ $? -eq 0 ] ; then\n        exit 0\nfi\nsleep 1\n#let retry=$retry+1\nretry=$retry+1\ndone\n</code></pre>","tags":["bash"]},{"location":"blog/bash-safety/","title":"bash safety","text":"<p>\u4e0d\u7ba1\u662f\u5927\u5382\u8fd8\u662f\u5c0f\u5382\uff0c\u603b\u80fd\u542c\u5230\u4e00\u4e9b\u8bef\u64cd\u4f5c\u65b0\u95fb \u90a3\u907f\u514d\u8bef\u64cd\u4f5c\u5c31\u529e\u6cd5\u5c31\u662f\u5199\u811a\u672c\uff0c \u7136\u540e\u4e5f\u6709\u5f88\u591a\u811a\u672c\u51fa\u4e8b\u7684\u65b0\u95fb, \u901a\u5e38\u6709\u4ee5\u4e0b</p>","tags":["bash"]},{"location":"blog/bash-safety/#_1","title":"\u5f15\u7528\u4e86\u4e0d\u5b58\u5728\u7684\u53d8\u91cf","text":"<pre><code>#!/bin/bash\n\nABC_PATH=abc\n\n/bin/rm ${ABC_PATH}/\n</code></pre> <p>\u5982\u679cABC_PATH\u53d8\u91cf\u88abunset\u4e86\uff0c \u90a3\u4e48\u5c31\u662f\u5220\u9664\u7cfb\u7edf\u4e86 \u4e0d\u8fc7\u542c\u8bf4<code>/bin/rm /</code> \u7684\u64cd\u4f5c\u4f1a\u53ef\u80fd\u88ab\u7cfb\u7edf\u7981\u6b62\uff0c \u4f46\u662f<code>/bin/rm /*</code>\u5219\u80af\u5b9a\u80fd\u6267\u884c\u6210\u529f</p>","tags":["bash"]},{"location":"blog/bash-safety/#_2","title":"\u811a\u672c\u6ca1\u6709\u8f93\u51fa","text":"<p>\u6709\u5f88\u591a\u516c\u53f8\u7528\u5821\u5792\u673a\u6765\u5ba1\u8ba1\u64cd\u4f5c\u8bb0\u5f55\uff0c \u4f46\u662f\u5982\u679c\u811a\u672c\u6ca1\u6709\u8f93\u51fa\uff0c\u90a3\u4e48\u5c31\u4e0d\u77e5\u9053\u6267\u884c\u4e86\u4ec0\u4e48\u547d\u4ee4\uff0c \u518d\u5982\u679c\u811a\u672c\u4e5f\u88ab\u5220\u9664\u6b7b\u65e0\u5bf9\u8bc1\uff0c\u90a3\u5c31\u65e0\u6cd5\u5206\u6790\u4e86</p>","tags":["bash"]},{"location":"blog/bash-safety/#_3","title":"\u89e3\u51b3\u529e\u6cd5","text":"","tags":["bash"]},{"location":"blog/bash-safety/#bash-set-xeu","title":"\u5728bash \u811a\u672c\u524d\u9762\u52a0\u4e0a   <code>set -xeu</code>","text":"<p>-x \u8c03\u8bd5\u6a21\u5f0f\uff0cbash\u4f1a\u8f93\u51fa\u6240\u6709\u547d\u4ee4 -e \u9047\u5230\u9519\u8bef\u5c31\u9000\u51fa -u \u5f15\u7528\u4e86\u4e0d\u5b58\u5728\u7684\u53d8\u91cf\u5c31\u9000\u51fa</p>","tags":["bash"]},{"location":"blog/bash-safety/#_4","title":"\u6dfb\u52a0\u9ed8\u8ba4\u503c","text":"<p>path=${ABC_PATH-/} # default /</p> <p>\u8fd9\u6837\uff0c\u5f53ABC_PATH\u4e0d\u5b58\u5728\u65f6\uff0c\u5c31\u4f7f\u7528\u9ed8\u8ba4\u503c'/'</p>","tags":["bash"]},{"location":"blog/bash-safety/#_5","title":"\u6700\u597d\u7684\u529e\u6cd5","text":"<p>\u4f7f\u7528ansible\uff0c \u53ef\u4ee5\u5bf9\u811a\u672c\u8fdb\u884c\u7248\u672c\u7ba1\u7406\u548creview\uff0c \u53ef\u4ee5\u907f\u514d\u811a\u672c\u96be\u4ee5\u7ef4\u62a4\u7684\u95ee\u9898 \u4f7f\u7528ide + bash \u63d2\u4ef6\uff0c \u53ef\u4ee5\u6709\u63d0\u793a</p>","tags":["bash"]},{"location":"blog/bash-safety/#_6","title":"\u826f\u597d\u7684\u811a\u672c\u4e60\u60ef","text":"<p>\u9664\u4e86\u5728\u811a\u672c\u524d\u9762\u52a0\u4e0a <code>set -xeu</code>\u5916\uff0c \u6709\u4e00\u4e9b\u5efa\u8bae </p> <ol> <li>\u591a\u7528<code>&amp;&amp;</code>,<code>||</code> \uff0c\u5c11\u7528 <code>;</code> \uff0c\u5982\u679c\u524d\u9762\u7684\u547d\u4ee4\u51fa\u9519\uff0c\u540e\u9762\u5c31\u4e0d\u4f1a\u6267\u884c\uff0c \u800c<code>;</code> \u4e0d\u7ba1  </li> <li>\u5584\u7528 date\uff0c \u4f8b\u5982\u5c06\u65e5\u5fd7\u6587\u4ef6\u52a0\u4e0a\u65e5\u671f <code>bash test.sh &gt; log_</code>date +%m_%d_%H_%M_%S``  </li> <li>\u811a\u672c\u653e\u5728\u6307\u5b9a\u76ee\u5f55\uff0c\u4e0d\u8981\u4e0e\u5de5\u4f5c\u76ee\u5f55\u653e\u5728\u4e00\u8d77\uff0c \u907f\u514d\u811a\u672c\u81ea\u5df1\u88ab\u5220\uff0c \u6b7b\u65e0\u5bf9\u8bc1</li> <li>\u5b9a\u671f\u5907\u4efd</li> </ol>","tags":["bash"]},{"location":"blog/bash-safety/#bash","title":"bash \u7684\u6761\u4ef6\u5224\u65ad","text":"<p>\u6709\u4ee5\u4e0b\u811a\u672c,\u5f53TMP \u4e0d\u4e3a\u7a7a\u7684\u65f6\u5019\uff0c\u624d\u8fdb\u884c\u5224\u65ad\u503c\u662f\u5426\u5927\u4e8e2</p> <pre><code>if [ -n \"$TMP\" -a ${TMP} -gt 2 ];then\n        echo \"aaaa\"\nelse\n        echo \"bbbbbbbb\"\nfi\n</code></pre> <p>\u800c\u5f53TMP \u4e3a\u7a7a\u7684\u65f6\u5019\uff0c\u5c31\u4f1a\u51fa\u73b0 <code>too many arguement</code>\u3002\u8fd9\u5c31\u8bf4\u660e\u4e86bash\u7684\u6267\u884c\u6d41\u7a0b\uff0c\u662f\u5148\u8fdb\u884c\u6574\u884c\u66ff\u6362\u518d\u6267\u884c\uff08\u8d77\u7801\u662f\u6574\u884c\uff0c\u4e5f\u8bb8\u8fd8\u662f\u5168\u6587\u66ff\u6362\uff09\u3002 \u66ff\u6362\u540e<code>[-n \"\" -a -gt 2]</code>\u3002\u5bfc\u81f4\u4e86\u62a5\u9519\u3002 \u89e3\u51b3\u8fd9\u6837\u7684\u95ee\u9898\u53ef\u4ee5\u7528\u9ed8\u8ba4\u503c TMP=${TMP:=2}, \u8fd9\u6837\u5f53TMP\u4e3a\u7a7a\u7684\u65f6\u5019\u5c31\u4f1a\u81ea\u52a8\u8d4b\u503c\u4e3a2 <pre><code>if [ -n \"$TMP\" -a ${TMP:=2} -gt 2 ];then\n        echo \"aaaa\"\nelse\n        echo \"bbbbbbbb\"\nfi\n</code></pre></p>","tags":["bash"]},{"location":"blog/binary-tree-traversal/","title":"\u4e8c\u53c9\u6811\u904d\u5386","text":"","tags":["\u7b97\u6cd5"]},{"location":"blog/binary-tree-traversal/#_2","title":"\u4e8c\u53c9\u6811\u5b9a\u4e49","text":"<p>\u4e8c\u53c9\u6811\u7684\u7236\u8282\u70b9\u6700\u591a\u67092\u4e2a\u5b50\u8282\u70b9\uff0c\u5982\u679c\u4e8c\u53c9\u6811\u7684\u6240\u6709\u7236\u8282\u70b9\u6ca1\u6709\u8282\u70b9\u6216\u8005\u67092\u4e2a\u8282\u70b9\uff0c\u90a3\u4e48\u53eb\u5b8c\u5168\u4e8c\u53c9\u6811</p>","tags":["\u7b97\u6cd5"]},{"location":"blog/binary-tree-traversal/#_3","title":"\u4e8c\u53c9\u6811\u7684\u904d\u5386\u65b9\u5f0f","text":"<p>\u4e8c\u53c9\u6811\u67094\u4e2d\u904d\u5386\u65b9\u5f0f\uff1a \u524d\u5e8f\u904d\u5386\uff0c \u4e2d\u5e8f\uff0c \u540e\u5e8f\uff0c \u4ee5\u53ca\u5c42\u5e8f  </p> <p>\u524d\u4e09\u79cd\u53ef\u4ee5\u5bf9\u6bd4\u7740\u770b\uff0c\u533a\u522b\u5728\u4e8e\u7236\u8282\u70b9\u5148\u88ab\u8bbf\u95ee\u7684\u987a\u5e8f\uff0c\u8fd9\u91cc\u7684\u5148\u540e\u90fd\u662f\u76f8\u5bf9\u4e8e\u540c\u4e00\u4e2a\u6811\u800c\u8a00\u3002 \u8fd9\u91cc\u7684\u8bbf\u95ee\u610f\u601d\u662f\u8bbf\u95ee\u5176\u503c\uff0c \u4f8b\u5982\u6253\u5370\u8282\u70b9\u7684\u6570\u636e\uff1a   * \u524d\u5e8f\u904d\u5386\uff0c \u5148\u7236\u8282\u70b9\uff0c\u518d\u5de6\u5b50\u8282\u70b9\uff0c\u6700\u540e\u662f\u53f3\u5b50\u8282\u70b9    * \u4e2d\u5e8f\u904d\u5386\uff0c \u5148\u5de6\u5b50\u8282\u70b9\uff0c \u518d\u7236\u8282\u70b9\uff0c \u6700\u540e\u662f\u53f3\u5b50\u8282\u70b9   * \u4e2d\u5e8f\u904d\u5386\uff0c \u5148\u5de6\u5b50\u8282\u70b9\uff0c \u518d\u53f3\u5b50\u8282\u70b9 \uff0c\u6700\u540e\u7236\u8282\u70b9</p> <p>\u53ef\u89c1\uff0c\u90fd\u662f\u5148\u5de6\u5b50\u8282\u70b9\u540e\u53f3\u5b50\u8282\u70b9  </p> <p>\u800c\u5c42\u5e8f\u904d\u5386\u662f\u4ece\u4e0a\u5f80\u4e0b\uff0c\u5e7f\u5ea6\u4f18\u5148</p>","tags":["\u7b97\u6cd5"]},{"location":"blog/binary-tree-traversal/#_4","title":"\u6548\u679c","text":"<p>\u82e5\u6709\u4ee5\u4e0b\u4e8c\u53c9\u6811\uff0c\u5219\u904d\u5386\u7ed3\u679c <pre><code>graph BT\n    A[1] --&gt; B[0]\n    C[2] --&gt; B\n    D[3] --&gt; A\n    E[4] --&gt; A\n    F[5] --&gt; C\n    G[6] --&gt; C\n    H[7] --&gt; D\n    I[8] --&gt; D\n    J[9] --&gt; E</code></pre></p> <p>\u5c42\u5e8f: 0 1 2 3 4 5 6 7 8 9</p> <p>\u5148\u5e8f: 0 1 3 7 8 4 9 2 5 6 \u4e2d\u5e8f: 7 3 8 1 9 4 0 5 2 6 \u540e\u5e8f: 7 8 3 9 4 1 5 6 2 0 </p> <p>\u6ce8\u610f\u4e0b\u5212\u7ebf\uff0c\u5373036\u7ec4\u6210\u7684\u4e00\u4e2a\u6811\uff0c \u53ef\u4ee5\u8bc1\u5b9e\u4e0a\u9762\u7684\u603b\u7ed3  </p>","tags":["\u7b97\u6cd5"]},{"location":"blog/binary-tree-traversal/#_5","title":"\u4ee3\u7801\u5b9e\u73b0","text":"<p>\u5b9e\u73b0\u524d\u4e09\u79cd\u904d\u5386\u90fd\u67092\u79cd\u65b9\u5f0f\uff0c \u9012\u5f52\u548c\u4f7f\u7528stack</p> <p>\u8282\u70b9\u6570\u636e\u7ed3\u6784 <pre><code>    def Node:\n        self.item\n        self.lchild\n        self.rchild\n</code></pre></p>","tags":["\u7b97\u6cd5"]},{"location":"blog/binary-tree-traversal/#_6","title":"\u9012\u5f52\u5b9e\u73b0","text":"<p>\u524d\u5e8f\u904d\u5386 <pre><code>def front_recursion(root: Node):\n    if root is None:\n        return None\n    print(root.item)\n    if root.lchild is not None:\n        front_recursion(root.lchild)\n    if root.rchild is not None:\n        front_recursion(root.rchild)\n</code></pre></p> <p>\u4e2d\u5e8f\u904d\u5386 <pre><code>def Middle_recursion(root: Node):\n    if root is None:\n        return None\n    if root.lchild is not None:\n        front_recursion(root.lchild)\n    print(root.item)\n    if root.rchild is not None:\n        front_recursion(root.rchild)\n</code></pre></p> <p>\u540e\u5e8f\u904d\u5386 <pre><code>def Middle_recursion(root: Node):\n    if root is None:\n        return None\n    if root.lchild is not None:\n        front_recursion(root.lchild)\n    if root.rchild is not None:\n        front_recursion(root.rchild)\n    print(root.item)\n</code></pre></p>","tags":["\u7b97\u6cd5"]},{"location":"blog/binary-tree-traversal/#stack","title":"stack\u5b9e\u73b0","text":"<p>\u524d\u5e8f\u904d\u5386 <pre><code>def Front_stack(root: Node):\n    if root is None:\n        return None\n\n    stack = []\n    Node = root\n    stack.append(Node)\n\n    while Node or stack:\n        while Node:\n            # \u8bbf\u95ee\u548c\u5165\u6808\u7684\u987a\u5e8f\u987a\u5e8f\u662f\u5148\u7236\u8282\u70b9\u540e\u5de6\u8282\u70b9\n            print(Node.item)\n            # \u7236\u8282\u70b9\u5165\u6808\n            stack.append(Node.lchild)\n            # \u6df1\u5ea6\u4f18\u5148\uff0c\u627e\u6700\u5de6\u8282\u70b9\uff0c\u4e0b\u4e2a\u5faa\u73af\u5c31\u662f\u5148\u8bbf\u95ee\u7236\u8282\u70b9\u540e\u5de6\u5b50\u8282\u70b9\n            Node = Node.lchild\n        # \u8fd9\u91cc\u9700\u8981\u597d\u597d\u4f53\u4f1a\uff0c\u7236\u8282\u70b9\u548c\u5de6\u5b50\u8282\u70b9\u5df2\u7ecf\u8bbf\u95ee\u8fc7\uff0c\u53ea\u5269\u4e0b\u53f3\u8282\u70b9\n        # \u6240\u4ee5\u5c31\u662f\u5148\u5de6\u540e\u53f3\n        Node = stack.pop()\n        Node = Node.rchild\n</code></pre></p> <p>\u4e2d\u5e8f\u904d\u5386 <pre><code>def Middle_stack(root: Node):\n    if root is None:\n        return None\n\n    stack = []\n    Node = root\n    stack.append(Node)\n\n    while Node or stack:\n        while Node:\n            # \u7236\u8282\u70b9\u5165\u6808\n            # \u5de6\u5b50\u8282\u70b9\u5165\u6808\n            # \u4f46\u90fd\u4e0d\u8bbf\u95ee\uff0c\u56e0\u4e3a\u538b\u6808\u987a\u5e8f\u662f\u5148\u7236\u540e\u5de6\u5b50\uff0c\u5230\u51fa\u6808\u7684\u65f6\u5019\u518d\u8bbf\u95ee\n            stack.append(Node.lchild)\n            Node = Node.lchild\n\n        Node = stack.pop()\n        # \u627e\u5230\u6700\u5de6\u5b50\u8282\u70b9\u4e86\uff0c\u5f00\u59cb\u51fa\u6808\uff0c\u6240\u4ee5\u80af\u5b9a\u662f\u5148\u51fa\u5de6\u8282\u70b9\uff0c \u7136\u540e\u518d\u51fa\u6808\u4e4b\u540e\u5c31\u662f\u7236\u8282\u70b9\n        print(Node.item)\n        # \u6700\u540e\u5c31\u662f\u53f3\u8282\u70b9\uff0c \u56de\u5230\u7b2c\u4e00\u4e2awhile \u7ee7\u7eed\u627e\u53f3\u5b50\u6811\u7684\u6700\u5de6\u8282\u70b9\n        Node = Node.rchild\n</code></pre></p> <p>\u540e\u5e8f\u7684stack\u6bd4\u8f83\u590d\u6742</p> <p>\u8fd8\u6709\u4e00\u4e2a\u6bd4\u8f83\u7b80\u5355\u7684\u5148\u5e8fstack <pre><code>def Front_stack(root: Node):\n    if root is None:\n        return None\n\n    stack = []\n    stack.append(root)\n\n    while stack:\n        Node = stack.pop()\n        print(Node.item)\n\n        # stack \u5148\u8fdb\u540e\u51fa\uff0c\u6240\u4ee5\u5148\u538b\u53f3\u8282\u70b9\n        if Node.rchild is not None:\n            stack.append(Node.rchild)\n\n        if Node.lchild is not None:\n            stack.append(Node.lchild)\n</code></pre></p> <p>\u5c42\u5e8f\u904d\u5386,\u662f\u5e7f\u5ea6\u4f18\u5148\u7684\u4e00\u79cd\u65b9\u5f0f\uff0c\u6240\u4ee5\u4f7f\u7528\u5230queue <pre><code>def Layer_queue(root: Node):\n    if root is None:\n        return None\n\n    queue = []\n    queue.append(root)\n    while queue:\n        # \u53d6\u524d\u9762\u7684\n        Node = queue.pop(0)\n        print(Node.item)\n        if Node.lchild is not None:\n            queue.append(Node.lchild)\n\n        if Node.rchild is not None:\n            queue.append(Node.rchild)\n</code></pre></p>","tags":["\u7b97\u6cd5"]},{"location":"blog/binary-tree-traversal/#_7","title":"\u540e\u5e8f\u6808\u904d\u5386","text":"<p>\u540e\u5e8f\u904d\u5386\u7684\u987a\u5e8f\u662f\u5148\u5de6\u5b50\u540e\u53f3\u5b50\uff0c\u6700\u540e\u624d\u662f\u7236\u8282\u70b9</p> <pre><code>'''\n1. \u540c\u6837\u5148\u627e\u5230\u6700\u5de6\u8fb9\u7684\u8282\u70b9\uff0c\u7236\u8282\u70b9\u548c\u5de6\u5b50\u8282\u70b9\u5165\u6808\n2. \u627e\u5230\u6700\u540e\u4e00\u4e2a\u5de6\u5b50\u8282\u70b9\u4e4b\u540e\uff0c\u5224\u65ad\u6808\u9876\u7684\u8282\u70b9\uff0c\u51fa\u6808\u987a\u5e8f\u662f\u5148\u5de6\u5b50\u540e\u7236\u8282\u70b9\uff0c\u6240\u4ee5\u53ea\u9700\u8981\u5224\u65ad\u53f3\u5b50\u8282\u70b9\u7684\u60c5\u51b5\uff1a\n   \u5982\u679c\u6808\u9876\u8282\u70b9\u7684\u53f3\u5b50\u8282\u70b9\u4e3a\u7a7a\uff0c\u76f4\u63a5\u6253\u5370\u6808\u9876\u8282\u70b9\u3002 \u5982\u679c\u6808\u9876\u8282\u70b9\u7684\u53f3\u5b50\u8282\u70b9\u662f\u4e0a\u4e00\u4e2a\u51fa\u6808\u7684\u8282\u70b9\uff0c\u90a3\u4e48\u8bf4\u660e\u5df2\u7ecf\u8bbf\u95ee\u5230\u4e86\u53f3\u5b50\u8282\u70b9\uff0c\u53ef\u4ee5\u7ee7\u7eed\u6253\u5370\u7236\u8282\u70b9  \n   \u5982\u679c\u6808\u9876\u7684\u53f3\u5b50\u8282\u70b9\u4e0d\u4e3a\u7a7a\u4e5f\u4e0d\u662f\u4e0a\u4e00\u4e2a\u8bbf\u95ee\u7684\u8282\u70b9\uff0c\u6240\u4ee5\u8981\u5148\u53bb\u8bbf\u95ee\u53f3\u5b50\u6811\uff0c \u5c06\u53f3\u5b50\u8282\u70b9\u5165\u6808\uff0c\u9000\u51fa\u5faa\u73af\uff0c\u6267\u884c\u7b2c\u4e00\u6b65\n'''\ndef back_stack(self, root):\n    if root is None:\n        return None\n    stack = []\n    Tag = None\n    stack.append(root)\n    while stack:\n        Node = stack[-1]\n        while Node.lchild:\n            stack.append(Node.lchild)\n            Node = Node.lchild\n\n        while stack:\n            Node = stack[-1]\n            if Tag == Node.rchild or Node.rchild is None:\n                Node = stack.pop()\n                print(Node.item)\n                Tag = Node\n            elif Node.rchild is not None:\n                stack.append(Node.rchild)\n                break\n</code></pre>","tags":["\u7b97\u6cd5"]},{"location":"blog/buffer-cache-too-high/","title":"Linux \u8c03\u4f18","text":"<p>\u7cfb\u7edf\u539f\u5382\u5546\u662f\u4e0d\u559c\u6b22\u8ba8\u8bba\u7cfb\u7edf\u8c03\u4f18\u7684\uff0c\u4e00\u65b9\u9762\u8bf4\u8d77\u6765\u6ca1\u5b8c\u6ca1\u4e86\uff0c\u4e8c\u6765\u6bd4\u8f83\u590d\u6742\uff0c\u800c\u4e14\u79c1\u4ee5\u4e3a\u8c03\u4f18\u5373\u8bf4\u660e\u7cfb\u7edf\u9ed8\u8ba4\u4e0d\u591f\u597d\uff1f</p> <p>\u800c\u4e14SUSE\u7684\u539f\u5382\u89c4\u5b9a:</p> <p>\u539f\u7406\u673a\u5236\u7684\u4ecb\u7ecd\u53ca\u7cfb\u7edf\u8c03\u4f18\u5e76\u4e0d\u5728\u6211\u4eec\u7684\u6280\u672f\u652f\u6301\u8303\u7574</p> <p>\u8fd9\u91cc\u662f\u4e00\u70b9\u76f8\u5173\u4ecb\u7ecd</p>","tags":["memory","linux"]},{"location":"blog/buffer-cache-too-high/#buffercache","title":"buffer/cache \u7684\u4f5c\u7528\u548c\u533a\u522b","text":"<p>buffer\u662f\u7528\u4e8e\u5b58\u653e\u5c06\u8981\u8f93\u51fa\u5230disk\uff08\u5757\u8bbe\u5907\uff09\u7684\u6570\u636e\uff0c\u800ccache\u662f\u5b58\u653e\u4ecedisk\u4e0a\u8bfb\u51fa\u7684\u6570\u636e\u3002\u4e8c\u8005\u90fd\u662f\u4e3a\u63d0\u9ad8IO\u6027\u80fd\u800c\u8bbe\u8ba1\u7684\u3002                                                                                                                                                        - buffer\uff1a\u7f13\u51b2\u5c06\u6570\u636e\u7f13\u51b2\u4e0b\u6765\uff0c\u89e3\u51b3\u901f\u5ea6\u6162\u548c\u5feb\u7684\u4ea4\u63a5\u95ee\u9898\uff1b\u901f\u5ea6\u5feb\u7684\u9700\u8981\u901a\u8fc7\u7f13\u51b2\u533a\u5c06\u6570\u636e\u4e00\u70b9\u4e00\u70b9\u4f20\u7ed9\u901f\u5ea6\u6162\u7684\u533a\u57df\u3002                                                                                \u4f8b\u5982\uff1a\u4ece\u5185\u5b58\u4e2d\u5c06\u6570\u636e\u5f80\u786c\u76d8\u4e2d\u5199\u5165\uff0c\u5e76\u4e0d\u662f\u76f4\u63a5\u5199\u5165\uff0c\u800c\u662f\u7f13\u51b2\u5230\u4e00\u5b9a\u5927\u5c0f\u4e4b\u540e\u5237\u5165\u786c\u76d8\u4e2d\u3002                                                                                                          A buffer is something that has yet to be \"written\" to disk.                                                                                                                                    </p> <ul> <li>cache\uff1a\u7f13\u5b58\u5b9e\u73b0\u6570\u636e\u7684\u91cd\u590d\u4f7f\u7528\uff0c\u901f\u5ea6\u6162\u7684\u8bbe\u5907\u9700\u8981\u901a\u8fc7\u7f13\u5b58\u5c06\u7ecf\u5e38\u8981\u7528\u5230\u7684\u6570\u636e\u7f13\u5b58\u8d77\u6765\uff0c\u7f13\u5b58\u4e0b\u6765\u7684\u6570\u636e\u53ef\u4ee5\u63d0\u4f9b\u9ad8\u901f\u7684\u4f20\u8f93\u901f\u5ea6\u7ed9\u901f\u5ea6\u5feb\u7684\u8bbe\u5907\u3002                                                     \u4f8b\u5982\uff1a\u5c06\u786c\u76d8\u4e2d\u7684\u6570\u636e\u8bfb\u53d6\u51fa\u6765\u653e\u5728\u5185\u5b58\u7684\u7f13\u5b58\u533a\u4e2d\uff0c\u8fd9\u6837\u4ee5\u540e\u518d\u6b21\u8bbf\u95ee\u540c\u4e00\u4e2a\u8d44\u6e90\uff0c\u901f\u5ea6\u4f1a\u5feb\u5f88\u591a\u3002                                                                                                    A cache is something that has been \"read\" from the disk and stored for later use.                                                           </li> </ul> <p>\u603b\u4e4bbuff\u548ccache\u90fd\u662f\u5185\u5b58\u548c\u786c\u76d8\u4e4b\u95f4\u7684\u8fc7\u6e21\uff0c\u524d\u8005\u662f\u5199\u5165\u78c1\u76d8\u65b9\u5411\uff0c\u800c\u540e\u8005\u662f\u5199\u5165\u5185\u5b58\u65b9\u5411</p>","tags":["memory","linux"]},{"location":"blog/buffer-cache-too-high/#cache","title":"\u56de\u6536cache","text":"<p><pre><code>drop_caches\u56de\u6536\u4e00\u4e0b\u3002\n#sync;sync;sync\n#echo 3 &gt; /proc/sys/vm/drop_caches    \n</code></pre> free\u589e\u52a0300M</p>","tags":["memory","linux"]},{"location":"blog/buffer-cache-too-high/#swap","title":"swap \u4ecb\u7ecd","text":"<p>Swap\u610f\u601d\u662f\u4ea4\u6362\u5206\u533a\uff0c\u662f\u786c\u76d8\u4e2d\u7684\u4e00\u4e2a\u5206\u533a\u3002\u5185\u6838\u5c06\u5185\u5b58Page\u79fb\u51fa\u5185\u5b58\u5230swap\u5206\u533a(swap out)</p> <p>swap\u901a\u8fc7 vm.swappiness \u8fd9\u4e2a\u5185\u6838\u53c2\u6570\u63a7\u5236\uff0c\u9ed8\u8ba4\u503c\u662f60\u3002<code>cat /proc/sys/vm/swappiness</code> \u53ef\u4ee5\u67e5\u770b\u5f53\u524d\u503c \u8fd9\u4e2a\u53c2\u6570\u63a7\u5236\u5185\u6838\u4f7f\u7528swap\u7684\u4f18\u5148\u7ea7\u3002\u8be5\u53c2\u6570\u4ece0\u5230100\u3002</p> <p>\u8bbe\u7f6e\u8be5\u53c2\u6570\u4e3a0\uff0c\u8868\u793a\u53ea\u8981\u6709\u53ef\u80fd\u5c31\u5c3d\u529b\u907f\u514d\u4ea4\u6362\u8fdb\u7a0b\u79fb\u51fa\u7269\u7406\u5185\u5b58\uff1b                                                             \u8bbe\u7f6e\u8be5\u53c2\u6570\u4e3a100\uff0c\u8fd9\u544a\u8bc9\u5185\u6838\u75af\u72c2\u7684\u5c06swapout\u7269\u7406\u5185\u5b58\u79fb\u5230swap\u5206\u533a\u3002 \u6ce8\u610f\uff1a\u8bbe\u7f6e\u8be5\u53c2\u6570\u4e3a0\uff0c\u5e76\u4e0d\u4ee3\u8868\u7981\u7528swap\u5206\u533a\uff0c\u53ea\u662f\u544a\u8bc9\u5185\u6838\uff0c\u80fd\u5c11\u7528\u5230swap\u5206\u533a\u5c31\u5c3d\u91cf\u5c11\u7528\u5230\uff0c\u8bbe\u7f6evm.swappiness=100\u7684\u8bdd\uff0c\u5219\u8868\u793a\u5c3d\u91cf\u4f7f\u7528swap\u5206\u533a\u3002                                                    </p> <p>\u8fd9\u91cc\u9762\u6d89\u53ca\u5230\u5f53\u7136\u8fd8\u6d89swappiness\u53ca\u5230\u590d\u6742\u7684\u7b97\u6cd5\u3002\u5982\u679c\u4ee5\u4e3a\u6240\u6709\u7269\u7406\u5185\u5728\u7528\u5b8c\u4e4b\u540e\uff0c\u518d\u4f7f\u7528swap, \u5b9e\u4e8b\u5e76\u4e0d\u662f\u8fd9\u6837\u3002\u4ee5\u524d\u66fe\u7ecf\u9047\u5230\u8fc7\uff0c\u7269\u7406\u5185\u5b58\u53ea\u5269\u4e0b10M\u4e86\uff0c\u4f46\u662f\u4f9d\u7136\u6ca1\u6709\u4f7f\u7528Swap\u4ea4\u6362\u7a7a\u95f4\uff0c\u53e6\u5916\u4e00\u53f0\u670d\u52a1\u5668\uff0c\u7269\u7406\u5185\u5b58\u8fd8\u5269\u4e0b15G\uff0c\u5c45\u7136\u7528\u4e86\u4e00\u70b9\u70b9Swap\u4ea4\u6362\u7a7a\u95f4\u3002 \u5176\u5b9e\u5c11\u91cf\u4f7f\u7528Swap\u4ea4\u6362\u7a7a\u95f4\u662f\u4e0d\u4f1a\u5f71\u54cd\u6027\u80fd\uff0c\u53ea\u6709\u5f53\u5185\u5b58\u8d44\u6e90\u51fa\u73b0\u74f6\u9888\u6216\u8005\u5185\u5b58\u6cc4\u9732\uff0c\u8fdb\u7a0b\u5f02\u5e38\u65f6\u5bfc\u81f4\u9891\u7e41\u3001\u5927\u91cf\u4f7f\u7528\u4ea4\u6362\u5206\u533a\u624d\u4f1a\u5bfc\u81f4\u4e25\u91cd\u6027\u80fd\u95ee\u9898\u3002             </p>","tags":["memory","linux"]},{"location":"blog/buffer-cache-too-high/#swap_1","title":"\u95ee\u9898\uff1a\u4f55\u65f6\u4f7f\u7528swap","text":"<p>\u8fd9\u4e2a\u95ee\u9898\u5982\u4e0a\u9762\u8bf4\u7684\uff0c\u6bd4\u8f83\u96be\u8bf4\uff0c\u7406\u8bba\u4e0a\u662f\u5f53\u7269\u7406\u5185\u5b58\u4e0d\u591f\u7528\u7684\u65f6\u5019\uff0c\u53c8\u9700\u8981\u8bfb\u5165\u5185\u5b58\u65f6\uff0c\u4f1a\u5c06\u4e00\u4e9b\u957f\u65f6\u95f4\u4e0d\u7528\u7684\u7a0b\u5e8f\u7684\u5185\u5b58Page \u4ea4\u6362\u51fa\u53bb\u3002                      \u4f46\u662f\u5f88\u591a\u65f6\u5019\u4f1a\u53d1\u73b0\uff0c\u5185\u6838\u5373\u4f7f\u5728\u5185\u5b58\u5145\u8db3\u7684\u60c5\u51b5\u4e0b\u4e5f\u662f\u4f7f\u7528\u5230swap</p>","tags":["memory","linux"]},{"location":"blog/buffer-cache-too-high/#swap_2","title":"\u95ee\u9898: \u90a3\u4e9b\u4e1c\u897f\u88abswap\u4e86\uff1f","text":"<p>\u53ef\u4ee5\u770b\u4e0b\u9762\u7684\u6d4b\u8bd5</p>","tags":["memory","linux"]},{"location":"blog/buffer-cache-too-high/#swap_3","title":"\u56de\u6536swap","text":"<p>swapoff \u4e4b\u540e\u6267\u884c<code>sudo sysctl vm.swappiness=0</code> \u4e34\u65f6\u8ba9\u5185\u6838\u4e0d\u7528swapout</p> <p><pre><code>\u5e76\u628aswap\u7684\u6570\u636e\u52a0\u8f7d\u5185\u5b58\uff0c\u5e76\u91cd\u542fswap \n#swapoff -a\n#swapon -a\n</code></pre> \u5373\u628aswap\u5206\u533a\u6e05\u7a7a,  \u81ea\u6d4b\u6548\u679c\u5982\u4e0b\uff0c\u5185\u6838\u7248\u672c<code>5.10.0-8-amd64</code></p> <pre><code>               total        used        free      shared  buff/cache   available\nMem:        12162380     4911564     5605744      459364     1645072     6466572\nSwap:        1000444      763040      237404\n</code></pre> <p>\u91cd\u542fswap\u540e <pre><code>               total        used        free      shared  buff/cache   available\nMem:        12162380     5605800     4843176      524984     1713404     5707112\nSwap:        1000444           0     1000444\n</code></pre></p> <p>\u53ef\u89c1\uff0c\u505c\u7528swap\u540e\uff0cswap\u7684used\u5927\u90e8\u5206\u5230\u4e86mem\u7684<code>used</code>\uff0c\u5c0f\u90e8\u5206\u5230\u4e86Mem\u7684shared</p>","tags":["memory","linux"]},{"location":"blog/buffer-cache-too-high/#_1","title":"\u8c03\u4f18\u7684\u4e00\u4e9b\u6709\u6548\u5de5\u5177","text":"<p>perf + flame\u706b\u7130\u56fe: \u67e5\u770b\u8fd0\u884c\u8017\u65f6\uff0c\u53ef\u4ee5\u67e5\u770b\u51fd\u6570\u8c03\u7528\u8017\u65f6\uff0c\u5982\u679c\u662f\u81ea\u5df1\u7684\u7a0b\u5e8f\uff0c\u53ef\u4ee5\u77e5\u9053\u54ea\u4e9b\u51fd\u6570\u9700\u8981\u4f18\u5316 vmstat \u67e5\u770b\u78c1\u76d8io\u60c5\u51b5\uff0c\u4f7f\u7528<code>vmstat -t 3</code>\u547d\u4ee4\uff0c\u5982\u679cb\u72b6\u6001\u7684\u6570\u5b57\u4e00\u76f4\u5f88\u5927\uff0c\u90a3\u4e48\u8bf4\u660e\u78c1\u76d8\u963b\u585e\u4e25\u91cd\uff0c\u53ef\u80fd\u662f\u78c1\u76d8\u574f\u4e86\uff0c\u53ef\u80fd\u662f\u7a0b\u5e8f\u8bbe\u8ba1\u4e0d\u5408\u7406</p> <p>\u8fd8\u6709top\uff0ciperf\u7b49\u7b49</p>","tags":["memory","linux"]},{"location":"blog/%E8%BE%93%E5%87%BA%E7%BC%93%E5%86%B2%E5%92%8Cstdbuf/","title":"\u8d77\u56e0","text":"<p>\u9047\u5230\u8fc7\u4e00\u4e2a\u9762\u8bd5\u9898, \u4ee5\u4e0b\u7a0b\u5e8f\u6253\u5370\u51e0\u4e2a'A' <pre><code>#include &lt;stdio.h&gt;\n#include &lt;unistd.h&gt;\n\nint main() {\n  printf(\"A\");\n  fork();\n  printf(\"A\");\n}\n</code></pre> \u7b54\u6848\u662f4\u4e2a,\u800c\u4ee5\u4e0b\u662f3\u4e2a <pre><code>#include &lt;stdio.h&gt;\n#include &lt;unistd.h&gt;\n\nint main() {\n  printf(\"A\\n\");\n  fork();\n  printf(\"A\");\n}\n</code></pre> \u518d\u628a\u4e0a\u9762\u7684\u7f16\u8bd1\u540e\u7684\u53ef\u6267\u884c\u6587\u4ef6\u91cd\u5b9a\u5411\u5230\u6587\u4ef6, \u5219\u67094\u4e2a'A' <pre><code>#./a.out &gt; r.log\n#cat r.log\n</code></pre> \u539f\u56e0\u5c31\u662f\u7f13\u51b2 </p>","tags":["stdbuf","buffer","linux"]},{"location":"blog/%E8%BE%93%E5%87%BA%E7%BC%93%E5%86%B2%E5%92%8Cstdbuf/#linux","title":"Linux \u7f13\u51b2\u4ecb\u7ecd","text":"<p>\u5206\u4e3a\u65e0\u7f13\u51b2\u3001\u884c\u7f13\u51b2\u548c\u5168\u7f13\u51b2</p>","tags":["stdbuf","buffer","linux"]},{"location":"blog/%E8%BE%93%E5%87%BA%E7%BC%93%E5%86%B2%E5%92%8Cstdbuf/#_2","title":"\u6f14\u793a","text":"<p>\u53d1\u73b0\u6709\u4e9b\u7a0b\u5e8f\u53ef\u4ee5\u8f93\u51fa\u5230\u5c4f\u5e55\uff0c\u91cd\u5b9a\u5411\u5230\u6587\u4ef6\u540e\uff0c\u6267\u884c<code>ctl+c</code>\u9000\u51fa\u540e\u5374\u6ca1\u6709\u4efb\u4f55\u5185\u5bb9\uff0c\u4f8b\u5982\u4ee5\u4e0b</p> <p><pre><code>#include &lt;stdio.h&gt;\n#include &lt;unistd.h&gt;\n\nint main(void) {\n  while (1) {\n    printf(\"Hello World\\n\");\n    sleep(1);\n  }\n}\n</code></pre> \u8fd9\u4e2a\u7a0b\u5e8f\u662f\u6b7b\u5faa\u73af\u6240\u4ee5\u9700\u8981\u624b\u52a8\u7ed3\u675f\uff0c\u4e14\u4e00\u76f4\u6253\u5370helloword\u3002\u4f46\u5982\u679c\u5c06\u8f93\u51fa\u91cd\u5b9a\u5411\u5230\u6587\u4ef6\uff0c</p> <p><pre><code>#./a.out &gt; r.log\n</code></pre> \u5f53\u624b\u52a8\u9000\u51fa\u65f6\uff0c\u6587\u4ef6\u4f9d\u65e7\u662f\u7a7a\u7684</p>","tags":["stdbuf","buffer","linux"]},{"location":"blog/%E7%88%AC%E8%99%AB/","title":"\u722c\u866b","text":"<p>\u8fd9\u4e2a\u622a\u56fe\u662f\u767e\u5ea6\u7684\u722c\u866b\u722c\u53d6\u7f51\u7ad9\u7684\u8bb0\u5f55\u3002 </p> <p>\u5982\u4f55\u505a\u4e00\u4e2a\u6700\u7b80\u5355\u7684\u722c\u866b\uff1f \u4e00\u6761bash\u547d\u4ee4\u722c\u6df1\u57337\u5929\u5929\u6c14 <pre><code>#\u83b7\u53d67\u5929\u7684\u5929\u6c14\nwget -q http://www.weather.com.cn/weather/101280601.shtml -O - \\\n| grep 'class=\"wea\"\\|^&lt;h1&gt;'  | grep -o \"&gt;.*&lt;\" | sed 's/&gt;//;s/&lt;//' \\\n| awk 'ORS=NR%2==1?\" \":\"\\n\" {print}'  \n\n7\u65e5\uff08\u4eca\u5929\uff09 \u6674\n8\u65e5\uff08\u660e\u5929\uff09 \u6674\n9\u65e5\uff08\u540e\u5929\uff09 \u6674\n10\u65e5\uff08\u5468\u4e94\uff09 \u6674\n11\u65e5\uff08\u5468\u516d\uff09 \u6674\n12\u65e5\uff08\u5468\u65e5\uff09 \u6674\n13\u65e5\uff08\u5468\u4e00\uff09 \u6674\u8f6c\u5c0f\u96e8\n</code></pre></p>","tags":["webcrawler"]},{"location":"blog/%E7%88%AC%E8%99%AB/#_2","title":"\u8fd9\u6761\u547d\u4ee4\u5982\u4f55\u5199\u51fa\u6765\u7684","text":"<ol> <li>\u5b9a\u76ee\u6807\uff0c\u60f3\u597d\u8981\u722c\u4ec0\u4e48\uff0c\u5982\u722c\u6df1\u5733\u5929\u6c14</li> <li>\u5148\u5728\u6d4f\u89c8\u5668\u8bbf\u95ee\u5929\u6c14\u7f51\u7ad9\uff0c\u7f51\u5740http://www.weather.com.cn/\uff0c \u518d\u627e\u5230\u6df1\u57337\u5929\u5929\u6c14\u7684\u7f51\u9875\u94fe\u63a5\u4e3ahttp://www.weather.com.cn/weather/101280601.shtml</li> <li>\u53f3\u952e\u83dc\u5355\u91cc\u9009\u62e9\u67e5\u770b\u7f51\u9875\u6e90\u7801\uff0c\u641c\u7d22\u5929\u6c14\u7684\u5185\u5bb9\u6240\u5728\u4f4d\u7f6e</li> <li>\u627e\u89c4\u5f8b\uff1a \u65e5\u671f\u548c\u5929\u6c14\u7684\u884c\u6709\u7279\u5b9a\u8d77\u59cb\u5185\u5bb9\uff0c\u65e5\u671f\u8fd9\u884c\u4ee5<code>&lt;h1&gt;</code>\u5f00\u5934\uff0c\u5929\u6c14\u8fd9\u884c\u5305\u542b<code>class=\"wea\"</code></li> <li>\u683c\u5f0f\u5316\uff1a \u6e05\u9664\u4e0d\u8981\u7684\u5185\u5bb9\uff0c\u4f7f\u7528sed\u548cawk</li> </ol>","tags":["webcrawler"]},{"location":"blog/%E7%88%AC%E8%99%AB/#_3","title":"\u62d3\u5c55","text":"<p>\u53ea\u6709\u8fd9\u6837\u6ca1\u6709\u610f\u4e49\uff0c \u4e0d\u5982\u81ea\u5df1\u5728\u6d4f\u89c8\u5668\u4e0a\u770b\uff1f \u4f46\u5982\u679c\u4e00\u6b21\u6027\u67e5\u627e\u6b66\u6c49\u3001\u5317\u4eac\u3001\u5e7f\u5dde\u7684\u5929\u6c14\uff0c\u4f46\u7f51\u9875\u53ea\u80fd\u67e5\u5f53\u5929\u7684\uff0c\u53ea\u6709\u4fdd\u5b58\u5230\u786c\u76d8\u7684\u6570\u636e\u624d\u80fd\u6c38\u8fdc\u56de\u5934\u7ffb \u6216\u8005\u5982\u679c\u60f3\u6bcf\u5929<code>\u81ea\u52a8</code>\u6267\u884c\u4e00\u904d\u5462\uff1f \u53c8\u6216\u8005\u5982\u4f55\u81ea\u52a8\u53d1\u90ae\u4ef6\u63d0\u9192\u4f60\u5e26\u4f1e\u5462\uff1f --\u90fd\u662f\u53ef\u4ee5\u7684\uff0c \u8fd9\u9700\u8981\u66f4\u591a\u8010\u5fc3\u548c\u5b66\u4e60     </p> <p>\u4f46\u56e0\u4e3abash\u5904\u7406\u7f51\u9875\u6bd4\u8f83\u9ebb\u70e6\uff0c\u800c\u4e14\u4e5f\u4e0d\u662f\u4eca\u5929\u7684\u4e3b\u9898\u8bed\u8a00\u3002</p>","tags":["webcrawler"]},{"location":"blog/%E7%88%AC%E8%99%AB/#_4","title":"\u5173\u952e\u7ec4\u4ef6","text":"<ul> <li>python</li> <li>scapy</li> <li>Beautiful Soup</li> </ul>","tags":["webcrawler"]},{"location":"blog/%E7%88%AC%E8%99%AB/#python","title":"python","text":"<p>python\u7b80\u5355\u7075\u6d3b\u7684\u8bed\u6cd5\u53c8\u6709\u4e30\u5bcc\u7684\u751f\u6001\uff0c \u9002\u5408\u4f5c\u4e3a\u5165\u95e8\u722c\u866b\u7684\u7f16\u7a0b\u8bed\u8a00</p>","tags":["webcrawler"]},{"location":"blog/%E7%88%AC%E8%99%AB/#beautiful-soup","title":"Beautiful Soup","text":"<p>\u65e9\u671f\u4f7f\u7528python\u81ea\u5e26\u7684request\u5e93\uff0c \u5c31\u80fd\u7b80\u5355\u5730\u5b9e\u73b0\u4e00\u4e2a\u722c\u866b\u8f6f\u4ef6</p>","tags":["webcrawler"]},{"location":"blog/%E7%88%AC%E8%99%AB/#scrapy","title":"\u4e3b\u89d2scrapy","text":"<p>An open source and collaborative framework for extracting the data you need from websites. In a fast, simple, yet extensible way.</p> <p>scrapy \u662f\u4e00\u5957\u5b8c\u6574\u6846\u67b6\uff0c \u5b9e\u73b0\u4e86\u722c\u53d6\u7f51\u7ad9\u7684\u8bb8\u591a\u7ec6\u8282\u5de5\u4f5c\uff0c\u8ba9\u6211\u4eec\u4e0d\u9700\u8981\u4e86\u89e3\u4ee3\u7801\uff0c\u5c31\u80fd\u722c\u7f51\u7ad9\u3002\u5176\u5f00\u53d1\u5546\u8fd8\u63d0\u4f9b\u722c\u866b\u6258\u7ba1\u670d\u52a1\uff0c \u53ef\u4ee5\u5c06\u4f60\u7684\u722c\u866b\u505a\u6210\u5728\u7ebf\u670d\u52a1\uff0c \u800cbs\u53ea\u662f\u4e00\u4e2a\u5e93</p> <p>\u7b80\u5355\u4ecb\u7ecd * \u76ee\u5f55\u7ed3\u6784 * \u914d\u7f6e</p>","tags":["webcrawler"]},{"location":"blog/%E7%88%AC%E8%99%AB/#scrapy_1","title":"scrapy\u9009\u62e9\u5668","text":"<p>\u9009\u62e9\u5668\u7528\u6765\u6307\u5b9a\u7f51\u9875\u7684\u4f4d\u7f6e\uff0cscrapy\u652f\u6301\u7684\u9009\u62e9\u5668\u6709\u4e24\u79cd\uff1a * css * xpath</p> <p>\u81ea\u5df1\u5148\u5728\u6e90\u7801\u4e0a\u627e\u89c4\u5f8b\uff0c\u4e5f\u53ef\u4ee5\u7b80\u5355\u5730\u4f7f\u7528\u6d4f\u89c8\u5668\u63d0\u4f9b\u7684\u590d\u5236\u9009\u62e9\u5668\u529f\u80fd  </p> <p>\u5148\u624b\u52a8\u9a8c\u8bc1, \u83b7\u53d6\u5217\u8868\u7684\u6240\u6709\u8be6\u60c5\u9875\u94fe\u63a5 <pre><code>scrapy shell \"https://www.douban.com/group/search?cat=1013&amp;q=\u6df1\u5733\u79df\u623f\"  \n# xpath\u65b9\u5f0f\nresponse.xpath('//td[has-class(\"td-subject\")]//a/@href').getall()\n# css\u65b9\u5f0f\nresponse.css('td.td-subject').css('a::attr(href)').getall()\n</code></pre></p> <p>\u5148\u624b\u52a8\u9a8c\u8bc1, \u83b7\u5f97\u4e0b\u4e00\u9875 <pre><code>response.css('span.next').css('a::attr(href)').get()\n# \u63a7\u5236\u53f0-&gt;\u2018Copy CSS Selector\u2019\n# .next &gt; a:nth-child(2)\nresponse.css('.next &gt; a::attr(href)').get()\n</code></pre></p> <p>\u8be6\u7ec6</p>","tags":["webcrawler"]},{"location":"blog/%E7%88%AC%E8%99%AB/#_5","title":"\u6570\u636e\u5904\u7406","text":"<p>\u722c\u5230\u7684\u6570\u636e\u53ef\u80fd\u4e71\u548c\u91cd\u590d\uff0c \u53ef\u4ee5\u52a0\u4e2a<code>\u6e05\u6d17</code>\u7684\u6b65\u9aa4\uff0c \u5728\u722c\u5230\u6570\u636e\u540e\u5bf9\u6570\u636e\u8fc7\u6ee4\uff0c\u5220\u9664\u4e0d\u8981\u7684\u6570\u636e <pre><code># \u5220\u9664\u91cd\u590d\u6761\u76ee\nclass DuplicatesPipeline(object):\n\n    def __init__(self):\n        self.ids_seen = set()\n\n    def process_item(self, item, spider):\n        if item['title_digist'] in self.ids_seen:\n            raise DropItem(\"Duplicate item found: %s\" % item)\n        else:\n            self.ids_seen.add(item['title_digist'])\n            return item\n</code></pre></p>","tags":["webcrawler"]},{"location":"blog/%E7%88%AC%E8%99%AB/#_6","title":"\u5177\u4f53\u9879\u76ee \u722c\u8c46\u74e3\u79df\u623f","text":"","tags":["webcrawler"]},{"location":"blog/%E7%88%AC%E8%99%AB/#_7","title":"\u4f7f\u7528\u722c\u866b\u6e05\u7406\u767e\u5ea6\u641c\u7d22\u7ed3\u679c","text":"<p>\u767e\u5ea6\u641c\u7d22\u7684\u6709\u6548\u7ed3\u679c\u53ea\u5360\u5c11\u90e8\u5206\uff0c\u5176\u4ed6\u662f\u5e7f\u544a\uff0c\u89c6\u9891\u548c\u63a8\u8350\u8bcd  </p> <p>\u7528\u722c\u866b\u6765\u63d0\u53d6\u6709\u6548\u7ed3\u679c <pre><code># \u6807\u9898\nresponse.css('#content_left &gt; div.result').css('a:nth-child(1)::text').getall()\n# \u7ed3\u679c\nresponse.css('#content_left &gt; div.result').css('a:nth-child(1)::attr(href)').get()\n</code></pre></p>","tags":["webcrawler"]},{"location":"blog/%E7%88%AC%E8%99%AB/#_8","title":"\u90e8\u7f72\u6210\u5728\u7ebf\u670d\u52a1","text":"<pre><code>pip install shub\n\nshub login\nInsert your Zyte Scrapy Cloud API Key: &lt;API_KEY&gt;\n\n# Deploy the spider to Zyte Scrapy Cloud\nshub deploy\n\n# Schedule the spider for execution\nshub schedule blogspider \nSpider blogspider scheduled, watch it running here:\nhttps://app.zyte.com/p/26731/job/1/8\n\n# Retrieve the scraped data\nshub items 26731/1/8\n</code></pre>","tags":["webcrawler"]},{"location":"blog/%E7%88%AC%E8%99%AB/#_9","title":"\u5176\u4ed6\u95ee\u9898","text":"","tags":["webcrawler"]},{"location":"blog/%E7%88%AC%E8%99%AB/#_10","title":"\u767b\u5f55","text":"<p>\u4e0d\u662f\u6240\u6709\u9875\u9762\u90fd\u80fd\u50cf\u8c46\u74e3\u8fd9\u6837\u7b80\u5355\u76f4\u63a5\u8bbf\u95ee\uff0c\u6709\u7684\u9700\u8981\u767b\u9646\uff0c\u8fd9\u65f6\u9700\u8981\u8bbe\u7f6ecookie \u53ef\u5c06\u6d4f\u89c8\u5668\u7684\u8bbf\u95ee\u7684\u8bf7\u6c42\u590d\u5236\u4e3acurl\u8bf7\u6c42\uff0c\u518d\u5c06curl\u8bf7\u6c42\u8f6c\u6362\u4e3ascrapy\u8bf7\u6c42, \u6709\u5de5\u5177curl2scrapy</p> <p>\u722c\u643a\u7a0b\u673a\u7968\uff0c\u4f46\u8fd9\u6837\u53ea\u80fd\u770b\u6700\u65b0\u6216\u8005\u6700\u4fbf\u5b9c\u7684\u673a\u7968\uff0c\u65e0\u6cd5\u81ea\u52a8\u8ba2\u7968 <pre><code>curl 'https://flights.ctrip.com/international/search/api/lowprice/calendar/getCalendarDetailList?v=0.4625948281116462' -H 'User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:78.0) Gecko/20100101 Firefox/78.0' -H 'Accept: application/json' -H 'Accept-Language: zh-CN,en-US;q=0.5' --compressed -H 'Content-Type: application/json;charset=utf-8' -H 'transactionID: 0feb04e3db5648acb409a9efaf68eb99' -H 'scope: d' -H 'Cache-Control: no-cache' -H 'Origin: https://flights.ctrip.com' -H 'Connection: keep-alive' -H 'Referer: https://flights.ctrip.com/online/list/oneway-wuh0-szx?_=1&amp;depdate=2021-12-08&amp;cabin=y_s&amp;adult=1&amp;searchid=j1043107111-1628648957090-97788Tk-0&amp;containstax=1' -H 'Cookie: _bfa=1.1638949895953.3tfx42.1.1638949895953.1638949895953.1.2; _bfs=1.2; FlightIntl=Search=[%22WUH|%E6%AD%A6%E6%B1%89(%E5%A4%A9%E6%B2%B3%E5%9B%BD%E9%99%85%E6%9C%BA%E5%9C%BA)(WUH)|477|WUH|WUH|480%22%2C%22SZX|%E6%B7%B1%E5%9C%B3(SZX)|30|SZX|480%22%2C%222021-12-09%22]; _RF1=116.30.223.163; _RSG=mtaCn0GabiBpwk2uaRD22A; _RDG=28d46524d5c5f727d530fed50e21ed2094; _RGUID=bb259100-3132-4df0-a082-35b9380aeeb3; _bfaStatus=send; MKT_Pagesource=PC; _bfaStatusPVSend=1; _bfi=p1%3D10320673302%26p2%3D10320673302%26v1%3D2%26v2%3D1' -H 'Sec-GPC: 1' -H 'TE: Trailers' --data-raw '{\"cabin\":\"Y_S\",\"flightWay\":\"S\",\"flightSegmentList\":[{\"arrivalCityCode\":\"SZX\",\"departureCityCode\":\"WUH\",\"departureDate\":\"2021-12-08\"}]}'\n</code></pre></p>","tags":["webcrawler"]},{"location":"blog/%E7%88%AC%E8%99%AB/#ip","title":"\u4ee3\u7406ip","text":"<p>\u722c\u53d6\u7684\u65f6\u5019\u83ab\u540d\u5176\u5999 IP \u5c31\u88ab\u7f51\u7ad9\u5c01\u6389\u4e86\uff0c\u6bd5\u7adf\u5404\u5927\u7f51\u7ad9\u4e5f\u4e0d\u60f3\u81ea\u5df1\u7684\u6570\u636e\u88ab\u8f7b\u6613\u5730\u722c\u8d70\u3002 \u5bf9\u4e8e\u722c\u866b\u6765\u8bf4\uff0c\u4e3a\u4e86\u89e3\u51b3\u5c01\u7981 IP \u7684\u95ee\u9898\uff0c\u4e00\u4e2a\u6709\u6548\u7684\u65b9\u5f0f\u5c31\u662f\u4f7f\u7528\u4ee3\u7406\uff0c\u4f7f\u7528\u4ee3\u7406\u4e4b\u540e\u53ef\u4ee5\u8ba9\u722c\u866b\u4f2a\u88c5\u81ea\u5df1\u7684\u771f\u5b9e IP\uff0c\u5982\u679c\u4f7f\u7528\u5927\u91cf\u7684\u968f\u673a\u7684\u4ee3\u7406\u8fdb\u884c\u722c\u53d6\uff0c\u90a3\u4e48\u7f51\u7ad9\u5c31\u4e0d\u77e5\u9053\u662f\u6211\u4eec\u7684\u722c\u866b\u4e00\u76f4\u5728\u722c\u53d6\u4e86\uff0c\u8fd9\u6837\u5c31\u6709\u6548\u5730\u89e3\u51b3\u4e86\u53cd\u722c\u7684\u95ee\u9898\u3002</p> <p>\u963f\u5e03\u4e91</p>","tags":["webcrawler"]},{"location":"blog/%E7%88%AC%E8%99%AB/#useragent","title":"\u6a21\u62df\u7528\u6237\u4ee3\u7406useragent","text":"<p>User Agent\u4e2d\u6587\u540d\u4e3a\u7528\u6237\u4ee3\u7406\uff0c\u7b80\u79f0 UA\uff0c\u5b83\u662f\u4e00\u4e2a\u7279\u6b8a\u5b57\u7b26\u4e32\u5934\uff0c\u4f7f\u5f97\u670d\u52a1\u5668\u80fd\u591f\u8bc6\u522b\u5ba2\u6237\u4f7f\u7528\u7684\u64cd\u4f5c\u7cfb\u7edf\u53ca\u7248\u672c\u3001CPU \u7c7b\u578b\u3001\u6d4f\u89c8\u5668\u53ca\u7248\u672c\u3001\u6d4f\u89c8\u5668\u6e32\u67d3\u5f15\u64ce\u3001\u6d4f\u89c8\u5668\u8bed\u8a00\u3001\u6d4f\u89c8\u5668\u63d2\u4ef6\u7b49\u3002</p> <p>\u53ef\u4ee5\u4f7f\u7528\u81ea\u5df1\u6d4f\u89c8\u5668\u7684UA\uff0c\u4e5f\u53ef\u4ee5\u7528\u767e\u5ea6\u8718\u86db\u7684UA\u5217\u8868  \u4f46\u76ee\u6807\u7f51\u7ad9\u662f\u5426\u5141\u8bb8\u5c31\u96be\u8bf4\u4e86\uff0c \u9700\u8981\u591a\u8bd5\u4e00\u8bd5</p>","tags":["webcrawler"]},{"location":"blog/%E7%88%AC%E8%99%AB/#_11","title":"\u6a21\u62df\u6d4f\u89c8\u5668","text":"<p>Selenium \u662f\u4e00\u4e2a\u7528\u4e8eWeb\u5e94\u7528\u7a0b\u5e8f\u6d4b\u8bd5\u7684\u5de5\u5177\u3002Selenium\u6d4b\u8bd5\u76f4\u63a5\u8fd0\u884c\u5728\u6d4f\u89c8\u5668\u4e2d\uff0c\u5c31\u50cf\u771f\u6b63\u7684\u7528\u6237\u5728\u64cd\u4f5c\u4e00\u6837\u3002</p> <pre><code>cd \uff5e/github/SeleniumLogin\npython SeleniumLogin/core/taobao.py\n</code></pre> <pre><code>def login(self, username, password, chromedriverpath, **kwargs):\n    # \u57fa\u672c\u8bbe\u7f6e\n    browser = webdriver.Chrome(options=self.chrome_opts)\n    browser.get(self.login_url)\n    driver_wait = WebDriverWait(browser, 60)\n    # \u70b9\u51fb'\u4eb2, \u8bf7\u767b\u5f55', \u8fdb\u5165\u767b\u5f55\u754c\u9762\n    button = driver_wait.until(EC.presence_of_element_located((By.CLASS_NAME, 'h')))\n    button.click()\n    # \u8f93\u5165\u7528\u6237\u540d\u5bc6\u7801\n    username_sender = driver_wait.until(EC.presence_of_element_located((By.ID, 'fm-login-id')))\n    username_sender.send_keys(username)\n    password_sender = driver_wait.until(EC.presence_of_element_located((By.ID, 'fm-login-password')))\n    password_sender.send_keys(password)\n    time.sleep(2)\n    # \u68c0\u67e5\u662f\u5426\u51fa\u73b0\u4e86\u6ed1\u52a8\u9a8c\u8bc1\u7801\n    try:\n        slider = browser.find_element_by_xpath(\"//span[contains(@class, 'btn_slide')]\")\n        if slider.is_displayed():\n            ActionChains(browser).click_and_hold(on_element=slider).perform()\n            ActionChains(browser).move_by_offset(xoffset=258, yoffset=0).perform()\n            ActionChains(browser).pause(0.5).release().perform()\n    except:\n        pass\n    # \u70b9\u51fb\u767b\u5f55\u6309\u94ae\n    #button = driver_wait.until(EC.presence_of_element_located((By.CLASS_NAME, 'password-login')))\n    #button.click()\n    # \u8fd4\u56de\u5fc5\u8981\u7684\u6570\u636e\n    infos_return = {'username': username}\n    return infos_return, browser\n</code></pre>","tags":["webcrawler"]},{"location":"blog/%E7%88%AC%E8%99%AB/#headless","title":"headless","text":"<p>Splash HTTP API</p>","tags":["webcrawler"]},{"location":"blog/%E7%88%AC%E8%99%AB/#_12","title":"\u5f15\u7528","text":"<p>http://c.biancheng.net/view/2011.html https://github.com/CharlesPikachu/SeleniumLogin</p>","tags":["webcrawler"]},{"location":"blog/c-%E4%BF%A1%E5%8F%B7%E5%92%8C%E5%BC%82%E5%B8%B8/","title":"c++\u7684\u4fe1\u53f7\u548c\u5f02\u5e38","text":"<p>\u4fe1\u53f7\u548c\u5f02\u5e38\u90fd\u662fc++\u7a0b\u5e8f\u4f1a\u9047\u5230\u7684\uff0c\u4ee5\u524d\u5e38\u628a\u4fe1\u53f7\u4e5f\u5f53\u5f02\u5e38\u6765\u770b\u5f85\uff0c\u5f53\u5176\u5b9e\u4e24\u8005\u662f\u622a\u7136\u4e0d\u540c\u7684\u4e1c\u897f</p>","tags":["c","cpp","signal","exception"]},{"location":"blog/c-%E4%BF%A1%E5%8F%B7%E5%92%8C%E5%BC%82%E5%B8%B8/#_1","title":"\u4fe1\u53f7","text":"<p>\u4fe1\u53f7\u4e0d\u4ec5\u662f\u5bf9c++\u7a0b\u5e8f\uff0c\u800c\u662f\u5bf9\u6240\u6709linux\u7a0b\u5e8f\uff0c\u662f\u5185\u6838<code>\u5728\u8fdb\u7a0b\u7531\u5185\u6838\u6001\u8f6c\u7528\u6237\u6001</code>\u65f6\uff0c\u68c0\u67e5\u4fe1\u53f7\u69fd\u5e76\u8c03\u7528\u4fe1\u53f7\u5904\u7406\u51fd\u6570\uff08\u7528\u6237\u5b9a\u4e49\u6216\u8005\u9ed8\u8ba4\uff09\u3002 \u6709\u4e9b\u4fe1\u53f7\u53ef\u4ee5\u7531\u7a0b\u5e8f\u5904\u7406\uff08\u5e38\u89c1\u9000\u51fa\u4fe1\u53f7SIGINT\uff09\uff0c\u800c\u6709\u4e9b\u65e0\u6cd5\u5904\u7406\uff08\u5e38\u89c1\u9000\u51fa\u4fe1\u53f7SIGABT, \u6bb5\u9519\u8bef\u4fe1\u53f7SIGSEGV\uff09\uff0c\u800c\u5927\u591a\u4fe1\u53f7\u9ed8\u8ba4\u662f\u9000\u51fa\u8fdb\u7a0b\u3002</p>","tags":["c","cpp","signal","exception"]},{"location":"blog/c-%E4%BF%A1%E5%8F%B7%E5%92%8C%E5%BC%82%E5%B8%B8/#_2","title":"\u5f02\u5e38","text":"<p>c++\u7684\u5f02\u5e38\u662fc\u6240\u6ca1\u6709\u7684\uff0c\u5f02\u5e38\u4e00\u822c\u5728\u51fa\u73b0<code>\u903b\u8f91\u9519\u8bef</code>\u548c<code>\u8fd0\u884c\u65f6\u9519\u8bef</code>\u65f6\u8981\u629b\u51fa\u5f02\u5e38\uff0c\u5982\u679c\u6ca1\u6709\u5f02\u5e38\u5904\u7406\u51fd\u6570\uff0c\u5219coredump\u3002</p>","tags":["c","cpp","signal","exception"]},{"location":"blog/c-%E4%BF%A1%E5%8F%B7%E5%92%8C%E5%BC%82%E5%B8%B8/#_3","title":"\u89e6\u53d1\u65b9\u5f0f","text":"<p>\u89e6\u53d1\u4fe1\u53f7\u7528raise\uff0c\u800c\u5f02\u5e38\u7528trow  <pre><code>int raise(int sig);\n</code></pre></p>","tags":["c","cpp","signal","exception"]},{"location":"blog/%E5%B0%8F%E5%BF%83%E4%BD%BF%E7%94%A8-epoll-%E8%B4%9F%E8%BD%BD%E5%9D%87%E8%A1%A1/","title":"\u5c0f\u5fc3\u4f7f\u7528 epoll \u8d1f\u8f7d\u5747\u8861","text":"<p>\u8bb0\u5f55\u4e00\u4e2aepoll\u4f7f\u7528\u95ee\u9898\u3002\u5728\u4e00\u4e2a\u65b0\u9879\u76ee\u5199\u4e86\u4e00\u4e2a\u534f\u8bae\u8f6c\u6362\u7684\u5c0f\u529f\u80fd\u3002\u628a\u6536\u5230\u7684RTP\u5305\u5c01\u88c5\u5ba2\u6237\u7684\u5934\u518d\u8f6c\u53d1\u51fa\u53bb\uff0c\u7528\u7684epoll\u6765\u6536RTP\u3002\u5728\u516c\u53f8\u73af\u5883\u6d4b\u8bd5\u6b63\u5e38\u3002\u53ef\u662f\u5230\u4e86\u5ba2\u6237\u73b0\u573a\u51fa\u73b0\u5947\u602a\u7684\u73b0\u8c61\uff0c\u6bcf\u6b21RTP\u6d41\u53ea\u80fd\u8f6c\u53d1\u524d\u9762\u51e0\u79d2\u7684\u6d41\uff0c\u540e\u9762\u5c31\u4e0d\u8f6c\u53d1\u4e86\u3002\u5173\u95ed/\u6253\u5f00\u76d1\u542c\uff0c\u53c8\u662f\u53ea\u8f6c\u53d1\u524d\u9762\u51e0\u79d2\u3002</p>","tags":["epoll"]},{"location":"blog/%E5%B0%8F%E5%BF%83%E4%BD%BF%E7%94%A8-epoll-%E8%B4%9F%E8%BD%BD%E5%9D%87%E8%A1%A1/#_1","title":"\u89e3\u51b3","text":"<p>\u901a\u8fc7\u52a0\u65e5\u5fd7\u548c\u6253\u5370\u5806\u6808\uff0c\u786e\u5b9a\u662f\u5361\u5728\u4e86epoll_wait\u90a3\u91cc\u3002\u5373\u4f7f\u6709\u5305\u8fc7\u6765\uff0c\u4e5f\u6ca1\u6709\u5f80\u4e0b\u8d70\u3002 \u5728\u5173\u95ed\u548c\u6253\u5f00\u76d1\u542c\u65f6\uff0c\u4f1a\u6267\u884cEPOLL_CTL_DEL\u548cEPOLL_CTL_ADD\uff0c\u91cd\u65b0\u521b\u5efa\u4e86socket fd\u3002\u540e\u6765\u4fee\u6539\u4e86Epoll\u4e8b\u4ef6\u89e6\u53d1\u65b9\u5f0f\uff0c\u4ece\u8fb9\u7f18\u89e6\u53d1+\u963b\u585e\uff0c\u6539\u6210\u6c34\u5e73+\u975e\u963b\u585e\u540e\u89e3\u51b3\u3002\u5728\u53e6\u4e00\u4e2a\u9879\u76ee\uff0c\u6c34\u5e73\u89e6\u53d1+\u963b\u585e\u4e5f\u6b63\u5e38\u5de5\u4f5c\u3002\u6240\u4ee5\u6c34\u5e73\u6a21\u5f0f\u662f\u5173\u952e\u3002</p>","tags":["epoll"]},{"location":"blog/%E5%B0%8F%E5%BF%83%E4%BD%BF%E7%94%A8-epoll-%E8%B4%9F%E8%BD%BD%E5%9D%87%E8%A1%A1/#_2","title":"\u63a2\u7a76","text":"<p>\u53c2\u8003\u4e86epoll\u76f8\u5173\u5e16\u5b50\u540e\u603b\u7ed3\uff0cepoll\u8d77\u521d\u662f\u4e3a\u591a\u8def\u590d\u7528\u8bbe\u8ba1\u7684\uff0c\u800c\u4e0d\u662f\u4e3a\u4e86\u8d1f\u8f7d\u5747\u8861\uff0c\u4e5f\u5c31\u662f\u5355\u7ebf\u7a0b\u7528epoll\u662f\u6bd4\u8f83\u597d\u7684\u3002\u591a\u7ebf\u7a0b\u76d1\u542c\u540c\u4e00\u4e2aepoll fd\u65f6\uff0c\u4f1a\u51fa\u73b0\u60ca\u7fa4, \u591a\u4e2a\u7ebf\u7a0b\u7684epoll_wait\u88ab\u5524\u9192\uff0c\u8fd9\u4e0d\u4ec5\u6d6a\u8d39\u65f6\u95f4\u7247\uff0c\u800c\u4e14ET\u6a21\u5f0f\u4e0b\u53ef\u80fd\u5bfc\u81f4\u6240\u6709\u7ebf\u7a0b\u997f\u6b7b\u3002\u540e\u6765\u5185\u6838\u4f18\u5316epoll, \u52a0\u4e86EPOLLEXCLUSIVE\u548cEPOLLONESHOT\uff0c\u4f5c\u7528\u5206\u522b\u662f * EPOLLEXCLUSIVE \u53ea\u5524\u9192\u4e00\u4e2a\u7ebf\u7a0b * EPOLLONESHOT \u53ea\u63d0\u9192\u4e00\u6b21\uff0c\u5728\u5904\u7406\u5b8c\u4e8b\u4ef6\u540e\uff0c\u8c03\u7528epoll_ctl MOD\u6765\u91cd\u65b0\u542f\u7528\u65f6\u95f4\u63d0\u9192\u3002\u6ce8\u610f\u8fd9\u4e2a\u662f\u9488\u5bf9socket fd\u7684\uff0c\u53ea\u6709\u89e6\u53d1\u4e8b\u4ef6\u7684fd\u4f1a\u88ab\u963b\u6b62\u89e6\u53d1\u65b0\u4e8b\u4ef6\u3002 \u800c\u5176\u4ed6\u6dfb\u52a0\u5230epoll fd\u7684socket fd\u4e0d\u53d7\u5f71\u54cd\u3002</p>","tags":["epoll"]},{"location":"blog/%E5%B0%8F%E5%BF%83%E4%BD%BF%E7%94%A8-epoll-%E8%B4%9F%E8%BD%BD%E5%9D%87%E8%A1%A1/#accept","title":"accept \u6269\u5bb9","text":"<p>\u4f46\u662f\u8fd9\u4e24\u4e2a\u65b0\u6807\u5fd7\u5bfc\u81f4\u6c38\u8fdc\u53ea\u6709\u4e00\u4e2a\u7ebf\u7a0b\u8c03\u7528accept, \u6240\u4ee5\u6548\u7387\u4f4e\u3002 \u4e0d\u8fc7accept\u4e5f\u6709\u65b0\u6807\u5fd7SO_REUSEPORT\uff0c\u53ef\u4ee5\u521b\u5efa\u591a\u4e2asocket fd, \u8fd9\u6837\u5c31\u80fd\u6dfb\u52a0\u591a\u4e2alisten fd\u5230epoll fd\u91cc\u3002\u5373\u4f7f\u4e00\u4e2alisten fd\u88ab\u5c4f\u853d\u89e6\u4e8b\u4ef6\uff0c\u5176\u4ed6\u7ebf\u7a0b\u4e5f\u80fd\u6536\u5230\u4e8b\u4ef6\u5e76\u5904\u7406\u8fde\u63a5\u3002</p>","tags":["epoll"]},{"location":"blog/%E5%B0%8F%E5%BF%83%E4%BD%BF%E7%94%A8-epoll-%E8%B4%9F%E8%BD%BD%E5%9D%87%E8%A1%A1/#read","title":"read \u6269\u5bb9","text":"<p>\u8fd9\u4e2a\u6536\u94f6\u5458\u7684\u4f8b\u5b50\u7684\u5f88\u6709\u610f\u601dyoutube\uff0c\u8d85\u5e02\u7684\u6536\u94f6\u53f0\u7684\u5ba2\u6237\u6392\u5728\u4e0d\u540c\u961f\u5217\uff0c\u4e00\u65e6\u961f\u5217\u7b2c\u4e00\u4e2a\u4eba\u4e1c\u897f\u5f88\u591a\uff0c\u90a3\u8fd9\u4e2a\u961f\u5217\u540e\u9762\u7684\u4eba\u90fd\u8981\u7b49\u3002\u800c\u533b\u9662\u4eba\u5de5\u6302\u53f7\uff0c\u94f6\u884c\u53eb\u53f7\u7cfb\u7edf\uff0c\u6240\u6709\u4eba\u4e00\u4e2a\u961f\u5217\uff0c\u5373\u4f7f\u4e00\u4e2a\u4eba\u5361\u4f4f\u4e86\uff0c\u5176\u4ed6\u7a97\u53e3\u8fd8\u80fd\u7ee7\u7eed\u5de5\u4f5c\u3002\u4f5c\u4e3a\u6d88\u8d39\u8005\uff0c\u8c01\u90fd\u4e0d\u613f\u610f\u88ab\u5361\u4f4f\uff0c\u4f46\u8d85\u5e02\u8bbe\u7f6e\u591a\u961f\u5217\u65f6\uff0c\u6bd4\u5982N\u4e2a\u961f\u5217\uff0c\u800c\u81ea\u5df1\u53ea\u80fd\u9009\u62e9\u4e00\u4e2a\uff0c\u90a3\u4e48\u5927\u6982\u7387\u81ea\u5df1\u4f1a\u89c9\u5f97\u6bd4\u522b\u4eba\u6162\uff0c\u56e0\u4e3a\u6bd4\u522b\u4eba\u5feb\u7684\u51e0\u7387\u53ea\u67091/N\u3002  </p> <p>\u800c\u5904\u7406\u7f51\u7edc\u4efb\u52a1\u65f6\uff0c\u5982\u679c\u6bcf\u4e2a\u7ebf\u7a0b\u53ea\u670d\u52a1\u4e00\u4e2a\u8fde\u63a5\u6216\u8005\u56fa\u5b9a\u7684\u51e0\u4e2a\u8fde\u63a5\u65f6\uff08\u8d85\u5e02\u6392\u961f\uff09\uff0c \u4e00\u65e6\u67d0\u4e2a\u7ebf\u7a0b\u5361\u4f4f\uff0c\u5219\u8fd9\u4e2a\u7ebf\u7a0b\u8d1f\u8d23\u7684\u6240\u6709\u8fde\u63a5\u90fd\u4f1a\u5361\u4f4f\u3002\u5176\u4ed6\u7ebf\u7a0b\u5373\u4f7f\u5f88\u95f2\u4e5f\u5e2e\u4e0d\u4e0a\u5fd9\uff0c\u56e0\u6b64\u63d0\u9ad8IO\u541e\u5410\u91cf\u7684\u6700\u597d\u7684\u65b9\u5f0f\u662f\u5c06\u6240\u6709\u8fde\u63a5\u5408\u5e76\u6210\u4e00\u4e2a\u961f\u5217\uff08\u94f6\u884c\u53eb\u53f7\uff09\u3002 \u5373Epoll\u53ea\u8d1f\u8d23\u5c06\u6240\u6709\u4e8b\u4ef6\u6dfb\u52a0\u5230\u4e00\u4e2a\u961f\u5217\uff0c\u5de5\u4f5c\u7ebf\u7a0b\u8d1f\u8d23\u603b\u961f\u5217\u91cc\u53d6\u51fa\u4e8b\u4ef6\uff0c\u5e76\u5904\u7406\u3002</p> <p>\u90a3\u8bfb\u4e00\u6b21\u8fd8\u662f\u8bfb\u5b8c\uff1f\u6c34\u5e73\u89e6\u53d1\u53ef\u4ee5\u53ea\u8bfb\u4e00\u6b21\uff0c\u4f46\u52a0\u4e86EPOLLONESHOT\u65f6\uff0c\u6700\u597d\u8bfb\u5b8c\u3002\u53e6\u5916ET\u6a21\u5f0f\u5fc5\u987b\u8981\u8bfb\u5b8c\u3002</p> <p>\u6ce8\u610f\u8fd9\u91cc\u8ba8\u8bba\u7684TCP\uff0cUDP\u5c31\u66f4\u7b80\u5355\u4e9b\u3002</p>","tags":["epoll"]},{"location":"blog/%E5%B0%8F%E5%BF%83%E4%BD%BF%E7%94%A8-epoll-%E8%B4%9F%E8%BD%BD%E5%9D%87%E8%A1%A1/#reference","title":"Reference","text":"<p>https://idea.popcount.org/2017-02-20-epoll-is-fundamentally-broken-12/</p>","tags":["epoll"]},{"location":"blog/%E8%BF%9B%E4%BD%8D%E4%BD%8D%E5%92%8C%E6%BA%A2%E5%87%BA%E4%BD%8Dcarry-bitoverflow-bit/","title":"\u8fdb\u4f4d\u4f4d\u548c\u6ea2\u51fa\u4f4d(carry bit/overflow bit)","text":"<p>\u8fd9\u4e24\u4e2a\u6807\u5fd7\u4f4d\u662f\u8fd0\u7b97\u5668(alu)\u7684\u7ec4\u6210\u90e8\u5206\uff0c\u56e0\u4e3a\u8fd0\u7b97\u5668\u5728\u6267\u884c\u52a0\u6cd5\u65f6\uff0c\u8981\u5173\u6ce8\u4e24\u4e2a\u95ee\u9898\uff1a\u662f\u5426\u8fdb\u4f4d\u8d85\u4e86\uff1b\u662f\u5426\u6ea2\u51fa\u4e86\u3002\u8fd9\u4e24\u4e2a\u95ee\u9898\u5f88\u76f8\u4f3c\uff0c\u4f46\u6709\u533a\u522b\u3002</p>","tags":["c"]},{"location":"blog/%E8%BF%9B%E4%BD%8D%E4%BD%8D%E5%92%8C%E6%BA%A2%E5%87%BA%E4%BD%8Dcarry-bitoverflow-bit/#_1","title":"\u52a0\u6cd5\u548c\u51cf\u6cd5","text":"<p>\u5bf9\u4e8e\u51cf\u6cd5\u800c\u8a00\uff0c\u5b9e\u9645\u662f\u5c06\u51cf\u6570\u7ffb\u8f6c\uff0c\u7136\u540e\u6267\u884c\u52a0\u6cd5\u3002\u5373\uff1a <pre><code>1 - 1 = 1 + (-1)\n</code></pre></p> <p>\u8fd0\u7b97\u5668\u505a\u51cf\u6cd5\u65f6\u8981\u6bd4\u8f83\u4e24\u6570\u7684\u7edd\u5bf9\u503c\u5927\u5c0f\u518d\u8fdb\u884c\u51cf\u6cd5\uff0c\u7b26\u53f7\u8bbe\u7f6e\u6210\u5927\u7684\u6570\u7684\u7b26\u53f7\uff0c\u4f8b\u5982 <pre><code>2 - 1 =&gt; 2 - 1 = 1 =&gt; \u7b26\u53f7\u4f4d\u8bbe\u7f6e\u62102\u7684\u7b26\u53f7\u4f4d\n1 - 2 =&gt; 2 - 1 = 1 =&gt; \u7b26\u53f7\u4f4d\u8bbe\u7f6e\u62101\u7684\u7b26\u53f7\u4f4d\n</code></pre></p> <p>\u6570\u5b57\u5728\u5185\u5b58\u4e2d\u5b58\u653e\u7684\u662f\u201c\u8865\u7801\u201d\u5f62\u5f0f\uff0c\u8865\u7801\u5f88\u591a\u597d\u5904\uff0c\u5bf9\u4e8e\u6b63\u6570\u800c\u8a00\uff0c\u6e90\u7801\u3001\u53cd\u7801\u3001\u8865\u7801\u7684\u4e8c\u8fdb\u5236\u5f62\u5f0f\u76f8\u540c\u3002\u8865\u7801\u7edf\u4e00\u4e86+0\u548c-0\u7684\u5f62\u5f0f\uff0c\u800c\u4e14\u8865\u7801\u9002\u5408\u505a\u51cf\u6cd5\u8fd0\u7b97\u3002 <pre><code>+0/-0\n\u539f\u7801: 0000 0000/ 1000 0000\n\u53cd\u7801: 0000 0000/ 1111 1111 \u6b63\u6570\u4e0d\u53d8\uff0c\u8d1f\u6570\u7684\u7b26\u53f7\u4f4d\u4e0d\u53d8\uff0c\u5176\u5b83\u4f4d\u53d6\u53cd\n\u8865\u7801: 0000 0000/10000 0000 \u6b63\u6570\u4e0d\u53d8\uff0c\u8d1f\u6570\u5148\u8f6c\u53cd\u7801\u518d\u52a01\uff0c\u8fdb\u4f4d\u4f4d\u4e22\u6389\u540e\u76f8\u540c\n</code></pre></p>","tags":["c"]},{"location":"blog/%E8%BF%9B%E4%BD%8D%E4%BD%8D%E5%92%8C%E6%BA%A2%E5%87%BA%E4%BD%8Dcarry-bitoverflow-bit/#_2","title":"\u8fdb\u4f4d\u6807\u5fd7\u4f4d","text":"<p>\u8fdb\u4f4d\u4f4d\u7528\u6765\u6807\u5fd7\u4e24\u6570\u76f8\u52a0\u4ea7\u751f\u7684\u8fdb\u4f4d\u8d85\u8fc7\u4e86\u4f4d\u6570\uff0c\u4f8b\u5982 1+1 = 10\uff0c\u8981\u591a\u4e00\u4f4d\uff0c\u5982\u679c\u8fd0\u7b97\u5668\u662f8\u4f4d\u7684\uff0c\u6267\u884c 11111111+1\u7684\u8fd0\u7b97\uff0c\u5c31\u8981\u8fdb\u4f4d\uff0c\u4e14\u8d85\u8fc7\u4e86\u4f4d\u6570\uff0c\u8fd9\u65f6\u5019\u8fdb\u4f4d\u4f4d\u5c31\u4f1a\u7f6e1\u3002</p> <p>\u5224\u65ad\u65b9\u6cd5 Carry = (Result &gt;&gt; n) &amp; 1</p>","tags":["c"]},{"location":"blog/%E8%BF%9B%E4%BD%8D%E4%BD%8D%E5%92%8C%E6%BA%A2%E5%87%BA%E4%BD%8Dcarry-bitoverflow-bit/#_3","title":"\u6ea2\u51fa\u6807\u5fd7\u4f4d","text":"<p>\u6ea2\u51fa\u4f4d\u53ea\u9488\u5bf9\u6709\u7b26\u53f7\u6570\u7684\u8fd0\u7b97\uff0c\u6709\u7b26\u53f7\u6570\u7684\u7b2c\u4e00\u4f4d\u8868\u793a\u6b63\u8d1f\uff0c0\u4ee3\u8868\u6b63\uff0c1\u4ee3\u8868\u8d1f\uff0c\u5176\u5b83\u4f4d\u8868\u793a\u503c\u3002\u5f53\u503c\u7684\u90e8\u5206\u60f3\u52a0\u4ea7\u751f\u8fdb\u4f4d\u65f6\uff0c\u5bfc\u81f4\u7b26\u53f7\u4f4d\u8986\u76d6\u3002</p> <p>\u5224\u65ad\u65b9\u6cd5\uff08\u5c318\u4f4d\u800c\u8a00\uff09 Overflow = (Result [7bit] XOR Op1[7bit] XOR Op2[7bit])</p> <p>\u6ea2\u51fa\u4f4d\u7f6e1\u65f6\uff0c\u867d\u7136\u7b26\u53f7\u4e3a\u4e0d\u6b63\u786e\uff0c\u4f46\u5176\u503c\u662f\u6b63\u786e\u7684\uff08\u5305\u542b\u7b26\u53f7\u4f4d\uff09\u3002</p>","tags":["c"]},{"location":"blog/%E8%BF%9B%E4%BD%8D%E4%BD%8D%E5%92%8C%E6%BA%A2%E5%87%BA%E4%BD%8Dcarry-bitoverflow-bit/#_4","title":"\u53c2\u8003","text":"<p>\u6e90\u7801/\u53cd\u7801/\u8865\u7801 \u8fdb\u4f4d\u4f4d/\u6ea2\u51fa\u4f4d</p>","tags":["c"]},{"location":"blog/change-hostname-of-pve-and-vm/","title":"change hostname of pve and vm","text":"<p>\u4ee5\u524d\u603b\u4e0d\u660e\u767d\uff0c\u521b\u5efa\u865a\u62df\u673a\u65f6\u586b\u5199\u7684\u57df\u540d example.com \u7684\u4f5c\u7528\uff0c\u76f4\u5230\u81ea\u5df1\u7528pve\u521b\u5efa\u4e86\u591a\u4e2a\u865a\u62df\u673a\uff0c</p>","tags":["pve"]},{"location":"blog/change-hostname-of-pve-and-vm/#change-domain-of-pve","title":"change domain of pve","text":"<p>\u4e00\u5f00\u59cb\u6211\u76f4\u63a5\u5728\u7cfb\u7edf\u91cc\u7528hostnamectl\u6765\u4fee\u6539\uff0c\u7136\u540e\u53d1\u73b0\u6267\u884cpct\u547d\u4ee4\u65f6\uff0c\u62a5\u9519\u6ca1\u6709\u865a\u62df\u673a\u7684\u914d\u7f6e\u6587\u4ef6\uff0c\u539f\u6765pct\u7528hostname\u6765\u9694\u79bb\u914d\u7f6e <pre><code>$ pct set 110 --hostname docker.pve                                                        \nConfiguration file 'nodes/NEW_HOSTNAME/lxc/110.conf' does not exist\n</code></pre> \u770b\u5b98\u65b9\u7684\u6587\u6863, \u6b63\u786e\u7684\u65b9\u6cd5\u8981\u6539\u597d\u51e0\u4e2a\u6587\u4ef6\uff0c\u4e8e\u662f\u91cd\u65b0\u6539\u56de\u53bb\u4e86\u3002</p>","tags":["pve"]},{"location":"blog/change-hostname-of-pve-and-vm/#change-domain-of-lxc","title":"change domain of lxc","text":"<p>\u8fd9\u4e2a\u5f00\u59cb\u5728\u865a\u62df\u673a\u91cc\u6539\uff0c\u540e\u6765\u77e5\u9053\u6b63\u786e\u65b9\u6cd5\u662f\u7528pct\u5de5\u5177 <pre><code>pct set ID --hostname NEW_HOSTNAME\n</code></pre></p>","tags":["pve"]},{"location":"blog/change-hostname-of-pve-and-vm/#_1","title":"\u53c2\u8003","text":"<p>https://virtualizeeverything.com/2021/11/12/how-to-change-the-hostname-of-a-lxc-using-command-line-proxmox-7/</p>","tags":["pve"]},{"location":"blog/cmake-learning/","title":"cmake \u5b66\u4e60","text":"","tags":["cmake"]},{"location":"blog/cmake-learning/#add_custom_command","title":"add_custom_command \u7528\u6cd5","text":"<p>\u7528\u6765\u5b9a\u4e49\u81ea\u5b9a\u4e49\u7684\u65b9\u6cd5, \u800c\u4e14\u67092\u5957\u7b7e\u540d\u6216\u8005\u8bf4\u89e6\u53d1\u89c4\u5219 </p>","tags":["cmake"]},{"location":"blog/cmake-learning/#add_custom_target","title":"\u4e0e <code>add_custom_target</code> \u914d\u5408\u4f7f\u7528, \u7528\u4e8e\u751f\u6210\u6587\u4ef6","text":"<p>\u8fd9\u79cd\u60c5\u51b5\u4e0b\uff0c<code>add_custom_target</code> \u7eed\u8981\u5728<code>add_custom_command</code>\u4e4b\u540e\u51fa\u73b0\u3002 \u8bed\u6cd5 <pre><code>add_custom_command(OUTPUT output1 [output2 ...]\n                   COMMAND command1 [ARGS] [args1...]\n                   [COMMAND command2 [ARGS] [args2...] ...]\n                   [MAIN_DEPENDENCY depend]\n                   [DEPENDS [depends...]]\n                   [BYPRODUCTS [files...]]\n                   [IMPLICIT_DEPENDS &lt;lang1&gt; depend1\n                                    [&lt;lang2&gt; depend2] ...]\n                   [WORKING_DIRECTORY dir]\n                   [COMMENT comment]\n                   [DEPFILE depfile]\n                   [JOB_POOL job_pool]\n                   [VERBATIM] [APPEND] [USES_TERMINAL]\n                   [COMMAND_EXPAND_LISTS])\n</code></pre></p> <p>\u7c7b\u4f3cmake\u7684\u8bed\u6cd5\u89c4\u5219 <pre><code>target:dependency\n  command\n</code></pre> \u5982\u679c<code>dependency</code>\u4e0d\u5b58\u5728\uff0c\u5c31\u53bb\u627e\u751f\u6210\u4f9d\u8d56\u672c\u8eab\u7684\u89c4\u5219\uff0c\u6ca1\u6709\u4e5f\u751f\u6210\u4f9d\u8d56\u7684\u89c4\u5219\uff0c\u90a3\u4e48make\u4f1a\u505c\u6b62\u3002 </p> <p>\u5982\u4e0b\u7684\u4f8b\u5b50 <pre><code> cmake_minimum_required(VERSION 3.5)\n project(test)\n add_executable(${PROJECT_NAME} main.c)\n add_custom_command(OUTPUT printout \n                    COMMAND ${CMAKE_COMMAND} -E echo compile finish\n                    VERBATIM\n                   )\n add_custom_target(finish\n                   DEPENDS printout\n                   )\n</code></pre></p> <p>finish \u4f9d\u8d56 printout, \u800c<code>add_custom_command</code>\u5b9a\u4e49\u4e86printout\u7684\u89c4\u5219\uff0cprintout\u5373\u4e3a\u4e0b\u9762\u7684command\u6267\u884c\u7684\u8f93\u51fa   </p> <p>\u6240\u4ee5\u5f53\u751f\u6210finish\u76ee\u6807\u7684\u65f6\u5019\u4f1a\u89e6\u53d1\u4e0a\u9762\u7684<code>add_custom_command</code> </p> <p>\u5176\u5b9e\u8fd9\u79cd\u60c5\u51b5\u4e0b\uff0c \u76f4\u63a5\u5c06<code>add_custome_command</code>\u7684command\u5199\u5230<code>add_custome_target</code>\u4e2d\u4e5f\u662f\u4e00\u6837\u7684\u6548\u679c</p>","tags":["cmake"]},{"location":"blog/cmake-learning/#command-line-tool","title":"command-line-tool","text":"<p>\u4ee5\u4e0a<code>add_cunstom_command</code>\u7684\u4e24\u79cd\u7528\u6cd5\u90fd\u4f7f\u7528\u4e86<code>COMMAND ${CMAKE_COMMAND} -E</code>\uff0c\u8fd9\u662f\u4f7f\u7528\u4e86cmake\u5185\u7f6e\u7684[\u547d\u4ee4]{https://cmake.org/cmake/help/latest/manual/cmake.1.html#run-a-command-line-tool}    </p>","tags":["cmake"]},{"location":"blog/cmake-learning/#_1","title":"\u8fd0\u7528","text":"<p>\u4f8b\u5982\u751f\u6210protobuf\u7684\u6587\u4ef6, \u9700\u8981\u81ea\u5b9a\u4e49\u65b9\u6cd5</p> <pre><code>    # output files:\n    FOREACH (src ${proto_srcs})\n        get_filename_component(base_name ${src} NAME_WE)\n        get_filename_component(path_name ${src} PATH)\n\n        set(src \"${base_name}.proto\")\n        set(cpp \"${base_name}.pb.cc\")\n        set(hpp \"${base_name}.pb.h\")\n        set(grpc_cpp \"${base_name}.grpc.pb.cc\")\n        set(grpc_hpp \"${base_name}.grpc.pb.h\")\n\n        # custom command.\n        add_custom_command(\n            OUTPUT ${proto_cpp_dist}/${cpp} ${proto_cpp_dist}/${hpp} ${proto_hpp_dist}/${hpp}\n              ${proto_cpp_dist}/${grpc_cpp} ${proto_cpp_dist}/${grpc_hpp}\n            COMMAND ${PROTOBUF_PROTOC_EXECUTABLE}\n            ARGS ${OUTPUT_PATH}\n              --grpc_out ${proto_cpp_dist}\n              --plugin=protoc-gen-grpc=${GRPC_CPP_PLUGIN}\n              ${src} \n            DEPENDS ${src}\n            COMMAND ${CMAKE_COMMAND}\n            ARGS -E copy_if_different ${proto_cpp_dist}/${hpp} ${proto_hpp_dist}/${hpp}\n            COMMAND ${CMAKE_COMMAND}\n            ARGS -E copy_if_different  ${proto_cpp_dist}/${grpc_hpp} ${proto_hpp_dist}/${grpc_hpp}\n            WORKING_DIRECTORY ${path_name}\n            COMMENT \"${PROTOBUF_PROTOC_EXECUTABLE} --cpp_out=${proto_cpp_dist} ${src}\"\n            )\n\n        LIST(APPEND output ${proto_cpp_dist}/${cpp})\n    ENDFOREACH()\n</code></pre>","tags":["cmake"]},{"location":"blog/cmake-learning/#_2","title":"\u5355\u72ec\u4f7f\u7528, \u7f16\u8bd1\u89e6\u53d1","text":"<p>\u8fd9\u4e2a\u662f\u5f53\u9879\u76ee\u4e2d\u6709<code>add_library</code>\u6216\u8005<code>add_excutable</code>\u76ee\u6807\u65f6\u53ef\u4ee5\u5728\u7f16\u8bd1\u76ee\u6807\u6587\u4ef6\u524d/\u94fe\u63a5\u524d/\u7f16\u8bd1\u540e\u89e6\u53d1 <pre><code>add_custom_command(TARGET &lt;target&gt;\n                   PRE_BUILD | PRE_LINK | POST_BUILD\n                   COMMAND command1 [ARGS] [args1...]\n                   [COMMAND command2 [ARGS] [args2...] ...]\n                   [BYPRODUCTS [files...]]\n                   [WORKING_DIRECTORY dir]\n                   [COMMENT comment]\n                   [VERBATIM] [USES_TERMINAL]\n                   [COMMAND_EXPAND_LISTS])\n</code></pre></p>","tags":["cmake"]},{"location":"blog/cmake-learning/#cmake_1","title":"cmake \u903b\u8f91\u8868\u8fbe\u5f0f","text":"","tags":["cmake"]},{"location":"blog/cmake-precompile-header/","title":"cmake\u9884\u5904\u7406\u5934\u6587\u4ef6","text":"<p>\u9884\u5904\u7406\u5934\u6587\u4ef6\u662fcmake 3.16\u6dfb\u52a0\u7684\u65b0\u529f\u80fd\uff0c\u53ef\u4ee5\u5c06\u5934\u6587\u4ef6\u5148</p> <pre><code>Precompiling header files can speed up compilation by creating a partially processed version of some header files, and then using that version during compilations rather than repeatedly parsing the original headers.\n</code></pre>","tags":["cmake"]},{"location":"blog/%E4%B8%BApve%E9%85%8D%E7%BD%AEdns/","title":"\u4e3apve\u914d\u7f6edns","text":"<p>\u6211\u7528\u95f2\u6687\u53f0\u5f0f\u673a\u5b89\u88c5\u4e86pve, \u521b\u4e86\u4e00\u4e9b\u865a\u62df\u673a\u548clxc\u5bb9\u5668\u6765\u8dd1\u672c\u5730\u90e8\u7f72\u7684\u5e94\u7528\uff0c\u4f8b\u5982\u4ee3\u7801\u7ba1\u7406\u7684gitea, web\u5e94\u7528\uff0cnginx\u53cd\u5411\u4ee3\u7406\u7b49\u3002 \u53cd\u5411\u4ee3\u7406\u5bb9\u5668\u8981\u8bbf\u95ee\u5176\u4ed6\u5bb9\u5668\uff0c\u4e5f\u8981\u4ece\u5916\u90e8\u8bbf\u95ee\u5bb9\u5668\uff0c\u4f8b\u5982\u6211\u7684\u7b14\u8bb0\u672c\u3002 \u6b63\u597d\u6700\u8fd1\u5de5\u4f5c\u9047\u5230\u4e9bdns\u7684\u95ee\u9898\uff0c\u4e8e\u662f\u60f3\u81ea\u5df1\u642d\u5efa\u4e00\u4e2adns\u670d\u52a1\u5668\u3002\u7528\u6765\u5b9e\u73b0\u4ece\u5916\u9762\uff0c\u4ece\u5bb9\u5668\u90fd\u80fd\u901a\u8fc7\u57df\u540d\u6765\u8bbf\u95ee\u3002\u5c31\u5982\u540cdocker compose \u91cc\u80fd\u901a\u8fc7\u5bb9\u5668\u540d\u79f0\u6765\u8bbf\u95ee\u5176\u4ed6\u5bb9\u5668\u4e00\u6837\u3002\u53cd\u4ee3nginx\u53ef\u4ee5\u7528frp\u7b49\u6280\u672f\u5b9e\u73b0\u516c\u7f51\u8bbf\u95ee\u3002</p>","tags":["pve","dns"]},{"location":"blog/%E4%B8%BApve%E9%85%8D%E7%BD%AEdns/#_1","title":"\u5b9e\u73b0\u6548\u679c","text":"<p>\u5728\u7b14\u8bb0\u672c\u4e0a\u80fd\u8bbf\u95ee gitea.pve\uff0c \u5728nginx\u53cd\u4ee3\u5bb9\u5668\u91cc\u4e5f\u80fd\u8bbf\u95ee gitea.pve\uff0c\u4f46\u662f\u524d\u8005\u5f97\u523010\u5730\u5740\uff0c\u540e\u8005\u5f97\u5230192\u5730\u5740\u3002</p>","tags":["pve","dns"]},{"location":"blog/%E4%B8%BApve%E9%85%8D%E7%BD%AEdns/#_2","title":"\u7f51\u7edc\u89c4\u5212","text":"<p>pve\u5728\u5b89\u88c5\u4e86\u81ea\u52a8\u521b\u5efa\u4e86\u7f51\u6865\uff0c\u6865\u63a5\u7269\u7406\u7f51\u5361\uff0c\u7f51\u7edc10.8.10.0/24\uff0c\u5916\u9762\u53ef\u4ee5\u76f4\u63a5\u8bbf\u95ee\u3002\u540e\u6211\u81ea\u5df1\u521b\u5efa\u4e86\u865a\u62df\u7f51\u7edc 192.168.10.1/24\u3002\u4e8e\u662f\u6bcf\u4e2a\u5bb9\u5668\u548c\u865a\u62df\u673a\u90fd\u6709\u4e24\u4e2a\u5730\u5740\uff0c\u6211\u79f0\u4e4b\u5916\u90e8\u5730\u5740\u548c\u5185\u90e8\u5730\u5740\u3002 pve \u521b\u5efa\u7f51\u7edc\u4f4d\u7f6e\u5728 Datacenter-&gt; pve -&gt; system -&gt; network</p>","tags":["pve","dns"]},{"location":"blog/%E4%B8%BApve%E9%85%8D%E7%BD%AEdns/#bind9","title":"\u5bbf\u4e3b\u673a\u5668\u4e0a\u5b89\u88c5bind9\u548c\u914d\u7f6e","text":"<p>\u5728AI\u7684\u5e2e\u52a9\u4e0b\uff0c\u4e86\u89e3\u4e86bind9\u7684view\u4e13\u95e8\u7528\u6765\u5b8c\u6210\u8fd9\u6837\u7684\u4e8b\u60c5\u3002\u5148\u4fee\u6539\u6587\u4ef6 /etc/bind/named.conf.default-zones, \u5c06\u539f\u6765\u7684\u90e8\u5206\u5957\u4e0a 'external view'\uff0c\u7136\u540e\u52a0\u4e0a\u81ea\u5b9a\u4e49\u6839\u57df\u540d'pve'</p> <pre><code>+view \"external\" {   \n// prime the server with knowledge of the root servers\nzone \".\" {\n        type hint;\n        file \"/usr/share/dns/root.hints\";\n};\n\n...\n\n+zone \"pve\" {\n+        type master;\n+        file \"/etc/bind/db.pve.external\";\n+};\n\n+};\n</code></pre> <p>\u4fee\u6539\u6587\u4ef6 /etc/bind/named.conf.local\uff0c\u539f\u672c\u8fd9\u6587\u4ef6\u662f\u7a7a\u7684\uff0c\u73b0\u5728\u6dfb\u52a0 'internal view'</p> <pre><code>//\n// Do any local configuration here\n//\n\n// Consider adding the 1918 zones here, if they are not used in your\n// organization\n//include \"/etc/bind/zones.rfc1918\";\n\n+acl \"internal-nets\" {\n+    192.168.10.0/24;    // VM subnet\n+    127.0.0.1;          // localhost\n+};\n+\n+view \"internal\" {\n+    match-clients { internal-nets; };\n+\n+    zone \"pve\" {\n+        type master;\n+        file \"/etc/bind/db.pve.internal\";\n+    };\n};\n</code></pre> <p>\u7136\u540e\u5728/etc/bind/db.pve.external \u4e2d\u6dfb\u52a0\u57df\u540d\u8bb0\u5f55\uff0cip\u662f\u5916\u90e8\u5730\u5740\uff0c \u5728/etc/bind/db.pve.internal\u6dfb\u52a0\u57df\u540d\u8bb0\u5f55\uff0cip\u662f\u5185\u90e8\u5730\u5740, \u5185\u5bb9\u5982\u4e0b <pre><code>$TTL 86400\n@   IN  SOA ns1.pve. admin.pve. (\n        2025082701 3600 1800 1209600 86400 )\n    IN  NS  ns1.pve.\n\nns1      IN A 192.168.10.1\npve      IN A 192.168.10.1\ndocker   IN A 192.168.10.101\nfrp      IN A 192.168.10.102\ngitea    IN A 192.168.10.103\n</code></pre></p> <p>\u7136\u540e\u68c0\u67e5\u914d\u7f6e\u548c\u66f4\u65b0\u914d\u7f6e <pre><code>rndc reconfig pve\nrndc reload\n</code></pre></p> <p>\u6ce8\u610f\uff1a AI\u8bf4\u4fee\u6539\u4e86\u57df\u540d\u8bb0\u5f55\uff0c\u8981\u589e\u52a0SOA\u53f7\uff0c\u4f8b\u5982 2025082701 -&gt; 2025082702</p>","tags":["pve","dns"]},{"location":"blog/%E4%B8%BApve%E9%85%8D%E7%BD%AEdns/#dig","title":"dig \u9a8c\u8bc1","text":"<ul> <li>\u5728\u7b14\u8bb0\u672c\u4e2ddig @pve\u7684ip \u67e5\u8be2\u5bb9\u5668ip</li> <li>\u5728pve\u91ccdig @192.168.10.1 \u67e5\u8be2\u5bb9\u5668\u7684ip</li> </ul>","tags":["pve","dns"]},{"location":"blog/%E4%B8%BApve%E9%85%8D%E7%BD%AEdns/#dns","title":"\u5916\u90e8\u914d\u5408\u4fee\u6539dns\u670d\u52a1\u5668","text":"<p>\u4e0a\u9762dig\u547d\u4ee4\u6307\u5b9a\u4e86dns\u670d\u52a1\u5668\u7684ip, \u4e3a\u4e86\u8ba9\u7cfb\u7edf\u81ea\u52a8\u9009\u62e9pve\u4e0a\u7684dns\u670d\u52a1\u5668\u6765\u89e3\u6790 *.pve \u57df\u540d\uff0c\u8981\u4fee\u6539\u7b14\u8bb0\u672c\u914d\u7f6e\uff0c\u4f7f\u7528\u7684NetworkManager <pre><code>nmcli connection modify WIFI_CONNECTION ipv4.dns-search \"~pve\" \nnmcli connection modify MI-MINI_5G_D300 ipv4.dns 10.8.10.77\nnmcli connection modify MI-MINI_5G_D300 ipv4.dns-priority -1 \n</code></pre></p> <p>\u800c\u6211\u7528\u4e86\u6709\u4ee5\u592a\u7f51\u548cwifi\u4e24\u4e2a\u7f51\u7edc\uff0c\u6211\u53ea\u4fee\u6539\u4e86wlp5s0\u3002\u901a\u8fc7\u524d\u540e resolvectl status \u5bf9\u6bd4\uff0c\u533a\u522b\u5982\u4e0b</p> <pre><code>Link 3 (wlp5s0)\n-    Current Scopes: LLMNR/IPv4 LLMNR/IPv6 mDNS/IPv4 mDNS/IPv6\n+    Current Scopes: DNS LLMNR/IPv4 LLMNR/IPv6 mDNS/IPv4 mDNS/IPv6\n         Protocols: -DefaultRoute +LLMNR +mDNS -DNSOverTLS DNSSEC=no/unsupported\n+       DNS Servers: 10.8.10.77\n+        DNS Domain: ~pve\n     Default Route: no\n</code></pre> <p>\u8fd9\u6837\u662f\u505a\u4e86dns\u8f6c\u53d1\uff0c\u628a*.pve\u7684\u57df\u540d\u8f6c\u53d1\u7ed910.8.10.77\u6765\u5904\u7406\u3002 \u6548\u679c\u5982\u4e0b <pre><code># ping gitea.pve                  \nPING gitea.pve (10.8.10.130) 56(84) bytes of data.\n64 bytes from gitea.local (10.8.10.130): icmp_seq=1 ttl=64 time=0.588 ms\n64 bytes from gitea.local (10.8.10.130): icmp_seq=2 ttl=64 time=0.767 ms\n64 bytes from gitea.local (10.8.10.130): icmp_seq=3 ttl=64 time=2.95 ms\n</code></pre></p> <p>\u4f46\u662f\u6211\u914d\u7f6e systemd-resolved \u7684 search \u529f\u80fd\u4e0d\u751f\u6548\uff0c\u53ea\u80fd\u5168\u5199\u57df\u540d\uff0c \u4e0d\u80fd\u50cf\u5728pve\u5bb9\u5668\u91cc\u90a3\u6837\u7701\u7565'.pve'\u3002</p>","tags":["pve","dns"]},{"location":"blog/%E4%B8%BApve%E9%85%8D%E7%BD%AEdns/#dns_1","title":"\u5185\u90e8\u914d\u5408\u4fee\u6539dns\u670d\u52a1\u5668","text":"<p>pve\u521b\u5efa\u5bb9\u5668\u65f6\uff0c\u9ed8\u8ba4\u62f7\u8d1d\u5bbf\u4e3b\u673a\u7684dns\u914d\u7f6e\u5373/etc/resolve.conf\uff0c\u5148\u5c06\u5176\u4fee\u6539\u6210\u5982\u4e0b\uff0csearch \u7684\u4f5c\u7528\u662f\u7b80\u5316\u57df\u540d gitea.pve \u6210 gitea  <pre><code>nameserver 192.168.10.1\nnameserver 1.0.0.1\nsearch pve local\n</code></pre></p> <p>\u8fd9\u6837\u65b0\u5efa\u7684\u5bb9\u5668\u7684dns\u81ea\u52a8\u7528\u642d\u5efa\u597d\u7684\u3002 \u5728\u5df2\u521b\u5efa\u7684\u5bb9\u5668\u91cc\u627e\u5230dns\u9009\u9879\uff0c\u624b\u52a8\u4fee\u6539\u3002\u6548\u679c <pre><code># ping gitea\nPING gitea.pve (192.168.10.103) 56(84) bytes of data.\n64 bytes from 192.168.10.103 (192.168.10.103): icmp_seq=1 ttl=64 time=0.022 ms\n64 bytes from 192.168.10.103 (192.168.10.103): icmp_seq=2 ttl=64 time=0.046 ms\n</code></pre></p>","tags":["pve","dns"]},{"location":"blog/connect-raspberry-and-arduino-via-i2c/","title":"connect raspberry and arduino via i2c","text":"","tags":["i2c","arduino"]},{"location":"blog/connect-raspberry-and-arduino-via-i2c/#_1","title":"\u51c6\u5907","text":"<p>\u5148\u63a5\u7ebf\uff0c\u7136\u540e\u542f\u52a8 arduino, \u6700\u540e\u5728\u6811\u8393\u6d3e\u4e2d\u9a8c\u8bc1\u548c\u8bfb\u5199\u3002</p>","tags":["i2c","arduino"]},{"location":"blog/connect-raspberry-and-arduino-via-i2c/#gnd-sda-scl","title":"\u8fde\u63a5\u4e24\u4e2a\u8bbe\u5907\u7684GND SDA SCL","text":"<p>\u6811\u8393\u6d3e\u7684SDA\u8fdearduino\u7684SDA\uff0cSCL\u63a5SCL\uff0c\u8fd9\u8ddf\u4e32\u53e3\u7684\u63a5\u7ebf\u4e0d\u4e00\u6837\uff08RX\u63a5TX,TX\u63a5RX\uff09\u3002</p> <p></p> <p></p>","tags":["i2c","arduino"]},{"location":"blog/connect-raspberry-and-arduino-via-i2c/#arduino","title":"\u542f\u52a8arduino","text":"<p>arduino \u4ece\u7aef\u4ee3\u7801\uff0c\u6ce8\u518c\u4e86i2c\u7684\u5730\u5740\u4e3a0x08</p> <pre><code>#include &lt;Wire.h&gt;\n#define SLAVE_ADDRESS 0x08\nbyte data_to_echo = 0;\nvoid setup()\n{\n  Wire.begin(SLAVE_ADDRESS);\n  Wire.onReceive(receiveData);\n  Wire.onRequest(sendData);\n}\nvoid loop() { }\nvoid receiveData(int bytecount)\n{\n  for (int i = 0; i &lt; bytecount; i++) {\n    data_to_echo = Wire.read();\n  }\n}\nvoid sendData()\n{\n  Wire.write(data_to_echo);\n}\n</code></pre>","tags":["i2c","arduino"]},{"location":"blog/connect-raspberry-and-arduino-via-i2c/#i2c","title":"\u6811\u8393\u6d3e\u5f00\u542fi2c","text":"<p>\u8fdb\u5165\u6811\u8393\u6d3e\u7ec8\u7aef\u6267\u884c<code>raspi-config</code> \u5f00\u542fI2c\u529f\u80fd\uff0c\u91cd\u542f\u540e\u6267\u884c\u547d\u4ee4<code>i2cdetect -y 1</code>\uff0c\u53ef\u4ee5\u770b\u5230bus\u4e0a\u7684\u8bbe\u5907\u3002</p>","tags":["i2c","arduino"]},{"location":"blog/connect-raspberry-and-arduino-via-i2c/#master","title":"\u6811\u8393\u6d3e\u7684master\u7aef\u8bfb\u5199\u64cd\u4f5c\u4ee3\u7801","text":"<pre><code>#include &lt;linux/i2c-dev.h&gt;\n#include &lt;i2c/smbus.h&gt;\n#include &lt;stdint.h&gt;\n#include &lt;stdio.h&gt;\n#include &lt;unistd.h&gt;\n#include &lt;fcntl.h&gt;\n#include &lt;sys/ioctl.h&gt;\n\n#define DEVICE_ID 0x08\nint main (int argc, char **argv) {\n    // Setup I2C communication\n    int fd = open(\"/dev/i2c-1\", O_RDWR);\n    if (fd == -1) {\n        printf(\"Failed to init I2C communication.\\n\");\n        return -1;\n    }\n    ioctl (fd, I2C_SLAVE, DEVICE_ID);\n    printf(\"I2C communication successfully setup.\\n\");\n    // Send data to arduino\n    uint8_t data_to_send = 17;\n    i2c_smbus_write_byte(fd, data_to_send);\n    // Read data from arduino\n    int received_data = i2c_smbus_read_byte(fd);\n    printf(\"Data received: %d\\n\", received_data);\n    if (received_data == data_to_send) {\n       printf(\"Success!\\n\");\n    }\n    close(fd);\n    return 0;\n}\n</code></pre>","tags":["i2c","arduino"]},{"location":"blog/%E5%AE%B9%E5%99%A8%E7%9A%84%E5%91%BD%E5%90%8D%E7%A9%BA%E9%97%B4/","title":"\u5bb9\u5668\u7684\u547d\u540d\u7a7a\u95f4","text":"<p>\u5bb9\u5668\u662f\u5229\u7528'cgroup'\u548c'namespace' \u5b9e\u73b0\u8f6f\u4ef6\u7ea7\u7684\u865a\u62df\u5316\uff0c\u4ea7\u54c1\u6709lxc\u548cdocker\u3002\u4e0d\u540c\u4e0e\u5168\u865a\u62df\u5316\u548c\u534a\u865a\u62df\u5316\uff0c\u8fd9\u4e9b\u662f\u786c\u4ef6\u8f85\u52a9\u7684\u534a\u865a\u62df\u5316Zen(Zen\u4e5f\u6709\u5168\u865a\u62df\u5316)\u548c\u5168\u865a\u62df\u5316kvm  \u56e0\u4e3a\u5bb9\u5668\u4f7f\u7528\u4e3b\u673a\u5185\u6838\uff0c\u4e0d\u5b58\u5728\u7279\u6743\u6307\u4ee4\u7ffb\u8bd1\uff0c\u6240\u4ee5\u4ece\u6027\u80fd\u4e0a\u6bd4\u8f83\uff0c\u5bb9\u5668\u662f\u6700\u9ad8\u6548\u7684\uff0c\u5176\u6b21\u662fkvm, Zen</p>","tags":["docker","namespace"]},{"location":"blog/%E5%AE%B9%E5%99%A8%E7%9A%84%E5%91%BD%E5%90%8D%E7%A9%BA%E9%97%B4/#cgroupnamespace","title":"cgroup\u548cnamespace","text":"<p>\u8fd9\u4e24\u4e2a\u662f\u5bb9\u5668\u6280\u672f\u7684\u6839\u57fa\uff0c\u5305\u62ecDocker, lxc\u3002\u5b9e\u9645\u4e0adocker\u5f00\u59cb\u7528\u7684lxc\uff0c\u540e\u6765\u7528go\u91cd\u65b0\u5199\u4e86libcontainer\u6765\u5b9e\u73b0\u63a7\u5236\u8fd9\u4e24\u4e2a\u4e1c\u897f \u7b80\u5355\u6765\u8bf4\uff0ccgroup\u5b9e\u73b0\u5bf9\u8fdb\u7a0b\u7ec4\u7684\u8d44\u6e90\u7684\u9650\u5236\u548c\u76d1\u63a7\uff0c\u800cnamespace\u5982\u540cc++\u91cc\u9762\u7c7b\u4f3c\uff0c\u5b9e\u73b0\u4e86\u8fdb\u7a0b\u7ec4\u4e4b\u95f4\u7684\u9694\u79bb</p> <p>\u4f46\u9664\u6b64\u4e4b\u5916, \u865a\u62df\u5316\u7cfb\u7edf\u65f6\u5219\u8fd8\u9700\u8981rootfs\u652f\u6301</p>","tags":["docker","namespace"]},{"location":"blog/%E5%AE%B9%E5%99%A8%E7%9A%84%E5%91%BD%E5%90%8D%E7%A9%BA%E9%97%B4/#lxcdocker","title":"LXC\u548cDocker","text":"<p>lxc\u4ee3\u7801\u5408\u5165\u4e86\u5185\u6838\uff0c\u5176\u539f\u7406\u548cDocker\u975e\u5e38\u7c7b\u4f3c, \u4e0d\u8fc7Docker\u6709\u6bd4\u8f83\u4e30\u5bcc\u7684\u5168\u5957\u5de5\u5177\u548c\u65b9\u4fbf\u7684api   </p>","tags":["docker","namespace"]},{"location":"blog/%E5%AE%B9%E5%99%A8%E7%9A%84%E5%91%BD%E5%90%8D%E7%A9%BA%E9%97%B4/#nsenter","title":"nsenter\u547d\u4ee4\u7684\u4f7f\u7528","text":"<p>\u5bb9\u5668\u6280\u672f\u90fd\u4f7f\u7528\u5230\u4e86namespace, \u800cnsenter\u53ef\u4ee5\u64cd\u4f5cnamespace, \u8fdb\u5165\u5bb9\u5668\u5185\u90e8\uff0c\u4ee5\u4e0b\u90fd\u4e00docker\u5bb9\u5668\u4e3a\u4f8b  </p> <p>\u4f7f\u7528\u547d\u4ee4, \u83b7\u53d6\u5230\u5bb9\u5668\u7684\u9996\u8fdb\u7a0bpid <pre><code>docker inspect --format '{{.State.Pid}}' containername\n3015\n</code></pre></p> <p>\u7136\u540e\u53ef\u4ee5\u4f7f\u7528nsenter\u6765\u8fdb\u5165\u5bb9\u5668\uff0c\u5982\u540c<code>docker exec</code> \u4e00\u6837 <pre><code>$ pwd\n/home/user\n$ sudo nsenter -t 3015 -m  pwd\n/\n</code></pre></p> <p><code>-m</code>\u8868\u793a\u6302\u8f7d\u547d\u540d\u7a7a\u95f4\uff0c\u8fd9\u6837\u5c31\u80fd\u8bbf\u95eedocker\u91cc\u7684\u8fdb\u7a0b\u7684\u6587\u4ef6\u7cfb\u7edf\uff0c\u6240\u4ee5\u80fd\u6b63\u786e\u6253\u5370\u51fa\u5bb9\u5668\u8fdb\u7a0b\u7684\u5f53\u524d\u76ee\u5f55 <code>-t</code>\u8868\u793a\u76ee\u6807\u8fdb\u7a0b\uff0cnsenter\u53ef\u4ee5\u83b7\u53d6\u4ee5\u4e0b\u547d\u540d\u7a7a\u95f4\u3002 \u8ddf\u901a\u8fc7\u6267\u884c<code>ls /proc/self/ns</code>\u6240\u770b\u5230\u7684\u5dee\u4e0d\u591a\uff0c\u8fd9\u91ccself\u662f\u547d\u4ee4\u672c\u8eabpid <pre><code>/proc/pid/ns/mnt    the mount namespace\n/proc/pid/ns/uts    the UTS namespace\n/proc/pid/ns/ipc    the IPC namespace\n/proc/pid/ns/net    the network namespace\n/proc/pid/ns/pid    the PID namespace\n/proc/pid/ns/user   the user namespace\n/proc/pid/ns/cgroup the cgroup namespace\n/proc/pid/ns/time   the time namespace\n/proc/pid/root      the root directory\n/proc/pid/cwd       the working directory respectively\n</code></pre> \u4e0a\u9762\u7684\u6bcf\u9879\u90fd\u6709\u5bf9\u5e94\u7684\u53c2\u6570\uff0c\u800c'-a'\u8868\u793a\u8fdb\u5165\u4e0a\u9762\u7684\u6240\u6709\u547d\u540d\u7a7a\u95f4</p>","tags":["docker","namespace"]},{"location":"blog/cpp%E5%8E%9F%E5%AD%90%E6%93%8D%E4%BD%9C/","title":"CPP\u539f\u5b50\u64cd\u4f5c","text":"","tags":["c/cpp","atomic"]},{"location":"blog/cpp%E5%8E%9F%E5%AD%90%E6%93%8D%E4%BD%9C/#_1","title":"\u65e0\u9501\u961f\u5217","text":"","tags":["c/cpp","atomic"]},{"location":"blog/cpp%E5%8E%9F%E5%AD%90%E6%93%8D%E4%BD%9C/#atomic","title":"atomic","text":"<pre><code>      void\n      store(__pointer_type __p,\n        memory_order __m = memory_order_seq_cst) noexcept\n      { return _M_b.store(__p, __m); }\n\n      void\n      store(__pointer_type __p,\n        memory_order __m = memory_order_seq_cst) volatile noexcept\n      { return _M_b.store(__p, __m); }\n\n      __pointer_type\n      load(memory_order __m = memory_order_seq_cst) const noexcept\n      { return _M_b.load(__m); }\n\n      __pointer_type\n      load(memory_order __m = memory_order_seq_cst) const volatile noexcept\n      { return _M_b.load(__m); }\n\n      __pointer_type\n      exchange(__pointer_type __p,\n           memory_order __m = memory_order_seq_cst) noexcept\n      { return _M_b.exchange(__p, __m); }\n</code></pre>","tags":["c/cpp","atomic"]},{"location":"blog/cpp%E5%8E%9F%E5%AD%90%E6%93%8D%E4%BD%9C/#cpp_1","title":"cpp\u5b9e\u73b0","text":"<pre><code>atomic::compare_exchange_weak\n</code></pre>","tags":["c/cpp","atomic"]},{"location":"blog/cpp%E5%8E%9F%E5%AD%90%E6%93%8D%E4%BD%9C/#memory_order","title":"memory_order","text":"<ul> <li>memory_order_relaxed</li> <li>memory_order_seq_cst</li> </ul>","tags":["c/cpp","atomic"]},{"location":"blog/%E6%A8%A1%E6%9D%BF%E7%BC%96%E7%A8%8B/","title":"\u6a21\u677f\u7f16\u7a0b","text":"<p>\u6a21\u677f\u7f16\u7a0b\u662f\u5176\u5b83\u9ad8\u7ea7\u8bed\u8a00\u6ca1\u6709\u7684\u6280\u672f, \u4e5f\u79f0\u4e3a\u8303\u578b\u7f16\u7a0b\uff0c\u5143\u7f16\u7a0b(meta programing), stl\u7684\u57fa\u77f3\u3002\u8fd9\u79cd\u5bf9\u7c7b\u578b\u7684\u6cdb\u5316\u76f8\u5f53\u4e8e\u5728\u7f16\u7a0b\u4e4b\u4e0a\u7f16\u7a0b</p>","tags":["c/cpp","template programing"]},{"location":"blog/%E6%A8%A1%E6%9D%BF%E7%BC%96%E7%A8%8B/#_2","title":"\u6982\u8ff0","text":"<p>\u6a21\u677f\u53ef\u4ee5\u4f5c\u7528\u4e8e\u51fd\u6570\u548c\u7c7b\uff0c\u5373\u80fd\u6cdb\u5316<code>\u7c7b\u578b</code>\uff0c\u4e5f\u53ef\u4ee5\u6cdb\u5316<code>\u5927\u5c0f</code> <pre><code> template &lt;typename T, int N&gt; void foo() { T t[N]; }\n template &lt;typename T, int N&gt; struct Foo { T t[N]; };\n\n int main() {\n    // array of two int\n    foo&lt;int, 2&gt;();\n    // class has a array of two int \n    Foo&lt;int, 2&gt; F;\n  } \n</code></pre></p>","tags":["c/cpp","template programing"]},{"location":"blog/%E6%A8%A1%E6%9D%BF%E7%BC%96%E7%A8%8B/#_3","title":"\u6a21\u677f\u7684\u7279\u5316","text":"<p>\u8ddf\u6cdb\u5316\u76f8\u53cd\u7684\u65b9\u5411\uff0c\u53eb\u7279\u5316\uff0c\u7f16\u8bd1\u5668\u4f1a\u4f18\u5148\u4f7f\u7528\u7279\u5316\u7684\u7248\u672c, \u800c\u7279\u5316\u67092\u4e2a\u65b9\u5411\uff0c<code>\u7c7b\u578b\u7279\u5316</code>\u548c<code>\u8303\u56f4\u7279\u5316</code> </p>","tags":["c/cpp","template programing"]},{"location":"blog/%E6%A8%A1%E6%9D%BF%E7%BC%96%E7%A8%8B/#_4","title":"\u7c7b\u578b\u7279\u5316","text":"<p>\u5bf9\u4e8e\u7279\u5316\u7c7b\u578b\u4e2a\u6570\u7684\u4e0d\u540c\uff0c\u5206\u4e3a\u504f\u7279\u5316\u548c\u5168\u7279\u5316\uff0c\u5168\u7279\u5316\u5373\u4e3a\u6240\u6709\u7c7b\u578b\u90fd\u6307\u5b9a\uff0c\u7279\u5316\u7c7b\u578b\u8d8a\u591a\u5339\u914d\u4f18\u5148\u7ea7\u8d8a\u9ad8  \u6ce8\u610f\uff1a\u6a21\u677f\u51fd\u6570\u4e0d\u80fd\u504f\u7279\u5316</p> <pre><code>template&lt;typename T1, typename T2&gt; struct Foo{};\ntemplate&lt;typename T2&gt; struct Foo&lt;int, T2&gt; {};\n// \u5168\u7279\u5316\ntemplate&lt;&gt; struct Foo&lt;int,int&gt;{};\n</code></pre> <p>\u4f8b\u5982`Foo foo'\uff0c\u7f16\u8bd1\u5668\u4f1a\u4f7f\u7528\u7b2c\u4e09\u4e2a\u7248\u672c","tags":["c/cpp","template programing"]},{"location":"blog/%E6%A8%A1%E6%9D%BF%E7%BC%96%E7%A8%8B/#_5","title":"\u8303\u56f4\u7279\u5316","text":"<p>\u6bd4\u5982\u5e38\u89c1\u7684\u6307\u9488\u548c\u5f15\u7528\uff0c\u8fd9\u548cint, float, class \u90fd\u662f\u65e0\u5173\u7684\uff0c\u5c5e\u4e8e\u53e6\u4e2a\u7ef4\u5ea6\uff0c\u4e5f\u53ef\u4ee5\u8bf4\u662f\u8303\u56f4, \u5728stl\u4e3a\u517c\u5bb9\u6307\u9488\u505a\u5927\u91cf\u7684\u5de5\u4f5c  </p> <p><pre><code>template &lt;typename T, typename N&gt; struct Foo&lt;T *, N&gt; {};\n</code></pre> \u8fd9\u6837'Foo foo'\u4f1a\u4f7f\u7528\u8fd9\u4e2a\u7248\u672c <p>\u8fd8\u4f8b\u5982\u6307\u5b9a\u5bf9\u5927\u5c0f\u7684\u7279\u4f8b\u5316 <pre><code>//\u6a21\u677f\ntemplate&lt;int n&gt; foo(){}\n\n//\u503c\u7279\u4f8b\u5316\ntemplate&lt;&gt; foo&lt;10&gt; foo(){}\n</code></pre> \u90a3\u4e48\u5982\u679c\u8c03\u7528<code>foo&lt;10&gt;();</code>\u65f6\uff0c\u4f18\u5148\u5339\u914d\u7279\u4f8b\u5316\u7248\u672c</p>","tags":["c/cpp","template programing"]},{"location":"blog/%E6%A8%A1%E6%9D%BF%E7%BC%96%E7%A8%8B/#_6","title":"\u51fd\u6570\u5339\u914d\u4f18\u5148\u7ea7","text":"<p>\u5728\u51fd\u6570\u8c03\u7528\u65f6\uff0c\u666e\u901a\u51fd\u6570\u7684\u5339\u914d\u4f18\u5148\u7ea7\u9ad8\u4e8e\u6a21\u677f\u51fd\u6570 <pre><code>template &lt;typename T&gt; void f(T) { std::cout &lt;&lt; \"temp\\n\"; }\nvoid f(int d) { std::cout &lt;&lt; \"temp1\\n\"; }\ntemplate &lt;&gt; void f(int d) { std::cout &lt;&lt; \"temp2\\n\"; }\n\nf(1); // temp1\n</code></pre></p>","tags":["c/cpp","template programing"]},{"location":"blog/%E6%A8%A1%E6%9D%BF%E7%BC%96%E7%A8%8B/#_7","title":"\u81ea\u5b9a\u4e49\u7c7b\u578b\u7684\u8303\u56f4\u7279\u5316","text":"<p>\u4e0a\u9762\u8bb2\u7684\u662f\u6307\u9488\u7c7b\u578b\u548c\u5f15\u7528\u7c7b\u578b\u4e24\u79cd\uff0c\u4f46\u5982\u679c\u662f\u81ea\u5b9a\u4e49\u7c7b\u578b\uff0c\u90a3\u5c31\u65e0\u7a77\u65e0\u5c3d\u4e86\uff0c\u6240\u4ee5\u6a21\u677f\u7f16\u7a0b\u4e5f\u662f'\u56fe\u7075\u5b8c\u5907'\u7684</p> <p>\u4f8b\u5982\u4ee5\u4e0b\uff0c\u521b\u5efa\u4e86\u4e00\u4e2a\u81ea\u5b9a\u4e49\u7684\u7c7b\u578b\u6765\u5305\u88c5\u57fa\u672c\u7c7b\u578b(int,float)\uff0c\u8fd9\u6837\u53ef\u4ee5\u6709\u81ea\u5b9a\u4e49\u7c7b\u578b\u7684\u7279\u5316\u7248\u672c <pre><code>  template &lt;typename T&gt; struct Decor { using type = T; };\n  template &lt;typename T&gt; struct Strip { using type = T; };\n  template &lt;typename T&gt; struct Strip&lt;Decor&lt;T&gt;&gt; { using type = T; };\n  template &lt;typename T&gt; using StripDecor = typename Strip&lt;T&gt;::type;\n\n  template &lt;typename T&gt; class Row {};\n\n  int main() {\n    using nodecor = Row&lt;int&gt;;\n    using decor = Decor&lt;Row&lt;int&gt;&gt;;\n    // \u867d\u5e95\u5c42\u540c\u4e3aint, \u4f46nodecor \u7c7b\u578b\u4e0d\u540c\u4e8edecor\u7c7b\u578b\n    static_assert(std::is_same&lt;col&gt;, nocol&gt;::value);\n    // \u901a\u8fc7Strip\u53d6\u51fa\u5176\u5e95\u5c42\u7c7b\u578b\n    static_assert(std::is_same&lt;StripDecor&lt;col&gt;, nocol&gt;::value);\n    return 0;\n  }\n</code></pre></p>","tags":["c/cpp","template programing"]},{"location":"blog/%E6%A8%A1%E6%9D%BF%E7%BC%96%E7%A8%8B/#_8","title":"\u6a21\u677f\u7684\u58f0\u660e\u5b9a\u4e49\u5206\u79bb","text":"<ol> <li>\u7531\u4e8etemplate\u7528\u6765\u751f\u6210\u51fd\u6570\u548c\u7c7b\uff0c\u6240\u4ee5\u7f16\u8bd1\u5668\u9700\u8981\u540c\u65f6\u77e5\u9053template\u7684\u7c7b\u578b\u548c\u5176\u7ec6\u8282\uff0c\u6240\u4ee5\u6a21\u677f\u51fd\u6570\u4e0d\u652f\u6301\u5c06\u5b9a\u4e49\u653e\u5230\u6e90\u6587\u4ef6\u4e2d</li> <li>\u800c\u4e14\u7f16\u8bd1\u5668\u901a\u5e38\u662f\u4ee5cpp\u4e3a\u7f16\u8bd1\u5355\u5143\uff0c\u5f53\u7f16\u8bd1\u6a21\u677fcpp\u65f6\u4e0d\u77e5\u9053\u8c03\u7528cpp, \u7f16\u8bd1\u8c03\u7528cpp\u65f6\uff0c\u4e0d\u77e5\u9053\u6a21\u677fcpp\u3002\u6240\u4ee5\u6a21\u677f\u51fd\u6570\u4e0d\u652f\u6301\u5c06\u5b9a\u4e49\u653e\u5230\u6e90\u6587\u4ef6\u4e2d</li> <li>\u5bf9\u4e8e\u6a21\u677f\u7c7b\u53ef\u4ee5\u5c06\u6210\u5458\u51fd\u6570\u7684\u5b9a\u4e49\u653e\u5230\u6e90\u6587\u4ef6\uff0c\u4f46\u8981\u4e3a\u6bcf\u4e2a\u6210\u5458\u51fd\u6570\u90fd\u6dfb\u52a0'template'\u9650\u5b9a, \u800c\u4e14\u8981\u4e3a\u5b9e\u4f8b\u6dfb\u52a0\u7279\u4f8b\u5316\u3002</li> <li>\u663e\u5f0f\u7279\u4f8b\u5316\u652f\u6301\u53ea\u58f0\u660e\u4e0d\u5b9a\u4e49\uff0c\u800c\u5728\u6e90\u6587\u4ef6\u4e2d\u4e3a\u6bcf\u79cd\u6240\u9700\u7684\u7c7b\u578b\u90fd\u7279\u4f8b\u5316\uff0c\u5373\u4e0e3\u76f8\u540c\u3002\u5176\u5b9e\u663e\u793a\u7279\u4f8b\u5316\u662f\u4e0d\u9700\u8981\u7279\u4f8b\u5316\u800c\u5f3a\u5236\u7279\u4f8b\u5316\u3002 </li> </ol> <p>\u5982\u4e0b\uff0c\u6a21\u677f\u7c7b\u7684\u5b9a\u4e49\u653e\u5230cpp\u4e2d\uff0c\u8fd9\u6837\u4f1a\u62a5\u9519\uff0c\u56e0\u4e3a\u5728\u7f16\u8bd1call_foo.cpp\u65f6\u4e0d\u77e5\u5230\u6a21\u677f\u5b9a\u4e49, \u56e0\u4e3a\u6ca1\u6709\u751f\u6210\u8fc7int\u7248\u672c\u7684Foo\u3002 \u4e3a\u6b64\uff0c\u5fc5\u987b\u5728foo.cpp\u91cc\u6dfb\u52a0<code>template class Foo&lt;int&gt;</code>, \u5982\u540c4\uff0c\u5b9e\u5728\u5403\u529b\u4e0d\u8ba8\u597d\u3002 <pre><code>// foo.h\n    template&lt;typename T&gt;\n    class Foo {\n    public:\n      Foo();\n      void someMethod(T x);\n    private:\n      T x;\n    };\n\n// foo.cpp\n    template&lt;typename T&gt;\n    Foo&lt;T&gt;::Foo()\n    {\n      // ...\n    }\n    template&lt;typename T&gt;\n    void Foo&lt;T&gt;::someMethod(T x)\n    {\n      // ...\n    }\n\n// call_foo.cpp\n    void blah_blah_blah()\n    {\n      // ...\n      Foo&lt;int&gt; f;\n      f.someMethod(5);\n      // ...\n    }\n</code></pre></p> <p>\u5f53\u7136\u628a\u6a21\u677f\u7684\u5b9a\u4e49\u653e\u5230\u5934\u6587\u4ef6\u4e2d\u4f1a\u589e\u52a0\u53ef\u6267\u884c\u6587\u4ef6\u7684\u4f53\u79ef\u3002</p>","tags":["c/cpp","template programing"]},{"location":"blog/%E6%A8%A1%E6%9D%BF%E7%BC%96%E7%A8%8B/#_9","title":"\u5b9e\u9645\u8fd0\u7528","text":"<p>grpc \u80fd\u4ee5\u6d41\u548c\u975e\u6d41\u65b9\u5f0f\u4f20\u8f93\uff0c\u800cgrpc\u53c2\u6570protobuf\u6d88\u606f\u7c7b\u578b\u662f\u53e6\u4e00\u4e2a\u8303\u56f4\u3002\u90a3\u4e48\u8981\u5c01\u88c5grpc\u65b9\u6cd5, \u9700\u8981\u5c01\u88c5\u6d41+\u7c7b\u578b</p> <p>\u4e3e\u4f8bprotobuf\u7684\u6d88\u606f\u7c7b\u578b\u6709string, fixed32 - string - fixed32 - Stream - Stream <p>\u901a\u8fc7\u4e0a\u9762\u7684\u504f\u7279\u5316\u53ef\u4ee5\u5373\u80fd\u533a\u5206\u6d41\u548c\u975e\u6d41\u53c8\u80fd\u533a\u5206\u7c7b\u578b</p>","tags":["c/cpp","template programing"]},{"location":"blog/%E6%A8%A1%E6%9D%BF%E7%BC%96%E7%A8%8B/#_10","title":"\u8d58\u8ff0\u4e00\u4e0b\u6a21\u677f\u7684\u7c7b\u578b","text":"<p>\u4e0a\u9762\u7684\u6a21\u677f\u7c7b\u578bT\u90fd\u662f\u5b9e\u9645\u7f16\u7a0b\u65f6\u5b9a\u4e49\u7684\u7c7b\u578b\uff0c\u4f46\u4f5c\u4e3a\u56fe\u7075\u5b8c\u5907\u7684\u6a21\u677f\u7f16\u7a0b\uff0c\u672a\u51b3\u7684template\u7c7b\u578b\u4e5f\u53ef\u4ee5\u4f5c\u4e3atemplate\u7c7b\u578b</p> <p>\u5982\u4e0b\u662f\u4e00\u4e2a\u6a21\u677f\u7528\u53e6\u4e00\u4e2a\u6a21\u677f\u6765\u7279\u4f8b\u5316 <pre><code>template &lt;typename T&gt; struct Upper {};\ntemplate &lt;template &lt;typename&gt; class T&gt; struct Lower {};\n\ntemplate&lt;typename T&gt;\nLower&lt;Upper&lt;T&gt;&gt; l;\n</code></pre></p>","tags":["c/cpp","template programing"]},{"location":"blog/%E6%A8%A1%E6%9D%BF%E7%BC%96%E7%A8%8B/#variadic-templates","title":"\u53ef\u53d8\u6a21\u7248variadic templates","text":"<p>c\u4e2d\u6709\u53ef\u53d8\u53c2\u6570<code>...</code>\u548cgcc\u5185\u7f6e<code>__VA_ARGS__</code>\u5b8f\u5b9a\u4e49, \u5b9e\u73b0\u4e0d\u540c\u4e2a\u6570\u7684\u53d8\u91cf\u6253\u5370\u3002\u8fd9\u662f\u7531\u7f16\u8bd1\u671f\u5b9e\u73b0\u7684\uff0c\u4f1a\u5c06format\u7684\u683c\u5f0f\u7b26\u66ff\u6362\u6210\u53c2\u6570 <pre><code>int printf ( const char * format, ... );\n</code></pre></p> <p>c++\u6709\u6a21\u7248\uff0c\u800c\u4e14\u5728c++11\u4e4b\u540e\u5f15\u5165\u4e86\u52a8\u6001\u53c2\u6570\u6a21\u7248\uff0c\u5373\u6a21\u7248\u51fd\u6570\u6216\u7c7b\u53ef\u4ee5\u4f7f\u7528\u52a8\u6001\u53c2\u6570</p>","tags":["c/cpp","template programing"]},{"location":"blog/%E6%A8%A1%E6%9D%BF%E7%BC%96%E7%A8%8B/#1","title":"\u5b9e\u9645\u8fd0\u75281","text":"<p>\u5728\u5b9e\u9645\u9879\u76ee\u4e2d\u624b\u52a8\u8dd1\u5355\u5143\u6d4b\u8bd5\u7528\u4f8b\u7684\u65f6\u5019\uff0c\u4e0d\u5e0c\u671b\u518d\u53bb\u770b\u65e5\u5fd7\u6587\u4ef6\uff0c\u800c\u662f\u60f3\u65e5\u5fd7\u76f4\u63a5\u8f93\u51fa\u5230\u7ec8\u7aef, \u6709\u4ee5\u4e0b\u529e\u6cd5</p>","tags":["c/cpp","template programing"]},{"location":"blog/%E6%A8%A1%E6%9D%BF%E7%BC%96%E7%A8%8B/#c11","title":"c++11\u53ca\u4ee5\u4e0a\u6807\u51c6","text":"<p>\u53ef\u4ee5\u4f7f\u7528\u52a8\u6001\u53c2\u6570\u6a21\u7248\u66ff\u6362\u539f\u672c\u7684\u65e5\u5fd7\u6253\u5370\u51fd\u6570 <pre><code>#undef log_debug\n\ntemplate&lt;typename First, typename ...Rest&gt;\nvoid log_debug(First &amp;&amp; first, Rest &amp;&amp; ... rest){\n  std::cout &lt;&lt; fmt::format(first, rest ...) &lt;&lt; std::endl;\n}\n\n// \u8fd9\u65f6\u65e5\u5fd7\u5c31\u76f4\u63a5\u8f93\u51fa\u5230\u7ec8\u7aef\u4e86, \u8fd9\u91cc\u4f7f\u7528\u4e86fmt\u5e93\nlog_debug(\"aasdas{}\", \"bbbb\");\n</code></pre></p> <p>\u4e5f\u53ef\u7b80\u5355\u5199\u6210 <pre><code>template&lt;typename ...Args&gt;\nvoid log_debug(Args&amp;&amp; ...args){\n    std::cout &lt;&lt; fmt::format(args...) &lt;&lt; std::endl;\n}\n</code></pre></p> <p>\u5982\u679c\u4e0d\u4f7f\u7528fmt\u683c\u5f0f\u5316\uff0c\u8fd8\u53ef\u4ee5\u7528 <pre><code>#undef log_debug\n// \u5b9a\u4e49\u4e00\u4e2a\u7a7a\u51fd\u6570\nvoid log_debug(){}\n\ntemplate&lt;typename First, typename Rest&gt;\nvoid log_debug(First&amp;&amp; first, Arg&amp;&amp; ...arg){\n    std::cout &lt;&lt; first;\n    log_debug(arg...);\n}\n</code></pre> \u9700\u8981\u89e3\u91ca\u4e00\u4e0b\uff0c\u51fd\u6570<code>log_debug()</code>\u5fc5\u987b\u8981\u5148\u58f0\u660e\uff0c\u56e0\u4e3a\u6a21\u7248\u5b9e\u4f8b\u5316\u7684\u7684\u6700\u7ec8\u8981\u8c03\u7528\u8fd9\u4e2a\u65e0\u53c2\u7684\u51fd\u6570 \u6a21\u62df\u4e00\u4e0b\u5806\u6808, \u56e0\u4e3a\u53c2\u6570\u5728\u6bcf\u6b21\u9012\u5f52\u65f6\u51cf\u5c11\u4e00\u4e2a\uff0c\u6240\u4ee5\u6700\u7ec8\u662f0\u4e2a\u53c2\u6570 <pre><code>log_debug(1, 0.2, \"aaa\");\nlog_debug(0.2, \"aaa\");\nlog_debug(\"aaa\");\nlog_debug();\n</code></pre></p>","tags":["c/cpp","template programing"]},{"location":"blog/%E6%A8%A1%E6%9D%BF%E7%BC%96%E7%A8%8B/#c11_1","title":"c++11\u4ee5\u524d\u7684\u6807\u51c6","text":"<p>\u53ef\u4ee5\u4f7f\u7528\u5b8f\u5b9a\u4e49\u6765\u66ff\u6362\u4e86, \u7136\u540e\u9700\u8981\u91cd\u8f7d<code>,</code>\u65b9\u6cd5 <pre><code>#define log_debug(...) std::cout , __VA_ARGS__ , std::endl\n\ntemplate &lt;typename T&gt;\nstd::ostream&amp; operator,(std::ostream&amp; out, const T&amp; t) {\n  out &lt;&lt; t;\n  return out;\n}\n\n//overloaded version to handle all those special std::endl and others...\nstd::ostream&amp; operator,(std::ostream&amp; out, std::ostream&amp;(*f)(std::ostream&amp;)) {\n  out &lt;&lt; f;\n  return out;\n}\n</code></pre></p>","tags":["c/cpp","template programing"]},{"location":"blog/%E6%A8%A1%E6%9D%BF%E7%BC%96%E7%A8%8B/#c","title":"\u76f4\u63a5\u7528c\u7684\u65b9\u5f0f","text":"<p>\u56e0\u4e3aprintf\u662f\u652f\u6301varidic\u7684 <pre><code>#undef log_debug\n\n#define log_debug(...) printf(__VA_ARGS__), printf(\"\\n\")\n\nint main() {\n  log_debug(\"example\",\"output\",\"filler\",\"text\");\n  return 0;\n}\n</code></pre></p>","tags":["c/cpp","template programing"]},{"location":"blog/%E6%A8%A1%E6%9D%BF%E7%BC%96%E7%A8%8B/#c17-fold-expression","title":"c++17 \u5f15\u5165\u4e86<code>fold expression</code>","text":"<p>\u53ef\u4ee5\u6539\u5199\u4e3a <pre><code>template&lt;typename ...Args&gt;\nvoid log_debug(Args &amp;&amp; ...args)\n{\n    (std::cout &lt;&lt; ... &lt;&lt; args);\n}\n</code></pre></p> <p>\u52a8\u6001\u53c2\u6570\u6a21\u7248\u9664\u4e86\u4ee5\u4e0a\u7684\u7528\u6cd5\uff0c\u8fd8\u6709\u66f4\u591a\u7528\u5904, \u4f8b\u5982<code>std::tupe</code>\u7684\u5b9e\u73b0</p>","tags":["c/cpp","template programing"]},{"location":"blog/%E6%A8%A1%E6%9D%BF%E7%BC%96%E7%A8%8B/#2","title":"\u5b9e\u9645\u8fd0\u75282","text":"","tags":["c/cpp","template programing"]},{"location":"blog/%E6%A8%A1%E6%9D%BF%E7%BC%96%E7%A8%8B/#_11","title":"\u4f7f\u7528\u6a21\u677f\u751f\u6210\u5e76\u53d1\u4ee3\u7801","text":"<p>\u4ee5\u4e0b\u4ee3\u7801\u5b9e\u73b0\u590d\u5236\u4e8c\u7ef4\u6570\u7ec4\uff0c <pre><code>for( size_t ch=0 ; ch&lt;channelNum ; ++ch ) {\n    for( size_t i=0; i&lt;length ; ++i ) {\n        out[ch][i]=in[ch][i];\n    }\n}\n</code></pre></p> <p>\u4f46\u4ee5\u4e0b\u7406\u8bba\u66f4\u5feb\uff0c\u6ca1\u6709\u4e24\u5c42for\uff0c\u524d\u63d0\u662f\u77e5\u9053channel\u5927\u5c0f <pre><code>for(size_t i=0;i&lt;length;++i) {\n    out[0][i]=in[0][i];\n    out[1][i]=in[1][i];\n    out[2][i]=in[2][i];\n    out[3][i]=in[3][i];\n}\n</code></pre></p> <p>\u4f46\u5982\u679c\u7528\u6a21\u677f\uff0c\u5c31\u4e0d\u9700\u8981\u77e5\u9053channel\u5927\u5c0f\uff0c\u81ea\u52a8\u751f\u6210\u4e0a\u9762\u7684\u4ee3\u7801</p> <pre><code>template &lt;int count&gt; class Copy {\npublic:\n  static inline void go(float **const out, float **const in, int i) {\n    Copy&lt;count - 1&gt;::go(out, in, i);\n    out[count - 1][i] = in[count - 1][i];\n  }\n};\n\ntemplate &lt;&gt; class Copy&lt;0&gt; {\npublic:\n  static inline void go(float **const, float **const, int) {}\n};\n\ntemplate &lt;int channelNum&gt;\nvoid parall_copy(float **out, float **in, size_t length) {\n  for (size_t i = 0; i &lt; length; ++i) {\n    Copy&lt;channelNum&gt;::go(out, in, i);\n  }\n}\n</code></pre> <p>\u9700\u8981\u63d0\u9192\u7684\uff0c\u5982\u540c\u6253\u5370\u65e5\u5fd7\u7684\uff0c0\u7684\u7279\u4f8b\u5316\u4e0d\u80fd\u7701\uff0c\u5426\u5219\u7f16\u8bd1\u51fa\u9519</p>","tags":["c/cpp","template programing"]},{"location":"blog/%E6%A8%A1%E6%9D%BF%E7%BC%96%E7%A8%8B/#3","title":"\u5b9e\u9645\u8fd0\u75283 \u5de5\u5382\u6a21\u5f0f","text":"<p>\u5728\u4f7f\u7528spdlog\u65f6\u53d1\u73b0\u6709\u4f7f\u7528\u5230template\u672a\u51b3\u540d, \u7528\u6765\u5b9e\u73b0\u4e24\u4e2a\u7ef4\u5ea6\u7684\u5de5\u5382\u6a21\u5f0f\u3002</p> <p>\u7b2c\u4e00\u5c42\u63d0\u4f9b\u4e24\u79cdsink\u7684\u5de5\u5382\uff0c\u800c\u5176factory\u662f\u672a\u51b3\u540d\uff0c\u6240\u4ee5\u8981\u52a0\u4e0a<code>Factory::template</code>\u6d88\u6b67\u4e49\uff0c\u4e0d\u7136<code>&lt;</code>\u4f1a\u5f53\u6210\u5c0f\u4e8e\u53f7  </p> <pre><code>//\n// factory functions\n//\ntemplate&lt;typename Factory = default_factory&gt;\ninline std::shared_ptr&lt;logger&gt; basic_logger_mt(const std::string &amp;logger_name, const filename_t &amp;filename, bool truncate = false)\n{\n    return Factory::template create&lt;sinks::basic_file_sink_mt&gt;(logger_name, filename, truncate);\n}\n\ntemplate&lt;typename Factory = default_factory&gt;\ninline std::shared_ptr&lt;logger&gt; basic_logger_st(const std::string &amp;logger_name, const filename_t &amp;filename, bool truncate = false)\n{\n    return Factory::template create&lt;sinks::basic_file_sink_st&gt;(logger_name, filename, truncate);\n}\n</code></pre> <p>\u6b64\u65f6factory\u53ef\u4ee5\u662f<code>synchronous_factory</code>, \u4e5f\u53ef\u4ee5\u662f\u5f02\u6b65\u7248\u672c\uff0c\u4f46\u8fd9\u9700\u8981\u7528\u6237\u81ea\u5df1\u5b9e\u73b0\u3002 <pre><code>// Default logger factory-  creates synchronous loggers\nstruct synchronous_factory\n{\n    template&lt;typename Sink, typename... SinkArgs&gt;\n    static std::shared_ptr&lt;spdlog::logger&gt; create(std::string logger_name, SinkArgs &amp;&amp;... args)\n    {\n        auto sink = std::make_shared&lt;Sink&gt;(std::forward&lt;SinkArgs&gt;(args)...);\n        auto new_logger = std::make_shared&lt;logger&gt;(std::move(logger_name), std::move(sink));\n        details::registry::instance().initialize_logger(new_logger);\n        return new_logger;\n    }\n};\n\nusing default_factory = synchronous_factory;\n</code></pre></p> <p>\u7b80\u5316\u4e3a\u4e0b\u9762\u7684demo\uff0c\u56fa\u7136\u53ef\u4ee5\u76f4\u63a5\u4f7f\u7528call_dd\u7684\u65b9\u5f0f\uff0c\u4f46\u7ef4\u5ea6\u53ea\u6709\u4e00\u4e2a\u3002\u800ccall_dd2\u5219\u67092\u4e2a\u7ef4\u5ea6\u4e86 \u4f46\u5fc5\u987b\u4f7f\u7528<code>T::template</code>\u6d88\u6b67\u4e49, \u56e0\u4e3a\u6b64\u65f6\u7684foo\u672a\u51b3\u540d, \u4e0d\u77e5\u9053\u662f\u90a3\u4e2a\u7c7b\u91cc\u9762\u7684foo\u3002 <pre><code>  struct AA {\n    template &lt;typename cc&gt; static void foo() { std::cout &lt;&lt; \"dd::foo\\n\"; };\n  };\n\n  struct BB {\n    template &lt;typename cc&gt; static void foo() { std::cout &lt;&lt; \"dd::foo\\n\"; };\n  };\n\n  template &lt;typename T&gt; void call_dd() { AA::foo&lt;T&gt;(); }\n  template &lt;typename T, typename K&gt; void call_dd2() { T::template foo&lt;K&gt;(); }\n\n  int main() {\n    call_dd&lt;void&gt;();\n    call_dd2&lt;AA&gt;();\n    call_dd2&lt;AA, int&gt;();\n    call_dd2&lt;BB, long&gt;();\n  }\n</code></pre></p>","tags":["c/cpp","template programing"]},{"location":"blog/%E6%A8%A1%E6%9D%BF%E7%BC%96%E7%A8%8B/#_12","title":"\u6a21\u7248\u4e0e\u5b8f\u5b9a\u4e49\u3001\u865a\u51fd\u6570\u7684\u533a\u522b","text":"<ol> <li>\u5b8f\u5b9a\u4e49\u5728\u9884\u5904\u7406\u671f\u6267\u884c\uff0c\u6a21\u677f\u5728\u7f16\u8bd1\u671f\u6267\u884c\uff0c\u800c\u865a\u51fd\u6570\u4e5f\u79f0\u52a8\u6001\u7ed1\u5b9a\u5728\u8fd0\u884c\u65f6\u6267\u884c</li> <li>\u5b8f\u548c\u6a21\u677f\u90fd\u5c06\u8fd0\u884c\u65f6\u7684\u5de5\u4f5c\u63d0\u524d\u4e86\uff0c\u7528\u7f16\u8bd1\u65f6\u95f4\u6362\u53d6\u8fd0\u884c\u6548\u7387</li> <li>\u5b8f\u5b9a\u4e49\u6ca1\u6709\u7c7b\u578b\u68c0\u67e5\uff0c\u8fd9\u70b9\u6a21\u677f\u6bd4\u8f83\u597d</li> <li>\u6a21\u677f\u867d\u7136\u4f1a\u5ef6\u957f\u7f16\u8bd1\u65f6\u95f4\uff0c\u4f46\u5f53\u7f16\u8bd1\u671f\u5b9e\u4f8b\u5316\u7c7b\u578b\u540e\uff0c\u67e5\u627e\u6a21\u677f\u51fd\u6570\u548c\u67e5\u627e\u666e\u901a\u51fd\u6570\u7684\u901f\u5ea6\u51e0\u4e4e\u76f8\u540c</li> </ol>","tags":["c/cpp","template programing"]},{"location":"blog/%E6%A8%A1%E6%9D%BF%E7%BC%96%E7%A8%8B/#dependent-name","title":"\u5f85\u51b3\u540ddependent name","text":"<ol> <li>\u5f85\u51b3\u540d\u7684\u610f\u601d\u662f\u5728\u5b9a\u4e49\u7684\u5730\u65b9\uff0c\u7c7b\u578b\u8fd8\u4e0d\u80fd\u51b3\u65ad\uff0c\u9700\u8981\u5ef6\u540e\u5230\u5b9e\u4f8b\u5316\u786e\u5b9a\u65f6\u3002\u800c\u975e\u5f85\u51b3\u540d\u6307\u7c7b\u578b\u5728\u5b9a\u4e49\u7684\u5730\u65b9\u5df2\u7ecf\u786e\u5b9a\u3002  </li> <li>\u5ef6\u540e\u5c06\u5bfc\u81f4\u6b64\u65f6\u65e0\u6cd5\u5728\u5b9a\u4e49\u70b9\u8fdb\u884c\u9519\u8bef\u68c0\u67e5\uff0c\u4ee5\u53ca\u6d88\u9664<code>typename</code>\u548c<code>template</code>\u6b67\u4e49\uff0c\u8fd9\u5bfc\u81f4\u9700\u8981\u5728\u8c03\u7528\u70b9\u52a0\u4e0atemplate</li> </ol> <p>\u5f85\u51b3\u540d\u5982: <pre><code>template&lt;typename T&gt;\nstruct X : B&lt;T&gt; // \"B&lt;T&gt;\" \u53d6\u51b3\u4e8e T\n{\n    typename T::A* pa; // \"T::A\" \u53d6\u51b3\u4e8e T\n                       // \uff08\u6b64 \"typename\" \u7684\u4f7f\u7528\u7684\u76ee\u7684\u89c1\u4e0b\u6587\uff09\n    void f(B&lt;T&gt;* pb)\n    {\n        static int i = B&lt;T&gt;::i; // \"B&lt;T&gt;::i\" \u53d6\u51b3\u4e8e T\n        pb-&gt;j++; // \"pb-&gt;j\" \u53d6\u51b3\u4e8e T\n    }\n};\n</code></pre></p> <p>\u8ba9\u4eba\u5403\u60ca\u7684\u4f8b\u5b50, \u8fd9\u5c31\u662f\u975e\u5f85\u51b3\u540d\u7684\u60c5\u51b5\u4e0b\uff0c\u7acb\u5373\u7ed1\u5b9a <pre><code>#include &lt;iostream&gt;\n\nvoid g(double) { std::cout &lt;&lt; \"g(double)\\n\"; }\n\ntemplate&lt;class T&gt;\nstruct S\n{\n    void f() const\n    {\n        g(1); // \"g\" \u662f\u975e\u5f85\u51b3\u540d\uff0c\u73b0\u5728\u7ed1\u5b9a\n    }\n};\n\nvoid g(int) { std::cout &lt;&lt; \"g(int)\\n\"; }\n\nint main()\n{\n    g(1);  // \u8c03\u7528 g(int)\n\n    S&lt;int&gt; s;\n    s.f(); // \u8c03\u7528 g(double)\n}\n</code></pre></p>","tags":["c/cpp","template programing"]},{"location":"blog/%E6%A8%A1%E6%9D%BF%E7%BC%96%E7%A8%8B/#typename","title":"typename\u6d88\u6b67\u4e49","text":"<p>\u5728\u6a21\u677f\uff08\u5305\u62ec\u522b\u540d\u6a21\u7248\uff09\u7684\u58f0\u660e\u6216\u5b9a\u4e49\u4e2d\uff0c\u4e0d\u662f\u5f53\u524d\u5b9e\u4f8b\u5316\u7684\u6210\u5458\u4e14\u53d6\u51b3\u4e8e\u67d0\u4e2a\u6a21\u677f\u5f62\u53c2\u7684\u540d\u5b57\u4e0d\u4f1a\u88ab\u8ba4\u4e3a\u662f\u7c7b\u578b\uff0c \u9664\u975e\u4f7f\u7528\u5173\u952e\u8bcd typename \u6216\u5b83\u5df2\u7ecf\u88ab\u8bbe\u7acb\u4e3a\u7c7b\u578b\u540d\uff08\u4f8b\u5982\u7528 typedef \u58f0\u660e\u6216\u901a\u8fc7\u7528\u4f5c\u57fa\u7c7b\u540d\uff09\u3002 </p> <pre><code>#include &lt;iostream&gt;\n#include &lt;vector&gt;\n\nint p = 1;\n\ntemplate&lt;typename T&gt;\nvoid foo(const std::vector&lt;T&gt; &amp;v)\n{\n    // std::vector&lt;T&gt;::const_iterator \u662f\u5f85\u51b3\u540d\uff0c\n    typename std::vector&lt;T&gt;::const_iterator it = v.begin();\n\n    // \u4e0b\u5217\u5185\u5bb9\u56e0\u4e3a\u6ca1\u6709 'typename' \u800c\u4f1a\u88ab\u89e3\u6790\u6210\n    // \u7c7b\u578b\u5f85\u51b3\u7684\u6210\u5458\u53d8\u91cf 'const_iterator' \u548c\u67d0\u53d8\u91cf 'p' \u7684\u4e58\u6cd5\u3002\n    // \u56e0\u4e3a\u5728\u6b64\u5904\u6709\u4e00\u4e2a\u53ef\u89c1\u7684\u5168\u5c40 'p'\uff0c\u6240\u4ee5\u6b64\u6a21\u677f\u5b9a\u4e49\u80fd\u7f16\u8bd1\u3002\n    std::vector&lt;T&gt;::const_iterator* p; \n\n    typedef typename std::vector&lt;T&gt;::const_iterator iter_t;\n    iter_t * p2; // iter_t \u662f\u5f85\u51b3\u540d\uff0c\u4f46\u5df2\u77e5\u5b83\u662f\u7c7b\u578b\u540d\n}\n\ntemplate&lt;typename T&gt;\nstruct S\n{\n    typedef int value_t; // \u5f53\u524d\u5b9e\u4f8b\u5316\u7684\u6210\u5458\n    void f()\n    {\n        S&lt;T&gt;::value_t n{}; // S&lt;T&gt; \u5f85\u51b3\uff0c\u4f46\u4e0d\u9700\u8981 'typename'\n        std::cout &lt;&lt; n &lt;&lt; '\\n';\n    }\n};\n\nint main()\n{\n    std::vector&lt;int&gt; v;\n    foo(v); // \u6a21\u677f\u5b9e\u4f8b\u5316\u5931\u8d25\uff1a\u7c7b\u578b std::vector&lt;int&gt; \u4e2d\u6ca1\u6709\n            // \u540d\u5b57\u662f 'const_iterator' \u7684\u6210\u5458\u53d8\u91cf\n    S&lt;int&gt;().f();\n}\n</code></pre>","tags":["c/cpp","template programing"]},{"location":"blog/%E6%A8%A1%E6%9D%BF%E7%BC%96%E7%A8%8B/#template","title":"template\u6d88\u6b67\u4e49","text":"<p>\u4e0e\u6b64\u76f8\u4f3c\uff0c\u6a21\u677f\u5b9a\u4e49\u4e2d\u4e0d\u662f\u5f53\u524d\u5b9e\u4f8b\u5316\u7684\u6210\u5458\u7684\u5f85\u51b3\u540d\u540c\u6837\u4e0d\u88ab\u8ba4\u4e3a\u662f\u6a21\u677f\u540d\uff0c\u9664\u975e\u4f7f\u7528\u6d88\u6b67\u4e49\u5173\u952e\u8bcd template\uff0c\u6216\u5b83\u5df2\u88ab\u8bbe\u7acb\u4e3a\u6a21\u677f\u540d\uff1a </p> <p><pre><code>template&lt;typename T&gt;\nstruct S\n{\n    template&lt;typename U&gt; void foo() {}\n};\n\ntemplate&lt;typename T&gt;\nvoid bar()\n{\n    S&lt;T&gt; s;\n    s.foo&lt;T&gt;();          // \u9519\u8bef\uff1a&lt; \u88ab\u89e3\u6790\u4e3a\u5c0f\u4e8e\u8fd0\u7b97\u7b26\n    s.template foo&lt;T&gt;(); // OK\n}\n</code></pre> template \u6d88\u6b67\u4e49\u53ef\u4ee5\u4f7f\u7528 <pre><code>T::template\ns.template\nthis-&gt;template\n</code></pre></p>","tags":["c/cpp","template programing"]},{"location":"blog/%E6%A8%A1%E6%9D%BF%E7%BC%96%E7%A8%8B/#stdforward","title":"std::forward \u8f6c\u53d1\u5728\u6a21\u7248\u7684\u4f7f\u7528","text":"<p>\u4e3a\u4ec0\u4e48\u5b8c\u7f8e\u8f6c\u53d1\u7684\u5bf9\u8c61\u5fc5\u987b\u662f\u53f3\u503c\u5f15\u7528\uff1f</p>","tags":["c/cpp","template programing"]},{"location":"blog/%E6%A8%A1%E6%9D%BF%E7%BC%96%E7%A8%8B/#_13","title":"\u8bf4\u660e\u4e00\u4e0b\u53f3\u503c\u5f15\u7528","text":"<pre><code> \u5f15\u7528\u7c7b\u578b   \u53ef\u4ee5\u5f15\u7528\u7684\u503c\u7c7b\u578b    \u4f7f\u7528\u573a\u666f\n\u975e\u5e38\u91cf\u5de6\u503c   \u5e38\u91cf\u5de6\u503c    \u975e\u5e38\u91cf\u53f3\u503c   \u5e38\u91cf\u53f3\u503c\n\u975e\u5e38\u91cf\u5de6\u503c\u5f15\u7528     Y   N   N   N   \u65e0\n\u5e38\u91cf\u5de6\u503c\u5f15\u7528  Y   Y   Y   Y   \u5e38\u7528\u4e8e\u7c7b\u4e2d\u6784\u5efa\u62f7\u8d1d\u6784\u9020\u51fd\u6570\n\u975e\u5e38\u91cf\u53f3\u503c\u5f15\u7528     N   N   Y   N   \u79fb\u52a8\u8bed\u4e49\u3001\u5b8c\u7f8e\u8f6c\u53d1\n\u5e38\u91cf\u53f3\u503c\u5f15\u7528  N   N   Y   Y   \u65e0\u5b9e\u9645\u7528\u9014\n</code></pre>","tags":["c/cpp","template programing"]},{"location":"blog/%E6%A8%A1%E6%9D%BF%E7%BC%96%E7%A8%8B/#_14","title":"\u53c2\u8003","text":"<p>https://en.cppreference.com/w/cpp/language/parameter_pack https://en.cppreference.com/w/cpp/language/fold https://en.cppreference.com/w/cpp/language/overload_resolution#Best_viable_function</p>","tags":["c/cpp","template programing"]},{"location":"blog/c-%E5%B0%8F%E6%8A%80%E5%B7%A7/","title":"C++ \u5c0f\u6280\u5de7","text":"","tags":["c/cpp"]},{"location":"blog/c-%E5%B0%8F%E6%8A%80%E5%B7%A7/#lambda-const","title":"\u4f7f\u7528lambda \u5b9a\u4e49\u4e00\u4e2a\u53ef\u53d8\u7684const","text":"<p>\u56e0\u4e3aconst \u4e0d\u80fd\u6539\u53d8\u7684\uff0c\u53ea\u6709\u5728\u7a0b\u5e8f\u8fd0\u884c\u7684\u65f6\u5019\u521d\u59cb\u5316\u3002 \u800c\u901a\u8fc7lamda\uff0c\u53ef\u4ee5\u901a\u8fc7\u83b7\u53d6\u547d\u4ee4\u884c\u8f93\u5165\u6765\u6539\u53d8\u503c</p> <pre><code>const int x = []() -&gt; int {\n        int t;\n        std::cin &gt;&gt; t;\n        return t;\n}();\n</code></pre>","tags":["c/cpp"]},{"location":"blog/crash-boot/","title":"\u524d\u8a00","text":"<p>\u5143\u65e6\u8fc7\u5b8c\u56de\u516c\u53f8\u53d1\u73b0archlinux \u7cfb\u7edf\u65e0\u6cd5\u542f\u52a8\u4e86\uff0c \u63d0\u793a\u6ca1\u6709\u627e\u5230\u5185\u6838\u4e4b\u7c7b\u7684\u9519\u8bef\u3002 \u867d\u7136\u4e5f\u6ca1\u6709\u627e\u5230\u6839\u672c\u539f\u56e0\uff0c\u53ea\u77e5\u9053\u662f\u5185\u6838\u955c\u50cf\u4e22\u5931\u4e86\uff0c \u8fd9\u91cc\u8bb0\u4e00\u4e0b\u89e3\u51b3\u529e\u6cd5</p>","tags":["grub","linux"]},{"location":"blog/crash-boot/#_2","title":"\u73b0\u8c61","text":"<p>\u542f\u52a8\u4e4b\u540e\uff0c \u63d0\u793a\u7f3a\u5c11\u5185\u6838\uff0c \u9700\u8981\u5148\u6307\u5b9a\u5185\u6838\u3002 \u56de\u8f66\u540e\u8fdb\u5165grub \u754c\u9762\u3002 \u5728grub \u754c\u9762\u53ef\u4ee5\u6267\u884cls (hd,gpt)/ \u6765\u67e5\u770b\u5206\u533a\u7684\u6587\u4ef6 hd0\u3001 hd1 \u4ee3\u8868\u7684\u786c\u76d8\u7f16\u53f7\uff0c gpt1\u3001 gpt2\u3001 gpt3 \u4ee3\u8868\u5206\u533a\uff0c ls (hd0, gpt1)/ \u8868\u793a\u67e5\u770b\u7b2c\u4e00\u4e2a\u786c\u76d8\u7b2c\u4e00\u4e2a\u5206\u533a\u7684\u6587\u4ef6</p> <pre><code>ls (hd1, gpt2)\nEFI  grub  initramfs-linux-fallback.img\n</code></pre> <p>\u6211\u7684boot\u5206\u533a\u662f\u7b2c\u4e8c\u4e2a\u786c\u76d8\u7684\u7b2c\u4e8c\u4e2a\u5206\u533a\uff0c \u53ef\u89c1\u786e\u5b9e\u6ca1\u6709 vmlinuz-linux \u6587\u4ef6\uff0c\u4e5f\u5f88\u5947\u602a</p>","tags":["grub","linux"]},{"location":"blog/crash-boot/#_3","title":"\u89e3\u51b3\u529e\u6cd5","text":"<p>\u6ca1\u6709 'vmlinuz-linux' \u6587\u4ef6\u7684\u8bdd\u9700\u8981\u901a\u8fc7archlinux\u7684U\u76d8\u542f\u52a8\u76d8\u542f\u52a8\uff0c \u6302\u8f7d\u5206\u533a\u540e\uff0carch-chroot \u8fdb\u5165\u5230\u574f\u7cfb\u7edf  </p> <p>\u6267\u884c\u91cd\u88c5linux  <pre><code>pacman -S linux\n</code></pre> \u6267\u884cgrub \u76f8\u5173\u547d\u4ee4\uff0c \u91cd\u5efa\u5f15\u5bfc\u914d\u7f6e\u3002 \u6211\u7684EFI\u5355\u72ec\u5206\u533a\u4e86</p> <pre><code>grub-install --target=x86_64-efi --efi-directory=/boot/EFI --bootloader-id=Arch\ngrub-config -o /boot/grub/grub.cfg\n</code></pre> <p><code>exit</code>\u9000\u51fa\u574f\u7cfb\u7edf\uff0cumount \u518d\u91cd\u542f\u3002 \u4e00\u5b9a\u8981umount \u5206\u533a\u5426\u5219grub\u4e0d\u4f1a\u751f\u6548</p>","tags":["grub","linux"]},{"location":"blog/crash-boot/#umount-grub","title":"\u6ca1\u6709umount \u5bfc\u81f4\u7684grub\u4e0d\u751f\u6548","text":"<p>\u56e0\u4e3a\u6ca1\u6709umount\uff0c<code>exit</code>\u540e\u76f4\u63a5\u91cd\u542f\uff0c \u53d1\u73b0\u4f9d\u65e7\u65e0\u6cd5\u8fdb\u5165\u7cfb\u7edf\uff0c\u8fd8\u662f\u8fdb\u5165\u4e86grub\u754c\u9762\uff0c\u597d\u5728linux\u5185\u6838\u955c\u50cf\u5df2\u7ecf\u5b58\u5728\u4e86\uff0c\u53ef\u4ee5\u901a\u8fc7grub\u6765\u914d\u7f6e\u542f\u52a8 \u6240\u4ee5\u8fd9\u79cd\u60c5\u51b5\u4e5f\u9002\u7528\u4e8e\u7cfb\u7edfok\uff0c\u4f46\u5f15\u5bfc\u635f\u574f\u7684\u60c5\u51b5\u3002</p>","tags":["grub","linux"]},{"location":"blog/crash-boot/#_4","title":"\u89e3\u51b3\u529e\u6cd5","text":"<p>\u6211\u7684boot\u5206\u533a\u662f(hd1,gpt2)</p> <p>\u6267\u884c\u4e00\u4e0b <pre><code>set prefix=(hd1,gpt2)/grub/  # \u6307\u5b9a\u5b9e\u9645\u7684grub\u76ee\u5f55\nset root=(hd1,gp2)\ninsmod normal\nnormal\n</code></pre></p> <p>\u6b64\u65f6grub\u4f1a\u5237\u65b0\uff0c \u7ee7\u7eed\u6267\u884c <pre><code>insmod linux\nlinux /vmlinuz-linux root=/dev/nvme0n1p2   # \u8bbe\u7f6e\u5185\u6838\ninitrd /initd.img\nboot\n</code></pre></p> <p>\u7531\u4e8e\u4e0d\u77e5\u9053nvme\u7684\u547d\u540d\u65b9\u5f0f\uff0c\u5bfc\u81f4\u4e5f\u633a\u9ebb\u70e6\uff0c grub\u4e0b\u53ef\u4ee5\u770b\u5230uuid,\u4f46\u4e0d\u80fd\u770b\u5230\u5206\u533a\u540d\u79f0\uff0c \u540e\u6765\u53d1\u73b0\u53ef\u4ee5\u901a\u8fc7uuid\u65b9\u5f0f\u6307\u5b9aroot <pre><code>insmod linux\nlinux /vmlinuz root=UUID=xxxxxxxxxxx\ninitrd /initd.img\nboot\n</code></pre></p>","tags":["grub","linux"]},{"location":"blog/crash-boot/#_5","title":"\u6269\u5145","text":"<p>\u540c\u6837\u53ef\u4ee5\u901a\u8fc7\u78c1\u76d8+\u5206\u533a\u7684\u65b9\u5f0f\u6307\u5b9a\u5185\u6838\u548cinitrd</p>","tags":["grub","linux"]},{"location":"blog/%E5%9C%A8%E6%96%87%E4%BB%B6%E7%B3%BB%E7%BB%9F%E4%B9%8B%E4%B8%8A%E5%86%8D%E5%88%9B%E4%B8%80%E4%B8%AA%E6%96%87%E4%BB%B6%E7%B3%BB%E7%BB%9F/","title":"\u5728\u6587\u4ef6\u7cfb\u7edf\u4e4b\u4e0a\u518d\u521b\u4e00\u4e2a\u6587\u4ef6\u7cfb\u7edf","text":"<p>\u4f8b\u5982\u5728ext3\u7684\u6587\u4ef6\u7cfb\u7edf\u4e0a\u521b\u5efa\u4e00\u4e2axfs\u7684\u6587\u4ef6\u7cfb\u7edf\uff0c\u53ef\u4ee5\u901a\u8fc7\u56de\u73af\u8bbe\u5907loop\uff0c \u6211\u4eec\u7ecf\u5e38\u901a\u8fc7 <code>mount -o loop</code> \u6765 mount\u4e00\u4e2aiso\u6587\u4ef6 \u4f46mount \u7684\u9009\u9879\u603b\u662fro\u7684</p> <pre><code>mount: /mnt: WARNING: device write-protected, mounted read-only.\n</code></pre> <p>\u4e0d\u4ec5\u5982\u6b64\uff0c \u5148\u5728\u5f53\u524d\u6587\u4ef6\u7cfb\u7edfdd\u51fa\u4e00\u4e2a\u6587\u4ef6\uff0c \u518d\u7ed1\u5b9a\u5230loop\u8bbe\u5907\u4e0a\uff0c\u7136\u540emount \u5230\u67d0\u4e2a\u76ee\u5f55\u540e\uff0c \u53ef\u4ee5\u8fdb\u884c<code>\u8bfb\u5199</code>\u8bbf\u95ee</p> <p><pre><code>[root@ha1 ~]# dd if=/dev/urandom of=file bs=1M count=2\n2+0 records in\n2+0 records out\n2097152 bytes (2.1 MB, 2.0 MiB) copied, 0.0164121 s, 128 MB/s\n\n[root@ha1 ~]# mkfs.ext3  file \nmke2fs 1.44.6 (5-Mar-2019)\nDiscarding device blocks: done                            \nCreating filesystem with 2048 1k blocks and 256 inodes\n\nAllocating group tables: done                            \nWriting inode tables: done                            \nCreating journal (1024 blocks): done\nWriting superblocks and filesystem accounting information: done\n\n[root@ha1 ~]# mount -o loop file  /mnt\n[root@ha1 ~]# ls /mnt/\nlost+found\n\n[root@ha1 mnt]# echo abc &gt; abc\n[root@ha1 mnt]# ls\nabc  lost+found\n</code></pre> \u7ed1\u5b9aloop\u8bbe\u5907\u548c\u6302\u8f7d\u662f\u7531mount \u4e00\u4e2a\u547d\u4ee4\u5b8c\u6210\u7684\u3002</p>","tags":["filesystem","linux"]},{"location":"blog/%E5%9C%A8%E6%96%87%E4%BB%B6%E7%B3%BB%E7%BB%9F%E4%B9%8B%E4%B8%8A%E5%86%8D%E5%88%9B%E4%B8%80%E4%B8%AA%E6%96%87%E4%BB%B6%E7%B3%BB%E7%BB%9F/#loop","title":"\u624b\u52a8\u7ed1\u5b9aloop","text":"<p><pre><code>[root@ha1 ~]# losetup -f\n/dev/loop1\n\n[root@ha1 ~]# losetup -f file \n</code></pre> \u8fd9\u6837\u53ea\u662f\u5c06\u6587\u4ef6\u7ed1\u5b9a\u4e86loop\u8bbe\u5907\uff0c\u9700\u8981\u518d\u6302\u8f7d\u5230\u6587\u4ef6\u76ee\u5f55<code>mount /dev/loop0 /mnt</code></p> <pre><code>[root@ha1 ~]# ls /mnt/\nabc  lost+found\n[root@ha1 ~]# \n</code></pre> <p>losetup -f \u53ef\u4ee5\u8fd4\u56de\u7b2c\u4e00\u4e2a\u672a\u88ab\u4f7f\u7528\u7684loop\u8bbe\u5907\u540d</p>","tags":["filesystem","linux"]},{"location":"blog/%E5%9C%A8%E6%96%87%E4%BB%B6%E7%B3%BB%E7%BB%9F%E4%B9%8B%E4%B8%8A%E5%86%8D%E5%88%9B%E4%B8%80%E4%B8%AA%E6%96%87%E4%BB%B6%E7%B3%BB%E7%BB%9F/#loop_1","title":"\u521b\u5efaloop\u8bbe\u5907","text":"<p>\u6709\u7684\u7cfb\u7edf\u9ed8\u8ba4\u521b\u5efa\u4e86 loop0 .. loop7 \u7684\u5757\u8bbe\u5907\uff0c\u6709\u7684\u5219\u662f\u5728\u9700\u8981\u7684\u65f6\u5019\u521b\u5efa\uff0c\u6bd4\u5982mount iso\u7684\u65f6\u5019\u53d1\u73b0\u6ca1\u6709loop\u8bbe\u5907\uff0c\u5219\u4f1a\u521b\u5efa</p> <ol> <li>\u624b\u52a8\u521b\u5efaloop\u8bbe\u5907\u901a\u8fc7 <code>mknode</code> \u521b\u5efa</li> </ol> <pre><code>mknode  /dev/loop0 b 7 0\nmknode  /dev/loop1 b 7 0\n...\n\nmknode /dev/loop7 b 7 0\n</code></pre> <ol> <li>\u5982\u679c8\u4e2aloop0 .. loop8 \u8bbe\u5907\u90fd\u5360\u7528\u4e86\uff0c \u53ef\u4ee5\u518d\u521b\u5efaloop8</li> </ol> <p><pre><code>$sudo mknod /dev/loop8 b 7 8 \n\n$ls -l /dev/loop8\nbrw-r--r-- 1 root root 7, 8 Jun 11 19:16 /dev/loop8\n</code></pre> ps\uff1a /dev/loop* \u662f\u5757\u8bbe\u5907</p>","tags":["filesystem","linux"]},{"location":"blog/linux%E5%AE%9A%E6%97%B6%E5%99%A8/","title":"Linux\u5b9a\u65f6\u5668","text":"<p>https://www.computerhope.com/unix/ucrontab.htm#command-entries</p>","tags":["linux"]},{"location":"blog/linux%E5%AE%9A%E6%97%B6%E5%99%A8/#systemd-run","title":"\u4f7f\u7528systemd-run \u66ff\u6362","text":"<pre><code># systemd-run --on-active=30 /bin/touch /tmp/foo\n# systemd-run --on-active=\"12h 30m\" --unit some-unit.service\n</code></pre>","tags":["linux"]},{"location":"blog/defualt-route-in-linux/","title":"defualt route in linux","text":"<p>\u9ed8\u8ba4\u8def\u7531\u975e\u5e38\u91cd\u8981\uff0c\u5f53\u5bf9\u7aef\u5730\u5740\u5728\u8def\u7531\u8868\u4e2d\u67e5\u4e0d\u5230\u4ece\u54ea\u4e2a\u7f51\u53e3\u51fa\u53bb\u65f6\uff0c\u5c31\u8d70\u9ed8\u8ba4\u8def\u7531\u5bf9\u5e94\u7684\u7f51\u5361\u3002</p>","tags":["network","route"]},{"location":"blog/defualt-route-in-linux/#_1","title":"\u5373\u4f7f\u662f\u53ea\u6709\u4e00\u5f20\u7f51\u5361\uff0c\u4e5f\u5e94\u8be5\u914d\u9ed8\u8ba4\u8def\u7531","text":"<p>\u6700\u8fd1\u9047\u5230\u95ee\u9898\uff0c\u4f7f\u7528\u547d\u4ee4<code>ip addr add 10.9.3.211/24 dev enp1s0</code>\u7ed9\u865a\u62df\u673a\u52a0ip\u540e\uff0c\u8def\u7531\u8868\u5982\u4e0b: <pre><code>#ip route\n10.9.3.0/24 dev enp1s0 proto kernel scope link src 10.9.3.211 \n</code></pre> \u80fdping\u7f51\u5173\u548c\u5176\u4ed6\u540c\u7f51\u6bb5\u4e3b\u673a\uff0c\u4f46ping\u4e0d\u540c\u5176\u4ed6\u7f51\u6bb5\u7684\u4e3b\u673a\uff0c\u663e\u793a'network unreachable'\uff0c \u53cd\u5411\u4e5f\u4e0d\u884c\u3002\u4f7f\u7528\u547d\u4ee4<code>ip route add default via 10.9.3.1 dev enp1s0</code>\u914d\u7f6e\u9ed8\u8ba4\u8def\u7531\uff0c\u95ee\u9898\u5c31\u89e3\u51b3\u4e86\u3002\u800c\u901a\u8fc7\u7f51\u5361\u914d\u7f6e\u548c\u7f51\u5361\u542f\u52a8\u811a\u672c\u4f8b\u5982<code>ifup</code>\uff0c\u6216\u8005\u7f51\u7edc\u7ba1\u7406\u5de5\u5177NetworkManager\uff0c\u662f\u4f1a\u81ea\u52a8\u6dfb\u52a0\u9ed8\u8ba4\u8def\u7531\u7684\uff0c\u6240\u4ee5\u4e0d\u5b58\u5728\u8fd9\u4e2a\u95ee\u9898\u3002</p>","tags":["network","route"]},{"location":"blog/defualt-route-in-linux/#1metric","title":"\u62d3\u5c551\uff0c\u8def\u7531Metric","text":"<p>\u6240\u6709\u5339\u914d\u4e0d\u5230\u7684\u5305\u5c31\u8d70\u9ed8\u8ba4\u8def\u7531\u6307\u5b9a\u7684\u7f51\u5173\uff0c\u5982\u679c\u5b58\u5728\u591a\u4e2a\u7f51\u5361\uff0c\u53ef\u4ee5\u6709\u591a\u4e2a\u9ed8\u8ba4\u8def\u7531\u5982\u4e0b\uff0c\u8fd9\u65f6\u5019\u9760metric\u6765\u6307\u5b9a\u4f18\u5148\u7ea7\uff0cmetric\u5728\u914d\u7f6e\u91cc\u6307\u5b9a</p> <p><pre><code>default via 10.14.160.1 dev enp1s0 proto static metric 90 \ndefault via 10.14.162.1 dev enp10s0 proto static metric 100 \ndefault via 10.14.161.1 dev enp9s0 proto static metric 100 \n</code></pre> \u8fd9\u65f610.14.160.0/24\u7f51\u6bb5\u7684\u5305\u8d70enp1s0\uff0c10.14.162.0/24\u8d70enp10s0\uff0c 10.14.161.0/24\u8d70enp9s0\uff0c\u56e0\u4e3aenp1s0\u7684metric\u6700\u5c0f\uff0c\u4f18\u5148\u7ea7\u6700\u9ad8\uff0c\u5176\u4ed6\u7f51\u6bb5\u7684\u5305\u8d70enp1s0\u3002  </p>","tags":["network","route"]},{"location":"blog/defualt-route-in-linux/#_2","title":"\u624b\u52a8\u518d\u6dfb\u52a0\u8def\u7531\uff0c\u4f18\u5148\u7ea7\u6bd4\u9ed8\u8ba4\u8def\u7531\u9ad8","text":"<p>\u4f8b\u5982\u6307\u5b9a1.1.1.1\u8d70\u975e\u9ed8\u8ba4\u8def\u7531\uff0c <pre><code>ip route add 1.1.1.1 via 10.14.161.1 dev enp9s0 \n</code></pre> \u8fd9\u65f6ping 1.1.1.1\u5c31\u4e0d\u8d70\u9ed8\u8ba4\u8def\u7531\u4e86\u3002</p>","tags":["network","route"]},{"location":"blog/defualt-route-in-linux/#lookup","title":"lookup \u8bbe\u7f6e\u8868\u7684\u4f18\u5148\u7ea7","text":"<p>\u4e0a\u9762\u7684\u624b\u52a8\u6dfb\u52a0\u8def\u7531\u53ef\u4ee5\u6307\u5b9a\u975e3\u4e2a\u7f51\u6bb5\u7684\u5305\u8d70\u975e\u9ed8\u8ba4\u8def\u7531\uff0c\u4f46\u662f\u65e0\u6cd5\u8d85\u8d8a\u540c\u7f51\u6bb5\u7684\u4f18\u5148\u7ea7\uff0c\u610f\u601d\u5c31\u662f\u65e0\u6cd5\u6307\u5b9a10.14.161.0/24\u7684\u5305\u8d7010.14.160.1\u8fd9\u4e2a\u7f51\u5173\u3002\u8fd9\u65f6\u5c31\u9700\u8981\u521b\u5efa\u65b0\u7684\u8def\u7531\u8868\uff0c\u901a\u8fc7\u8868\u7684\u4f18\u5148\u7ea7\u6765\u5b9e\u73b0</p> <pre><code>echo \"200 custom1\" | sudo tee -a /etc/iproute2/rt_tables\nsudo ip route add 10.14.162.100 via 10.14.160.1 dev enp1s0 table custom1\nsudo ip rule add to 10.14.162.100 lookup custom1\n</code></pre> <p>\u4e0d\u8fc7\u4f3c\u4e4e\u5927\u90e8\u5206\u60c5\u51b5\u6ca1\u610f\u4e49\uff0c\u6211\u9047\u5230\u6709\u610f\u4e49\u7684\u60c5\u51b5\u662f\u4f7f\u7528\u4e86tailscale exit node\u65f6\uff0c\u6240\u6709\u5305\u90fd\u8d70\u4e86\u96a7\u9053\u3002\u5982\u679c\u5e0c\u671b\u672c\u5730\u67d0\u4e2a\u4e3b\u673a\u4e0d\u8d70\u96a7\u9053\uff0c\u5c31\u9700\u8981lookup \u81ea\u5b9a\u4e49\u8def\u7531\u8868\u3002</p>","tags":["network","route"]},{"location":"blog/docker-network/","title":"docker network","text":"<p>\u8bb0\u5f55\u4e00\u6b21docker\u7684\u7f51\u7edc\u95ee\u9898\uff0c\u4ee5\u53ca\u5b66\u5230\u7684\u77e5\u8bc6\u3002</p>","tags":["docker","network"]},{"location":"blog/docker-network/#_1","title":"\u80cc\u666f","text":"<p>\u516c\u53f8\u7528docker\u5bb9\u5668\u66ff\u4ee3\u865a\u62df\u673a\u6765\u9694\u79bb\uff0c\u7528\u6765ssh\u767b\u5f55\u4ee5\u53ca\u8fd0\u884c\u4e0d\u540c\u7684\u670d\u52a1\u3002\u5bb9\u5668\u8fde\u63a5\u4e86\u53cc\u7f51\u7edc\uff0c\u4e00\u4e2a\u7528\u6765\u8bbf\u95ee\u540c\u5bbf\u4e3b\u673a\u4e0a\u7684\u5bb9\u5668\uff0c\u53e6\u4e00\u4e2a\u7528\u6765\u4ece\u5176\u4ed6\u4e3b\u673a\u8bbf\u95ee\u3002</p>","tags":["docker","network"]},{"location":"blog/docker-network/#_2","title":"\u95ee\u9898","text":"<p>\u5bbf\u4e3b\u673a\u91cd\u542f\u4e4b\u540e\uff0c\u5bb9\u5668\u65e0\u6cd5\u8bbf\u95ee\u3002\u9700\u8981\u624b\u52a8\u6539\u8def\u7531\u3002</p>","tags":["docker","network"]},{"location":"blog/docker-network/#_3","title":"\u89e3\u51b3\u529e\u6cd5","text":"<p>\u6bcf\u6b21\u4fee\u6539\u8def\u7531\u9ebb\u70e6\uff0c\u540e\u9762\u53d1\u73b0\u4e24\u4e2a\u7f51\u7edc\u90fd\u662fmacvlan\u65f6\uff0c\u5b58\u5728\u65e0\u6cd5\u6ca1\u6709\u7f51\u7edc\u3002</p>","tags":["docker","network"]},{"location":"blog/docker-network/#_4","title":"\u521b\u5efa\u6865\u63a5\u7269\u7406\u7f51\u5361","text":"<p>\u8fd9\u662f\u9700\u8981\u6307\u5b9aparent\u4e3a\u7269\u7406\u7f51\u5361\uff0c\u65e2\u7136\u662f\u6865\u63a5\u7269\u7406\u7f51\u5361\uff0c\u5c31\u80fd\u4ece\u5176\u4ed6\u5bbf\u4e3b\u673a\u8bbf\u95ee\u4e86\u3002 <pre><code>docker network create -d bridge   --subnet=10.9.3.0/24   --gateway=10.9.3.1   -o parent=ens39f0 public_net_bridge\n</code></pre></p> <p><pre><code>docker network create -d macvlan  --subnet=10.9.3.0/24   --gateway=10.9.3.1   -o parent=ens39f0 public_net_macvlan\n</code></pre> \u8fd9\u4e24\u4e2a\u7531\u4e8e\u4f7f\u7528\u7684\u540c\u4e00\u4e2a\u7f51\u6bb5/\u7f51\u5361\uff0c\u6240\u4ee5\u4e0d\u53ef\u80fd\u540c\u65f6\u5b58\u5728\u3002\u4e5f\u8bb8\u53ef\u4ee5\u901a\u8fc7\u6307\u5b9a\u4e0d\u540c\u7684ip-range\u6765\u5b9e\u73b0\u5417\uff1f</p>","tags":["docker","network"]},{"location":"blog/docker-network/#_5","title":"\u521b\u5efa\u6865\u63a5\u865a\u62df\u7f51\u5361","text":"<p>\u8fd9\u79cd\u7f51\u7edc\u5c31\u4e0d\u80fd\u4ece\u975e\u5bbf\u4e3b\u673a\u7684\u5176\u4ed6\u4e3b\u673a\u8bbf\u95ee\uff0c\u53ea\u80fd\u5728\u540c\u5bbf\u673a\u4e0b\u7684\u5bb9\u5668\u4e4b\u95f4\u8bbf\u95ee\u3002\u6211\u79f0\u4e4b\u4e3a\u79c1\u6709\u7f51\u7edc  <pre><code>docker network create -d bridge   private_net_bridge\n</code></pre></p> <p><pre><code>docker network create -d macvlan  private_net_macvlan\n</code></pre> \u8fd9\u91cc\u6ca1\u6709\u6307\u5b9a\u7f51\u7edc\u5730\u5740</p>","tags":["docker","network"]},{"location":"blog/docker-network/#iperf","title":"iperf\u6d4b\u901f","text":"<p>\u53d1\u73b0\u65e0\u8bba\u6865\u63a5\u7269\u7406\u7f51\u5361\u8fd8\u662f\u865a\u62df\u7f51\u5361\uff0cmacvlan\u90fd\u8981\u6bd4bridge\u5feb</p> <ul> <li> <p>\u79c1\u6709\u7f51\u7edc bridge \u6a21\u5f0f\u5206\u522b\u6d4b\u5f97: 20.4 Gbits/sec 22.6 Gbits/sec 23.0 Gbits/sec macvlan \u6a21\u5f0f\u5206\u522b\u6d4b\u5f97: 26.1 Gbits/sec 24.4 Gbits/sec 26.7 Gbits/sec</p> </li> <li> <p>\u6865\u63a5\u7269\u7406\u7f51\u5361 macvlan: 25.7 Gbits/sec 25.5 Gbits/sec 27.3 Gbits/sec bridge: 20.2 Gbits/sec 20.4 Gbits/sec 23.2 Gbits/sec</p> </li> </ul>","tags":["docker","network"]},{"location":"blog/docker-network/#_6","title":"\u987a\u4fbf\u8bf4\u4e0b\u5bb9\u5668\u8fde\u63a5\u591a\u7f51\u7edc\u7684\u65b9\u6cd5","text":"<p>\u5bb9\u5668\u542f\u52a8\u7684\u65f6\u5019\uff0c\u53ea\u80fd\u6307\u5b9a\u4e00\u4e2a\u7f51\u7edc, \u7136\u540e\u542f\u52a8\u4e4b\u540e\uff0c\u53ef\u4ee5\u901a\u8fc7\u547d\u4ee4\u6765\u8fde\u63a5\u591a\u7f51\u7edc\uff0c\u53ef\u4ee5\u5728\u542f\u52a8\u65f6\u8bbe\u7f6e--restart=alway,\u8fd9\u6837\u91cd\u542f\u4e3b\u673a\u540e\u81ea\u52a8\u8fde\u63a5\u53cc\u7f51\u7edc <pre><code>docker network connect private_net_bridge test_container\n</code></pre></p>","tags":["docker","network"]},{"location":"blog/docker-network/#_7","title":"\u6742\u9879","text":"<p>\u7f51\u7edc\u914d\u7f6e\u633a\u590d\u6742\uff0cmacvlan \u4e0b\u9762\u8fd8\u5206 * Bridge mode, \u5c31\u662f\u5e38\u89c1\u7684\u6a21\u5f0f\uff0c\u8d70\u5bbf\u4e3b\u673a\u7684\u7f51\u5361 * 802.1q trunk bridge mode, \u5148\u5728\u7269\u7406\u7f51\u5361\u4e0a\u521b\u5efa\u5b50\u7f51\u5361</p>","tags":["docker","network"]},{"location":"blog/docker-network/#ipvlan","title":"IPvlan","text":"<p>\u9664\u4e86bridge macvlan\u4e4b\u5916\uff0c\u8fd8\u6709IPvlan, \u8fd9\u79cd\u6a21\u5f0f\u4e0b\uff0c\u6240\u6709\u7684\u5bb9\u5668\u90fd\u4f7f\u7528\u76f8\u540c\u7684mac\u5730\u5740\uff0c\u6240\u4ee5\u5982\u679c\u5bb9\u5668\u4f7f\u7528dhcp\u6765\u83b7\u53d6ip\u5730\u5740\uff0c\u5219\u53ef\u80fd\u6709\u95ee\u9898\u3002 \u8bbf\u95ee\u5176\u4ed6\u5bb9\u5668\u65f6\uff0c\u53ef\u4ee5\u914d\u7f6e\u6765\u4f7f\u7528macvlan\u6a21\u5f0f\u3002</p>","tags":["docker","network"]},{"location":"blog/docker-network/#overlay","title":"overlay","text":"<p>docker network driver \u9664\u4e86\u4e0a\u9762\u7684\u4e09\u79cd\u6a21\u5f0f\u4e4b\u5916\uff0c\u8fd8\u6709overlay, \u7528\u4e8e\u8fde\u63a5\u4e0d\u540c\u4e3b\u673a\u7684\u7f51\u7edc\uff0c\u53ef\u4ee5\u8de8\u5bbf\u4e3b\u673a\u8bbf\u95ee\u5bb9\u5668\u3002</p>","tags":["docker","network"]},{"location":"blog/docker-network/#_8","title":"\u5bbf\u4e3b\u673a\u7f51\u7edc\u7c7b\u578b","text":"<p>\u6211\u901a\u5e38\u4f1a\u521b\u5efabridge\u5e76\u5c06\u7269\u7406\u7f51\u5361\u8bbe\u4e3a\u4ece\u5361\uff0c\u7136\u540e\u521b\u5efa\u865a\u62df\u7f51\u6865\uff0c\u7528\u4e8e\u8bbf\u95ee\u865a\u62df\u673a\u3002\u800c\u9664\u4e86bridge, \u8fd8\u6709bond,\u53e6\u5916\u8fd8\u6709team\u3002\u603b\u800c\u8a00\u4e4b\uff0cbridge\u53ef\u4ee5\u4f7f\u4e0d\u540c\u7684\u865a\u62df\u673a\uff08client\uff09\u4f7f\u7528\u7f51\u5361\u7684\u865a\u62df\u5316\u529f\u80fd\uff0c\u800cbond\u53ef\u4ee5\u5c06\u4e0d\u540c\u7684\u7f51\u5361\u7ed1\u5b9a\uff0c\u5b9e\u73b0\u8d1f\u8f7d\u5747\u8861\u3002\u5982\u679c\u4e24\u4e2a\u7f51\u5361\u5206\u522b\u67091M\u5e26\u5bbd\uff0c\u90a3\u4e48bond\u540e\u7684\u7f51\u5361\u5219\u67092M\u5e26\u5bbd\u3002\u4e0b\u9762\u7684\u94fe\u63a5\u5148bonding,\u7136\u540e\u5728bonding\u7f51\u5361\u4e0a\u521b\u5efabridge\u7f51\u5361\u3002\u53c2\u8003</p>","tags":["docker","network"]},{"location":"blog/docker-overlay-filesystem/","title":"docker overlay filesystem","text":"<p>overlay \u662fdocker\u4f7f\u7528\u7684\u6587\u4ef6\u7cfb\u7edf\uff0c\u5177\u6709\u5206\u5c42\u7684\u7279\u70b9, docker\u4f7f\u7528\u7684\u6587\u4ef6\u7cfb\u7edf\u7ecf\u8fc7\u5f88\u591a\u53d8\u5316\uff0c\u800c\u4e14\u5404\u53d1\u884c\u7248\u53ef\u80fd\u4e0d\u540c\u3002 \u6267\u884c<code>docker info</code> \u67e5\u770b\u5f53\u524d\u4f7f\u7528\u7684\u662foverlay2</p> <pre><code>sudo docker info | grep -i storage                                                                                                                                              \n Storage Driver: overlay2\n</code></pre>","tags":["docker","filesystem"]},{"location":"blog/docker-overlay-filesystem/#_1","title":"\u5386\u53f2","text":"<p>\u9664\u4e86 overlay\uff0c\u7c7b\u4f3c\u6709rootfs\uff0c aufs \uff08ubuntu\uff09\uff0c devicemapper\uff08centos\uff09\uff0c\u4e0d\u591f\u6210\u719f\u7684btrfs</p> <p>\u4ed6\u4eec\u90fd\u67092\u4e2a\u76ee\u7684\uff1a 1. \u63d0\u4f9b\u4e0d\u542b\u5185\u6838\u7684\u6587\u4ef6\u7cfb\u7edf\uff08rootfs\uff09\u5373\u5bb9\u5668, \u5728\u5185\u6838\u4e4b\u4e0a\u3002\u8fd9\u662fdocker \u6700\u6709\u4ef7\u503c\u7684\u5730\u65b9\uff0c\u5c31\u662f\u65e0\u8bba\u5728\u90a3\u91cc\u8fd0\u884cdocker\uff0c \u5bb9\u5668\u91cc\u7684\u73af\u5883\u90fd\u662f\u4e00\u81f4\u7684 2. \u63d0\u4f9b\u5206\u5c42</p>","tags":["docker","filesystem"]},{"location":"blog/docker-overlay-filesystem/#overlay","title":"overlay\u7684\u4f18\u52bf","text":"<ol> <li>page caching\uff0c \u53ef\u4ee5\u5728\u591a\u4e2a\u4e0d\u540c\u5b9e\u4f8b\u4e4b\u95f4\u5171\u4eab</li> <li>\u5199\u65f6\u590d\u5236\uff0c \u53ea\u6709\u6267\u884cwrite\u64cd\u4f5c\u65f6\uff0c \u4f1a\u5c06lower layer \u7684\u6587\u4ef6\u590d\u5236\u5230container\u5c42</li> <li>\u4e0d\u540c\u5c42\u4e4b\u95f4\uff0c\u76f8\u540c\u6587\u4ef6\u4f7f\u7528\u786c\u8fde\u63a5\uff0c \u8282\u7701inode \u548c \u5927\u5c0f</li> </ol> <p>\u5199\u65f6\u590d\u5236 copy-up \u4f1a\u5bfc\u81f4\u7b2c\u4e00\u6b21\u5199\u65f6\u9020\u6210\u5ef6\u8fdf\uff0c\u7279\u522b\u662f\u5927\u6587\u4ef6\uff0c\u62f7\u8d1d\u8d77\u6765\u8d39\u65f6\u3002 \u4f46\u7b2c\u4e8c\u6b21\u5c31\u4e0d\u4f1a\u5ef6\u65f6\uff0c \u800c\u4e14overlay2 \u6709caching\uff0c \u76f8\u6bd4\u5176\u5b83\u6587\u4ef6\u7cfb\u7edf\uff0c\u66f4\u51cf\u5c11\u5ef6\u65f6</p>","tags":["docker","filesystem"]},{"location":"blog/docker-overlay-filesystem/#overlay_1","title":"overlay\u7684\u95ee\u9898","text":"<ol> <li>\u5b9e\u73b0\u4e0d\u591f\u5b8c\u5168\uff0c \u4f8b\u5982\u6ca1\u6709\u5b9e\u73b0uname </li> <li>\u5148\u53ea\u8bfb\u6253\u5f00\u4e00\u4e2a\u6587\u4ef6 open\uff08read\uff09\uff0c \u518d\u8bfb\u5199\u6253\u5f00\u76f8\u540c\u6587\u4ef6open\uff08write\uff09\uff0c \u4e24\u4e2afd \u4f1a\u5bf9\u5e942\u4e2a\u4e0d\u540c\u6587\u4ef6\uff0c \u7b2c\u4e00\u4e2a\u5bf9\u5e94\u7684lower\u7684\u6587\u4ef6\uff0c\u7b2c\u4e8c\u4e2a\u9020\u6210\u5199\u65f6\u590d\u5236\uff0c\u5bf9\u5e94\u5bb9\u5668\u91cc\u7684\u6587\u4ef6\u3002 </li> <li>\u89c4\u907f\u65b9\u6cd5\u662f\u5148\u6267\u884ctouch \u64cd\u4f5c\u3002 \u73b0\u5b9e\u7684\u4f8b\u5b50\u662f yum \u9700\u8981\u5b89\u88c5yum-plugin-ovl\u3002 \u4f46\u8fd9\u4e2a\u53ea\u67097.2\u624d\u652f\u6301\uff0c \u4e4b\u524d\u7684\u8bdd\u5c31\u9700\u8981\u5148<code>touch /var/lib/rpm/*</code></li> </ol>","tags":["docker","filesystem"]},{"location":"blog/docker-overlay-filesystem/#_2","title":"\u6700\u4f73\u5b9e\u8df5","text":"<ol> <li>\u4f7f\u7528ssd </li> <li>\u5bf9\u4e8e\u5199\u64cd\u4f5c\u6bd4\u8f83\u591a\u7684\u76ee\u5f55\uff0c \u4f7f\u7528\u6620\u5c04\u6587\u4ef6\u3002\u8fd9\u6837\u8df3\u8fc7\u4e86overlay\u7684\u590d\u6742\u64cd\u4f5c\uff0c\u76f4\u63a5\u4f7f\u7528\u4e3b\u673a\u7684\u6587\u4ef6\u7cfb\u7edf\u3002</li> </ol>","tags":["docker","filesystem"]},{"location":"blog/docker-overlay-filesystem/#_3","title":"\u5206\u5c42\u4ecb\u7ecd","text":"<p>\u6211\u7406\u89e3\u5c31\u662f\u5c06\u5206\u79bb\u7684\u591a\u4e2a\u76ee\u5f55\u6302\u8f7d\u5230\u4e00\u8d77\u7684\u6280\u672f\u3002 \u4f8b\u5982\u5bf9docker \u5bb9\u5668\u7684\u6587\u4ef6\u8fdb\u884c\u589e\u5220\u6539\u540e\uff0c\u518dcommit\uff0c \u4f1a\u591a\u4e00\u5c42layer\u3002  \u518d\u5f53docker \u5bb9\u5668\u542f\u52a8\u65f6\uff0c\u4f1a\u81ea\u52a8\u6302\u8f7d\u591a\u5c42layer\u3002  \u7ec4\u7ec7\uff1a overlay\u5bf9\u8fd0\u884c\u7684\u5b9e\u4f8b\u901a\u8fc7\u5143\u6570\u636e\u7ec4\u7ec7\u6587\u4ef6\uff0c \u662f\u5426\u662flink\u6587\u4ef6 </p> <pre><code>ls 04ea1faa8074e5862f40eecdba968bd9b7f222cb30e5bf6a0b9a9c48be0940f2/\ndiff  link  lower  merged  work\n</code></pre>","tags":["docker","filesystem"]},{"location":"blog/docker-overlay-filesystem/#mount","title":"\u624b\u52a8mount\u7684\u4f8b\u5b50","text":"<ol> <li>\u539f\u672c\u76ee\u5f55\uff0c\u6587\u4ef6\u90fd\u5206\u6563\u5728\u4e0d\u540c\u76ee\u5f55ABC <pre><code>.\n\u251c\u2500\u2500 A\n\u2502   \u251c\u2500\u2500 aa\n\u2502   \u2514\u2500\u2500 a.txt\n\u251c\u2500\u2500 B\n\u2502   \u251c\u2500\u2500 a.txt\n\u2502   \u2514\u2500\u2500 b.txt\n\u251c\u2500\u2500 C\n\u2502   \u2514\u2500\u2500 c.txt\n\u2514\u2500\u2500 worker\n    \u2514\u2500\u2500 work [error opening dir]\n</code></pre></li> <li>overlay \u6302\u8f7d\u5230/tmp/test\u76ee\u5f55 <code>sudo mount -t overlay overlay -o lowerdir=A:B,upperdir=C,workdir=worker /tmp/test/</code></li> <li>\u67e5\u770btest\u76ee\u5f55  <pre><code>/tmp/test/\n\u251c\u2500\u2500 aa\n\u251c\u2500\u2500 a.txt\n\u251c\u2500\u2500 b.txt\n\u2514\u2500\u2500 c.txt\n</code></pre> <pre><code>mount  | grep 'overlay'\noverlay on /tmp/test type overlay (rw,relatime,lowerdir=A:B,upperdir=C,workdir=worker)\n</code></pre></li> </ol>","tags":["docker","filesystem"]},{"location":"blog/docker-overlay-filesystem/#overlay_2","title":"overlay\u7684\u589e\u5220\u6539","text":"<p>\u5f53\u8fd0\u884cdocker\u5bb9\u5668\u65f6\u67e5\u770b\u6302\u8f7d</p> <p><pre><code>overlay on /var/lib/docker/overlay2/04ea1faa8074e5862f40eecdba968bd9b7f222cb30e5bf6a0b9a9c48be0940f2/merged type overlay \n(rw,relatime,\n    lowerdir=/var/lib/docker/overlay2/l/B74PWZCBMRCWXFH5UL2ZXB5WEU:/var/lib/docker/overlay2/l/WNHICVPVSDNUGSCZW435TPSMOK,\n    upperdir=/var/lib/docker/overlay2/04ea1faa8074e5862f40eecdba968bd9b7f222cb30e5bf6a0b9a9c48be0940f2/diff,\n    workdir=/var/lib/docker/overlay2/04ea1faa8074e5862f40eecdba968bd9b7f222cb30e5bf6a0b9a9c48be0940f2/work\n)\n</code></pre> docker \u5c06\u955c\u50cf\u7684\u6587\u4ef6\u6302\u8f7d\u4e3a\u53ea\u8bfb\uff0c \u5c06\u5bb9\u5668\u5c42\u6302\u8f7d\u4e3a\u53ef\u8bfb\u53ef\u5199\u3002 \u6587\u4ef6\u7cfb\u7edf\u53ef\u4ee5\u5206\u4e3a2\u90e8\u5206 upper\uff08\u5bb9\u5668\u5c42\uff09 + lower \uff08\u955c\u50cf\u5c42\uff09</p> <ul> <li>\u5f53\u5728\u5bb9\u5668\u91cc\u6267\u884c\u5199\u65f6\uff0c \u5982\u679c\u6587\u4ef6\u4e0d\u5b58\u5728\uff0c \u4f1a\u4f9d\u6b21\u904d\u5386lower\u3002\u5982\u679c\u90fd\u4e0d\u5b58\u5728\u5c31\u4f1a\u5728upper\u5c42\u521b\u5efa\u6587\u4ef6</li> <li>\u8bfb\u4e5f\u76f8\u540c</li> <li>\u5220\u9664\u65f6\u4f1a\u521b\u5efa\u4e00\u4e2awithout \u6765\u9690\u85cf\uff0c \u8fd9\u662f\u4e3a\u4ec0\u4e48\u5373\u4f7f\u5220\u9664\u5bb9\u5668\u91cc\u7684\u6587\u4ef6\uff0c \u955c\u50cf\u8fd8\u662f\u4f1a\u589e\u5927\u3002 </li> <li>\u5220\u9664\u76ee\u5f55\u60c5\u51b5\u4e5f\u5dee\u4e0d\u591a</li> </ul> <p>\u4f3c\u4e4e\u5f88\u5947\u602a\uff0c\u4e3a\u4ec0\u4e48\u591a\u4e86\u4e00\u4e2aworkdir,  \u636e\u8bf4\u8fd9\u4e2a\u76ee\u5f55\u603b\u662f\u7a7a\u7684\uff0c\u4e3a\u4e86\u5b9e\u73b0\u539f\u5b50\u64cd\u4f5c\u6dfb\u52a0\u548c\u5220\u9664\u6587\u4ef6</p>","tags":["docker","filesystem"]},{"location":"blog/docker-overlay-filesystem/#_4","title":"\u7279\u6b8a\u60c5\u51b5","text":"<p>\u5728\u4fee\u6539\u5bb9\u5668\u540e\uff0c \u5bb9\u5668\u7cfb\u7edf\u4f1a\u591a\u4e00\u5c42\uff0c \u91cc\u9762\u5305\u542b\u4e86\u4fee\u6539\u7684\u6587\u4ef6\uff0c\u4ee5\u53ca\u5220\u9664\u540e\u751f\u6210\u7684without\u6587\u4ef6\uff0c \u7136\u540e\u751f\u6210\u955c\u50cf</p> <p>\u4f46\u5bf9\u4e8e\u4ee5\u4e0b\u7279\u6b8a\u76ee\u5f55\u6587\u4ef6\u4e0d\u4f1a\u63d0\u4ea4\uff0c \u56e0\u4e3a\u8fd9\u4e9b\u6587\u4ef6\u662f\u8fd0\u884c\u65f6docker \u8981\u6839\u636e\u7528\u6237\u914d\u7f6e\u8fdb\u884c\u4fee\u6539\u7684\u3002  </p> <ol> <li>/etc/hostname </li> <li>/etc/hosts </li> <li>/etc/resov.conf</li> </ol> <p>\u4f8b\u5982docker \u7684link\u9009\u9879\uff0c\u4f1a\u5728\u5bb9\u5668\u7684hosts \u6587\u4ef6\u91cc\u5b9a\u4e49\u5bf9\u5e94\u7684\u5bb9\u5668\u540d-&gt;\u5bb9\u5668ip</p>","tags":["docker","filesystem"]},{"location":"blog/docker-storage/","title":"docker storage","text":"<p>docker \u67093\u79cd\u65b9\u5f0f\u4f7f\u7528\u7cfb\u7edf\u5b58\u50a8:</p> <ul> <li>bind:    \u5bbf\u4e3b\u673a\u76ee\u5f55\u6620\u5c04\u65b9\u5f0f\uff0c\u542f\u52a8\u5bb9\u5668\u547d\u4ee4\u6dfb\u52a0\u53c2\u6570<code>-v dir1:dir2</code>\u3002\u5c06\u5bbf\u4e3b\u673a\u7684\u76ee\u5f55dir1\u6302\u8f7d\u5230\u5bb9\u5668\u7684dir2\u76ee\u5f55\uff0c\u5b9e\u9645\u6267\u884c\u7684<code>mount -o bind</code>\u7c7b\u4f3c\u547d\u4ee4</li> <li>volume:    \u7531docker\u7ba1\u7406\u7684\u5b58\u50a8\uff0c\u5148\u521b\u5efa\u540e\u4f7f\u7528\uff0c\u4e14\u53ef\u4ee5\u5728\u591a\u4e2a\u5bb9\u5668\u4e2d\u5171\u4eab\uff0c\u662f\u5b98\u65b9\u63a8\u8350\u7684\u65b9\u5f0f</li> <li>tmpfs:    \u4f7f\u7528\u5bbf\u4e3b\u673a\u7684\u5185\u5b58\u4f5c\u4e3a\u5b58\u50a8\uff0c\u8fd9\u79cd\u4f7f\u7528\u5185\u5b58\u6587\u4ef6\u7cfb\u7edf\u6765\u6302\u8f7d\u5230\u5bb9\u5668\u76ee\u5f55, \u4f7f\u7528\u53c2\u6570<code>--mount type=tmpfs,destination=/dir</code>, tmpfs\u662f\u9000\u51fa\u5373\u91ca\u653e\u7684\u4e00\u79cd\u6587\u4ef6\u7cfb\u7edf</li> </ul>","tags":["docker"]},{"location":"blog/docker-storage/#docker","title":"docker\u4f7f\u7528\u7684\u6587\u4ef6\u7cfb\u7edf","text":"<p>docker\u4f7f\u7528\u7684\u6587\u4ef6\u7cfb\u7edf\u7ecf\u8fc7\u5f88\u591a\u53d8\u5316\uff0c\u800c\u4e14\u5728\u5404\u53d1\u884c\u7248\u4e0b\u53ef\u80fd\u4e0d\u540c\uff0c\u4f46\u76ee\u524d\u4e3b\u6d41\u7684\u662foverlay2\uff0c\u6267\u884c<code>docker info</code> \u67e5\u770b\u5f53\u524d\u4f7f\u7528\u7684\u662foverlay2 <pre><code>sudo docker info | grep  Storage                                                                                                                                              \n Storage Driver: overlay2\n</code></pre></p> <p>\u9664\u4e86overlay2\uff0c\u8fd8\u6709aufs\uff08ubuntu\uff09\uff0cdevicemapper\uff08centos\uff09\uff0cbtrfs\u548czfs\u3002\u4ed6\u4eec\u7684\u5b9e\u73b0\u90fd\u4e0d\u540c\uff0c\u90fd\u80fd\u652f\u6301\u5206\u5c42\u548c\u652f\u6301\u5199\u65f6\u590d\u5236\uff08Cow/copy-on-write\uff09\uff0c\u800c\u4ed6\u4eec\u5b9e\u73b0\u7684\u65b9\u5f0f\u6709\u533a\u522b\uff0c\u6240\u4ee5\u6548\u7387\u4e5f\u6709\u533a\u522b</p> <ul> <li>\u5206\u5c42\uff1a \u955c\u50cf\u90fd\u662f\u5206\u5c42\u7684\uff0c\u5728Dockerfile\u6784\u5efa\u65f6\uff0c\u6bcf\u6b21\u6267\u884cCOPY/RUN\u65f6\uff0c\u90fd\u4f1a\u589e\u52a0\u4e00\u5c42</li> <li>\u5199\u65f6\u590d\u5236: \u5728\u5bb9\u5668\u6216\u8005DockerFile\u6267\u884c\u4fee\u6539\u64cd\u4f5c\u65f6\uff0c\u5305\u62ec\u6743\u9650\u4fee\u6539\uff0c\u4f1a\u5c06lower layer \u7684\u6587\u4ef6\u590d\u5236\u5230container\u5c42\u518d\u4fee\u6539</li> </ul> <p>\u800c\u5bb9\u5668\u5c31\u662f\u5728\u955c\u50cf\u9876\u5c42<code>\u538b\u6808</code>\u4e86\u4e00\u4e2a<code>\u53ef\u5199</code>\u5c42\uff0c\u800c\u4e14\u662f\u4e34\u65f6\u7684\uff0c\u5f53\u5bb9\u5668\u9500\u6bc1\u65f6\uff0c\u8fd9\u5c42\u7684\u6587\u4ef6\u4e5f\u4f1a\u5220\u9664</p>","tags":["docker"]},{"location":"blog/docker-storage/#overlay","title":"overlay\u7684\u4f18\u52bf","text":"<ol> <li>page caching\uff0c \u53ef\u4ee5\u5728\u591a\u4e2a\u4e0d\u540c\u5b9e\u4f8b\u4e4b\u95f4\u5171\u4eab</li> <li>\u4e0d\u540c\u5c42\u4e4b\u95f4\uff0c\u76f8\u540c\u6587\u4ef6\u4f7f\u7528\u786c\u8fde\u63a5\uff0c \u8282\u7701inode \u548c \u5927\u5c0f</li> </ol> <p>\u5199\u65f6\u590d\u5236 copy-up \u4f1a\u5bfc\u81f4\u7b2c\u4e00\u6b21\u5199\u65f6\u9020\u6210\u5ef6\u8fdf\uff0c\u7279\u522b\u662f\u5927\u6587\u4ef6\uff0c\u62f7\u8d1d\u8d77\u6765\u8d39\u65f6\u3002 \u4f46\u7b2c\u4e8c\u6b21\u5c31\u4e0d\u4f1a\u5ef6\u65f6\uff0c \u800c\u4e14overlay2 \u6709caching\uff0c \u76f8\u6bd4\u5176\u5b83\u6587\u4ef6\u7cfb\u7edf\uff0c\u66f4\u51cf\u5c11\u5ef6\u65f6</p>","tags":["docker"]},{"location":"blog/docker-storage/#overlay_1","title":"overlay\u7684\u95ee\u9898","text":"<ol> <li>\u5b9e\u73b0\u4e0d\u591f\u5b8c\u5168\uff0c \u4f8b\u5982\u6ca1\u6709\u5b9e\u73b0uname </li> <li>\u5148\u53ea\u8bfb\u6253\u5f00\u4e00\u4e2a\u6587\u4ef6 open\uff08read\uff09\uff0c \u518d\u8bfb\u5199\u6253\u5f00\u76f8\u540c\u6587\u4ef6open\uff08write\uff09\uff0c \u4e24\u4e2afd \u4f1a\u5bf9\u5e942\u4e2a\u4e0d\u540c\u6587\u4ef6\uff0c \u7b2c\u4e00\u4e2a\u5bf9\u5e94\u7684lower\u7684\u6587\u4ef6\uff0c\u7b2c\u4e8c\u4e2a\u9020\u6210\u5199\u65f6\u590d\u5236\uff0c\u5bf9\u5e94\u5bb9\u5668\u91cc\u7684\u6587\u4ef6\u3002 </li> <li>\u89c4\u907f\u65b9\u6cd5\u662f\u5148\u6267\u884ctouch \u64cd\u4f5c\u3002 \u73b0\u5b9e\u7684\u4f8b\u5b50\u662f yum \u9700\u8981\u5b89\u88c5yum-plugin-ovl\u3002 \u4f46\u8fd9\u4e2a\u53ea\u67097.2\u624d\u652f\u6301\uff0c \u4e4b\u524d\u7684\u8bdd\u5c31\u9700\u8981\u5148<code>touch /var/lib/rpm/*</code></li> </ol>","tags":["docker"]},{"location":"blog/docker-storage/#_1","title":"\u6700\u4f73\u5b9e\u8df5","text":"<ol> <li>\u4f7f\u7528ssd </li> <li>\u5bf9\u4e8e\u5199\u64cd\u4f5c\u6bd4\u8f83\u591a\u7684\u573a\u666f\uff0c\u4f8b\u5982\u6570\u636e\u5e93\uff0c\u5e94\u4f7f\u7528\u6620\u5c04\u6587\u4ef6(bind)\u6216\u8005volume\u3002\u8fd9\u6837\u8df3\u8fc7\u4e86overlay\u7684\u590d\u6742\u64cd\u4f5c\uff0c\u76f4\u63a5\u4f7f\u7528\u4e3b\u673a\u7684\u6587\u4ef6\u7cfb\u7edf</li> </ol>","tags":["docker"]},{"location":"blog/docker-storage/#overlay_2","title":"overlay\u7684\u589e\u5220\u6539","text":"<p>\u5f53\u8fd0\u884cdocker\u5bb9\u5668\u65f6\u67e5\u770b\u6302\u8f7d</p> <p><pre><code>overlay on /var/lib/docker/overlay2/04ea1faa8074e5862f40eecdba968bd9b7f222cb30e5bf6a0b9a9c48be0940f2/merged type overlay (rw,relatime,lowerdir=/var/lib/docker/overlay2/l/B74PWZCBMRCWXFH5UL2ZXB5WEU:/var/lib/docker/overlay2/l/WNHICVPVSDNUGSCZW435TPSMOK,upperdir=/var/lib/docker/overlay2/04ea1faa8074e5862f40eecdba968bd9b7f222cb30e5bf6a0b9a9c48be0940f2/diff,workdir=/var/lib/docker/overlay2/04ea1faa8074e5862f40eecdba968bd9b7f222cb30e5bf6a0b9a9c48be0940f2/work)\n</code></pre> docker \u5c06\u955c\u50cf\u7684\u6587\u4ef6\u6302\u8f7d\u4e3a\u53ea\u8bfb\uff0c \u5c06\u5bb9\u5668\u5c42\u6302\u8f7d\u4e3a\u53ef\u8bfb\u53ef\u5199\u3002 \u6587\u4ef6\u7cfb\u7edf\u53ef\u4ee5\u5206\u4e3a2\u90e8\u5206 upper\uff08\u5bb9\u5668\u5c42\uff09 + lower \uff08\u955c\u50cf\u5c42\uff09</p> <ul> <li>\u5f53\u5728\u5bb9\u5668\u91cc\u6267\u884c\u5199\u65f6\uff0c \u5982\u679c\u6587\u4ef6\u4e0d\u5b58\u5728\uff0c \u4f1a\u4f9d\u6b21\u904d\u5386lower\u3002\u5982\u679c\u90fd\u4e0d\u5b58\u5728\u5c31\u4f1a\u5728upper\u5c42\u521b\u5efa\u6587\u4ef6</li> <li>\u8bfb\u4e5f\u76f8\u540c</li> <li>\u5220\u9664\u65f6\u4f1a\u521b\u5efa\u4e00\u4e2awithout \u6765\u9690\u85cf\uff0c \u8fd9\u662f\u4e3a\u4ec0\u4e48\u5373\u4f7f\u5220\u9664\u5bb9\u5668\u91cc\u7684\u6587\u4ef6\uff0c \u955c\u50cf\u8fd8\u662f\u4f1a\u589e\u5927\u3002 </li> <li>\u5220\u9664\u76ee\u5f55\u60c5\u51b5\u4e5f\u5dee\u4e0d\u591a</li> </ul>","tags":["docker"]},{"location":"blog/docker-storage/#_2","title":"\u7279\u6b8a\u60c5\u51b5","text":"<p>\u5728\u4fdd\u5b58\u5bb9\u5668\u540e(docker commit)\uff0c\u4f1a\u591a\u4e00\u5c42\uff0c\u91cc\u9762\u5305\u542b\u4e86\u4fee\u6539\u7684\u6587\u4ef6\uff0c\u4ee5\u53ca\u5220\u9664\u540e\u751f\u6210\u7684without\u6587\u4ef6\uff0c\u7136\u540e\u751f\u6210\u955c\u50cf</p> <p>\u4f46\u5bf9\u4e8e\u4ee5\u4e0b\u7279\u6b8a\u76ee\u5f55\u6587\u4ef6\u4e0d\u4f1a\u63d0\u4ea4\uff0c \u56e0\u4e3a\u8fd9\u4e9b\u6587\u4ef6\u662f\u8fd0\u884c\u65f6docker \u8981\u6839\u636e\u7528\u6237\u914d\u7f6e\u8fdb\u884c\u4fee\u6539\u7684\u3002  </p> <ol> <li>/etc/hostname </li> <li>/etc/hosts </li> <li>/etc/resov.conf</li> </ol> <p>\u4f8b\u5982docker \u7684link\u9009\u9879\uff0c\u4f1a\u5728\u5bb9\u5668\u7684hosts \u6587\u4ef6\u91cc\u5b9a\u4e49\u5bf9\u5e94\u7684\u5bb9\u5668\u540d-&gt;\u5bb9\u5668ip</p>","tags":["docker"]},{"location":"blog/docker-storage/#mount-overlayfs","title":"\u624b\u52a8mount overlayfs\u7684\u4f8b\u5b50","text":"<ol> <li>\u539f\u672c\u76ee\u5f55\uff0c\u6587\u4ef6\u90fd\u5206\u6563\u5728\u4e0d\u540c\u76ee\u5f55ABC <pre><code>.\n\u251c\u2500\u2500 A\n\u2502   \u251c\u2500\u2500 aa\n\u2502   \u2514\u2500\u2500 a.txt\n\u251c\u2500\u2500 B\n\u2502   \u251c\u2500\u2500 a.txt\n\u2502   \u2514\u2500\u2500 b.txt\n\u251c\u2500\u2500 C\n\u2502   \u2514\u2500\u2500 c.txt\n\u2514\u2500\u2500 worker\n    \u2514\u2500\u2500 work [error opening dir]\n</code></pre></li> <li>overlay \u6302\u8f7d\u5230/tmp/test\u76ee\u5f55 <code>sudo mount -t overlay overlay -o lowerdir=A:B,upperdir=C,workdir=worker /tmp/test/</code></li> <li>\u67e5\u770btest\u76ee\u5f55  <pre><code>/tmp/test/\n\u251c\u2500\u2500 aa\n\u251c\u2500\u2500 a.txt\n\u251c\u2500\u2500 b.txt\n\u2514\u2500\u2500 c.txt\n</code></pre> <pre><code>mount  | grep 'overlay'\noverlay on /tmp/test type overlay (rw,relatime,lowerdir=A:B,upperdir=C,workdir=worker)\n</code></pre></li> </ol>","tags":["docker"]},{"location":"blog/docker-storage/#_3","title":"\u53c2\u8003","text":"<p>https://docs.docker.com/storage/storagedriver/</p>","tags":["docker"]},{"location":"blog/download-music-to-ipod-shuffle-4/","title":"download music to ipod shuffle 4","text":"","tags":["music","apple"]},{"location":"blog/download-music-to-ipod-shuffle-4/#install-ipod-shuffle-4gpy","title":"install ipod-shuffle-4g.py","text":"<p>Python script for building the Track and Playlist database for the newer gen IPod Shuffle. Forked from the shuffle-db-ng project and improved my nims11 and NicoHood.</p>","tags":["music","apple"]},{"location":"blog/download-music-to-ipod-shuffle-4/#automatically-or-manually-mount-ipod","title":"automatically or manually mount ipod","text":"<p>mount /dev/sdb /mnt</p>","tags":["music","apple"]},{"location":"blog/download-music-to-ipod-shuffle-4/#copy-mp3-or-m4a-file-into-ipod","title":"copy mp3 or m4a file into ipod","text":"<p>/mnt/iPod_Control/Music/F00/</p>","tags":["music","apple"]},{"location":"blog/download-music-to-ipod-shuffle-4/#command-of-update-play-list","title":"command of update play list","text":"<p>sudo ./ipod-shuffle-4g.py -d 1 /mnt/      </p>","tags":["music","apple"]},{"location":"blog/download-music-to-ipod-shuffle-4/#copy-music-to-iphone-in-linux","title":"copy music to iPhone in Linux","text":"<pre><code>sudo apt update\nsudo apt install ifuse libimobiledevice-utils\n</code></pre> <p>pair iphone, unlock and trust pair in the iphone <pre><code>idevicepair pair\n</code></pre></p> <p>list supported app installed in the iPhone <pre><code>ifuse --list-apps\n</code></pre></p> <p>mount vlc's app directory to Linux <pre><code>ifuse --documents org.videolan.vlc-ios ~/iphone_vlc\n</code></pre></p> <p>copy Music file to ~/iphone_vlc</p> <p>finally fusermount -u ~/iphone_vlc</p>","tags":["music","apple"]},{"location":"blog/dp-%E5%9B%9B%E6%9D%BF%E6%96%A7/","title":"DP \u56db\u677f\u65a7","text":"<p>\u4ee5\u8df3\u53f0\u9636\u7684\u9898\u76ee\u4e3a\u4f8b\uff0c \u9898\u76ee\u662f\u4ee5\u6bcf\u6b21\u8df31\u5c42\u62162\u5c42\u7684\u65b9\u5f0f\u8df3\u5230n\u53f0\u9636\uff0c \u95ee\u4e00\u5171\u6709\u591a\u5c11\u79cd\u8df3\u6cd5 \u5f00\u59cb\u6211\u89c9\u5f97\u8fd9\u662f\u6c42\u8def\u5f84\u4e2a\u6570\uff0c\u800c\u901a\u5e38dp\u7b97\u6700\u5927\u6216\u6700\u5c0f\u503c\uff0c \u4e0d\u9002\u7528\u3002  \u4f46\u540e\u6765\u6362\u4e2a\u89d2\u5ea6\u60f3\uff0c\u6c42\u6700\u5927\u6700\u5c0f\u5fc5\u987b\u5f97\u8bd5\u8fc7\u6240\u6709\u65b9\u6cd5\u624d\u5f97\u51fa\u6765\u7684\uff0c \u800c\u5c06\u6240\u6709\u7684\u8bd5\u8fc7\u7684\u65b9\u6cd5\u8ba1\u6570\uff0c\u5c31\u662f\u8fd9\u9898\u7684\u89e3</p>","tags":["\u7b97\u6cd5","DP"]},{"location":"blog/dp-%E5%9B%9B%E6%9D%BF%E6%96%A7/#_1","title":"\u5199\u51fa\u9012\u5f52","text":"<p>dp\u7b2c\u4e00\u6b65\u8981\u5148\u5199\u51fa\u9012\u5f52\u6765\uff0c \u5199\u9012\u5f52\u5f97\u5199\u6536\u655b\u6761\u4ef6 \u8fd9\u91cc\u7684\u6536\u655b\u6761\u4ef6\u662f\u5f53\u4f20\u53c2\u5c0f\u4e8e0,\u5219\u8bf4\u660e\u89e3\u6cd5\u5931\u8d25\uff08\u591a\u8df3\u4e86\uff09\uff0c\u8fd4\u56de0\u3002 \u5f53\u6070\u597d\u4e3a0\u5219\u89e3\u6cd5\u6709\u6548\u8fd4\u56de1  </p> <p>\u9012\u5f52\u4f53\u5c31\u662f\u8df31\u5c42\u548c\u8df32\u5c42</p> <pre><code>static int jump(int number) {\n  if (number &lt; 0) {\n    return 0;\n  } else if (number == 0) {\n    return 1;\n  }\n  return jump(number - 1) + jump(number - 2);\n}\n\nint jumpFloor(int number) { \n  return jump(number - 1) + jump(number - 2); \n}\n</code></pre>","tags":["\u7b97\u6cd5","DP"]},{"location":"blog/dp-%E5%9B%9B%E6%9D%BF%E6%96%A7/#_2","title":"\u7528\u7f13\u5b58\u6765\u4f18\u5316\u9012\u5f52","text":"<p>\u9012\u5f52\u663e\u7136\u4f1a\u91cd\u590d\u8ba1\u7b97\uff0c \u53ef\u4ee5\u7528\u7f13\u5b58\u8ba1\u7b97\u7ed3\u679c\u6765\u907f\u514d\uff0c \u5f53\u6709\u7f13\u5b58\u65f6\u4f7f\u7528\u7f13\u5b58\uff0c\u5426\u5219\u624d\u53bb\u8ba1\u7b97\uff0c \u6700\u540e\u5c06\u7ed3\u679c\u7f13\u5b58  </p> <p>\u5e76\u4e14\u4f7f\u7528\u7f13\u5b58\u65f6\u5e94\u8be5\u6307\u5b9a\u5c3e\u9012\u5f52\u7684\u503c</p> <pre><code>int jump(int number, int *cache) {\n  if (number &lt; 3) {\n    return cache[number];\n  }\n  // \u7f13\u5b58\u6ca1\u547d\u4e2d\u5c31\u8ba1\u7b97\n  int ret1 =\n      cache[number - 1] != -1 ? cache[number - 1] : jump(number - 1, cache);\n  int ret2 =\n      cache[number - 2] != -1 ? cache[number - 2] : jump(number - 2, cache);\n  cache[number] = ret1 + ret2;\n  return cache[number];\n}\n\nint jumpFloor(int number) {\n  int cache[number + 1];\n  for (int i = 0; i &lt; number + 1; i++) {\n    cache[i] = -1;\n  }\n\n  cache[0] = 0;\n  cache[1] = 1;\n  cache[2] = 2;\n  return jump(number, cache);\n}\n</code></pre>","tags":["\u7b97\u6cd5","DP"]},{"location":"blog/dp-%E5%9B%9B%E6%9D%BF%E6%96%A7/#for","title":"\u9012\u5f52\u6539for\u5faa\u73af","text":"<p>\u9012\u5f52\u7684\u8c03\u7528\u6d41\u7a0b\u662f\u81ea\u4e0a\u800c\u4e0b\uff0c\u5148\u8ba1\u7b97(n)-&gt;\u8ba1\u7b97(n -1)-&gt;\u518d\u8ba1\u7b97(n-2) ... 0 \u73b0\u5728\u8981\u53cd\u8fc7\u6765\uff0c \u5148\u8ba1\u7b97(0)-&gt;\u8ba1\u7b97(1)-&gt;\u8ba1\u7b97(2) ... n  \u5373\u81ea\u4e0b\u800c\u4e0a</p> <pre><code>int jumpFloor(int number) {\n  if (number &lt; 3) {\n    return number;\n  }\n\n  // \u4e4b\u524d\u8981\u521d\u59cb\u5316\u4e3a\u4e86\u5224\u65ad\uff0c \u800c\u73b0\u5728\u663e\u7136\u4e0b\u6807\u5927\u4e8e2\u7684\u503c\u662f\u8981\u8ba1\u7b97\u51fa\u6765\u7684\uff0c\u4e0d\u9700\u8981\u8bfb\u53d6  \n  // \u6240\u4ee5\u4e0d\u9700\u8981\u521d\u59cb\u5316\n  int cache[number + 1];\n  cache[1] = 1;\n  cache[2] = 2;\n\n  for (int i = 3; i &lt;= number; i++) {\n    cache[i] = cache[i - 1] + cache[i - 2];\n  }\n\n  return cache[number];\n}\n</code></pre>","tags":["\u7b97\u6cd5","DP"]},{"location":"blog/dp-%E5%9B%9B%E6%9D%BF%E6%96%A7/#_3","title":"\u7f29\u5c0f\u7f13\u5b58\u5927\u5c0f","text":"<p>\u4ed4\u7ec6\u770b\uff0c \u5176\u5b9e\u6bcf\u6b21\u8ba1\u7b97\u53ea\u6d89\u53ca\u6700\u5927\u7684\u4e09\u4e2a\u6570\uff0c \u6240\u4ee5\u6570\u7ec4\u5e76\u4e0d\u9700\u8981\u90a3\u4e48\u5927\uff0c\u53ea\u75283\u4e2a\u5355\u5143\u5c31\u8db3\u591f\uff0c\u6545\u76f4\u63a5\u5199\u62103\u4e2a\u53d8\u91cf</p> <pre><code>  int jumpFloorD(int number) {\n    if (number &lt; 3) {\n      return number;\n    }\n\n    int total = 0;\n    int minors2 = 1;\n    int minors1 = 2;\n\n    for (int i = 3; i &lt;= number; i++) {\n      total = minors1 + minors2;\n      minors2 = minors1;\n      minors1 = total;\n    }\n\n    return total;\n  }\n</code></pre> <p>\u8fd9\u6837DP\u89e3\u6cd5\u5c31\u51fa\u6765\u4e86\uff0c \u8fd9\u4e2a\u5957\u8def\u662f\u6211\u4ece\u529b\u6263\u4e0a\u5b66\u5230\u7684\uff0c \u975e\u5e38\u6709\u6548\u7b80\u5355</p>","tags":["\u7b97\u6cd5","DP"]},{"location":"blog/dp-%E5%9B%9B%E6%9D%BF%E6%96%A7/#_4","title":"\u603b\u7ed3","text":"<p>\u4ece\u4e0a\u53ef\u89c1\uff0c\u4f60\u9700\u8981\u8bad\u7ec3\u5982\u4f55\u53d1\u73b0\u9012\u5f52\u5173\u7cfb\uff0c\u5269\u4e0b\u7684\u5de5\u4f5c\u5c31\u662f\u7f13\u5b58\u9012\u5f52\u8c03\u7528\u7684\u7ed3\u679c\uff0c\u6700\u540e\u662f\u5c06\u4ece\u4e0a\u5230\u4e0b\u7684\u89e3\u51b3\u601d\u8def\u53d8\u4e3a\u4ece\u4e0b\u5230\u4e0a\u3002\u8fd9\u6837\u6211\u4eec\u5c31\u53ef\u4ee5\u7528O(N)\u7684\u65f6\u95f4\u590d\u6742\u5ea6\u53bb\u904d\u5386  </p>","tags":["\u7b97\u6cd5","DP"]},{"location":"blog/dp-%E5%9B%9B%E6%9D%BF%E6%96%A7/#_5","title":"\u53c2\u8003","text":"<p>https://leetcode.com/discuss/study-guide/1490172/dynamic-programming-is-simple</p>","tags":["\u7b97\u6cd5","DP"]},{"location":"blog/dpdk-testpmd-to-test-nic-speed/","title":"dpdk-testpmd to test NIC speed","text":"<p>\u542f\u52a8\uff0c\u8fdb\u5165dpdk \u4ea4\u4e92\u6a21\u5f0f</p> <pre><code>./dpdk-testpmd -l 0-3 -n 4 --vdev=net_tap0,iface=tap0 -a 0000:07:00.0 -- -i --port-topology=chained \n./dpdk-testpmd -l 0-3 -n 4   --vdev 'net_bonding0,mode=0,member=0000:08:00.0,member=0000:09:00.0' --vdev=net_tap0,iface=tap0 -- -i --port-topology=chained\n\n#\u786e\u8ba4\ntestmpd&gt; show port summary all \n\n#\u8bbe\u7f6e\u8f6c\u53d1\ntestpmd&gt; set fwd io \n\n#\u542f\u52a8\u8f6c\u53d1\ntestpmd&gt; start \n</code></pre> <p>\u8bbe\u7f6etap\u8bbe\u5907\u7684ip <pre><code>ip add add 10.9.108.211/24 dev tap0\nip route add 10.9.3.13 via 10.9.108.211 dev tap0\n#\u542f\u52a8\niperf -s\n</code></pre></p>","tags":["dpdk"]},{"location":"blog/dpdk-testpmd-to-test-nic-speed/#dpdk-bonding","title":"dpdk bonding","text":"<p>\u8981\u5728dpdk-testpmd\u521b\u5efa1\u4e2abond\u7f51\u5361\uff0c\u8f6c\u53d1bond\u7f51\u5361\u548ctap\u4e4b\u95f4\u7684\u6d41\u91cf\u3002\u542f\u52a8\u65f6\u8981\u6ce8\u610fEAL\u65e5\u5fd7\uff0c\u53c2\u6570\u5199\u9519\u4e86\u4f1a\u62a5\u9519\u4e86\u3002 <pre><code># ./dpdk-testpmd -l 0-3 -n 4  --vdev=net_tap0,iface=tap0 -- -i --port-topology=chained\n\nConfiguring Port 0 (socket 0)\nPort 0: D0:9F:D9:70:6E:77\nConfiguring Port 1 (socket 0)\nPort 1: D0:9F:D9:70:6E:76\nConfiguring Port 2 (socket 0)\nPort 2: C6:44:56:84:8C:92\nChecking link statuses...\nDone\n</code></pre></p> <ol> <li> <p>\u521b\u5efabond\u7f51\u5361\uff0c1 \u8868\u793a mode, 0 \u662fsocket id\u3002\u8f93\u51fa\u663e\u793a\u521b\u5efa\u7684bond\u7f51\u5361id\u662f3 <pre><code>testpmd&gt; create bonded device 1 0\nCreated new bonded device net_bonding_testpmd_0 on (port 3).\n</code></pre></p> </li> <li> <p>\u6253\u5370\u6240\u6709\u7f51\u5361\u72b6\u6001\uff0c \u8fd9\u91cc0 \u548c1 \u662f\u5c06\u88abbonding\u7684\u7f51\u5361\uff0c2\u662ftap\u8bbe\u5907\uff0c 3\u662fbond\u7f51\u5361\u3002 <pre><code>testpmd&gt; show port stats all\n</code></pre></p> </li> <li> <p>\u6dfb\u52a0slave\u7f51\u5361\u3002\u6ce8\u610f\u5efa\u8bae\u5148\u5173\u6389bond\u7f51\u5361\uff0c\u518d\u6dfb\u52a0slave\u7f51\u5361\u3002 <pre><code>testpmd&gt; add bonding slave 0 3\ntestpmd&gt; add bonding slave 1 3\n</code></pre></p> </li> <li> <p>\u67e5\u770bbond\u7f51\u5361\u914d\u7f6e, \u5982\u679c\u6dfb\u52a0slave\u7f51\u5361\u524d\u6ca1\u6709\u505cbond\u7f51\u5361\uff0c\u5c31\u4f1a\u51fa\u73b0\u4e0b\u9762\u7684\u6253\u5370\uff0c\u867d\u7136Slave\u7f51\u5361\u663e\u793a\u6709\u4e24\u4e2a\uff0c\u4f46\u662fActive\u7684\u662f\u7a7a\u7684\u3002\u8fd9\u65f6\u9700\u8981\u5173\u95ed\u518d\u542f\u52a8bond\u7f51\u5361\u3002 <pre><code>testpmd&gt; show bonding config 0\nshow bonding config 3\n        Bonding mode: 1\n        Slaves (2): [0 1]\n        Active Slaves: []\n        Primary: [0]\n</code></pre></p> </li> <li>\u5173\u5f00bond\u7f51\u5361 <pre><code>testpmd&gt; port stop 3\nStopping ports...\nDone\ntestpmd&gt; port start 3\nConfiguring Port 3 (socket 0)\n</code></pre></li> <li> <p>\u8bbe\u7f6e\u8f6c\u53d1\u7f51\u5361id\uff0c\u4ee5\u53ca\u542f\u52a8\u8f6c\u53d1\u3002 <pre><code>testpmd&gt; set portlist 2,3\ntestpmd&gt; start\n</code></pre></p> </li> <li> <p>\u4fee\u6539Bond\u6a21\u5f0f <pre><code>set bonding mode 3 2\n</code></pre></p> </li> </ol>","tags":["dpdk"]},{"location":"blog/dockerfile-%E4%B8%ADentrypoint%E5%92%8Ccmd%E7%9A%84%E5%8C%BA%E5%88%AB/","title":"Dockerfile \u4e2dENTRYPOINT\u548cCMD\u7684\u533a\u522b","text":"<p>Dockerfile \u4e2d\uff0cENTRYPOINT\u548cCMD\u6765\u90fd\u53ef\u4ee5\u7528\u6765\u8bbe\u7f6e\u9ed8\u8ba4\u547d\u4ee4\uff0c\u800c\u4ee3\u66ff<code>docker run</code>\u65f6\u7684\u547d\u4ee4\uff0c\u4e5f\u53ef\u4ee5\u4e00\u8d77\u4f7f\u7528  </p> <p>\u5355\u72ec\u4f7f\u7528ENTRYPOINT\u6216CMD\u65f6\uff0c\u5176\u533a\u522b\u5728\u4e8e\u5bf9<code>docker run</code>\u7684\u53c2\u6570\u5904\u7406: CMD\u7684\u547d\u4ee4\u4f1a\u88ab<code>docker run</code>\u7684\u53c2\u6570\u8986\u76d6\uff0c\u800cENTRYPOINT\u662f\u8ffd\u52a0</p> <p>\u4f8b\u5982\uff1a <pre><code># image1\nFROM ubuntu\nENTRYPOINT [\"echo\", \"hello world\"]\n</code></pre> <pre><code># image2\nFROM ubuntu\nCMD [\"echo\", \"hello world\"]\n</code></pre></p> <p>\u6267\u884c\u7ed3\u679c <pre><code># docker run image1\nhello world\n\n# docker run image1 hostname\n0c33ff9af81c\n</code></pre></p> <pre><code># docker run image2\nhello world\n\n# docker run image2 hostname\nhello world 0c33ff9af81c\n</code></pre>","tags":["docker"]},{"location":"blog/dockerfile-%E4%B8%ADentrypoint%E5%92%8Ccmd%E7%9A%84%E5%8C%BA%E5%88%AB/#entrypointcmd","title":"\u5b9e\u9645\u60c5\u51b5\u591a\u662fentrypoint\u4e0ecmd\u7ec4\u5408\u4f7f\u7528","text":"<p>cmd \u4e3aentrypoint \u63d0\u4f9b\u9ed8\u8ba4\u53c2\u6570\uff0c \u5373\u5982\u679c'docker run'\u7ed9\u4e86\u53c2\u6570\u65f6\uff0c\u8986\u76d6CMD\u53c2\u6570\uff0c\u5426\u5219\u4f7f\u7528CMD\u63d0\u4f9b\u7684\u53c2\u6570</p> <pre><code>FROM ubuntu\nENTRYPOINT [\"top\", \"-b\"]\nCMD [\"-c\"]\n</code></pre>","tags":["docker"]},{"location":"blog/dockerfile-%E4%B8%ADentrypoint%E5%92%8Ccmd%E7%9A%84%E5%8C%BA%E5%88%AB/#cmdentrypoint","title":"\u9996\u5148\u8bf4cmd\u548centrypoint \u90fd\u6709\u4e24\u79cd\u6a21\u5f0f","text":"<ol> <li>shell\u6a21\u5f0f\uff0c \u5373\u6ca1\u6709\u7528\u6570\u7ec4\u6765\u4f20\u9012\u53c2\u6570, \u76f4\u63a5\u63a5\u547d\u4ee4\u5982 CMD top -p \u6216\u8005 entrypoint top -p </li> <li>exec \u6a21\u5f0f\uff0c \u5373\u4f7f\u7528\u6570\u7ec4\u8868\u793a\u5982 CMD [\"top\", \"-p\"]\uff0c \u6ce8\u610f\u5fc5\u987b\u7528\u53cc\u5f15\u53f7\uff0c\u56e0\u4e3a\u8fd9\u4e2a\u662f\u7528json\u6765\u4f20\u9012\u7684</li> </ol> <p>\u4e24\u8005\u533a\u522b: shell\u6a21\u5f0f\u4e0d\u4f1a\u63a5\u53d7\u547d\u4ee4\u884c\u53c2\u6570\uff0c\u800c\u4e141\u53f7\u8fdb\u7a0b\u662fsh\uff0c\u800c\u975e\u5982\u4e0a\u7684top\u3002 \u8fd9\u6837\u7684\u8bddtop\u4e0d\u80fd\u63a5\u53d7\u5230<code>docker stop container</code>\u65f6\u7684\u4fe1\u53f7\u3002  \u800c\u4e00\u822c\u6211\u4eec\u5199\u7684\u7a0b\u5e8f\u90fd\u662f\u6355\u6349SIGTERM\u6765\u8fdb\u884cpeaceful exit\uff0c\u90a3\u4e48\u5c31\u4e00\u5b9a\u4e0d\u80fd\u4f7f\u7528shell\u6a21\u5f0f</p> <p>exec\u6a21\u5f0f\u65f6\uff0c \u53ef\u4ee5\u63a5\u53d7docker run image param\uff0c \u8fd9\u4e2aparam\u4f1a\u4f20\u9012\u7ed9top\u4f5c\u4e3a\u53c2\u6570\u3002 \u800c\u4e14top \u662f1\u53f7\u8fdb\u7a0b\uff0c\u80fd\u63a5\u6536\u4fe1\u53f7\u3002</p> <p>\u7ec6\u5fae\u533a\u522b\uff1a \u7531\u4e8eshell\u6a21\u5f0f\u662f\u5148\u542f\u52a8sh\uff0c \u7b26\u53f7\u89e3\u6790\u7531shell\u6267\u884c\uff0c\u4f8b\u5982<code>$HOME</code>\u7684\u5c55\u5f00\u7531shell\u8fdb\u884c\uff0c \u800c\u7528exec\u6a21\u5f0f\u65f6\uff0c\u7531docker \u8fdb\u884c</p> <p>\u603b\u4e4b\uff0c\u63a8\u8350\u4f7f\u7528exec \u6a21\u5f0f</p>","tags":["docker"]},{"location":"blog/dockerfile-%E4%B8%ADentrypoint%E5%92%8Ccmd%E7%9A%84%E5%8C%BA%E5%88%AB/#_1","title":"\u989d\u5916\u8bdd, \u51cf\u5c0f\u955c\u50cf\u4f53\u79ef","text":"<p>\u4f7f\u7528'\\' \u6216\u8005 '&amp;&amp;' \u5c06\u547d\u4ee4\u8fde\u8d77\u6765\u53ef\u4ee5\u51cf\u5c0f\u955c\u50cf\u5c42\u6570\uff0c\u4ece\u800c\u51cf\u5c0f\u4f53\u79ef\u3002\u53e6\u5916build\u65f6\uff0c\u5355\u72ec\u4e00\u884c\u7684\u547d\u4ee4\u4f1a\u5728\u65b0\u7684layer \u5c42\u6267\u884c\u3002\u6709\u4e9b\u547d\u4ee4\u4ea7\u751f\u7684cache\uff0c\u4f1a\u6301\u7eed\u5f71\u54cd\u5230\u4e0b\u4e00\u5c42 \u4f8b\u5982<code>RUN apt-get dist-upgrade -y</code>\uff0c\u5982\u679c\u4e0d\u60f3\u4fdd\u7559cache\uff0c\u9700\u8981\u5728build\u65f6\u52a0\u5165\u53c2\u6570<code>docker build --no-cache.</code> </p> <p>\u8fd8\u6709\u6700\u6709\u6548\u51cf\u5c0f\u955c\u50cf\u4f53\u79ef\u7684\u65b9\u5f0f\uff0c\u4e5f\u5e38\u89c1\u7684\u662f\u6700\u540e\u7528\u7a7a\u767d\u955c\u50cf\uff0c'FROM SCRATCH', \u8fd9\u6837\u628a\u5176\u4ed6\u7684\u5c42\u90fd\u5e72\u6389\u4e86, \u53ea\u4fdd\u7559\u4e00\u5c42\u955c\u50cf</p>","tags":["docker"]},{"location":"blog/%E7%8E%A9%E8%BD%ACesp32/","title":"\u73a9\u8f6cESP32","text":"<p>ESP32\u7684\u751f\u6001\u6bd4\u8f83\u597d\uff0c\u7c7b\u4f3carduino, \u4f46\u662f\u96c6\u6210\u4e86wifi\u548c\u84dd\u7259\uff0c\u6709\u7684\u751a\u81f3\u96c6\u6210\u4e86gps\uff0c\u529f\u80fd\u5f88\u5f3a\u5927\u800c\u4e14\u4fbf\u5b9c\u3002\u6700\u8fd1\u6dd8\u5b9d\u4e70\u4e86\u4e00\u4e2aESP32-USB-Geek\uff0c \u5e26\u4e00\u4e2aLCD\u5c4f\u5e55\u548c\u51e0\u4e2a\u6269\u5c55\u63a5\u53e3\uff0c\u8fd8\u6709\u95ea\u5b58\u53e3\u53ef\u4ee5\u8bfb\u5199\u3002</p> <p></p>","tags":["esp","arduino"]},{"location":"blog/%E7%8E%A9%E8%BD%ACesp32/#_1","title":"\u7f16\u8bd1\u70e7\u5f55","text":"<p>ESP32 \u67093\u79cd\u65b9\u5f0f\uff1a \u5b98\u65b9\u7684idf\uff0c mpy, arduino\u3002</p>","tags":["esp","arduino"]},{"location":"blog/%E7%8E%A9%E8%BD%ACesp32/#_2","title":"\u5b98\u65b9\u5de5\u5177","text":"<p>\u5b98\u65b9\u7684idf\u5206vscode\u63d2\u4ef6\u548cpython\u811a\u672c\uff0c vscode\u4e2d\u6ca1\u6709\u6210\u529f\uff0c\u4e0d\u8fc7idf.py\u53ef\u4ee5\u7f16\u8bd1\u548c\u70e7\u5f55\u3002</p> <p>\u6839\u636e\u5b98\u65b9\u6587\u6863\u5199\u7684\u4e0b\u8f7d\u5b89\u88c5idf\uff0c\u89e3\u538b\u540e\u6267\u884c\u811a\u672c\u3002\u5b89\u88c5\u811a\u672c\u4f9d\u8d56python-venv\uff0c \u800c\u6211\u6700\u5e38\u7528vituralenv</p> <pre><code>bash v5.3.1/esp-idf/install.sh\n</code></pre> <p>\u8fdb\u5165\u6dd8\u5b9d\u5e97\u4f8b\u5b50, \u7528cmake\u7ba1\u7406\u7684\u3002 \u5728\u8ddf\u76ee\u5f55\u6267\u884c</p> <pre><code>idf.py set-target esp32-s3\n</code></pre> <p>\u8fd9\u79cd\u65b9\u5f0f\u652f\u6301\u975e\u5e38\u590d\u6742\u7684\u914d\u7f6e</p> <pre><code>idf.py menuconfig\n</code></pre> <p>\u7f16\u8bd1\u5237\u5165</p> <pre><code>idf.py build\n\nidf.py -p /dev/ttyACM0 flash\n</code></pre> <p>\u5b98\u65b9\u7684\u65b9\u5f0f\u6700\u80fd\u4e86\u89e3\u7269\u7406\u8bbe\u5907\u4e86\u3002\u770b\u65e5\u5fd7\u53d1\u73b0\u4ed6\u751f\u6210\u4e86bin\u6587\u4ef6\uff0c\u5e76\u4ece0\u4f4d\u7f6e\u5237\u5165bin\u6587\u4ef6\u3002</p>","tags":["esp","arduino"]},{"location":"blog/%E7%8E%A9%E8%BD%ACesp32/#mpy-thonny-ide","title":"mpy thonny ide","text":"<p>\u6700\u597d\u7528pip\u5b89\u88c5\u6700\u65b0\u7684\u3002 \u5c06python\u4e0a\u4f20\u5230esp\u540e\uff0c\u70b9\u8fd0\u884c\u5c31\u53ef\u4ee5\u4e86\uff0c\u8fd8\u80fd\u5728REPL\u4e2d\u4eff\u771f\u8c03\u8bd5\uff0c\u975e\u5e38\u65b9\u4fbf\u3002</p>","tags":["esp","arduino"]},{"location":"blog/%E7%8E%A9%E8%BD%ACesp32/#arduino","title":"arduino","text":"<p>arduino ide gui\u7248\u672c\u7f16\u8bd1\u5931\u8d25\uff0c\u800c\u4e14\u56e0\u4e3a\u662fLinux\u7248\u662f\u7528java\u5199\u7684\uff0c\u64cd\u4f5c\u975e\u5e38\u6162\u3002\u6539\u7528arduio-cli\u811a\u672c\u6210\u529f\uff0c \u5b98\u65b9\u6587\u6863\u4e5f\u8bf4\u4e86arduino-cli\u975e\u5e38\u5f3a\u5927\u3002\u8fd9\u91cc\u8bf4\u811a\u672c\u4f7f\u7528\u65b9\u6cd5\u3002</p>","tags":["esp","arduino"]},{"location":"blog/%E7%8E%A9%E8%BD%ACesp32/#_3","title":"\u521d\u59cb\u5316\u914d\u7f6e","text":"<ol> <li> <p>\u9996\u5148\u4e0b\u8f7d\u538b\u7f29\u5305\uff0c\u89e3\u538b\u5230PATH\u76ee\u5f55\u4e0b\u3002</p> </li> <li> <p>\u521d\u59cb\u5316\u914d\u7f6e\uff0c <code>arduino-cli config init</code> \u53ef\u4ee5\u751f\u6210\u914d\u7f6e\u6587\u4ef6'~/.arduino15/arduino-cli.yaml'\u3002</p> </li> <li> <p>\u4fee\u6539\u914d\u7f6e\u6587\u4ef6\uff0c \u6839\u636e\u6dd8\u5b9d\u8001\u677f\u8bf4\u7684\uff0cESP32\u7684\u677f\u5b50\u8981\u4ece\u53e6\u5916\u7b2c\u4e09\u65b9\u6e90\u4e2d\uff0c \u56e0\u4e3a\u8fd9\u4e2a\u6e90\u662fgithubcontent\u9700\u8981\u68af\u5b50\u624d\u80fd\u8bbf\u95ee\uff0c\u4fee\u6539\u6210\u5982\u4e0b</p> </li> </ol> <pre><code>$ cat ~/.arduino15/arduino-cli.yaml\n\nboard_manager:\n\nadditional_urls: ['https://raw.githubusercontent.com/espressif/arduino-esp32/gh-pages/package_esp32_index.json']\n\n\n\nnetwork:\n\nproxy: 'socks5://ip:port'\n</code></pre>","tags":["esp","arduino"]},{"location":"blog/%E7%8E%A9%E8%BD%ACesp32/#_4","title":"\u5b89\u88c5\u677f\u5b50\u5e93\u548c\u4f9d\u8d56\u5e93","text":"<p>\u5f53\u6ca1\u6709\u4e0b\u8f7d\u677f\u5b50\u65f6\uff0c\u67e5\u770b\u8fde\u63a5\u7684\u8bbe\u5907\u4f1a\u663e\u793aUnknown</p> <pre><code>$ arduino-cli board list\n\nPort Protocol Type Board Name FQBN Core\n\n/dev/ttyACM0 serial Serial Port (USB) Unknown\n</code></pre> <p>\u663e\u793a\u641c\u7d22\u6240\u6709\u677f\u5b50\uff08\u5305\u62ec\u5728\u6dfb\u52a0\u7684\u7b2c\u4e09\u65b9\u6e90\u91cc\u7684\uff09, \u8fd9\u91cc\u641c\u7d22ESP32\u6838\u5fc3\u677f\uff0c \u6dd8\u5b9d\u8001\u677f\u8bf4\uff0c\u6211\u7684\u5f00\u53d1\u677f\u53eb ESP32S3 Dev Module</p> <pre><code>$ arduino-cli board listall ESP32S3 Dev Module\n\nESP32S3 Dev Module esp32:esp32:esp32s3\n</code></pre> <p>\u5b89\u88c5\u677f\u5b50module\uff0c \u6bd4\u8f83\u5927\u8981\u7b49\u5f85\u4e00\u4f1a\u3002 tips\uff1a \u677f\u5b50\u7684\u5305\u53ebmodule, \u8f6f\u4ef6\u4f9d\u8d56\u5e93\u53eblibrary</p> <pre><code>$ arduino-cli core install esp32:esp32\n</code></pre> <p>\u641c\u7d22\u5df2\u5b89\u88c5\u7684\u5b89\u88c5\u6838\u5fc3\u677f</p> <pre><code>$ arduino-cli core search esp32\n\nID Version Name\n\narduino:esp32 2.0.18-arduino.5 Arduino ESP32 Boards\n\nesp32:esp32 3.0.7 esp32\n</code></pre>","tags":["esp","arduino"]},{"location":"blog/%E7%8E%A9%E8%BD%ACesp32/#_5","title":"\u7f16\u8bd1","text":"<p>\u7f16\u8bd1\u6dd8\u5b9d\u5e97\u7684\u4f8b\u5b50LCD_Button\uff0c\u8981\u5728LCD_Button\u5916\u9762\u6267\u884c</p> <p>arduino-cli compile --fqbn esp32:esp32:esp32s3 LCD_Button</p>","tags":["esp","arduino"]},{"location":"blog/%E7%8E%A9%E8%BD%ACesp32/#_6","title":"\u4e0a\u4f20\u5230\u677f\u5b50","text":"<p>arduino-cli upload -p /dev/ttyACM0 --fqbn esp32:esp32:esp32s3 LCD_Button</p> <p>\u6709\u65f6\u5019\u5931\u8d25\u4e86\uff0c\u8981\u6309\u4f4fBoot\u952e\u63d2\u5165\u7535\u8111\u518d\u677e\u5f00\uff0c\u5c31\u80fd\u6b63\u5e38\u4e0a\u4f20\u3002</p> <pre><code>esptool.py v4.6\n\nSerial port /dev/ttyACM0\n\nConnecting...\n\nTraceback (most recent call last):\n\n...\n\nOSError: [Errno 71] Protocol error\n\nFailed uploading: uploading error: exit status 1\n</code></pre> <p>\u770b\u8fd9\u4e2a\u65e5\u5fd7\uff0c\u539f\u6765arduino\u4e5f\u662f\u8c03\u7528\u7684\u5b98\u65b9\u7684idf\u5de5\u5177\u7684esptool\u811a\u672c\u3002 \u91cd\u65b0\u63d2\u5165USB\uff0c \u518d\u6b21\u67e5\u770b\u5df2\u8fde\u63a5\u7684\u5f00\u53d1\u677f\u5c31\u4e0d\u4f1a\u663e\u793aUnknown\u4e86</p> <pre><code>$ arduino-cli board list\n\nPort Protocol Type Board Name FQBN Core\n\n/dev/ttyACM0 serial Serial Port (USB) ESP32 Family Device esp32:esp32:esp32_family esp32:esp32\n</code></pre>","tags":["esp","arduino"]},{"location":"blog/%E7%8E%A9%E8%BD%ACesp32/#uart","title":"\u8fde\u63a5\u4e32\u53e3UART","text":"<p>\u70e7\u5f55\u4e86\u6dd8\u5b9d\u5e97\u7ed9\u7684\u4e32\u53e3\u6536\u53d1\u4f8b\u5b50\uff0c\u4ee3\u7801\u975e\u5e38\u7b80\u5355\uff0c \u7136\u540e\u7528\u6211\u7684USB\u8f6cttl\u5de5\u5177\u6d4b\u8bd5\u6210\u529f\u3002</p> <pre><code>import machine\n\n\n\nuart = machine.UART(1, baudrate=115200, tx=machine.Pin(43), rx=machine.Pin(44))\n\n\n\ndef send_data(data):\n\nuart.write(data)\n\n\n\ndef receive_data():\n\nif uart.any():\n\ndata = uart.read()\n\nprint(\"Received data:\",data)\n\n\n\n\nwhile True:\n\nsend_data(\"Hello UART\")\n\nreceive_data()\n</code></pre> <p>\u7136\u800c\u8fd9\u91cc\u662f\u4e0d\u5bf9\u7684\uff0c \u4e32\u53e3\u8f6cTTL\u548cESP\u7684USB\u90fd\u8981\u8fde\u63a5\u5230\u7535\u8111\u4e0a\u3002\u5355\u8fde\u4e00\u4e2a\u90fd\u662f\u8fdb\u4e86mpy\u7684repl\u3002</p> <p></p>","tags":["esp","arduino"]},{"location":"blog/libavcodec%E4%BD%BF%E7%94%A8/","title":"libavcodec\u4f7f\u7528","text":"<p>\u8bb0\u5f55ffmpeg\u7684\u5b66\u4e60\u7cfb\u5217\uff0c\u8fd9\u662f\u5173\u4e8eAVCodecContext\u7684\u90e8\u5206\u3002</p>","tags":["ffmpeg","\u97f3\u89c6\u9891"]},{"location":"blog/libavcodec%E4%BD%BF%E7%94%A8/#sample_fmt","title":"sample_fmt","text":"<p>\u89e3\u7801\u5668avctx\u4e2d\u7684sample_fmt,\u662f\u89e3\u7801\u540e\u7684\u539f\u59cb\u97f3\u9891\uff08PCM\uff09\u91c7\u6837\u683c\u5f0f\uff0c\u51e0\u4e4e\u6240\u6709\u7684\u97f3\u9891\u683c\u5f0f\uff08amr,mp3\uff09\u89e3\u7801\u540e\u90fd\u662fPCM\u3002\u4f46\u662f\u91c7\u6837\u683c\u5f0f\u53ef\u80fd\u4e0d\u540c\uff0c\u8fd9\u4e2a\u662f\u7531\u89e3\u7801\u5668\u6765\u8bbe\u5b9a\u7684\u3002 \u5177\u4f53\u5728\u6253\u5f00\u89e3\u7801\u5668\u7684\u65f6\u5019<code>avcodec_open2</code>, \u9700\u8981\u4f20\u5165\u89e3\u7801\u89e3\u7801avctx, \u8fd9\u4e2a\u51fd\u6570\u4f1a\u8c03\u7528\u89e3\u7801\u5668\u7684<code>init</code>\u51fd\u6570\uff0c\u4ece\u800c\u5c06\u89e3\u7801\u5668\u7684\u8bbe\u5b9a\u540c\u6b65\u5230avctx\u4e2d\u3002 \u5bf9\u4e8e\u7f16\u7801\u5668\u800c\u8a00\uff0c\u8fd9\u4e2a\u503c\u7531\u662f\u7528\u6237\u81ea\u5df1\u8bbe\u7f6e\u3002\u5982\u6ce8\u91ca\u6240\u8bf4\uff1a</p> <pre><code>    /**\n     * audio sample format\n     * - encoding: Set by user.\n     * - decoding: Set by libavcodec.\n     */\n    enum AVSampleFormat sample_fmt;  ///&lt; sample format\n</code></pre> <p>\u6240\u6709\u7684\u91c7\u6837\u683c\u5f0f\u3002\u56e0\u4e3a\u5de5\u4f5c\u9700\u8981\u89e3\u7801amr, \u5148\u662f\u81ea\u5df1\u57fa\u4e8eopencore\u5f00\u53d1\u7684\uff0c\u89e3\u7801\u540e\u662fS16\uff08\u5373AV_SAMPLE_FMT_S16\uff09, \u800c\u7528ffmpeg\u89e3\u7801\u540e\u662fAV_SAMPLE_FMT_FLTP, \u8fd9\u6837\u7684\u8bdd\u91cd\u91c7\u6837\u4e00\u6b21\uff0c\u6548\u7387\u4f4e\u3002\u540e\u6765\u53d1\u73b0ffmpeg\u6709\u4e24\u5957amr\u89e3\u7801\u5b9e\u73b0\uff0c\u9009\u62e9opencore\u7248\u672c\u5c31\u662fS16\u4e86\u3002 <pre><code>enum AVSampleFormat {\n    AV_SAMPLE_FMT_NONE = -1,\n    AV_SAMPLE_FMT_U8,          ///&lt; unsigned 8 bits\n    AV_SAMPLE_FMT_S16,         ///&lt; signed 16 bits\n    AV_SAMPLE_FMT_S32,         ///&lt; signed 32 bits\n    AV_SAMPLE_FMT_FLT,         ///&lt; float\n    AV_SAMPLE_FMT_DBL,         ///&lt; double\n\n    AV_SAMPLE_FMT_U8P,         ///&lt; unsigned 8 bits, planar\n    AV_SAMPLE_FMT_S16P,        ///&lt; signed 16 bits, planar\n    AV_SAMPLE_FMT_S32P,        ///&lt; signed 32 bits, planar\n    AV_SAMPLE_FMT_FLTP,        ///&lt; float, planar\n    AV_SAMPLE_FMT_DBLP,        ///&lt; double, planar\n    AV_SAMPLE_FMT_S64,         ///&lt; signed 64 bits\n    AV_SAMPLE_FMT_S64P,        ///&lt; signed 64 bits, planar\n\n    AV_SAMPLE_FMT_NB           ///&lt; Number of sample formats. DO NOT USE if linking dynamically\n};\n</code></pre></p>","tags":["ffmpeg","\u97f3\u89c6\u9891"]},{"location":"blog/firefox-%E5%90%AF%E7%94%A8%E6%89%8B%E5%8A%A8%E6%B7%BB%E5%8A%A0%E6%90%9C%E7%B4%A2%E5%BC%95%E6%93%8E/","title":"firefox \u542f\u7528\u624b\u52a8\u6dfb\u52a0\u641c\u7d22\u5f15\u64ce","text":"<ol> <li>Open a new tab and type about:config in the address bar</li> <li>In the search box type: browser.urlbar.update2.engineAliasRefresh</li> <li>Click on the little + symbol on the right. This is what it should look like after you pressed it: boolean true value after pressing plus sign</li> <li>Go to firefox Settings \u2192 Search. Or enter this in the address bar: about:preferences#search</li> <li>In the \"Search Shortcuts\" section you should notice a new \"add\" button.</li> </ol>","tags":["firefox"]},{"location":"blog/firefox-%E5%90%AF%E7%94%A8%E6%89%8B%E5%8A%A8%E6%B7%BB%E5%8A%A0%E6%90%9C%E7%B4%A2%E5%BC%95%E6%93%8E/#_1","title":"\u53c2\u8003","text":"<p>https://superuser.com/questions/7327/how-to-add-a-custom-search-engine-to-firefox</p>","tags":["firefox"]},{"location":"blog/%E5%9C%A8c%E8%AF%AD%E8%A8%80%E4%B8%AD%E6%89%93%E5%8D%B0%E6%94%AF%E6%8C%81%E4%B8%8D%E5%90%8C%E7%B1%BB%E5%9E%8B%E5%8F%98%E9%87%8F/","title":"\u5728c\u8bed\u8a00\u4e2d\u6253\u5370\u652f\u6301\u4e0d\u540c\u7c7b\u578b\u53d8\u91cf","text":"<p>in this doc, i'll introduce how to print(stringify) variable of different types, <code>typeof</code> is a GCC extension, and <code>_Generic</code> is part of C11. typeof is disabled by option '-std=*' or '-ansi<code>, so use</code>typeof` instead. </p>","tags":["c"]},{"location":"blog/%E5%9C%A8c%E8%AF%AD%E8%A8%80%E4%B8%AD%E6%89%93%E5%8D%B0%E6%94%AF%E6%8C%81%E4%B8%8D%E5%90%8C%E7%B1%BB%E5%9E%8B%E5%8F%98%E9%87%8F/#c11-_generic","title":"c11 _Generic","text":"<pre><code>#include &lt;stdio.h&gt;\n\n#define PRINT_VAR(var)        \\\n    _Generic((var),           \\\n        int: print_int,       \\\n        float: print_float,   \\\n        double: print_double, \\\n        char: print_char      \\\n    )(#var, (var))\n\n// Type-specific print functions\nvoid print_int(const char* name, int value) {\n    printf(\"%s = %d\\n\", name, value);\n}\n\nvoid print_float(const char* name, float value) {\n    printf(\"%s = %.2f\\n\", name, value);\n}\n\nvoid print_double(const char* name, double value) {\n    printf(\"%s = %.2f\\n\", name, value);\n}\n\nvoid print_char(const char* name, char value) {\n    printf(\"%s = %c\\n\", name, value);\n}\n\nint main() {\n    int x = 10;\n    float y = 3.14f;\n    double z = 3.14159;\n    char c = 'A';\n\n    PRINT_VAR(x);  // Prints: x = 10\n    PRINT_VAR(y);  // Prints: y = 3.14\n    PRINT_VAR(z);  // Prints: z = 3.14\n    PRINT_VAR(c);  // Prints: c = A\n\n    return 0;\n}\n</code></pre>","tags":["c"]},{"location":"blog/%E5%9C%A8c%E8%AF%AD%E8%A8%80%E4%B8%AD%E6%89%93%E5%8D%B0%E6%94%AF%E6%8C%81%E4%B8%8D%E5%90%8C%E7%B1%BB%E5%9E%8B%E5%8F%98%E9%87%8F/#simpler-way","title":"simpler way","text":"<p>linter raise warnings if place <code>printf</code> directly in <code>_Generic</code>.</p> <pre><code>#define DECLARE_PRINT_FUNC(value)                                              \\\n  do {                                                                         \\\n    printf(\"%s = \", #value);                                                   \\\n    char *format = NULL;                                                       \\\n    _Generic((value),                                                          \\\n        int: format = \"%d\\n\",                                                  \\\n        long unsigned int: format = \"%lu\\n\",                                   \\\n        long: format = \"%ld\\n\",                                                \\\n        float: format = \"%.2f\\n\",                                              \\\n        double: format = \"%.2f\\n\",                                             \\\n        char: format = \"%c\\n\",                                                 \\\n        default: format = NULL);                                               \\\n    format != NULL ? printf(format, (value)):                                  \\\n    printf(\"Unknown type\\n\");                                                  \\\n  } while (0)\n</code></pre>","tags":["c"]},{"location":"blog/%E5%9C%A8c%E8%AF%AD%E8%A8%80%E4%B8%AD%E6%89%93%E5%8D%B0%E6%94%AF%E6%8C%81%E4%B8%8D%E5%90%8C%E7%B1%BB%E5%9E%8B%E5%8F%98%E9%87%8F/#using-gcc-build-in-typeof-instead-of-_generic","title":"using GCC build-in <code>typeof</code> instead of <code>_Generic</code>","text":"<pre><code>#include &lt;stdio.h&gt;\n\n#define PRINT_VAR_TYPEOF(var)                                                  \\\n  do {                                                                         \\\n    printf(\"%s = \", #var);                                                     \\\n    char *format = NULL;                                                       \\\n    __typeof__(var) _v = (var);                                                \\\n    if (__builtin_types_compatible_p(__typeof__(_v), int))                     \\\n      format = \"%d\\n\";                                                         \\\n    else if (__builtin_types_compatible_p(__typeof__(_v), float))              \\\n      format = \"%.2f\\n\";                                                       \\\n    else if (__builtin_types_compatible_p(__typeof__(_v), double))             \\\n      format = \"%.2f\\n\";                                                       \\\n    else if (__builtin_types_compatible_p(__typeof__(_v), char))               \\\n      format = \"%c\\n\";                                                         \\\n    printf(format, (var));                                                     \\\n  } while (0)\n</code></pre>","tags":["c"]},{"location":"blog/gcc-%E4%BC%9A%E4%BC%98%E5%8C%96%E5%BE%88%E5%A4%9A%E5%86%85%E5%AD%98%E7%9B%B8%E5%85%B3%E7%9A%84%E8%B0%83%E7%94%A8/","title":"gcc \u4f1a\u4f18\u5316\u5f88\u591a\u5185\u5b58\u76f8\u5173\u7684\u8c03\u7528","text":"<p>\u4ed6\u4eec\u901a\u5e38\u5728'string.h'\u91cc\uff0c\u6bd4\u5982memcpy, \u5f53\u7f16\u8bd1\u5668\u901a\u8fc7\u4e0a\u4e0b\u6587\u80fd\u63a8\u65ad\u51fa\u4f20\u5165\u53c2\u6570\u7c7b\u578b\uff0clibc\u7684mempcy\u5c31\u4f1a\u66ff\u6362\u4e3agcc\u7684memcpy, \u8fd9\u53ef\u80fd\u5bfc\u81f4\u95ee\u9898</p>","tags":["c","cpp","gcc"]},{"location":"blog/gcc-%E4%BC%9A%E4%BC%98%E5%8C%96%E5%BE%88%E5%A4%9A%E5%86%85%E5%AD%98%E7%9B%B8%E5%85%B3%E7%9A%84%E8%B0%83%E7%94%A8/#_1","title":"\u4e3e\u4f8b","text":"<p>\u77e5\u4e4e\u8bc4\u8bba\u7684\uff0crelease\u7248\u672c\u7684memset\u88ab\u66ff\u6362, \u5bfc\u81f4\u8ddfdebug\u7248\u672c\u4e0d\u540c\u884c\u4e3abug <pre><code>https://www.zhihu.com/question/435258463/answer/1969561682\n</code></pre></p>","tags":["c","cpp","gcc"]},{"location":"blog/gcc-%E4%BC%9A%E4%BC%98%E5%8C%96%E5%BE%88%E5%A4%9A%E5%86%85%E5%AD%98%E7%9B%B8%E5%85%B3%E7%9A%84%E8%B0%83%E7%94%A8/#_2","title":"\u5185\u5b58\u5730\u5740\u5bf9\u9f50","text":"<p>\u5982\u679c\u5185\u5b58\u5730\u5740\u5bf9\u9f50\u7684\uff0c\u90a3\u4e48'\u53d6\u503c\u5730\u5740\u88ab\u53d6\u503c\u957f\u5ea6\u6c42\u6a21\u4e3a0'\uff0c\u4f8b\u5982<code>int i</code>, \u5219\u8981\u6c42<code>(void*)&amp;i % sizeof(int) == 0</code> </p>","tags":["c","cpp","gcc"]},{"location":"blog/gcc-%E4%BC%9A%E4%BC%98%E5%8C%96%E5%BE%88%E5%A4%9A%E5%86%85%E5%AD%98%E7%9B%B8%E5%85%B3%E7%9A%84%E8%B0%83%E7%94%A8/#_3","title":"\u539f\u56e0","text":"<p>\u5f53\u540c\u65f6\u5b9a\u4e49\u591a\u4e2a\u53d8\u91cf\u65f6\uff0c\u4e0d\u8003\u8651\u7f16\u8bd1\u5668\u4f18\u5316\uff0c\u5219\u4ed6\u4eec\u5728\u5185\u5b58\u7684\u4f4d\u7f6e\u76f8\u90bb\u3002\u6309\u7167\u4e0d\u540c\u7684\u5bf9\u9f50\u957f\u5ea6\uff0c\u6709\u4e0d\u540c\u7684\u5360\u7528\u5927\u5c0f \u8fd9\u91cc\u4ee5\u7ed3\u6784\u4f53\u4e3e\u4f8b</p> <p><pre><code>struct bar{\n    int interger;\n        char charactor;\n        long long longlong;\n};\n</code></pre> \u4f7f\u7528<code>#pragma pack(4)</code> \u8bbe\u7f6e\u63094\u5b57\u8282\u5bf9\u9f50\uff0c\u9ed8\u8ba4\u4e5f\u662f4\u5b57\u8282\uff0c\u90a3\u4e48<code>sizeof(struct abc) == 16</code> \u4f7f\u7528gdb\u6253\u5370\u5185\u5b58\u5730\u5740\uff0c\u53ef\u89c1\u5730\u5740\u90fd\u5bf9\u9f50\u7684: '0x7fffffffe430&amp;4==0' '0x7fffffffe438%8==0' <pre><code>(gdb) p sizeof(struct abc)\n$5 = 16\n(gdb) p &amp;a.interger \n$1 = (int *) 0x7fffffffe430\n(gdb) p &amp;a.charactor \n$2 = 0x7fffffffe434 \"\\232\\177\"\n(gdb) p &amp;a.longlong \n$3 = (long long *) 0x7fffffffe438\n(gdb) p &amp;a\n$4 = (abc *) 0x7fffffffe430\n</code></pre></p> <p>\u987a\u4fbf\u63d0\u4e00\u4e0b\uff0c\u6307\u9488\u6307\u5411\u7684\u662f\u5185\u5b58\u6bb5\u7684\u4f4e\u5730\u5740\uff0c\u6240\u4ee5\u6709\u4e2a\u9762\u8bd5\u9898\u662f\u5224\u65ad\u7cfb\u7edf\u662f\u5927\u7aef\u5c0f\u7aef\u7684\u65b9\u6cd5\u5982\u4e0b \u901a\u8fc7\u5982\u4e0b\u5f3a\u8f6cint\u4e3achar, \u5982\u679c<code>c==0x12</code>\u5219\u4e3a\u5927\u7aef\uff0c\u5426\u5219\u4e3a\u5c0f\u7aef\u7cfb\u7edf <pre><code>int i=0x12345678;\nchar c=(char)i;\n</code></pre></p> <p>\u4f7f\u7528<code>#pragma pack(1)</code> \u8bbe\u7f6e\u4e3a\u63091\u5b57\u8282\u5bf9\u9f50\uff0c\u5219\u4e0a\u9762\u7684\u7ed3\u6784\u4f53\u5927\u5c0f\u4e3a'13'\uff0c\u663e\u7136\u66f4\u7701\u5185\u5b58\u4e86 \u4f46\u901a\u8fc7\u53d6\u5730\u5740\u4f1a\u53d1\u73b0\u5730\u5740\u672a\u5bf9\u9f50, \u6c42\u6a21\u4e0d\u4e3a0\u3002 \u4f46\u6211\u81ea\u5df1\u4f7f\u7528gcc\u6d4b\u8bd5\u5730\u5740\u4f9d\u65e7\u5bf9\u9f50\u7684\uff0c\u539f\u56e0\u662f\u7f16\u8bd1\u5668\u4f1a\u8fdb\u884c\u81ea\u7136 \u5bf9\u9f50</p>","tags":["c","cpp","gcc"]},{"location":"blog/gcc-%E4%BC%9A%E4%BC%98%E5%8C%96%E5%BE%88%E5%A4%9A%E5%86%85%E5%AD%98%E7%9B%B8%E5%85%B3%E7%9A%84%E8%B0%83%E7%94%A8/#_4","title":"\u81ea\u7136\u5bf9\u9f50","text":"<p>\u4e0a\u9762\u7684<code>#pragma pack(1)</code>\u867d\u7136\u4f7f\u5f97longlong\u7684\u5730\u5740\u5bf9\u4e8ebar\u6765\u8bf4\u504f\u79fb\u4e865\u5b57\u8282\uff0c\u4f46\u7f16\u8bd1\u5668\u59cb\u7ec8\u80fd\u8c03\u6574bar\u7684\u8d77\u59cb\u5730\u5740\u4f7f\u5f97longlong\u7684\u5730\u5740\u5bf9\u9f50 <pre><code>595fac88 \nc3c5a2d8\n105d3ab8\n</code></pre></p>","tags":["c","cpp","gcc"]},{"location":"blog/gcc-%E4%BC%9A%E4%BC%98%E5%8C%96%E5%BE%88%E5%A4%9A%E5%86%85%E5%AD%98%E7%9B%B8%E5%85%B3%E7%9A%84%E8%B0%83%E7%94%A8/#_5","title":"\u4e0d\u5bf9\u9f50\u7684\u574f\u5904","text":"<p>\u867d\u7136\u4e0a\u9762\u8bf4\u4e86\u7f16\u8bd1\u5668\u80fd\u81ea\u7136\u5bf9\u9f50\uff0c\u4f46\u8fd8\u662f\u4f1a\u771f\u7684\u51fa\u73b0\u4e0d\u5bf9\u9f50\u8bbf\u95ee\u3002\u7531\u4e8e\u5bf9\u5185\u5b58\u7684\u8bbf\u95ee\u6d89\u53ca\u5230\u5177\u4f53\u786c\u4ef6\u7684\u5b9e\u73b0\uff0c\u6240\u4ee5\u4e00\u822c\u4f1a\u6709\u51e0\u79cd\u5f71\u54cd 1. \u786c\u4ef6\u5e73\u53f0\u652f\u6301\u975e\u5bf9\u9f50\u8bbf\u95ee\uff0c\u4f46\u6027\u80fd\u6709\u635f\u8017 2. \u629b\u51fa\u5f02\u5e38\u7ed9cpu,\u7531cpu\u6765\u6821\u51c6\uff0c\u6027\u80fd\u6709\u66f4\u5927\u635f\u8017 3. \u5e73\u53f0\u4e0d\u652f\u6301\uff0c\u4f46\u4e5f\u4e0d\u629b\u5f02\u5e38\uff0c\u83b7\u53d6\u7684\u662f\u9519\u8bef\u7684\u503c\uff0c\u5bfc\u81f4\u96be\u5b9a\u4f4d\u7684\u5f02\u5e38</p>","tags":["c","cpp","gcc"]},{"location":"blog/gcc-%E4%BC%9A%E4%BC%98%E5%8C%96%E5%BE%88%E5%A4%9A%E5%86%85%E5%AD%98%E7%9B%B8%E5%85%B3%E7%9A%84%E8%B0%83%E7%94%A8/#_6","title":"\u5f15\u7528","text":"<p>https://www.kernel.org/doc/html/latest/core-api/unaligned-memory-access.html</p>","tags":["c","cpp","gcc"]},{"location":"blog/gdb%E8%B0%83%E8%AF%95%E5%AE%B9%E5%99%A8%E5%86%85%E7%9A%84%E8%BF%9B%E7%A8%8B/","title":"gdb\u8c03\u8bd5\u5bb9\u5668\u5185\u7684\u8fdb\u7a0b","text":"<p>\u5148\u6765\u4e2agdb\u624b\u518c\u94fe\u63a5 \u8fd9\u91cc\u8bb0\u5f55\u4e00\u4e0b\u81ea\u5df1\u5e38\u7528\u7684\u6280\u5de7</p>","tags":["c","cpp","gdb"]},{"location":"blog/gdb%E8%B0%83%E8%AF%95%E5%AE%B9%E5%99%A8%E5%86%85%E7%9A%84%E8%BF%9B%E7%A8%8B/#debug","title":"\u6062\u590ddebug\u7b26\u53f7","text":"<p>\u901a\u5e38\u4e0a\u7ebf\u7684\u7a0b\u5e8f\u8981strip\u7b26\u53f7\u8868\u6765\u51cf\u5c11\u5185\u5b58\u5360\u7528\u548c\u786c\u76d8\u5360\u7528\uff0c\u4f1a\u6267\u884c\u4ee5\u4e0b\u547d\u4ee4 <pre><code>## 1. \u53ea\u4fdd\u7559debug\u8868\u7684\u5185\u5bb9\uff08\u53ef\u9009\uff09\uff0c\u4e3a\u4ee5\u540e\u8c03\u8bd5\u7528\uff0c\u751f\u4ea7\u65f6\u4e0d\u7528\nobjcopy --only-keep-debug foo foo.dbg\n\n## 2. \u5c06foo\u7684debug\u8868\u5220\u9664\uff0c\u4e0d\u8981\u4efb\u4f55\u8c03\u8bd5\u4fe1\u606f\uff0c\u7528\u4e8e\u751f\u4ea7\u4f7f\u7528\nobjcopy --strip-debug  foo \n</code></pre></p> <p>\u5982\u679c\u751f\u4ea7\u51fa\u95ee\u9898\u4e86\uff0c\u5c31\u9700\u8981\u6062\u590ddebug\u4fe1\u606f\uff0cadd-gnu-debuglink\u53c2\u6570\u53ef\u4ee5\u662ffoo.dbg, \u4e5f\u53ef\u4ee5\u5c31\u662fstrip\u4e4b\u524d\u7684foo\u6587\u4ef6 \u6240\u4ee5\u7b2c\u4e00\u6b65\u662f\u53ef\u9009\u7684 </p> <pre><code>## 3. \u6062\u590ddebug\u4fe1\u606f\nobjcopy --add-gnu-debuglink=foo.dbg foo\n</code></pre> <p>\u4f46\u5176\u5b9e\u7b2c\u4e09\u6b65\u4e5f\u662f\u53ef\u9009\u7684\uff0c\u53ea\u8981\u628afoo.dbg\u653e\u5230foo\u76f8\u540c\u4f4d\u7f6e\u65f6\uff0cgdb\u5c31\u53ef\u4ee5\u8bfb\u53d6\u5230debug\u4fe1\u606f</p>","tags":["c","cpp","gdb"]},{"location":"blog/gdb%E8%B0%83%E8%AF%95%E5%AE%B9%E5%99%A8%E5%86%85%E7%9A%84%E8%BF%9B%E7%A8%8B/#gdbinit","title":"\u4f7f\u7528.gdbinit","text":"<p>.gdbinit \u6587\u4ef6\u662f\u7c7b\u4f3c.bash_profile\u7684\u6587\u4ef6\uff0c\u4e00\u822c\u5728home\u76ee\u5f55\u6216\u8005\u9879\u76ee\u6839\u76ee\u5f55, gdb \u81ea\u52a8\u8bfb\u53d6   \u4e5f\u53ef\u4ee5\u624b\u52a8\u8bfb\u53d6\u5176\u4ed6\u4f4d\u7f6e\u7684, \u5728gdb\u6267\u884c<code>source /somedir/.gdbinit</code></p> <p>\u901a\u5e38\u53ef\u4ee5\u5728\u8fd9\u4e2a\u6587\u4ef6\u91cc\u5b9a\u4e49\u4e00\u4e9b\u8bbe\u7f6e\u4f8b\u5982<code>set pagination off</code> \u5173\u95ed\u8f93\u51fa\u5206\u9875, \u5c31\u4e0d\u7528\u6bcf\u6b21\u4ea4\u4e92\u786e\u5b9a \u8fd8\u53ef\u4ee5\u5b9a\u4e49\u547d\u4ee4 \u5982pvector\u53ef\u4ee5\u6253\u5370vector\u5185\u7684\u6240\u6709\u6210\u5458, \u975e\u5e38\u6bd4\u8f83\u65b9\u4fbf</p>","tags":["c","cpp","gdb"]},{"location":"blog/gdb%E8%B0%83%E8%AF%95%E5%AE%B9%E5%99%A8%E5%86%85%E7%9A%84%E8%BF%9B%E7%A8%8B/#gdb_1","title":"gdb \u8c03\u8bd5\u5bb9\u5668\u5185\u7684\u8fdb\u7a0b","text":"<p>\u56e0\u4e3a\u5bb9\u5668\u5185\u8fd0\u884c\u7684\u7a0b\u5e8f\u90fd\u662fstrip\u4e86debug\u7b26\u53f7\u7684\uff0c\u6240\u4ee5\u4e4b\u524d\u8c03\u8bd5\u90fd\u662f\u5148\u5c06debug\u6587\u4ef6\u590d\u5236\u5230\u5bb9\u5668\u5bf9\u5e94\u4f4d\u7f6e\uff0c\u7136\u540e\u5c06\u6e90\u7801\u4e5f\u6620\u5c04\u5230\u5bb9\u5668\u5185\uff0c\u800c\u4e14\u8fd8\u8981\u5b89\u88c5gdb\u548c\u91cd\u65b0\u5f00\u542fpriveledge\u6a21\u5f0f\uff0c \u975e\u5e38\u7e41\u7410\u3002  \u6240\u4ee5\u5c1d\u8bd5\u5982\u4e0b\u64cd\u4f5c\uff1a 1. \u80fd\u4e0d\u80fd\u5355\u72ec\u4e00\u4e2a\u5bb9\u5668\u5b89\u88c5gdb\u548c\u7b26\u53f7\u548c\u4ee3\u7801\u6587\u4ef6\uff0c \u8de8\u5bb9\u5668\u53bb\u8c03\u8bd5\u53e6\u4e00\u4e2a\u5bb9\u5668\u7684\u8fdb\u7a0b\u5462\uff1f  2. \u80fd\u4e0d\u80fd\u5728\u5bbf\u4e3b\u673a\u4e0a\u76f4\u63a5\u8c03\u8bd5\u5bb9\u5668\u8fdb\u7a0b\u5462\uff1f   </p> <p>\u7ecf\u8fc7\u4e00\u756a\u641c\u7d22\uff0c\u6ca1\u6709\u7b2c\u4e00\u79cd\u65b9\u6848\u7684\u5b9e\u8df5\u529e\u6cd5\uff0c\u4f46\u7b2c\u4e8c\u79cd\u65b9\u6848\u4eb2\u6d4b\u53ef\u884c\uff01</p>","tags":["c","cpp","gdb"]},{"location":"blog/gdb%E8%B0%83%E8%AF%95%E5%AE%B9%E5%99%A8%E5%86%85%E7%9A%84%E8%BF%9B%E7%A8%8B/#_1","title":"\u6b65\u9aa4","text":"<ol> <li>\u5148\u542f\u52a8\u5bb9\u5668\uff0c\u4e00\u822c\u4e1a\u52a1\u4e3b\u8fdb\u7a0b\u7684pid\u4e3a1  </li> <li>\u5728\u5bb9\u5668\u5916\u9762\u6267\u884c<code>ps aux | grep xxx</code>\uff0c\u56e0\u4e3a\u5728\u5f88\u591a\u60c5\u51b5\u662f\u591a\u4e2a\u5bb9\u5668\u8dd1\u540c\u4e00\u4e2a\u7a0b\u5e8f\uff0c\u6240\u4ee5<code>ps aux</code> \u901a\u8fc7\u53c2\u6570\u540d\u6765\u786e\u5b9a\u8fdb\u7a0b\u7684pid\uff0c \u5f53\u7136\u6700\u597d\u7684\u65b9\u5f0f\u662f\u901a\u8fc7\u8fdb\u7a0bnamespace\u4e86 </li> <li>\u4f7f\u7528sudo gdb -p pid\uff0c \u63d0\u793a\u7f3a\u5c11<code>Missing separate debuginfo for target</code></li> <li>\u5c06debug\u7b26\u53f7\u6587\u4ef6\u590d\u5236\u5230\u5bb9\u5668\u5bf9\u5e94\u5bb9\u5668\u7684\u76ee\u5f55</li> <li>\u518d\u6b21attach\uff0c\u63d0\u793a\u7f3a\u5c11\u6e90\u6587\u4ef6<code>/builds/project/src/aaa.cpp</code>\uff0c\u8fd9\u662fcmake\u7f16\u8bd1\u65f6\u7684\u76ee\u5f55\uff0c\u9700\u8981\u66ff\u6362</li> <li>\u5728gdb\u91cc\u6267\u884c\u547d\u4ee4 set substitute-path /builds/ /home/my-home/  # from -&gt; to</li> <li>\u7136\u540e\u4f7f\u7528l\u53ef\u4ee5\u67e5\u770b\u5bf9\u5e94\u7684\u6e90\u4ee3\u7801\u4e86</li> </ol>","tags":["c","cpp","gdb"]},{"location":"blog/gdb%E8%B0%83%E8%AF%95%E5%AE%B9%E5%99%A8%E5%86%85%E7%9A%84%E8%BF%9B%E7%A8%8B/#_2","title":"\u603b\u7ed3","text":"<p>\u53ef\u4ee5\u76f4\u63a5\u5728\u5bbf\u4e3b\u673a\u4e0a\u8fd0\u884cgdb\u6765\u8c03\u8bd5\u5bb9\u5668\u8fdb\u7a0b\uff0c\u5e76\u66ff\u6362\u4ee3\u7801\u8def\u5f84\u4e3a\u5bbf\u4e3b\u673a\u7684\u76ee\u5f55\u3002 </p> <p>ps: gdb \u542f\u52a8\u65f6\u9ed8\u8ba4\u4f1a\u8bfb\u53d6~/.gdbinit \u6587\u4ef6, \u4f46\u662fgdb\u4f1a\u63d0\u793a, \u8fd9\u662f\u7531\u4e8e\u8c03\u8bd5docker\u9700\u8981sudo\u6743\u9650\uff0c\u800c\u6211\u7684gdbinit\u5728\u975eroot\u76ee\u5f55</p> <pre><code>warning: File \"/home/h/.gdbinit\" auto-loading has been declined by your `auto-load safe-path' set to \"$debugdir:$datadir/auto-load\".                                                        \nTo enable execution of this file add                                                                                                                                                          \n        add-auto-load-safe-path /home/h/.gdbinit                                                                                                                                            \nline to your configuration file \"/root/.gdbinit\".                                                                                                                                             \nTo completely disable this security protection add                                                                                                                                            \n        set auto-load safe-path /                                                                                                                                                             \nline to your configuration file \"/root/.gdbinit\".                                                                                                                                             \n</code></pre> <p>\u4e5f\u5c31\u662f\u9700\u8981\u624b\u52a8\u6267\u884c<code>set auto-load safe-path /</code> \u6216\u8005\u5c06 <code>add-auto-load-safe-path /home/h/.gdbinit</code>\u5199\u5165/root/.gdbinit </p>","tags":["c","cpp","gdb"]},{"location":"blog/ways-of-generating-compile-command-json-file/","title":"ways of generating compile command json file","text":"<p>clangd is programming language server of clang, requires a compile_commands.json file located in source code directory for the best. I recommend intercept-build for generating the file, because it is included in clang-tools package when compiling via make and makefile.</p> <ul> <li>intercept-build make -B</li> <li>bear make -B</li> <li>compiledb make -B</li> <li>meson, cmake</li> <li>codechecker</li> </ul> <p>or use bash script <pre><code>make --always-make --dry-run \\\n | grep -wE 'gcc|g\\+\\+' \\\n | grep -w '\\-c' \\\n | jq -nR '[inputs|{directory:\".\", command:., file: match(\" [^ ]+$\").string[1:]}]' \\\n &gt; compile_commands.json\n</code></pre></p>","tags":["clang","dev-tool"]},{"location":"blog/ways-of-generating-compile-command-json-file/#reference","title":"reference","text":"<p>https://releases.llvm.org/11.0.1/tools/clang/docs/JSONCompilationDatabase.html https://gist.github.com/gtors/effe8eef7dbe7052b22a009f3c7fc434 https://stackoverflow.com/questions/21134120/how-to-turn-makefile-into-json-compilation-database</p>","tags":["clang","dev-tool"]},{"location":"blog/%E8%8E%B7%E5%8F%96%E5%85%B6%E4%BB%96%E8%BF%9B%E7%A8%8B%E6%89%93%E5%BC%80%E7%9A%84%E6%96%87%E4%BB%B6%E6%8F%8F%E8%BF%B0%E7%AC%A6/","title":"\u83b7\u53d6\u5176\u4ed6\u8fdb\u7a0b\u6253\u5f00\u7684\u6587\u4ef6\u63cf\u8ff0\u7b26","text":"<p>fd\u662f\u6587\u4ef6\u63cf\u8ff0\u7b26\uff0c\u6bcf\u4e2a\u8fdb\u7a0b\u7684fd\u662f\u4e0d\u5171\u4eab\u7684\uff0c\u53ea\u80fd\u5728\u5f53\u524d\u8fdb\u7a0b\u64cd\u4f5c\u3002\u53ef\u4ee5\u901a\u8fc7\u547d\u4ee4<code>ls /proc/self/fd -l</code>\u770b\u5230\u6253\u5f00\u7684fd\u3002\u4f8b\u5982\u4e00\u773c\u80fd\u731c\u52300,1,2\u5c31\u662f\u8f93\u5165\u8f93\u51fa\u548c\u9519\u8bef\u8f93\u51fa\u90fd\u5173\u8054\u5230\u4e86\u7ec8\u7aef\u3002\u90a3\u5982\u679c\u8981\u4ece\u5176\u4ed6\u8fdb\u7a0b\u5199\u5165\u6253\u5f00\u7684\u6587\u4ef6\u5462\uff0c\u90a3\u5c31\u8981\u5148\u83b7\u53d6\u5230fd, \u5f53\u7136\u4e0d\u80fd\u590d\u5236fd\u7684\u503c\uff0c\u56e0\u4e3a\u8fd9\u4e2a\u503c\u53ea\u5bf9\u672c\u8fdb\u7a0b\u6709\u6548\u3002</p> <p></p> <pre><code># ls /proc/self/fd -l\ntotal 0\nlrwx------ 1 hst hst 64 Jul 24 14:59 0 -&gt; /dev/pts/13\nlrwx------ 1 hst hst 64 Jul 24 14:59 1 -&gt; /dev/pts/13\nlrwx------ 1 hst hst 64 Jul 24 14:59 2 -&gt; /dev/pts/13\nlr-x------ 1 hst hst 64 Jul 24 14:59 3 -&gt; /proc/2453780/fd\n</code></pre> <p>\u800csendmsg \u548c CMSG\u53ef\u4ee5\u5c06\u672c\u8fdb\u7a0b\u6253\u5f00\u7684\u6587\u4ef6\u63cf\u8ff0\u7b26\u53d1\u9001\u7ed9\u5176\u4ed6\u8fdb\u7a0b\uff0c\u5176\u4ed6\u8fdb\u7a0b\u4e5f\u80fd\u8bfb\u5199\u8be5\u6587\u4ef6\u3002\u5f53\u7136\u662f\u5728\u540c\u4e3b\u673a\u4e0b\u3002</p> <p>\u6ce8\u610f fork, CMSG, pidfd_getfd \u83b7\u5f97\u7684\u6587\u4ef6node\u662f\u5171\u4eab\u7684\uff0c\u5305\u62ec\u5199\u5165\u8bfb\u53d6\u7684\u504f\u79fb\u91cf</p>","tags":["linux","CMSG","sctp","file"]},{"location":"blog/%E8%8E%B7%E5%8F%96%E5%85%B6%E4%BB%96%E8%BF%9B%E7%A8%8B%E6%89%93%E5%BC%80%E7%9A%84%E6%96%87%E4%BB%B6%E6%8F%8F%E8%BF%B0%E7%AC%A6/#sendmsgrecvmsg","title":"sendmsg/recvmsg \u53d1\u9001\u63a5\u6536\u6587\u4ef6\u63cf\u8ff0\u7b26","text":"","tags":["linux","CMSG","sctp","file"]},{"location":"blog/%E8%8E%B7%E5%8F%96%E5%85%B6%E4%BB%96%E8%BF%9B%E7%A8%8B%E6%89%93%E5%BC%80%E7%9A%84%E6%96%87%E4%BB%B6%E6%8F%8F%E8%BF%B0%E7%AC%A6/#_2","title":"\u53d1\u9001","text":"<pre><code>void send_fd(int socket, int fd_to_send) {\n    struct msghdr msg = {0};\n    char buf[CMSG_SPACE(sizeof(int))];\n    memset(buf, 0, sizeof(buf));\n\n    struct cmsghdr *cmsg;\n    char iobuf[1] = {0};\n    struct iovec io = {\n        .iov_base = iobuf,\n        .iov_len = sizeof(iobuf)\n    };\n\n    msg.msg_iov = &amp;io;\n    msg.msg_iovlen = 1;\n    msg.msg_control = buf;\n    msg.msg_controllen = sizeof(buf);\n\n    cmsg = CMSG_FIRSTHDR(&amp;msg);\n    cmsg-&gt;cmsg_level = SOL_SOCKET;\n    cmsg-&gt;cmsg_type = SCM_RIGHTS;\n    cmsg-&gt;cmsg_len = CMSG_LEN(sizeof(int));\n\n    memcpy(CMSG_DATA(cmsg), &amp;fd_to_send, sizeof(int));\n\n    if (sendmsg(socket, &amp;msg, 0) == -1) {\n        perror(\"sendmsg\");\n        exit(-1);\n    }\n}\n</code></pre>","tags":["linux","CMSG","sctp","file"]},{"location":"blog/%E8%8E%B7%E5%8F%96%E5%85%B6%E4%BB%96%E8%BF%9B%E7%A8%8B%E6%89%93%E5%BC%80%E7%9A%84%E6%96%87%E4%BB%B6%E6%8F%8F%E8%BF%B0%E7%AC%A6/#_3","title":"\u63a5\u6536","text":"<pre><code>int recv_fd(int socket) {\n    struct msghdr msg = {0};\n    char m_buffer[1] = {0};\n    struct iovec io = {\n        .iov_base = m_buffer,\n        .iov_len = sizeof(m_buffer)\n    };\n\n    char cmsgbuf[CMSG_SPACE(sizeof(int))];\n    msg.msg_iov = &amp;io;\n    msg.msg_iovlen = 1;\n    msg.msg_control = cmsgbuf;\n    msg.msg_controllen = sizeof(cmsgbuf);\n\n    if (recvmsg(socket, &amp;msg, 0) == -1) {\n        perror(\"recvmsg\");\n        exit(-1);\n    }\n\n    struct cmsghdr *cmsg = CMSG_FIRSTHDR(&amp;msg);\n    int fd;\n    memcpy(&amp;fd, CMSG_DATA(cmsg), sizeof(int));\n    return fd;\n}\n</code></pre>","tags":["linux","CMSG","sctp","file"]},{"location":"blog/%E8%8E%B7%E5%8F%96%E5%85%B6%E4%BB%96%E8%BF%9B%E7%A8%8B%E6%89%93%E5%BC%80%E7%9A%84%E6%96%87%E4%BB%B6%E6%8F%8F%E8%BF%B0%E7%AC%A6/#pidfd_getfd","title":"\u66f4\u7b80\u5355\u7684\u65b9\u6cd5\u83b7\u53d6\u6587\u4ef6\u63cf\u8ff0\u7b26 pidfd_getfd","text":"<p>Linux 5.6\u540e\uff0cpidfd_getfd \u53ef\u4ee5\u7528\u6765\u83b7\u53d6\u5176\u4ed6\u8fdb\u7a0b\u6253\u5f00\u7684fd\uff0c\u56e0\u4e3aglibc\u6ca1\u6709\u5305\u88c5\u8fd9\u4e2a\u51fd\u6570\uff0c\u6240\u4ee5\u7528syscall\uff0c\u6c47\u7f16\u4ee3\u7801\u91cc\u4e5f\u770b\u5230syscall\u3002 <pre><code>       int syscall(SYS_pidfd_getfd, int pidfd, int targetfd,\n                   unsigned int flags);\n\n       Note: glibc provides no wrapper for pidfd_getfd(), necessitating\n       the use of syscall(2).\n</code></pre></p>","tags":["linux","CMSG","sctp","file"]},{"location":"blog/%E8%8E%B7%E5%8F%96%E5%85%B6%E4%BB%96%E8%BF%9B%E7%A8%8B%E6%89%93%E5%BC%80%E7%9A%84%E6%96%87%E4%BB%B6%E6%8F%8F%E8%BF%B0%E7%AC%A6/#fork","title":"\u8fd8\u6709\u66f4\u7b80\u5355\u7684fork\u7ee7\u627f\u6587\u4ef6\u63cf\u8ff0\u7b26","text":"<p>fork\u524d\u5148\u6253\u5f00\u6587\u4ef6\uff0c\u8fd9\u6837\u4e24\u4e2a\u8fdb\u7a0b\u90fd\u80fd\u8bfb\u5199\u6587\u4ef6\u4e86\u3002 <pre><code>int fd = open(\"text.txt\", O_RDONLY);\nfork();\n</code></pre></p>","tags":["linux","CMSG","sctp","file"]},{"location":"blog/%E8%8E%B7%E5%8F%96%E5%85%B6%E4%BB%96%E8%BF%9B%E7%A8%8B%E6%89%93%E5%BC%80%E7%9A%84%E6%96%87%E4%BB%B6%E6%8F%8F%E8%BF%B0%E7%AC%A6/#reference","title":"reference","text":"<p>https://www.man7.org/linux/man-pages/man3/cmsg.3.html https://man7.org/linux/man-pages/man2/pidfd_getfd.2.html https://stackoverflow.com/questions/2358684/can-i-share-a-file-descriptor-to-another-process-on-linux-or-are-they-local-to-t</p>","tags":["linux","CMSG","sctp","file"]},{"location":"blog/git%E7%9A%84%E9%87%8D%E8%A6%81%E6%93%8D%E4%BD%9C/","title":"Git\u7684\u91cd\u8981\u64cd\u4f5c","text":"","tags":["git","tool"]},{"location":"blog/git%E7%9A%84%E9%87%8D%E8%A6%81%E6%93%8D%E4%BD%9C/#git_1","title":"Git\u767b\u5f55\u4fe1\u606f","text":"<p>\u5728\u4e34\u65f6\u73af\u5883\u4e0b\u62c9\u4ee3\u7801\uff0c \u5982\u679c\u91cd\u65b0\u751f\u6210\u5bc6\u94a5\u518d\u6dfb\u52a0\u5230\u6258\u7ba1\u5e73\u53f0\u6bd4\u8f83\u9ebb\u70e6\uff0c\u8981\u4e48\u62f7\u8d1d\u81ea\u5df1\u7684\u79c1\u94a5\u8fc7\u6765\uff0c\u66f4\u52a0\u4e0d\u5b89\u5168\u3002 \u8fd9\u65f6\u5019\u4e34\u65f6\u7528\u5bc6\u7801\u767b\u5f55\u6700\u9002\u5408\u4e86\uff0c \u4f46\u662f\u6bcf\u4e2apull fetch\u64cd\u4f5c\u90fd\u8981\u767b\u5f55\uff0c\u8fd9\u5f88\u70e6\u8e81\uff0c\u6240\u4ee5\u4e0b\u9762\u67092\u4e2a\u65b9\u6cd5\u89e3\u51b3</p>","tags":["git","tool"]},{"location":"blog/git%E7%9A%84%E9%87%8D%E8%A6%81%E6%93%8D%E4%BD%9C/#_1","title":"\u8bbe\u7f6e\u5bc6\u7801\u6682\u5b58","text":"<p>\u6307\u7c7b\u4f3csudo\u547d\u4ee4\u4e00\u6837\uff0c \u6821\u9a8c\u6210\u529f\u4e4b\u540e\u4e00\u6bb5\u65f6\u95f4\uff0c\u4e0d\u9700\u8981\u8f93\u5165\u5bc6\u7801 <pre><code>git config --global   credential.helper 'cache --timeout 900'\n</code></pre> \u6211\u4eec\u90fd\u77e5\u9053Git \u7684\u914d\u7f6e\u52063\u79cd\u7ea7\u522b local system global\uff0c \u8fd9\u91cc\u63a8\u8350global\u3002 \u56e0\u4e3a\u53ea\u8bbe\u7f6elocal\uff0c\u5728\u6709submodule\u7684\u60c5\u51b5\u4e0b\uff0c\u540c\u6837\u4f1a\u63d0\u793a\u8f93\u5165\u5bc6\u7801\u3002</p>","tags":["git","tool"]},{"location":"blog/git%E7%9A%84%E9%87%8D%E8%A6%81%E6%93%8D%E4%BD%9C/#_2","title":"\u8bbe\u7f6e\u5bc6\u7801\u6c38\u5b58","text":"<p>\u4e0d\u63a8\u8350  <pre><code>git config --global   credential.helper store\n</code></pre></p>","tags":["git","tool"]},{"location":"blog/git%E7%9A%84%E9%87%8D%E8%A6%81%E6%93%8D%E4%BD%9C/#git_2","title":"git\u4e3a\u4e0d\u540c\u9879\u76ee\u914d\u7f6e\u4e0d\u540c\u7684\u7528\u6237\u540d\u548c\u90ae\u7bb1","text":"<p>\u7535\u8111\u4e2d\u540c\u65f6\u6709\u4e2a\u4eba\u9879\u76ee\u548c\u516c\u53f8\u9879\u76ee\u65f6\uff0c\u6709\u65f6\u5019\u4f1a\u5bfc\u81f4commit \u6d88\u606f\u91cc\u9762\u7684\u90ae\u4ef6\u641e\u4e32\u4e86\u3002\u53ef\u4ee5\u901a\u8fc7git\u914d\u7f6e\u4e0d\u540c\u76ee\u5f55\u4e0b\u7684\u9879\u76ee\u4f7f\u7528\u4e0d\u540c\u7684\u4fe1\u606f\u3002\u53c2\u8003</p>","tags":["git","tool"]},{"location":"blog/go-%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/","title":"go \u5b66\u4e60\u7b14\u8bb0","text":"","tags":["golang"]},{"location":"blog/go-%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/#go_1","title":"go\u4e3a\u4ec0\u4e48\u8981\u6307\u9488\u548c\u4ec0\u4e48\u65f6\u5019\u5fc5\u987b\u7528\u6307\u9488","text":"<ol> <li>\u4f20\u9012waitgroup\u65f6</li> <li>\u83b7\u53d6\u547d\u4ee4\u884c\u53c2\u6570</li> </ol>","tags":["golang"]},{"location":"blog/go-%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/#_1","title":"\u5168\u5c40\u53d8\u91cf\u548c\u591a\u53d8\u91cf\u8d4b\u503c\u95ee\u9898","text":"<p>\u56e0\u4e3a\u5f88\u591a\u51fd\u6570\u9700\u8981\u5904\u7406error, \u5f53\u5b58\u5728\u5168\u5c40\u53d8\u91cf\u65f6\uff0c\u53ef\u80fd\u4f1a\u8986\u76d6\u5168\u5c40\u53d8\u91cf</p> <p><pre><code>var global_var int = 1\nfunc foo(){\n  // \u6b64\u65f6\u8986\u76d6\u4e86\u5168\u5c40\u53d8\u91cf\n  global_var, err := os.OpenFile(\"file\")\n}\n</code></pre> \u5e94\u6539\u4e3a <pre><code>var global_var int = 1\nfunc foo(){\n  var err error\n  global_var, error = os.OpenFile(\"file\")\n}\n</code></pre></p>","tags":["golang"]},{"location":"blog/go-%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/#slice","title":"\u6570\u7ec4\u548cslice\u7684\u533a\u522b","text":"<p>\u6570\u7ec4\u548cslice\u4f7f\u7528\u4e0a\u5982\u540cc++\u91cc\u7684std::array\u548cstd::vector, \u6570\u7ec4\u7684\u957f\u5ea6\u56fa\u5b9a\uff0cslice\u957f\u5ea6\u53ef\u4ee52\u500d\u6269\u5bb9 \u4f46\u6709\u4f20\u53c2\u4e0a\u6709\u5927\u533a\u522b: golang\u4e2d\u6570\u7ec4\u662f\u503c\u4f20\u9012\uff0c\u76f8\u5f53\u4e8e\u5c06\u6574\u4e2a\u6570\u7ec4\u590d\u5236\u4e00\u904d\uff0c\u800cslice\u662f\u5f15\u7528\u4f20\u9012\uff0c\u6240\u4ee5slice\u7528\u5f97\u591a\uff0cmap\u540c\u7406  </p> <p>\u5b9a\u4e49\u6570\u7ec4\u548cslice: <pre><code>// \u6570\u7ec4\nvar a [3] int\narr := [5] int {1,2,3,4,5}\nvar array2 = [...]int {6,7,8}\nq := [...] int {1,2,3} // \u7701\u7565\u957f\u5ea6\nq2 := [...] int {99, -1} // \u524d99\u9879\u4e3a0,\u7b2c100\u4e2a\u5143\u7d20\u662f-1\n\n// slice\ns1 := []int{1, 2, 3}\na := [10]int{1, 2, 3, 4, 5, 6, 7, 8, 9, 0}  //a\u662f\u6570\u7ec4\ns2 := a[2:8]         \ns3 := make([]int, 10, 20) \n</code></pre></p>","tags":["golang"]},{"location":"blog/go-%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/#var-make","title":"var \u548c := \u533a\u522b, \u4ee5\u53ca\u54ea\u4e9b\u7c7b\u578b\u9700\u8981make","text":"<p>\u4e24\u8005\u5f88\u591a\u65f6\u5019\u53ef\u4ee5\u76f8\u4e92\u66ff\u6362\uff0c\u4f46\u662f\u5728\u4e0d\u540c\u7c7b\u578b\u4e0a\uff0c\u6709\u533a\u522b</p> <p>\u5bf9\u4e8e\u57fa\u672c\u7c7b\u578bstring, int, boolean, \u6570\u7ec4\uff0cvar<code>\u58f0\u660e</code>\u5373\u521d\u59cb\u5316 <pre><code>var str string // \u81ea\u52a8\u521d\u59cb\u5316\u4e3a\u7a7a\u5b57\u7b26\u4e32\nvar inter int // \u81ea\u52a8\u521d\u59cb\u5316\u4e3a0\nvar bo bool // \u81ea\u52a8\u521d\u59cb\u5316\u4e3afalse\n\n// \u53ef\u4ee5\u76f4\u63a5\u4f7f\u7528\nfmt.Printf(\"%s %d %t\", str, inter, bo) \n</code></pre></p> <p>\u800c\u5bf9\u4e8eslice, map, chann\u7c7b\u578b\u800c\u8a00, \u4f7f\u7528<code>var m map[int]string</code>\u53ea\u662f\u58f0\u660e\uff0c\u9700\u8981\u518d\u7528<code>make</code>\u6765\u83b7\u5f97\u5185\u5b58\u548c\u521d\u59cb\u5316 <pre><code>var m map[int] string // \u6b64\u65f6\u4e0d\u80fd\u4f7f\u7528m\nm = make(map[int] string){1:\"a\",2:\"b\"}\nfmt.Println(m[1])\n</code></pre> \u800c\u4e0a\u9762\u7684\u6b65\u9aa4\u53ef\u4ee5\u7b80\u5316\u6210 <pre><code>m := make(map[int] string){1:\"a\", 2:\"b\"}\n</code></pre> \u6216\u76f4\u63a5 <pre><code>m := map[int] string{1:\"a\", 2:\"b\"}\n</code></pre></p>","tags":["golang"]},{"location":"blog/%E8%AF%AD%E6%B3%95%E8%A7%84%E5%88%99-%E5%90%8D%E8%AF%8D%E4%BF%AE%E9%A5%B0%E5%90%8D%E8%AF%8D/","title":"\u8bed\u6cd5\u89c4\u5219-\u540d\u8bcd\u4fee\u9970\u540d\u8bcd","text":"<p>\u65e0\u8bba\u4e66\u5199\u8fd8\u662f\u53e3\u8bed\uff0c\u65e0\u8bba\u82f1\u6587\u8fd8\u662f\u4e2d\u6587\uff0c\u5f53\u7528\u540d\u8bcd\u4fee\u9970\u540d\u8bcd\u65f6\uff0c\u5c31\u611f\u89c9\u5bb9\u6613\u627e\u4e0d\u5230\u4e3b\u4f53(subject)  \uff0c\u4f46\u8fd9\u79cd\u7528\u6cd5\u6709\u5f88\u5e38\u89c1\uff0c\u7279\u522b\u662f\u4e2d\u6587\u3002\u6bd4\u5982\u7535\u8111/\u4eba\u8111\uff0c\u8bf4\u660e\u4e66/\u6f2b\u753b\u4e66\uff0c\u90fd\u662f\u7528\u540d\u8bcd\u4fee\u9970\u540d\u8bcd\uff0c\u4e5f\u53ef\u4ee5\u8bf4\u662f\u9020\u4e86\u65b0\uff08\u540d\uff09\u8bcd\uff0c\u5728\u82f1\u6587\u4e2d\u6709\u5f88\u591a\u540d\u8bcd+\u540d\u8bcd\u5408\u6210\u7684\u6d3e\u751f\u8bcd\uff0c \u4f8b\u5982bookstore\u3002\u5927\u5bb6\u63a5\u53d7\u8fd9\u79cd\u8bcd\u56e0\u4e3a\u6ca1\u6709\u6b67\u4e49\uff0c\u5927\u5bb6\u90fd\u77e5\u9053\u524d\u9762\u7684\u540d\u8bcd\u662f\u7528\u6765\u4fee\u9970\u540e\u9762\u7684\u8bcd\u3002\u4f8b\u5982\u8bf4\u7535\u8111\uff0c\u5927\u5bb6\u90fd\u77e5\u9053\u6307\u201c\u5e26\u7535\u7684\u8111\u201d\uff0c\u4e0d\u4f1a\u4ee5\u4e3a\u6307\u201c\u8111\u91cc\u9762\u7684\u7535\u201d\u3002bookstore \u5219\u90fd\u8ba4\u4e3a\u6307 store of books(\u6709\u4e66\u7684\u5e97)\uff0c\u4e0d\u4f1a\u8ba4\u4e3a\u662f book of stores(\u6709\u5e97\u7684\u4e66)\u3002</p> <p>\u4f46\u5982\u679c\u53e5\u5b50\u6bd4\u8f83\u590d\u6742\u65f6\uff0c\u5c31\u5bb9\u6613\u6709\u6b67\u4e49\u4e86\u3002</p>","tags":["grammar"]},{"location":"blog/%E8%AF%AD%E6%B3%95%E8%A7%84%E5%88%99-%E5%90%8D%E8%AF%8D%E4%BF%AE%E9%A5%B0%E5%90%8D%E8%AF%8D/#_1","title":"\u4e3e\u4f8b\u4e2d\u6587","text":"<p>\u5f53\u957f\u4e00\u70b9\u7684\u53e5\u5b50\uff0c\u6709\u8bcd\u4fee\u9970\u8bcd\u7684\u60c5\u51b5\u65f6\uff0c\u5c31\u4f1a\u53ef\u80fd\u6709\u6b67\u4e49\uff0c\u7279\u522b\u662f\u6bd4\u8f83\u964c\u751f\u65f6\uff0c\u4e0d\u4e00\u5b9a\u80fd\u9760\u8bed\u53e5\u5206\u6790\u51fa\u4e3b\u4f53\uff0c\u800c\u719f\u6089\u7684\u4e1c\u897f\u53ef\u4ee5\u9760\u7ecf\u9a8c\u50a8\u5907\u6765\u8f85\u52a9</p> <p>\u201d\u65b0\u7684\u8bc1\u636e\u8868\u683c\u201c: 1. \u65b0\u4fee\u9970\u7684\u8868\u683c\uff0c\u8868\u683c\u6709\u65b0\u65e7\u4e4b\u5206\uff0c\u65b0\u8868\u683c\u548c\u8868\u683c\u90fd\u7528\u4e8e\u8bb0\u5f55\u8bc1\u636e 2. \u65b0\u4fee\u9970\u7684\u8bc1\u636e\uff0c\u8bc1\u636e\u6709\u65b0\u65e7\u4e4b\u5206\uff0c\u8868\u683c\u4e13\u95e8\u7528\u6765\u8bb0\u5f55\u65b0\u8bc1\u636e</p>","tags":["grammar"]},{"location":"blog/%E8%AF%AD%E6%B3%95%E8%A7%84%E5%88%99-%E5%90%8D%E8%AF%8D%E4%BF%AE%E9%A5%B0%E5%90%8D%E8%AF%8D/#_2","title":"\u4e3e\u4f8b\u82f1\u6587","text":"<p>new evidence table \u8fd9\u91cc\u6709\u6b67\u4e49\uff1a \u65b0\u8868\u683c\u8fd8\u662f\u65b0\u8bc1\u636e\uff1f</p> <p>\u6b63\u786e\u7684\u8bf4\u6cd5 * new table of evidence\uff0c \u65b0\u8868\u683c * new evidence in the table, \u65b0\u8bc1\u636e</p>","tags":["grammar"]},{"location":"blog/%E8%AF%AD%E6%B3%95%E8%A7%84%E5%88%99-%E5%90%8D%E8%AF%8D%E4%BF%AE%E9%A5%B0%E5%90%8D%E8%AF%8D/#_3","title":"\u82f1\u6587\u4e2d\u7684\u540d\u8bcd\u4fee\u9970\u540d\u8bcd","text":"<p>\u82f1\u6587\u4e2d\u7684\u540d\u8bcd </p> <p>Noun-adjunct-\u7ef4\u57fa \u77e5\u4e4e</p>","tags":["grammar"]},{"location":"blog/%E8%AF%AD%E6%B3%95%E8%A7%84%E5%88%99-%E5%90%8D%E8%AF%8D%E4%BF%AE%E9%A5%B0%E5%90%8D%E8%AF%8D/#of","title":"\u591a\u4e2aof \u60c5\u51b5","text":"<p>\u662f\u4e0d\u63a8\u8350\u7684</p>","tags":["grammar"]},{"location":"blog/%E8%AF%AD%E6%B3%95%E8%A7%84%E5%88%99-%E5%90%8D%E8%AF%8D%E4%BF%AE%E9%A5%B0%E5%90%8D%E8%AF%8D/#_4","title":"\u603b\u7ed3","text":"<p>\u5bf9\u4e8e\u82f1\u6587\u800c\u8a00\uff0c\u540d\u8bcd\u4fee\u9970\u540d\u8bcd\u7684\u60c5\u51b5\u6bd4\u8f83\u5c11\u89c1\uff0c\u9664\u975e\u662f\u5e38\u7528\u7684\u6216\u8005\u6d3e\u751f\u8bcd\u3002\u7528\u201c\u540d\u8bcd of \u540d\u8bcd\u201d\u662f\u6bd4\u8f83\u5408\u7406\u7684\u3002\u800c\u5f53\u591a\u4e2aof\u65f6\uff0c \u867d\u7136\u8bed\u6cd5\u4e0a\u6ca1\u9519\uff0c\u4f46\u662f\u5bb9\u6613\u4ea7\u751f\u6b67\u4e49\uff0c\u8fd9\u65f6\u9700\u8981\u8c03\u6574\u8bed\u53e5\u7ed3\u6784\u6765\u6d88\u9664\u6b67\u4e49\u3002\u4e2d\u6587\u540c\u7406\u3002</p>","tags":["grammar"]},{"location":"blog/grpc-callback-api/","title":"grpc callback api","text":"","tags":["c","cpp","grpc"]},{"location":"blog/grpc-callback-api/#c-callback-based-asynchronous-api","title":"C++ callback-based asynchronous API","text":"<ul> <li>Author(s): vjpai, sheenaqotj, yang-g, zhouyihaiding</li> <li>Approver: markdroth</li> <li>Status: Proposed</li> <li>Implemented in: https://github.com/grpc/grpc/projects/12</li> <li>Last updated: March 22, 2021</li> <li>Discussion at https://groups.google.com/g/grpc-io/c/rXLdWWiosWg</li> </ul>","tags":["c","cpp","grpc"]},{"location":"blog/grpc-callback-api/#abstract","title":"Abstract","text":"<p>Provide an asynchronous gRPC API for C++ in which the completion of RPC actions in the library will result in callbacks to user code,</p>","tags":["c","cpp","grpc"]},{"location":"blog/grpc-callback-api/#background","title":"Background","text":"<p>Since its initial release, gRPC has provided two C++ APIs:</p> <ul> <li>Synchronous API</li> <li>All RPC actions (such as unary calls, streaming reads, streaming writes, etc.) block for completion</li> <li>Library provides a thread-pool so that each incoming server RPC executes its method handler in its own thread</li> <li>Completion-queue-based (aka CQ-based) asynchronous API</li> <li>Application associates each RPC action that it initiates with a tag</li> <li>The library performs each RPC action</li> <li>The library posts the tag of a completed action onto a completion queue</li> <li>The application must poll the completion queue to determine which asynchronously-initiated actions have completed</li> <li>The application must provide and manage its own threads</li> <li>Server RPCs don't have any library-invoked method handler; instead the application is responsible for executing the actions for an RPC once it is notified of an incoming RPC via the completion queue</li> </ul> <p>The goal of the synchronous version is to be easy to program. However, this comes at the cost of high thread-switching overhead and high thread storage for systems with many concurrent RPCs. On the other hand, the asynchronous API allows the application full control over its threading and thus can scale further. The biggest problem with the asynchronous API is that it is just difficult to use. Server RPCs must be explicitly requested, RPC polling must be explicitly controlled by the application, lifetime management is complicated, etc. These have proved sufficiently difficult that the full features of the asynchronous API are basically never used by applications. Even if one can use the async API correctly, it also presents challenges in deciding how many completion queues to use and how many threads to use for polling them, as one can either optimize for reducing thread hops, avoiding stranding, reducing CQ contention, or improving locality. These goals are often in conflict and require substantial tuning.</p>","tags":["c","cpp","grpc"]},{"location":"blog/grpc-callback-api/#related-proposals","title":"Related proposals","text":"<ul> <li>The C++ callback API has an implementation that is built on top of a new callback completion queue in core. There is also another implementation, discussed below.</li> <li>The API structure has substantial similarities to the gRPC-Node and gRPC-Java APIs.</li> </ul>","tags":["c","cpp","grpc"]},{"location":"blog/grpc-callback-api/#proposal","title":"Proposal","text":"<p>The callback API is designed to have the performance and thread scalability of an asynchronous API without the burdensome programming model of the completion-queue-based model. In particular, the following are fundamental guiding principles of the API:</p> <ul> <li>Library directly calls user-specified code at the completion of RPC actions. This user code is run from the library's own threads, so it is very important that it must not wait for completion of any blocking operations (e.g., condition variable waits, invoking synchronous RPCs, blocking file I/O).</li> <li>No explicit polling required for notification of completion of RPC actions.</li> <li>In practice, these requirements mean that there must be a library-controlled poller for monitoring such actions. This is discussed in more detail in the Implementation section below.</li> <li>As in the synchronous API, server RPCs have an application-defined method handler function as part of their service definition. The library invokes this method handler when a new server RPC starts.</li> <li>Like the synchronous API and unlike the completion-queue-based asynchronous API, there is no need for the application to \"request\" new server RPCs. Server RPC context structures will be allocated and have their resources allocated as and when RPCs arrive at the server.</li> </ul>","tags":["c","cpp","grpc"]},{"location":"blog/grpc-callback-api/#reactor-model","title":"Reactor model","text":"<p>The most general form of the callback API is built around a reactor model. Each type of RPC has a reactor base class provided by the library. These types are:</p> <ul> <li><code>ClientUnaryReactor</code> and <code>ServerUnaryReactor</code> for unary RPCs</li> <li><code>ClientBidiReactor</code> and <code>ServerBidiReactor</code> for bidi-streaming RPCs</li> <li><code>ClientReadReactor</code> and <code>ServerWriteReactor</code> for server-streaming RPCs</li> <li><code>ClientWriteReactor</code> and <code>ServerReadReactor</code> for client-streaming RPCs</li> </ul> <p>Client RPC invocations from a stub provide a reactor pointer as one of their arguments, and the method handler of a server RPC must return a reactor pointer.</p> <p>These base classes provide three types of methods:</p> <ol> <li>Operation-initiation methods: start an asynchronous activity in the RPC. These are methods provided by the class and are not virtual. These are invoked by the application logic. All of these have a <code>void</code> return type. The <code>ReadMessageType</code> below is the request type for a server RPC and the response type for a client RPC; the <code>WriteMessageType</code> is the response type for a server RPC or the request type for a client RPC.</li> <li><code>void StartCall()</code>: (Client only) Initiates the operations of a call from the client, including sending any client-side initial metadata associated with the RPC. Must be called exactly once. No reads or writes will actually be started until this is called (i.e., any previous calls to <code>StartRead</code>, <code>StartWrite</code>, or <code>StartWritesDone</code> will be queued until <code>StartCall</code> is invoked). This operation is not needed at the server side since streaming operations at the server are released from backlog automatically by the library as soon as the application returns a reactor from the method handler, and because there is a separate method just for sending initial metadata.</li> <li><code>void StartSendInitialMetadata()</code>: (Server only) Sends server-side initial metadata. To be used in cases where initial metadata should be sent without sending a message. Optional; if not called, initial metadata will be sent when <code>StartWrite</code> or <code>Finish</code> is called. May not be invoked more than once or after <code>StartWrite</code> or <code>Finish</code> has been called. This does not exist at the client because sending initial metadata is part of <code>StartCall</code>.</li> <li><code>void StartRead(ReadMessageType*)</code>: Starts a read of a message into the object pointed to by the argument. <code>OnReadDone</code> will be invoked when the read is complete. Only one read may be outstanding at any given time for an RPC (though a read and a write can be concurrent with each other). If this operation is invoked by a client before calling <code>StartCall</code> or by a server before returning from the method handler, it will be queued until one of those events happens and will not actually trigger any activity or reactions until it is thereby released from the queue.</li> <li><code>void StartWrite(const WriteMessageType*)</code>: Starts a write of the object pointed to by the argument. <code>OnWriteDone</code> will be invoked when the write is complete. Only one write may be outstanding at any given time for an RPC (though a read and a write can be concurrent with each other).  As with <code>StartRead</code>, if this operation is invoked by a client before calling <code>StartCall</code> or by a server before returning from the method handler, it will be queued until one of those events happens and will not actually trigger any activity or reactions until it is thereby released from the queue.</li> <li><code>void StartWritesDone()</code>: (Client only) For client RPCs to indicate that there are no more writes coming in this stream.  <code>OnWritesDoneDone</code> will be invoked when this operation is complete. This causes future read operations on the server RPC to indicate that there is no more data available. Highly recommended but technically optional; may not be called more than once per call.  As with <code>StartRead</code> and <code>StartWrite</code>, if this operation is invoked by a client before calling <code>StartCall</code> or by a server before returning from the method handler, it will be queued until one of those events happens and will not actually trigger any activity or reactions until it is thereby released from the queue.</li> <li><code>void Finish(Status)</code>: (Server only) Sends completion status to the client, asynchronously. Must be called exactly once for all server RPCs, even for those that have already been cancelled. No further operation-initiation methods may be invoked after <code>Finish</code>.</li> <li>Operation-completion reaction methods: notification of completion of asynchronous RPC activity. These are all virtual methods that default to an empty function (i.e., <code>{}</code>) but may be overridden by the application's reactor definition. These are invoked by the library. All of these have a <code>void</code> return type. Most take a <code>bool ok</code> argument to indicate whether the operation completed \"normally,\" as explained below.</li> <li><code>void OnReadInitialMetadataDone(bool ok)</code>: (Client only) Invoked by the library to notify that the server has sent an initial metadata response to a client RPC. If <code>ok</code> is true, then the RPC received initial metadata normally. If it is false, there is no initial metadata either because the call has failed or because the call received a trailers-only response (which means that there was no actual message and that any information normally sent in initial metadata has been dispatched instead to trailing metadata, which is allowed in the gRPC HTTP/2 transport protocol). This reaction is automatically invoked by the library for RPCs of all varieties; it is uncommonly used as an application-defined reaction however.</li> <li><code>void OnReadDone(bool ok)</code>: Invoked by the library in response to a <code>StartRead</code> operation. The <code>ok</code> argument indicates whether a message was read as expected. A false <code>ok</code> could mean a failed RPC (e.g., cancellation) or a case where no data is possible because the other side has already ended its writes (e.g., seen at the server-side after the client has called <code>StartWritesDone</code>).</li> <li><code>void OnWriteDone(bool ok)</code>: Invoked by the library in response to a <code>StartWrite</code> operation. The <code>ok</code> argument that indicates whether the write was successfully sent; a false value indicates an RPC failure.</li> <li><code>void OnWritesDoneDone(bool ok)</code>: (Client only) Invoked by the library in response to a <code>StartWritesDone</code> operation. The bool <code>ok</code> argument that indicates whether the writes-done operation was successfully completed; a false value indicates an RPC failure.</li> <li><code>void OnCancel()</code>: (Server only) Invoked by the library if an RPC is canceled before it has a chance to successfully send status to the client side. The reaction may be used for any cleanup associated with cancellation or to guide the behavior of other parts of the system (e.g., by setting a flag in the service logic associated with this RPC to stop further processing since the RPC won't be able to send outbound data anyway). Note that servers must call <code>Finish</code> even for RPCs that have already been canceled as this is required to cleanup all their library state and move them to a state that allows for calling <code>OnDone</code>.</li> <li><code>void OnDone(const Status&amp;)</code> at the client, <code>void OnDone()</code> at the server: Invoked by the library when all outstanding and required RPC operations are completed for a given RPC. For the client-side, it additionally provides the status of the RPC (either as sent by the server with its <code>Finish</code> call or as provided by the library to indicate a failure), in which case the signature is <code>void OnDone(const Status&amp;)</code>. The server version has no argument, and thus has a signature of <code>void OnDone()</code>. Should be used for any application-level RPC-specific cleanup.</li> <li>Thread safety: the above calls may take place concurrently, except that <code>OnDone</code> will always take place after all other reactions. No further RPC operations are permitted to be issued after <code>OnDone</code> is invoked.</li> <li>IMPORTANT USAGE NOTE : code in any reaction must not block for an arbitrary amount of time since reactions are executed on a finite-sized, library-controlled threadpool. If any long-term blocking operations (like sleeps, file I/O, synchronous RPCs, or waiting on a condition variable) must be invoked as part of the application logic, then it is important to push that outside the reaction so that the reaction can complete in a timely fashion. One way of doing this is to push that code to a separate application-controlled thread.</li> <li>RPC completion-prevention methods. These are methods provided by the class and are not virtual. They are only present at the client-side because the completion of a server RPC is clearly requested when the application invokes <code>Finish</code>. These methods are invoked by the application logic. All of these have a <code>void</code> return type.</li> <li><code>void AddHold()</code>: (Client only) This prevents the RPC from being considered complete (ready for <code>OnDone</code>) until each <code>AddHold</code> on an RPC's reactor is matched to a corresponding <code>RemoveHold</code>. An application uses this operation before it performs any  extra-reaction flows, which refers to streaming operations initiated from outside a reaction method. Note that an RPC cannot complete before <code>StartCall</code>, so holds are not needed for any extra-reaction flows that take place before <code>StartCall</code>. As long as there are any holds present on an RPC, though, it may not have <code>OnDone</code> called on it, even if it has already received server status and has no other operations outstanding. May be called 0 or more times on any client RPC.</li> <li><code>void AddMultipleHolds(int holds)</code>: (Client only) Shorthand for <code>holds</code> invocations of <code>AddHold</code> .</li> <li><code>void RemoveHold()</code>: (Client only) Removes a hold reference on this client RPC. Must be called exactly as many times as <code>AddHold</code> was called on the RPC, and may not be called more times than <code>AddHold</code> has been called so far for any RPC. Once all holds have been removed, the server has provided status, and all outstanding or required operations have completed for an RPC, the library will invoke <code>OnDone</code> for that RPC.</li> </ol> <p>Examples are provided in the PR to de-experimentalize the callback API.</p>","tags":["c","cpp","grpc"]},{"location":"blog/grpc-callback-api/#unary-rpc-shortcuts","title":"Unary RPC shortcuts","text":"<p>As a shortcut, client-side unary RPCs may bypass the reactor model by directly providing a <code>std::function</code> for the library to call at completion rather than a reactor object pointer. This is passed as the final argument to the stub call, just as the reactor would be in the more general case. This is semantically equivalent to a reactor in which the <code>OnDone</code> function simply invokes the specified function (but can be implemented in a slightly faster way since such an RPC will definitely not wait separately for initial metadata from the server) and all other reactions are left empty. In practice, this is the common and recommended model for client-side unary RPCs, unless they have a specific need to wait for initial metadata before getting their full response message. As in the reactor model, the function provided as a callback may not include operations that block for an arbitrary amount of time.</p> <p>Server-side unary RPCs have the option of returning a library-provided default reactor when their method handler is invoked. This is provided by calling <code>DefaultReactor</code> on the <code>CallbackServerContext</code>. This default reactor provides a <code>Finish</code> method, but does not provide a user callback for <code>OnCancel</code> and <code>OnDone</code>. In practice, this is the common and recommended model for most server-side unary RPCs unless they specifically need to react to an <code>OnCancel</code> callback or do cleanup work after the RPC fully completes.</p>","tags":["c","cpp","grpc"]},{"location":"blog/grpc-callback-api/#servercontext-extensions","title":"ServerContext extensions","text":"<p><code>ServerContext</code> is now made a derived class of <code>ServerContextBase</code>. There is a new derived class of <code>ServerContextBase</code> called <code>CallbackServerContext</code> which provides a few additional functions:</p> <ul> <li><code>ServerUnaryReactor* DefaultReactor()</code> may be used by a method handler to return a default reactor from a unary RPC.</li> <li><code>RpcAllocatorState* GetRpcAllocatorState</code>: see advanced topics section</li> </ul> <p>Additionally, the <code>AsyncNotifyWhenDone</code> function is not present in the <code>CallbackServerContext</code>.</p> <p>All method handler functions for the callback API take a <code>CallbackServerContext*</code> as their first argument. <code>ServerContext</code> (used for the sync and CQ-based async APIs) and <code>CallbackServerContext</code> (used for the callback API) actually use the same underlying structure and thus their object pointers are meaningfully convertible to each other via a <code>static_cast</code> to <code>ServerContextBase*</code>. We recommend that any helper functions that need to work across API variants should use a <code>ServerContextBase</code> pointer or reference as their argument rather than a <code>ServerContext</code> or <code>CallbackServerContext</code> pointer or reference. For example, <code>ClientContext::FromServerContext</code> now uses a <code>ServerContextBase*</code> as its argument; this is not a breaking API change since the argument is now a parent class of the previous argument's class.</p>","tags":["c","cpp","grpc"]},{"location":"blog/grpc-callback-api/#advanced-topics","title":"Advanced topics","text":"","tags":["c","cpp","grpc"]},{"location":"blog/grpc-callback-api/#application-managed-server-memory-allocation","title":"Application-managed server memory allocation","text":"<p>Callback services must allocate an object for the <code>CallbackServerContext</code> and for the request and response objects of a unary call.  Applications can supply a per-method custom memory allocator for gRPC server to use to allocate and deallocate the request and response messages, as well as a per-server custom memory allocator for context objects. These can be used for purposes like early or delayed release, freelist-based allocation, or arena-based allocation. For each unary RPC method, there is a generated method in the server called <code>SetMessageAllocatorFor_*MethodName*</code> . For each server, there is a method called <code>SetContextAllocator</code>. Each of these has numerous classes involved, and the best examples for how to use these features lives in the gRPC tests directory.</p> <ul> <li>Message allocator usage example</li> <li>Context allocator usage example</li> </ul>","tags":["c","cpp","grpc"]},{"location":"blog/grpc-callback-api/#generic-non-code-generated-services","title":"Generic (non-code-generated) services","text":"<p><code>RegisterCallbackGenericService</code> is a new method of <code>ServerBuilder</code> to allow for processing of generic (unparsed) RPCs. This is similar to the pre-existing <code>RegisterAsyncGenericService</code> but uses the callback API and reactors rather than the CQ-based async API. It is expected to be used primarily for generic gRPC proxies where the exact serialization format or list of supported methods is unknown.</p>","tags":["c","cpp","grpc"]},{"location":"blog/grpc-callback-api/#per-method-specification","title":"Per-method specification","text":"<p>Just as with async services, callback services may also be specified on a method-by-method basis (using the syntax <code>WithCallbackMethod_*MethodName*</code>), with any unlisted methods being treated as sync RPCs. The shorthand <code>CallbackService</code> declares every method as being processed by the callback API. For example:</p> <ul> <li><code>Foo::Service</code> -- purely synchronous service</li> <li><code>Foo::CallbackService</code> -- purely callback service</li> <li><code>Foo::WithCallbackMethod_Bar&lt;Service&gt;</code> -- synchronous service except for callback method <code>Bar</code></li> <li><code>Foo::WithCallbackMethod_Bar&lt;WithCallbackMethod_Baz&lt;Service&gt;&gt;</code> -- synchronous service except for callback methods <code>Bar</code> and <code>Baz</code></li> </ul>","tags":["c","cpp","grpc"]},{"location":"blog/grpc-callback-api/#rationale","title":"Rationale","text":"<p>Besides the content described in the background section, the rationale also includes early and consistent user demand for this feature as well as the fact that many users were simply spinning up a callback model on top of gRPC's completion queue-based asynchronous model.</p>","tags":["c","cpp","grpc"]},{"location":"blog/grpc-callback-api/#implementation","title":"Implementation","text":"<p>There is more than one mechanism available for implementing the background polling required by the C++ callback API. One has been implemented on top of the C++ completion queue API. In this approach, the callback API uses a number of library-owned threads to call <code>Next</code> on an async CQ that is owned by the internal implementation. Currently, the thread count is automatically selected by the library with no user input and is set to half the system's core count, but no less than 2 and no more than 16. This selection is subject to change in the future based on our team's ongoing performance analysis and tuning efforts. Despite being built on the CQ-based async API, the developer using the callback API does not need to consider any of the CQ details (e.g., shutdown, polling, or even the existence of a CQ).</p> <p>It is the gRPC team's intention that that implementation is only a temporary solution. A new structure called an <code>EventEngine</code> is being developed to provide the background threads needed for polling, and this sytem is also intended to provide a direct API for application use. This event engine would also allow the direct use of the core callback API that is currently only used by the Python async implementation. If this solution is adopted, there will be a new gRFC for it. This new implementation will not change the callback API at all but rather will only affect its performance. The C++ code for the callback API already has <code>if</code> branches in place to support the use of a poller that directly supplies the background threads, so the callback API will naturally layer on top of the <code>EventEngine</code> without further development effort.</p>","tags":["c","cpp","grpc"]},{"location":"blog/grpc-callback-api/#open-issues-if-applicable","title":"Open issues (if applicable)","text":"<p>N/A. The gRPC C++ callback API has been used internally at Google for two years now, and the code and API have evolved substantially during that period.</p>","tags":["c","cpp","grpc"]},{"location":"blog/grpc-%E5%AD%A6%E4%B9%A0/","title":"rpc","text":"<p>rpc \u610f\u4e3a<code>\u8fdc\u7a0b\u8fc7\u7a0b\u8c03\u7528</code>, http, grpc \u5e7f\u4e49\u4e0a\u8bb2\u90fd\u662frpc\u3002 \u800c\u4e14\u8fd8\u6709\u4e2a\u9879\u76ee\u53ebgrpc-gateway, \u53ef\u4ee5\u5c06grpc\u901a\u8fc7http\u7684\u65b9\u5f0f\u66b4\u9732\u3002</p>","tags":["grpc","c","cpp"]},{"location":"blog/grpc-%E5%AD%A6%E4%B9%A0/#grpc","title":"grpc","text":"<p>grpc \u662frpc\u7684\u4e00\u79cd\u5b9e\u73b0\uff0c\u7531google\u5f00\u6e90\uff0c\u5176\u4ed6\u8fd8\u6709thrift, sogorpc \u7b49\u7b49\u3002 \u5e76\u4e14grpc\u4f7f\u7528\u7684http/2\u534f\u8bae</p>","tags":["grpc","c","cpp"]},{"location":"blog/grpc-%E5%AD%A6%E4%B9%A0/#http11-http2","title":"http/1.1 \u4e0e http/2 \u7684\u533a\u522b","text":"<ul> <li>2\u4f7f\u7528\u4e8c\u8fdb\u5236\uff0c\u800c1.1\u4f7f\u7528\u6587\u672c\uff0c\u63d0\u9ad8\u6548\u7387</li> <li>2\u5c06\u76f8\u540c\u7684tcp\u8fde\u63a5\u5408\u5e76\u4e3a\u4e00\u4e2a\u8bf7\u6c42\uff0c\u63d0\u9ad8\u6027\u80fd,\u800c1.1\u5219\u4e3a\u6bcf\u4e2a\u8bf7\u6c42\u521b\u5efatcp\u8fde\u63a5</li> <li>2\u7684\u5ba2\u6237\u7aef\u4f7f\u7528\u6d41\uff0c\u8fd9\u6837\u53ef\u4ee5\u591a\u6b21\u8bf7\u6c42</li> <li>2\u542b\u6709trailers\uff0c\u4e5f\u5c31\u662f\u5c3e\u90e8\u6d88\u606f\uff0c\u53ef\u4ee5\u7528\u6765\u53d1\u9001body\u7684checksume\u7b49, \u5f53\u7136\u4e5f\u53ef\u4ee5\u76f4\u63a5\u653e\u5230body\u91cc ...</li> </ul> <p>\u800c1.1\u4e2d\u4e5f\u5df2\u7ecf\u5b9e\u73b0\u670d\u52a1\u7aef\u5230\u5ba2\u6237\u7aef\u7684\u6d41,\u4f7f\u7528'Transfer-Encoding=chunked'\u6765\u66ff\u4ee3'Content-Length'\uff0c\u8be6\u89c1rfc <pre><code> A sender MUST NOT send a Content-Length header field in any message\n   that contains a Transfer-Encoding header field.\n</code></pre></p>","tags":["grpc","c","cpp"]},{"location":"blog/grpc-%E5%AD%A6%E4%B9%A0/#proto","title":"\u8ba4\u8bc6proto\u6587\u4ef6","text":"","tags":["grpc","c","cpp"]},{"location":"blog/grpc-%E5%AD%A6%E4%B9%A0/#proto-serviceservice","title":"proto \u6587\u4ef6\u4e2d\u591a\u4e2aservice\u548c\u5355\u4e2aservice \u533a\u522b","text":"<p>\u5728\u540c\u4e00\u4e2aservice\u91cc\u7684\u65b9\u6cd5\u4f1acodegen\u5230\u540c\u4e00\u4e2a\u7c7b\uff0c\u4f46\u8fd9\u4e2a\u7c7b\u6bd4\u8f83\u9e21\u808b\u3002 \u7531\u4e8eRPC\u8c03\u7528\u662fRESTful\u7684\uff0c\u6240\u4ee5\u591a\u6b21\u8c03\u7528\u6216\u8005\u591a\u4e2arpc\u65b9\u6cd5\u65e0\u6cd5\u901a\u8fc7\u540c\u4e00\u4e2aservice\u6765\u5171\u4eab\u6570\u636e\uff0c\u8fd9\u9700\u8981\u4f7f\u7528\u8005\u501f\u52a9\u5176\u4ed6\u529e\u6cd5\u6765\u89e3\u51b3\u3002</p> <p>service \u8fd8\u53ef\u4ee5\u7528\u4ee5\u9694\u79bb\u76f8\u540c\u540d\u79f0\u7684rpc\uff0c \u5982  - service1/helloworld - service2/helloworld</p> <p>\u800c\u65b9\u6cd5\u548c\u65b9\u6cd5\u901a\u8fc7<code>RpcServiceMethod</code>\u6765\u4fdd\u5b58\uff0c\u800c\u901a\u8fc7index\u6765\u8c03\u7528 <pre><code>::grpc::Service::RequestAsyncUnary(0, context, request, response, new_call_cq, notification_cq, tag);\n::grpc::Service::RequestAsyncUnary(1, context, request, response, new_call_cq, notification_cq, tag);\n</code></pre></p>","tags":["grpc","c","cpp"]},{"location":"blog/grpc-%E5%AD%A6%E4%B9%A0/#rpc-unarycallstreamingcall","title":"rpc \u58f0\u660eUnaryCall&amp;StreamingCall","text":"<p>\u975e\u6d41\u8c03\u7528\u4e5f\u79f0\u4e3a<code>UnaryCall</code>\uff0c\u6307\u53d1\u9001\u6216\u63a5\u53d7\u7684\u6d88\u606f\u5927\u5c0f\u662f\u56fa\u5b9a\u7684\u3002 \u6d41\u8c03\u7528\u79f0\u4e3a<code>StreamingCall</code>\uff0c\u53ef\u4ee5\u591a\u6b21\u53d1\u9001\u6216\u8005\u63a5\u6536\uff0c\u6240\u4ee5\u6d88\u606f\u5927\u5c0f\u5e76\u4e0d\u56fa\u5b9a\u3002</p> <p>StreamCall \u53ef\u4ee5\u591a\u6b21\u8c03\u7528\uff0c\u76f4\u5230\u53d1\u9001<code>WriteDone/Finish</code>\uff0c\u6240\u4ee5\u5728\u63a5\u53d7\u7684\u4e00\u7aef\u603b\u662f <pre><code>while(read stream){}\n</code></pre></p> <p>grpc\u652f\u6301\u5ba2\u6237\u7aef\u6d41\u670d\u52a1\u7aef\u975e\u6d41\u3001\u5ba2\u6237\u7aef\u975e\u6d41\u3001\u670d\u52a1\u7aef\u6d41\u4ee5\u53ca\u53cc\u5411\u6d41\uff0c\u800c\u666e\u901a\u7684\u5c31\u662f\u5ba2\u6237\u7aef\u548c\u670d\u52a1\u7aef\u90fd\u4e0d\u6d41NORMAL_RPC(unary call) - grpc::internal::RpcMethod::NORMAL_RPC - grpc::internal::RpcMethod::RpcType::SERVER_STREAMING - grpc::internal::RpcMethod::RpcType::CLIENT_STREAMING - grpc::internal::RpcMethod::RpcType::BIDI_STREAMING</p>","tags":["grpc","c","cpp"]},{"location":"blog/grpc-%E5%AD%A6%E4%B9%A0/#pbhgrpcpbh","title":"\u8ba4\u8bc6pb.h\u548cgrpc.pb.h\u6587\u4ef6","text":"<p>protoc \u8c03\u7528<code>grpc_cpp_plugin</code> \u63d2\u4ef6\u751f\u6210grpc.pb.{h,cc}\u6587\u4ef6\uff0c\u751f\u6210rpc\u65b9\u6cd5\u7684\u5b9e\u73b0  </p> <p>pb.{h,cc}\u5219\u662f\u5b9a\u4e49\u4e86protobuf\u6d88\u606f\u7684\u5e8f\u5217\u5316\u548c\u53cd\u5e8f\u5217\u5316\u65b9\u6cd5</p>","tags":["grpc","c","cpp"]},{"location":"blog/grpc-%E5%AD%A6%E4%B9%A0/#_1","title":"\u53cd\u5c04\u3001\u5e8f\u5217\u5316\u548c\u53cd\u5e8f\u5217\u5316\u7684\u5b9e\u73b0","text":"<p>pb.h \u5b9e\u73b0grpc\u7684\u8bf7\u6c42\u53c2\u6570\u548c\u8fd4\u56de\u53c2\u6570\u7684\u7279\u5b9a\u8bed\u8a00\u7684\u89e3\u6790\uff0c\u8fd8\u6709pb\u7684\u901a\u7528\u65b9\u6cd5\uff0c \u4f8b\u5982: <code>has_xx</code>(\u7248\u672c3\u91cc\u53ea\u6709\u81ea\u5b9a\u4e49\u7c7b\u578b\u624d\u652f\u6301), <code>class XXX_CPP_API</code></p> <p>\u751f\u6210\u7684class\u90fd\u7ee7\u627f\u81ea<code>google::protobuf::Message</code> <pre><code>class HelloRequest PROTOBUF_FINAL :\n      public ::PROTOBUF_NAMESPACE_ID::Message\n\n#define PROTOBUF_NAMESPACE \"google::protobuf\"\n#define PROTOBUF_NAMESPACE_ID google::protobuf \n</code></pre> \u800c\u5728<code>message</code>\u4e2d\u6709\u6ce8\u91ca\u8bf4\u660e, \u5173\u952e\u51fd\u6570\u662f<code>SerializeToString</code>\u548c<code>ParseFromString</code>\uff0c\u8fd8\u6709\u4e2aarray\u7248\u672c<code>SerializeToArray</code>, \u8fd8\u6709\u4e00\u4e2a\u53cd\u5c04\u51fd\u6570<code>GetDescriptor()</code>\u7528\u6765\u52a8\u6001\u83b7\u53d6\u6307\u5b9a\u69fd\u4f4d\u7684\u6570\u636e <pre><code>// Example usage:\n  //\n  // Say you have a message defined as:\n  //\n  //   message Foo {\n  //     optional string text = 1;\n  //     repeated int32 numbers = 2;\n  //   }\n  //\n  // Then, if you used the protocol compiler to generate a class from the above\n  // definition, you could use it like so:\n  //\n  //   std::string data;  // Will store a serialized version of the message.\n  //\n  //   {\n  //     // Create a message and serialize it.\n  //     Foo foo;\n  //     foo.set_text(\"Hello World!\");\n  //     foo.add_numbers(1);\n  //     foo.add_numbers(5);\n  //     foo.add_numbers(42);\n  //\n  //     foo.SerializeToString(&amp;data);\n  //   }\n  //\n  //   {\n  //     // Parse the serialized message and check that it contains the\n  //     // correct data.\n  //     Foo foo;\n  //     foo.ParseFromString(data);\n  //\n  //     assert(foo.text() == \"Hello World!\");\n  //     assert(foo.numbers_size() == 3);\n  //     assert(foo.numbers(0) == 1);\n  //     assert(foo.numbers(1) == 5);\n  //     assert(foo.numbers(2) == 42);\n  //   }\n</code></pre></p> <p>\u5982\u4e0b\u53ef\u4ee5\u5c06Message\u8f6c\u6362\u4e3a\u57fa\u672c\u7c7b\u578b <pre><code>int size = reqMsg.ByteSizeLong();\nchar* array = new char[size];\nreqMsg.SerializeToArray(array, size);\n</code></pre></p> <pre><code>std::string bytes = reqMsg.SerializeAsString();\nconst char* array = bytes.data();\nint size = bytes.size();\n</code></pre> <p>\u8fdb\u4e00\u6b65\u770b<code>protobuf::message</code>\u7ee7\u627f\u81ea<code>protobuf::message_lite</code>, \u540e\u8005\u5b9e\u73b0\u4e86<code>SerializeAsString</code>\u548c<code>SerializeToArray</code> <pre><code>inline uint8* SerializeToArrayImpl(const MessageLite&amp; msg, uint8* target,\n                                     int size) {\n    constexpr bool debug = false;\n    if (debug) {\n      // Force serialization to a stream with a block size of 1, which forces\n      // all writes to the stream to cross buffers triggering all fallback paths\n      // in the unittests when serializing to string / array.\n      io::ArrayOutputStream stream(target, size, 1);\n      uint8* ptr;\n      io::EpsCopyOutputStream out(\n          &amp;stream, io::CodedOutputStream::IsDefaultSerializationDeterministic(),\n          &amp;ptr);\n      ptr = msg._InternalSerialize(ptr, &amp;out);\n      out.Trim(ptr);\n      GOOGLE_DCHECK(!out.HadError() &amp;&amp; stream.ByteCount() == size);\n      return target + size;\n    } else {\n      io::EpsCopyOutputStream out(\n          target, size,\n          io::CodedOutputStream::IsDefaultSerializationDeterministic());\n\u5b9e\u9645\u8c03\u7528-&gt;    auto res = msg._InternalSerialize(target, &amp;out);\n      GOOGLE_DCHECK(target + size == res);\n      return res;\n    }\n  }\n</code></pre> \u53ef\u89c1\uff0c\u5176\u5b9e\u5e8f\u5217\u5316\u6700\u7ec8\u8c03\u7528\u7684\u662fpb.h\u6587\u4ef6\u91cc\u5b9a\u4e49\u7684<code>_InternalSerialize</code>, \u4e3e\u4f8b\u5b98\u65b9\u4f8b\u5b50<code>HelloRequest</code> <pre><code> ::PROTOBUF_NAMESPACE_ID::uint8* HelloRequest::_InternalSerialize(\n      ::PROTOBUF_NAMESPACE_ID::uint8* target, ::PROTOBUF_NAMESPACE_ID::io::EpsCopyOutputStream*   stream) const {\n    // @@protoc_insertion_point(serialize_to_array_start:helloworld.HelloRequest)\n    ::PROTOBUF_NAMESPACE_ID::uint32 cached_has_bits = 0;\n    (void) cached_has_bits;\n\n    // string name = 1;\n    if (this-&gt;name().size() &gt; 0) {\n      ::PROTOBUF_NAMESPACE_ID::internal::WireFormatLite::VerifyUtf8String(\n        this-&gt;_internal_name().data(), static_cast&lt;int&gt;(this-&gt;_internal_name().length()),\n        ::PROTOBUF_NAMESPACE_ID::internal::WireFormatLite::SERIALIZE,\n        \"helloworld.HelloRequest.name\");\n      target = stream-&gt;WriteStringMaybeAliased(\n          1, this-&gt;_internal_name(), target);\n    }\n\n    if (PROTOBUF_PREDICT_FALSE(_internal_metadata_.have_unknown_fields())) {\n      target = ::PROTOBUF_NAMESPACE_ID::internal::WireFormat::InternalSerializeUnknownFieldsToA  rray(\n         _internal_metadata_.unknown_fields&lt;::PROTOBUF_NAMESPACE_ID::UnknownFieldSet&gt;(::PROTOB  UF_NAMESPACE_ID::UnknownFieldSet::default_instance), target, stream);\n    }\n    // @@protoc_insertion_point(serialize_to_array_end:helloworld.HelloRequest)\n    return target;\n  }\n</code></pre></p>","tags":["grpc","c","cpp"]},{"location":"blog/grpc-%E5%AD%A6%E4%B9%A0/#grpcpbrpc","title":"grpc.pb\u751f\u6210\u7684\u4ee3\u7801\u5b9e\u73b0rpc\u8c03\u7528","text":"<p>\u751f\u6210\u7684\u6846\u67b6\u4ee3\u7801\u7528\u6765\u7ee7\u627f\u5b9e\u73b0Service\u548c\u83b7\u53d6stub\u6765\u53d1\u8d77rpc call\u3002\u5b9e\u9645\u4e0a\u8fd9\u4e9b\u4ee3\u7801\u5e76\u4e0d\u662f\u5fc5\u987b\u7684 \u5728\u4e0b\u9762\u8bb2\u4e86\u5982\u4f55\u4f7f\u7528\u51e0\u4e2a\u5de5\u5382\u7c7b\u6765\u521b\u5efaStub\uff0c\u8fd8\u6709\u76f4\u63a5<code>new</code>\u51faService</p> <pre><code>class XXXServer {\n        // \u5ba2\u6237\u7aef\u4f7f\u7528\u7684\u6869\n    class Stub\n        // base \n    class Service\n    // \u5404\u79cd\u7248\u672c\u7684rpc\u5305\u88c5\uff0c\u4f46\u90fd\u7ee7\u627f\u81eabase\n        class WithAsyncMethod_XXX\n        typedef WithAsyncMethod_XXX&lt;Service &gt; AsyncService;\n    typedef ExperimentalWithCallbackMethod_XXX&lt;Service &gt; CallbackService;\n    class WithGenericMethod_XXX\n    class WithRawMethod_XXX\n    typedef WithStreamedUnaryMethod_XXX&lt;Service &gt; StreamedUnaryService;\n}\n</code></pre>","tags":["grpc","c","cpp"]},{"location":"blog/grpc-%E5%AD%A6%E4%B9%A0/#_2","title":"\u540c\u6b65\u4e0e\u5f02\u6b65","text":"<p>grpc \u7684\u5f02\u6b65\u5373\u4e3a\u4f7f\u7528cq\u4e8b\u4ef6\u9a71\u52a8\uff08cq-based\uff09\uff0c\u4f7f\u7528tag\u6807\u8bb0\u4e8b\u4ef6\u3002\u53e6\u5916\u8fd8\u6709callback\u65b9\u5f0f</p>","tags":["grpc","c","cpp"]},{"location":"blog/grpc-%E5%AD%A6%E4%B9%A0/#_3","title":"\u5bf9\u4e8e\u5ba2\u6237\u7aef","text":"<p>\u540c\u6b65\u65f6\uff0c\u901a\u8fc7\u8c03\u7528'::grpc::internal::BlockingUnaryCall' \u5f02\u6b65\u65f6\uff0c\u521b\u5efa'ClientAsyncResponseReader'(\u975e\u6d41), \u7136\u540e\u901a\u8fc7\u8c03\u7528'ClientAsyncResponseReader'\u7684write\u548cfinish\uff0c\u5e76\u7b49\u5f85tag \u5f53\u5b58\u5728\u6d41\u65f6\u5206\u522b\u662f - ::grpc::ClientAsyncReader - ::grpc::ClientAsyncWriter - ::grpc::ClientAsyncReaderWriter</p> <p>\u8fd9\u4e9b\u7c7b\u578b\u53ef\u7528\u5bf9\u5e94\u7684\u5de5\u5382\u7c7b\u6765\u521b\u5efa, \u751f\u6210\u4ee3\u7801\u7684stub\u4e5f\u662f\u8fd9\u4e48\u7528\u7684 <pre><code>class ClientReaderFactory \nclass ClientWriterFactory \nclass ClientReaderWriterFactory \n</code></pre></p>","tags":["grpc","c","cpp"]},{"location":"blog/grpc-%E5%AD%A6%E4%B9%A0/#_4","title":"\u5bf9\u4e8e\u670d\u52a1\u7aef","text":"<p>\u540c\u6b65\u65f6\uff0c\u901a\u8fc7'AddMethod'\u6765\u6ce8\u518c\uff0c\u751f\u6210\u4ee3\u7801\u4f1a\u5728\u7236\u7c7b\u6784\u9020\u65f6\u6267\u884c\u3002\u6ce8\u518c\u540e\u7531grpc\u8c03\u7528 <pre><code>Greeter::Service::Service() {\n    AddMethod(new ::grpc::internal::RpcServiceMethod(\n        Greeter_method_names[0],\n        ::grpc::internal::RpcMethod::NORMAL_RPC,\n        new ::grpc::internal::RpcMethodHandler&lt; Greeter::Service, ::helloworld::HelloRequest, ::helloworld::HelloReply&gt;(\n            [](Greeter::Service* service,\n               ::grpc_impl::ServerContext* ctx,\n               const ::helloworld::HelloRequest* req,\n               ::helloworld::HelloReply* resp) {\n                 return service-&gt;SayHello(ctx, req, resp);\n               }, this)));\n  }\n</code></pre></p> <p>\u5f02\u6b65\u65f6\uff0c\u7c7b\u4f3c\u5ba2\u6237\u7aef - grpc::ServerAsyncReaderWriter - grpc::ServerAsyncReader - grpc::ServerAsyncWriter</p> <p>\u53ef\u89c1\u670d\u52a1\u7aef\u662f\u76f4\u63a5new\u51fa\u6765\u7684\uff0c\u5f02\u6b65\u65f6\u8fd9\u4e9bio\u64cd\u4f5c\u5bf9\u8c61\u4e5f\u662f\u76f4\u63a5new\u51fa\u6765\u7684, \u5728\u8c03\u7528\u4ee5\u4e0b\u65f6\u4f20\u5165 <pre><code>RequestAsyncBidiStreaming\nRequestAsyncClientStreaming\nRequestAsyncServerStreaming\n</code></pre></p>","tags":["grpc","c","cpp"]},{"location":"blog/grpc-%E5%AD%A6%E4%B9%A0/#grpc-callback","title":"grpc callback","text":"<p>\u53ea\u5728\u5ba2\u6237\u7aef\u4f7f\u7528\uff0ccallback\u65b9\u5f0f\u7684\u8bf7\u6c42\u53ef\u4ee5\u4f20\u5165\u4e00\u4e2alambda, \u5728\u8bf7\u6c42\u5b8c\u6210\u65f6\u8c03\u7528 <pre><code>    stub_-&gt;async()-&gt;SayHello(&amp;context, &amp;request, &amp;reply,\n                             [&amp;mu, &amp;cv, &amp;done, &amp;status](Status s) {\n                               status = std::move(s);\n                               std::lock_guard&lt;std::mutex&gt; lock(mu);\n                               done = true;\n                               cv.notify_one();\n                             });\n</code></pre></p> <p>\u65b0\u7248\u672c\u7684grpc\u5df2\u7ecf\u5c06\u5b9e\u9a8c\u6027\u7684\u6807\u8bb0\u53bb\u9664\uff0c\u8bf4\u660e\u6b64\u65b9\u5f0f\u6210\u719f\u4e86 <pre><code>    #ifdef GRPC_CALLBACK_API_NONEXPERIMENTAL\n      ::grpc::Service::\n    #else\n      ::grpc::Service::experimental().\n    #endif\n</code></pre></p>","tags":["grpc","c","cpp"]},{"location":"blog/grpc-%E5%AD%A6%E4%B9%A0/#grpc_1","title":"grpc\u5f02\u6b65\u6d41","text":"<p>\u5b98\u65b9\u4ed3\u5e93\u7684\u793a\u4f8b\u4ee3\u7801\u6ca1\u6709\u5f02\u6b65\u4e14\u6d41\u7684, \u5728\u5b9e\u9645\u9879\u76ee\u4e2d\u7528\u5230\u5f02\u6b65\u6d41,\u4f7f\u7528\u5927\u6982\u65b9\u6cd5 1. \u624b\u52a8\u521b\u5efawritereader 2. \u542f\u52a8\u65f6\uff0c\u8c03\u7528'grpc::Service::RequestAsyncBidiStreaming' \u548c 'grpc::Service::RequestAsyncClientStreaming' \u4ee5\u53ca'RequestAsyncServerStreaming', \u5411cq\u585e\u8bf7\u6c42new_connection\u4e8b\u4ef6 3. \u6536\u5230'new_connection'\u4e8b\u4ef6\u8fd4\u56de\u540e\uff0c\u518d\u8c03\u7528read\u4e8b\u4ef6\u3002</p> <p>\u4e00\u5171\u67095\u4e2a\u7c7b\u578b <pre><code>new_connection, read, write, finish, done\n</code></pre> \u6211\u5199\u4e86\u4e00\u4e2ademo grpcstreamhelloworld</p>","tags":["grpc","c","cpp"]},{"location":"blog/grpc-%E5%AD%A6%E4%B9%A0/#grpc_2","title":"grpc \u6d88\u606f\u5927\u5c0f","text":"<p>\u8001\u7248\u672c\u7684grpc\u4e2d\uff0c\u53d1\u9001\u7aef\u662f\u652f\u6301\u65e0\u9650\u5927\u5c0f\u7684\uff0c\u4f46\u63a5\u53d7\u7aef\u53ea\u80fd\u662f4M <pre><code>#define GRPC_DEFAULT_MAX_SEND_MESSAGE_LENGTH -1\n#define GRPC_DEFAULT_MAX_RECV_MESSAGE_LENGTH (4 * 1024 * 1024)\n</code></pre> \u670d\u52a1\u7aef\u4ee3\u7801 <pre><code>std::unique_ptr&lt;Server&gt; ServerBuilder::BuildAndStart() {\n    if (max_receive_message_size_ &gt;= 0) {\n      args.SetInt(GRPC_ARG_MAX_RECEIVE_MESSAGE_LENGTH, max_receive_message_size_);\n    }\n</code></pre></p> <p>\u4f46\u5728\u65b0\u7248grpc\u4e2d\u53d8\u4e86</p> <pre><code>  std::unique_ptr&lt;grpc::Server&gt; ServerBuilder::BuildAndStart() {\n    grpc::ChannelArguments args;\n    if (max_receive_message_size_ &gt;= -1) {\n      args.SetInt(GRPC_ARG_MAX_RECEIVE_MESSAGE_LENGTH, max_receive_message_size_);\n    }\n    if (max_send_message_size_ &gt;= -1) {\n      args.SetInt(GRPC_ARG_MAX_SEND_MESSAGE_LENGTH, max_send_message_size_);\n    }\n</code></pre>","tags":["grpc","c","cpp"]},{"location":"blog/grpc-%E5%AD%A6%E4%B9%A0/#grpc_3","title":"grpc \u7f16\u8bd1\u5b89\u88c5\u7684\u95ee\u9898","text":"<p>https://github.com/grpc/grpc/issues/13841</p>","tags":["grpc","c","cpp"]},{"location":"blog/grpc-%E5%AD%A6%E4%B9%A0/#grpc_4","title":"grpc\u5f02\u6b65\u5b58\u5728\u95ee\u9898","text":"<p>\u56e0\u4e3a\u5f02\u6b65\u670d\u52a1\u7aef\u901a\u8fc7completionqueue\u6765\u901a\u77e5rpc\u6267\u884c\u7ed3\u679c\u548c\u6267\u884c\u4e0b\u6b21\u8c03\u7528\uff0c\u901a\u5e38\u4f7f\u7528\u591aqueue\u548c\u591a\u7ebf\u7a0b\u7684\u65b9\u5f0f\u63d0\u9ad8\u5904\u7406\u6548\u7387 1. \u901a\u5e38\u60c5\u51b5\u662f\u591aqueue, \u5373\u6bcf\u4e2aservice\u5bf9\u5e94\u4e00\u4e2aqueue, \u800c\u6bcf\u4e2aservice\u53c8\u6709\u591a\u4e2arpc\uff0c\u7ebf\u7a0b\u53bb\u8f6e\u8be2\u8fd9\u4e2acomplete_queue\u3002\u8fd9\u6837\u5bfc\u81f4\u9ad8\u7ebf\u7a0b\u5207\u6362\u5f00\u9500\uff0c\u800c\u4e14complete_queue\u4e5f\u5360\u7528\u5927\u91cf\u5185\u5b58 2. \u591a\u7ebf\u7a0b\uff0cqueue\u53ef\u4ee5\u7528\u591a\u4e2a\u7ebf\u7a0b\u53bb\u8f6e\u8be2\uff0c\u4f460.13\u7248\u672c\u53ef\u80fd\u51fa\u73b0bug</p>","tags":["grpc","c","cpp"]},{"location":"blog/grpc-%E5%AD%A6%E4%B9%A0/#grpc_5","title":"grpc\u5f02\u6b65\u6d41\u5b58\u5728\u7684\u95ee\u9898","text":"<p>grpc\u533a\u522b\u4e0e\u5176\u4ed6\u6846\u67b6\u5f88\u5927\u4e00\u4e2a\u4f18\u52bf\u662f\u652f\u6301\u5f02\u6b65\u6d41\uff0c\u5373\u53ef\u4ee5\u591a\u6b21\u8bf7\u6c42\u548c\u591a\u6b21\u56de\u590d\u3002\u5f02\u6b65\u662f\u57fa\u4e8ecq\u7684\u4e8b\u4ef6\u9a71\u52a8\uff0c\u6240\u4ee5\u5fc5\u987b\u7b49\u5f85tag\u56de\u8c03, \u8fde\u7eed\u4e24\u6b21\u53d1\u9001\u4f1a\u5f02\u5e38\u3002 \u800c\u771f\u6b63\u7684\u8bf7\u6c42\u4e00\u822c\u5728\u4e1a\u52a1\u6a21\u5757\u5904\u7406, \u4e0d\u77e5\u9053tag\u7684\u72b6\u6001\u5373\u4e0d\u77e5\u9053\u662f\u5426\u6b63\u5728\u53d1\u9001\uff0c \u90a3\u4e48\u5982\u4f55\u5728cq\u56de\u8c03\u5916\u53d1\u9001\u6d88\u606f\u5462\uff1f </p> <p>\u529e\u6cd5\u662f\u7ef4\u62a4\u4e00\u4e2a\u53d1\u9001\u961f\u5217\uff0c\u6d88\u606f\u5148\u5b58\u961f\u5217\u91cc\uff0c\u7b49\u5f85cq\u56de\u8c03\u65f6\u53d6\u51fa\u53d1\u9001\u3002 \u53e6\u5916\u7531\u4e8e\u6d41\u540c\u6b65\u9700\u8981\u663e\u5f0f\u53d1\u9001\u7ed3\u675f\u6807\u8bb0(\u670d\u52a1\u7aef\u8c03Stream::Finish, \u5ba2\u6237\u7aef\u8c03\u7528WriteDown\u548cFinish),  \u6240\u4ee5\u9700\u8981\u6709\u4e00\u4e2a\u7279\u6b8a\u6d88\u606f\u52a0\u4ee5\u533a\u5206\uff0c\u901a\u5e38\u7528\u7a7a\u6307\u9488\uff0c\u4e5f\u53ef\u4ee5\u8bbe\u7f6e\u7ed3\u675f\u6807\u5fd7\u3002\u53e6\u5916\u7531\u4e8e\u53d1\u9001\u4ee3\u7801\u4f1a\u540c\u65f6\u88ab\u4e1a\u52a1\u8c03\u7528\u548ccq\u56de\u8c03\uff0c\u9700\u8981\u5bf9\u53d1\u9001\u4ee3\u7801\u52a0\u9501</p>","tags":["grpc","c","cpp"]},{"location":"blog/grpc-%E5%AD%A6%E4%B9%A0/#grpc_6","title":"\u8c03\u8bd5grpc","text":"<p>\u901a\u8fc7\u8bbe\u7f6e\u73af\u5883\u53d8\u91cf\uff0c\u8ba9grpc\u5411\u63a7\u5236\u53f0\u6253\u5370\u8be6\u7ec6\u4fe1\u606f <pre><code>export GRPC_VERBOSITY=DEBUG\nbash-5.0# ./build/bin/hasync slave  stdin stdout @127.0.0.1:7615\nD1026 08:27:44.142802149   24658 ev_posix.cc:174]            Using polling engine: epollex\nD1026 08:27:44.143406685   24658 dns_resolver_ares.cc:490]   Using ares dns resolver\nI1026 08:27:44.158115785   24658 server_builder.cc:332]      Synchronous server. Num CQs: 1, Min pollers: 1, Max Pollers: 2, CQ timeout (msec): 10000\n</code></pre></p>","tags":["grpc","c","cpp"]},{"location":"blog/grpc-%E5%AD%A6%E4%B9%A0/#_5","title":"\u9879\u76ee\u5b9e\u8df5","text":"<p>\u9879\u76ee\u4f7f\u7528\u5ba2\u6237\u7aef\u5f02\u6b65/\u540c\u6b65\uff0c\u670d\u52a1\u7aef\u5168\u5f02\u6b65\uff0c \u53ef\u4ee5\u517c\u5bb9\u56db\u79cd\u4f20\u8f93\u65b9\u5f0f</p>","tags":["grpc","c","cpp"]},{"location":"blog/grpc-%E5%AD%A6%E4%B9%A0/#_6","title":"\u5f15\u7528","text":"<p>https://grpc.github.io/grpc/cpp/grpcpp_2impl_2codegen_2sync__stream_8h_source.html https://grpc.github.io/grpc/cpp/grpcpp_2impl_2codegen_2byte__buffer_8h_source.html https://grpc.github.io/grpc/cpp/call__op__set_8h_source.html</p>","tags":["grpc","c","cpp"]},{"location":"blog/%E5%90%89%E4%BB%96%E5%AD%A6%E4%B9%A0/","title":"\u5409\u4ed6\u5b66\u4e60","text":"","tags":["guitar"]},{"location":"blog/%E5%90%89%E4%BB%96%E5%AD%A6%E4%B9%A0/#10","title":"\u6700\u5e38\u7528\u768410\u4e2a\u548c\u5f26","text":"<p> \u98df\u6307\u653e\u57285\u5f26\u7684\u7b2c\u4e8c\u54c1\u4e0a\uff0c\u4e2d\u6307\u653e\u57284\u5f26\u7684\u7b2c\u4e8c\u54c1\u4e0a, \u6216\u7528\u4e2d\u6307\u653e\u57285\u5f26\u7684\u7b2c\u4e8c\u54c1\u4e0a\uff0c\u65e0\u540d\u6307\u653e\u57284\u5f26\u7684\u7b2c\u4e8c\u54c1\u4e0a</p> <p> \u98df\u6307\u653e\u57283\u5f26\u7684\u7b2c\u4e8c\u54c1\u4e0a\uff0c\u4e2d\u6307\u653e\u57281\u5f26\u7684\u7b2c\u4e8c\u54c1\u4e0a\uff0c\u65e0\u540d\u6307\u653e\u57282\u5f26\u7684\u7b2c\u4e09\u54c1\u4e0a</p> <p> \u98df\u6307\u653e\u57282\u5f26\u7684\u7b2c\u4e00\u54c1\u4e0a\uff0c\u4e2d\u6307\u653e\u57284\u5f26\u7684\u7b2c\u4e8c\u54c1\u4e0a\uff0c\u65e0\u540d\u6307\u653e\u57285\u5f26\u7684\u7b2c\u4e09\u54c1\u4e0a</p> <p> \u98df\u6307\u653e\u57285\u5f26\u7684\u7b2c\u4e8c\u54c1\u4e0a\uff0c\u4e2d\u6307\u653e\u57286\u5f26\u7684\u7b2c\u4e09\u54c1\u4e0a\uff0c\u65e0\u540d\u6307\u653e\u57281\u5f26\u7684\u7b2c\u4e09\u54c1\u4e0a, \u6216\u4e2d\u6307\u653e\u57285\u5f26\u7684\u7b2c\u4e8c\u54c1\u4e0a\uff0c\u65e0\u540d\u6307\u653e\u57286\u5f26\u7684\u7b2c\u4e09\u54c1\u4e0a\uff0c\u5c0f\u6307\u653e\u57281\u5f26\u7684\u7b2c\u4e09\u54c1\u4e0a</p> <p> \u98df\u6307\u653e\u57282\u5f26\u7684\u7b2c\u4e00\u54c1\u4e0a\uff0c\u4e2d\u6307\u653e\u57284\u5f26\u7684\u7b2c\u4e8c\u54c1\u4e0a\uff0c\u65e0\u540d\u6307\u653e\u57283\u5f26\u7684\u7b2c\u4e8c\u54c1\u4e0a</p> <p> \u98df\u6307\u5927\u6a2a\u6309\u5728\u4e00\u54c1\u4e0a\uff0c\u4e2d\u6307\u653e\u57283\u5f26\u7684\u7b2c\u4e8c\u54c1\u4e0a\uff0c\u65e0\u540d\u6307\u653e\u57285\u5f26\u7b2c\u4e09\u54c1\u4e0a\uff0c\u5c0f\u6307\u653e\u57284\u5f26\u7b2c\u4e09\u54c1\u4e0a </p> <p> \u98df\u6307\u6307\u653e\u57283\u5f26\u7684\u7b2c\u4e00\u54c1\u4e0a\uff0c\u4e2d\u6307\u653e\u57285\u5f26\u7b2c\u4e8c\u54c1\u4e0a\uff0c\u65e0\u540d\u6307\u653e\u57284\u5f26\u7b2c\u4e8c\u54c1\u4e0a</p> <p> \u98df\u6307\u653e\u57281\u5f26\u7b2c\u4e00\u54c1\u4e0a\uff0c\u4e2d\u6307\u653e\u57283\u5f26\u7b2c\u4e8c\u54c1\u4e0a\uff0c\u65e0\u540d\u6307\u653e\u57282\u5f26\u7b2c\u4e09\u54c1\u4e0a</p> <p> \u98df\u6307\u653e\u57284\u5f26\u7b2c\u4e8c\u54c1\u4e0a\uff0c\u4e2d\u6307\u653e\u57283\u5f26\u7b2c\u4e8c\u54c1\u4e0a\uff0c\u65e0\u540d\u6307\u653e\u57282\u5f26\u7b2c\u4e8c\u54c1\u4e0a</p> <p> \u98df\u6307\u5927\u6a2a\u6309\u653e\u5728\u7b2c\u4e8c\u54c1\u4e0a\uff0c\u4e2d\u6307\u653e\u57282\u5f26\u7b2c\u4e09\u54c1\u4e0a\uff0c\u65e0\u540d\u6307\u653e\u57284\u5f26\u7b2c\u56db\u54c1\u4e0a\uff0c\u5c0f\u6307\u653e\u57283\u5f26\u7b2c\u56db\u54c1\u4e0a </p>","tags":["guitar"]},{"location":"blog/%E5%90%89%E4%BB%96%E5%AD%A6%E4%B9%A0/#_2","title":"\u516b\u4e2a\u5b9e\u7528\u7684\u5409\u4ed6\u548c\u5f26\u8f6c\u6362\u6280\u5de7","text":"<p>1.\u538b\u719f\u8981\u8f6c\u6362\u7684\u548c\u7d43\uff0c\u786e\u4fdd\u6ca1\u6709\u6742\u97f3 2.\u627e\u51fa\u5171\u901a\u7684\u624b\u6307  3.\u7ec3\u4e60\u624b\u6307\u79fb\u52a8\u7684\u901f\u5ea6\uff0c\u5148\u4ece\u7ec3\u4e60\u79fb\u52a8\u4f4e\u97f3\u7684\u624b\u6307\u5f00\u59cb  4.\u76f8\u540c\u6307\u578b\u7684\u624b\u6307\u53ef\u4ee5\u4e00\u8d77\u79fb\u52a8</p>","tags":["guitar"]},{"location":"blog/%E5%90%89%E4%BB%96%E5%AD%A6%E4%B9%A0/#_3","title":"\u5f15\u7528","text":"<p>https://www.zhihu.com/tardis/bd/ans/1797295715</p>","tags":["guitar"]},{"location":"blog/%E5%A0%86%E6%8E%92%E5%BA%8F/","title":"\u5806\u6392\u5e8f","text":"<p>\u5806\u6392\u7c7b\u4f3c\u9009\u62e9\u6392\u5e8f\uff0c\u53ea\u6392\u5e8f\u672a\u6392\u5e8f\u7684\u90e8\u5206\uff0c\u4f46\u5806\u6392\u6bd4\u8f83\u65b9\u5f0f\u4e0d\u540c\uff0c\u6bcf\u6b21\u53ea\u6bd4\u8f83log(n)\u6b21 \u6700\u7ec8\u7684\u5806\u6392\u65f6\u95f4\u590d\u6742\u5ea6\u4e3aO(nlogn)</p>","tags":["\u7b97\u6cd5"]},{"location":"blog/%E5%A0%86%E6%8E%92%E5%BA%8F/#_2","title":"\u5173\u952e\u4e0b\u6807","text":"<p>\u5806\u4e00\u822c\u7528\u6570\u7ec4\u6765\u8868\u793a\uff0c\u4f46\u662f\u5173\u7cfb\u4e3a</p> <ul> <li>\u5f53\u4ee51\u4e3a\u8d77\u70b9\u65f6\uff0c\u82e5\u7236\u8282\u70b9\u662fn</li> <li>\u5de6\u5b50\u8282\u70b9=n*2</li> <li> <p>\u53f3\u5b50\u8282\u70b9=n*2 + 1</p> </li> <li> <p>\u82e5\u8282\u70b9\u4e3an, \u5219\u5176\u7236\u8282\u70b9\u4e3an/2</p> </li> <li> <p>\u82e5\u5143\u7d20\u4e3am\u4e2a\uff0c\u5219\u6700\u540e\u4e00\u4e2a\u6839\u8282\u70b9\uff08\u975e\u53f6\u8282\u70b9\uff09\u4e3am/2</p> </li> <li> <p>\u5f53\u4ee50\u4e3a\u8d77\u70b9\u65f6\uff0c\u82e5\u7236\u8282\u70b9\u662fn</p> </li> <li>\u5de6\u5b50\u8282\u70b9=(n+1)2-1 = n2 + 1</li> <li> <p>\u53f3\u5b50\u8282\u70b9=(n+1)2+1 -1 = n2 + 2</p> </li> <li> <p>\u82e5\u8282\u70b9\u4e0b\u6807\u4e3an, \u5176\u7236\u8282\u70b9\u4e3a(n+1)/2 - 1 = (n-1)/2</p> </li> <li>\u82e5\u5143\u7d20\u4e3am\u4e2a\uff0c\u5219\u6700\u540e\u4e00\u4e2a\u6839\u8282\u70b9\uff08\u975e\u53f6\u8282\u70b9\uff09\u4e3a(m+1)/2-1 = (m-1)/2</li> </ul> <p>\u53ef\u89c1\uff0c\u82e5\u4ee51\u4e3a\u8d77\u70b9\uff0c\u8981\u7b80\u6d01\u5f88\u591a</p>","tags":["\u7b97\u6cd5"]},{"location":"blog/%E5%A0%86%E6%8E%92%E5%BA%8F/#_3","title":"\u5efa\u7acb\u5806","text":"<ol> <li>\u4ece\u7b2c\u4e00\u4e2a\u975e\u53f6\u5b50\u8282\u70b9\u5f00\u59cb\uff0c\u6bd4\u8f83\u7236\u5b50\u8282\u70b9\u4e2d\u627e\u7684\u6700\u503c\uff0c\u5982\u679c\u9700\u8981\u8c03\u6574\u5219\u4ea4\u6362\u7236\u5b50\u8282\u70b9\u518d\u9012\u5f52\u904d\u5386\u4e0b\u4e00\u5c42\uff1a</li> <li>\u5efa\u7acb\u6700\u5c0f\u5806\u65f6\uff0c\u6bcf\u6b21\u6bd4\u8f83\u51fa\u6700\u5927\u503c\uff0c\u4e00\u904d\u4e4b\u540e\uff0c\u5806\u9876\u4e3a\u6700\u5927</li> <li>\u5efa\u7acb\u6700\u5927\u5806\u65f6\uff0c\u6bcf\u6b21\u6bd4\u8f83\u51fa\u6700\u5c0f\u503c\uff0c\u4e00\u904d\u4e4b\u540e\uff0c\u5806\u9876\u4e3a\u6700\u5c0f</li> <li>\u6bd4\u8f83\u5230\u9876\u90e8\u8282\u70b9\u65f6\uff0c\u5b8c\u6210\u7b2c\u4e00\u6b21\u904d\u5386\uff0c\u627e\u5230\u4e86\u9876\u90e8\u7684\u6700\u503c</li> <li>\u5c06\u5806\u9876\u7684\u6700\u503c\u4e0e\u5c3e\u90e8\u4ea4\u6362\uff0c\u904d\u5386\u8303\u56f4-1\uff0c\u7136\u540e\u4ece\u5806\u9876\u5f00\u59cb\u6bd4\u8f83</li> <li>\u91cd\u590d3\u52a8\u4f5c\uff0c\u76f4\u5230\u8303\u56f4\u4e3a1</li> </ol> <p>3\u7684\u52a8\u4f5c\u7c7b\u4f3c<code>\u9009\u62e9\u6392\u5e8f</code>\uff0c\u53ea\u904d\u5386\u672a\u6392\u5e8f\u7684\u90e8\u5206</p>","tags":["\u7b97\u6cd5"]},{"location":"blog/%E5%A0%86%E6%8E%92%E5%BA%8F/#_4","title":"\u6700\u5927\u5806\u548c\u6700\u5c0f\u5806","text":"<p>\u6700\u5c0f\u5806\u53ef\u4ee5\u6c42\u5f97topK\u5927\u7684\u6570\uff0c\u53cd\u8fc7\u6765\u6700\u5927\u5806\u53ef\u4ee5\u6c42\u5f97topK\u5c0f\u7684\u6570</p>","tags":["\u7b97\u6cd5"]},{"location":"blog/%E5%A0%86%E6%8E%92%E5%BA%8F/#topk","title":"topK","text":"<p>\u5806\u6392\u5e8f\u901a\u5e38\u7528\u6765\u5b9e\u73b0topK\uff0c\u9002\u7528\u4e8e\u9650\u5236\u5185\u5b58\u7684\u60c5\u51b5\u3002\u65b9\u6cd5\u662f\u5efa\u7acb\u4e00\u4e2a\u5806\u5927\u5c0f\u4e3aK\uff1a \u5148\u7528\u5934\u90e8K\u4e2a\u6570\u636e\u5efa\u7acb\u6700\u5c0f\u5806\uff0c\u540e\u7eed\u7684\u6570\u5b57\u4e0e\u5806\u9876\uff08\u6700\u5c0f\uff09\u6bd4\uff0c\u5982\u679c\u8ddf\u5c0f\u5219\u8df3\u8fc7\uff0c\u5426\u5219\u66ff\u6362\u7136\u540e\u6267\u884cthiftdown\u3002\u5176\u65f6\u95f4\u590d\u6742\u8bfb\u4e3aO)KlogK + NlogK), \u53ea\u9700\u8981\u4e00\u6b21\u5efa\u5806\uff0c\u540e\u7eed\u90fd\u662f\u6bd4\u8f83\u3002\u7a7a\u95f4\u590d\u6742\u5ea6\u4e3aK\u3002</p> <p>\u4e5f\u53ef\u4ee5\u5219\u4f7f\u7528\u5206\u6cbb\u6cd5\uff0c\u5c06\u6570\u636e\u5206\u4e3a\u591a\u7ec4\uff0c\u6bcf\u7ec4\u6c42\u5176top k\u3002\u6700\u540e\u5408\u5e76\u8d77\u6765\u518d\u6392\u5e8f\uff0c\u6c42\u6700\u7ec8\u7684topK\u3002 \u5206\u6cbb\u6cd5\u53ef\u4ee5\u914d\u5408\u7ebf\u7a0b\u4e00\u8d77\u4f7f\u7528\u52a0\u5feb\u901f\u5ea6\u3002</p> <pre><code>// \u4f7f\u7528\u6700\u5c0f\u5806\u6765\u5b9e\u73b0topK\nvoid thiftdown(int *heap, int root, int size) {\n  int m = root;\n  int l = root * 2 + 1;\n  int r = root * 2 + 2;\n\n  if (l &lt; size &amp;&amp; heap[l] &gt; heap[m]) {\n    m = l;\n  }\n  if (r &lt; size &amp;&amp; heap[r] &gt; heap[m]) {\n    m = r;\n  }\n\n  if (m != root) {\n    int tmp = heap[root];\n    heap[root] = heap[m];\n    heap[m] = tmp;\n\n    thiftdown(heap, m, size);\n  }\n}\n\nvoid adjust(int *heap, int root, int size) {\n  int m = root;\n  int l = root * 2 + 1;\n  int r = root * 2 + 2;\n\n  if (l &lt; size &amp;&amp; heap[l] &lt; heap[m]) {\n    m = l;\n  }\n  if (r &lt; size &amp;&amp; heap[r] &lt; heap[m]) {\n    m = r;\n  }\n\n  if (m != root) {\n    int tmp = heap[root];\n    heap[root] = heap[m];\n    heap[m] = tmp;\n\n    adjust(heap, m, size);\n  }\n}\n\nvoid heapify(int *heap, int size) {\n  for (int i = (size - 1) / 2; i &gt;= 0; i--) {\n    thiftdown(heap, i, size);\n  }\n\n  while (size &gt; 0) {\n    int tmp = heap[0];\n    heap[0] = heap[size - 1];\n    heap[size - 1] = tmp;\n    size--;\n    thiftdown(heap, 0, size);\n  }\n}\n\nvoid add(int *heap, int val, int size) {\n  if (heap[0] &gt;= val) {\n    return;\n  }\n  heap[0] = val;\n  adjust(heap, 0, size);\n}\n</code></pre> <p>\u4f7f\u7528\u65b9\u6cd5 <pre><code>heapify(m, 5);\nfor (int i = 5; i &lt; 49; i++) {\n  add(m, n[i], 5);\n}\nreturn m[0];\n</code></pre></p>","tags":["\u7b97\u6cd5"]},{"location":"blog/%E5%A0%86%E6%8E%92%E5%BA%8F/#topk_1","title":"\u6d77\u91cf\u6570\u636e\u6c42topK","text":"<p>\u5e38\u89c1\u95ee\u9898\u7c7b\u4f3c\uff1a 1. \u6c42\u8bb8\u591a\u91cd\u590d\u6574\u6570\u4e2d\uff0c\u91cd\u590d\u7b2cK\u591a\u7684\u6b63\u6574\u6570\u3002 2. \u6c42\u6587\u672c\u4e2d\u91cd\u590d\u51fa\u73b0\u7684\u8bcd\u8bed\u6b21\u6570\uff0c\u91cd\u590d\u7b2cK\u591a\u7684\u201d\uff0c 3. ip\u4e2d\u8bbf\u95ee\u6700K\u591a\u7684\u201d\u3002</p> <p>\u8fd9\u4e9b\u95ee\u9898\u9700\u8981\u591a\u4e00\u6b65\u7edf\u8ba1\uff0c\u7edf\u8ba1\u51fa\u73b0\u6b21\u6570\uff0c\u7136\u540e\u518d\u4f7f\u7528\u5806\u6765\u67e5\u627etopK\u3002</p> <ol> <li>\u4f7f\u7528\u6570\u7ec4\u7edf\u8ba1\uff0c\u5982\u679c\u76ee\u6807\u90fd\u662f\u6b63\u6574\u6570\uff0c\u5982\u95ee\u98981</li> <li>\u4f7f\u7528map\u7edf\u8ba1\uff0cint\u8868\u793a\u51fa\u73b0\u6b21\u6570\uff0c\u5982\u679c\u76ee\u6807\u5b57\u7b26\u4e32\uff0c\u5982\u95ee\u98982\u548c\u95ee\u98983 <p>\u7edf\u8ba1\u5b8c\u6210\u540e\uff0c\u5c06\u76ee\u6807\u548c\u8ba1\u6570\u653e\u5165\u7ed3\u6784\u4f53\uff0c\u518d\u4f7f\u7528\u5806\u6765\u627etopK <pre><code>{\n  \u76ee\u6807\n  \u6b21\u6570\n}\n</code></pre></p>","tags":["\u7b97\u6cd5"]},{"location":"blog/%E5%A0%86%E6%8E%92%E5%BA%8F/#_5","title":"\u603b\u7ed3","text":"<p>topK \u95ee\u9898\u9664\u4e86\u5806\u6392\u5e8f\u4ee5\u5916\uff0c\u8fd8\u5e38\u7528\u5feb\u6392\u6765\u627e\u3002</p>","tags":["\u7b97\u6cd5"]},{"location":"blog/huawei-unlock-bootloader/","title":"huawei unlock bootloader","text":"<p>\u89e3\u9501\u534e\u4e3a\u5e73\u677fM3\u7684BL\u9501\uff0c\u4ee5\u53ca\u83b7\u53d6root\u6743\u9650</p>","tags":["android","lineage"]},{"location":"blog/huawei-unlock-bootloader/#_1","title":"\u80cc\u666f","text":"<p>\u6211\u6709\u4e00\u4e2a\u534e\u4e3a\u5e73\u677fM3\uff0cWIFI\u7248, \u578b\u53f7BTV-W09\uff0c\u7cfb\u7edf\u662femui5\uff0c \u4e70\u6765\u6ca1\u4ec0\u4e48\u7528\uff0c\u6700\u5927\u7684\u529f\u80fd\u5c31\u662f\u770b\u89c6\u9891\u3002 \u5076\u5c14\u53d1\u73b0\u4e00\u4e2aapp\uff0cLinuxDeploy, \u53ef\u4ee5\u5728\u5b89\u5353\u4e0a\u5b89\u88c5\u5b8c\u6574\u7684Linux\u7cfb\u7edf\uff0c\u800c\u4e0d\u662f\u5185\u7f6e\u7684\u9609\u5272\u7248\uff0c \u524d\u63d0\u662f\u83b7\u5f97root\u6743\u9650\u3002</p>","tags":["android","lineage"]},{"location":"blog/huawei-unlock-bootloader/#_2","title":"\u6b65\u9aa4","text":"<p>\u5168\u90e8\u6b65\u9aa4\u52064\u4e2a\uff1a  1. \u89e3BL 2. \u5237\u5165recovery \u4e5f\u5c31\u662fRTWP 3. \u5c06root\u538b\u7f29\u5305\u590d\u5236\u5230\u5e73\u677f\uff0c\u5728RTWP\u4e0b\u5b89\u88c5 4. \u5b89\u88c5supersu \u7684apk 5. \u53ef\u9009\u5237\u5165xposed\u6846\u67b6\uff0c\u5e76\u5b89\u88c5xposed manager\uff0c\u6b65\u9aa4\u53c2\u80033,4</p>","tags":["android","lineage"]},{"location":"blog/huawei-unlock-bootloader/#_3","title":"\u89e3\u9501","text":"<p>\u56e0\u4e3a\u534e\u4e3a\u5b98\u65b9\u505c\u6b62\u7533\u8bf7\u89e3\u9501BL\u7684\u670d\u52a1\uff0c \u6240\u4ee5\u9700\u8981\u4e0a\u6dd8\u5b9d\u627e\u4eba\u5e2e\u4f60\u641e\u5b9a\u3002 \u89e3\u9501BL\u4e4b\u540e\uff0c \u5728\u5173\u673a\u72b6\u6001\u6309\u4f4f\u7535\u6e90\u548c\u97f3\u91cf\u51cf\uff0c\u8fdb\u5165fastboot\u6a21\u5f0f\u65f6\uff0c\u6709\u7ea2\u5b57\u63d0\u793aunlocked</p>","tags":["android","lineage"]},{"location":"blog/huawei-unlock-bootloader/#rec","title":"\u5237\u5165rec","text":"<p>\u627e\u5230\u4e0e\u8bbe\u5907\u578b\u53f7\u5bf9\u5e94\u7684rec\u975e\u5e38\u91cd\u8981\uff0c\u56e0\u4e3a\u578b\u53f7\u4e0d\u5bf9\u4f1a\u5237\u4e0d\u8fdb\u53bb\uff0c\u6211\u5c1d\u8bd5\u4e86\u5f88\u591a\u4e2a\u7248\u672c\uff0c\u6700\u7ec8\u5728\u534e\u4e3a\u8bba\u575b\u627e\u5230\u4e86\u3002  \u6709\u4e86rec\u540e\uff0c \u8ba9\u624b\u673a\u5904\u4e8efastboot\u72b6\u6001\uff0c \u8fde\u63a5\u624b\u673a\u5230\u7535\u8111\uff0c\u4f7f\u7528 <code>fastboot flash recovery rec</code> \u6765\u5237\u5165 \uff0c\u63d0\u4e66\u5237\u5165\u6210\u529f\u4e4b\u540e\uff0c\u53ef\u80fd\u81ea\u52a8\u91cd\u542f\uff0c\u5982\u679c\u6ca1\u6709\u91cd\u542f\uff0c\u957f\u6309\u7535\u6e90\u952e\u5f3a\u5236\u5173\u673a\u3002  \u5173\u673a\u72b6\u6001\u4e0b\uff0c \u6309\u4f4f\u7535\u6e90\u952e\u548c\u97f3\u91cf+\uff0c\u8fdb\u5165recovery \uff0c \u80fd\u770b\u5230RTWP\u7684\u754c\u9762\u8bf4\u660e\u8f93\u5165\u6210\u529f\uff0c\u5982\u679c\u6ca1\u6709\u770b\u5230RTWP,\u800c\u662f\u8fdb\u5165\u534e\u4e3a\u5b98\u65b9\u7684eRecovery \u8868\u793a\u5931\u8d25\uff0c\u53c8\u53ef\u80fd\u662f\u88ab\u534e\u4e3a\u8986\u76d6\u4e86\u3002 \u4e00\u65e6\u80fd\u8fdb\u5165RTWP, \u90a3\u4e48RTWP\u4f1a\u81ea\u52a8\u5b89\u88c5\uff0c\u4ee5\u540e\u5c31\u4e0d\u7528\u62c5\u5fc3\u88ab\u8986\u76d6\u7684\u95ee\u9898\u3002</p>","tags":["android","lineage"]},{"location":"blog/huawei-unlock-bootloader/#root","title":"\u5237\u5165root\u5de5\u5177","text":"<p>\u5c06root.zip \u62f7\u8d1d\u5230\u5e73\u677f\u7684\u50a8\u5b58\u5361\u76ee\u5f55\uff0c\u8fdb\u5165RTWP\uff0c\u70b9INSTALL,  \u7136\u540e\u9009\u62e9root.zip \u5c31\u4f1a\u5f00\u59cb\u5b89\u88c5\u4e86\uff0c \u5b89\u88c5\u540e\u518d\u5b89\u88c5supersu \u7684\u5e94\u7528</p> <p>\u8fd9\u6837\u5c31root\u6210\u529f\u4e86\uff0c \u6240\u4ee5\u6b65\u9aa4\u5f88\u7b80\u5355\uff0c\u627e\u5230\u5bf9\u5e94\u673a\u578b\u7684rec \u5f88\u5173\u952e\u3002 </p>","tags":["android","lineage"]},{"location":"blog/huawei-unlock-bootloader/#xposed","title":"\u5237\u5165xposed","text":"<p>xposed \u5f88\u5f3a\u5927\uff0c\u4f46\u662fxposed\u53ea\u662f\u4e2a\u6846\u67b6\uff0c\u9700\u8981\u5b89\u88c5\u5305\u6765\u5b9e\u73b0\u5bf9app\u7684hack\u3002\u4f46\u662f\u6211\u5b89\u88c5\u5b8c\uff0c\u6ca1\u53d1\u73b0\u4ec0\u4e48\u5f88\u5f3a\u5927\u5305\uff0c\u611f\u89c9\u4e5f\u6ca1\u4ec0\u4e48\u7528\u3002 </p>","tags":["android","lineage"]},{"location":"blog/huawei-unlock-bootloader/#_4","title":"\u66f4\u65b0","text":"<p>\u5e73\u677f\u4e00\u76f4\u90fd\u5728\u5403\u7070\uff0c\u6700\u8fd1\u53d1\u73b0\u8bbf\u95ee\u7f51\u7ad9\u90fd\u62a5\u8bc1\u4e66\u9519\u8bef\uff0c\u53ef\u80fd\u662f\u7cfb\u7edf\u65e7\u4e86(\u540e\u9762\u53d1\u73b0\u662f\u7535\u6c60\u9988\u7535\u592a\u4e45\uff0c\u65f6\u95f4\u4e0d\u540c\u6b65)\uff0c\u6240\u4ee5\u51b3\u5b9a\u5347\u7ea7\u7cfb\u7edf\u3002\u8fd9\u6b21\u5b8c\u6574\u8d34\u51fa\u547d\u4ee4\uff0c\u56e0\u4e3a\u53d1\u73b0\u6211\u4e4b\u524d\u5199\u7684\u96be\u4ee5\u53c2\u8003\u3002\u5728XDA\u7f51\u7ad9\u53d1\u73b0\u6709\u65b0\u7684lineage17\u9002\u5408btv-w09,\u4e8e\u662f\u6309\u7167\u5e16\u5b50\u91cc\u9762\u7684\u65b9\u6cd5\u505a\uff1a 1. \u4e0b\u8f7dTWRP 3.3.1-1\uff0clineage 17 \u7cfb\u7edf\u538b\u7f29\u5305\uff0c boot \u955c\u50cf\uff0c\u6211\u7684\u662fwifi-only\u7248\u672c\u3002 2. \u5728\u5e73\u677f\u5173\u95ed\u72b6\u6001\u4e0b\uff0c\u6309\u4f4f\u7535\u6e90+\u97f3\u91cf\u51cf\uff0c\u632f\u52a8\u7684\u65f6\u5019\u91ca\u653e\u7535\u6e90\u952e\uff0c\u7136\u540e\u5c31\u8fdb\u5165fastboot\u72b6\u6001\uff0c\u663e\u793a<code>phone unlock</code> 3. \u5237\u5165twrp <code>fastboot flash recovery twrp-xxx.img</code> 4. \u5237\u5165boot <code>fastboot flash boot boot-xxx.img</code> 5. \u8fdb\u5165twrp\uff0c\u8fd9\u91cc\u6709\u70b9\u8ff7\u60d1\uff0c\u7f51\u4e0a\u8bf4\uff08\u5305\u62ec\u6211\u4e4b\u524d\u8bf4\u7684\uff09\u6309\u4f4f\u7535\u6e90+\u97f3\u91cf\u52a0\u603b\u662f\u65e0\u6cd5\u8fdb\u5165twrp\u800c\u662f\u8fdb\u5165\u4e86\u534e\u4e3a\u7684eRecovery,\u4f7f\u7528<code>adb boot-recovery</code>\u5219\u8fdb\u5165\u4e86\u6b63\u5e38\u7cfb\u7edf\u3002\u6700\u540e\u53d1\u73b0\u5728\u5f00\u53d1\u8005\u6a21\u5f0f\u4e0b\u5f00\u542f<code>\u9ad8\u7ea7\u91cd\u542f</code>\u529f\u80fd\uff0c\u91cd\u542f\u7684\u65f6\u5019\u9009\u62e9\u91cd\u542f\u5230<code>recovery</code>\u5219\u80fd\u6b63\u5e38\u8fdb\u5165Twrp\u754c\u9762\u3002\u53ef\u80fd\u662f\u5e73\u677f\u63a5\u7740USB\u7ebf\u3002 6. \u5e16\u5b50\u4e0a\u8bf4\u4e86\uff0c\u5347\u7ea7lineage\u9700\u8981Wipe\uff0c\u5f7b\u5e95\u521d\u59cb\u5316\u4f46\u4fdd\u7559\u7cfb\u7edf\uff0c\u6267\u884c\u540e\u8fdesdcard\u76ee\u5f55\u4e5f\u4f1a\u683c\u5f0f\u5316\uff0c\u5269\u51e0\u4e2a\u6807\u51c6\u76ee\u5f55\u3002 7. \u7528adb push \u5c06\u7cfb\u7edf\u5b89\u88c5\u538b\u7f29\u5305\u53d1\u9001\u5230\u5e73\u677f\u7684\u5b58\u50a8\u7a7a\u95f4\uff0c<code>adb push Lineage-xxx.zip /sdcard</code>\uff0c\u7136\u540e\u5728TWRP\u4e2d\u9009\u62e9 Install\uff0c\u9009\u62e9\u8fd9\u4e2azip \u8fdb\u884c\u5b89\u88c5\u3002 \u4e0d\u8fc7\u53d1\u73b0\u8fd9\u4e2azip\u6587\u4ef6\u6821\u9a8c\u5931\u8d25\uff0c\u4e0d\u7ba1\u4ed6\u4e86\u3002</p> <p>\u7136\u540e\u5c31\u91cd\u542f\u8fdb\u5165\u65b0\u7248\u672c\u7684Lineage 17(android 10)\uff0c\u53ef\u60dc\u7684\u662f\u6ca1\u6709\u76f8\u673a\u529f\u80fd\u3002</p>","tags":["android","lineage"]},{"location":"blog/huawei-unlock-bootloader/#2025lineageos20","title":"2025\u5e74\u91cd\u65b0\u5237lineageos20","text":"<p>\u540c\u6837\u95ee\u9898\u53c8\u51fa\u73b0\u4e86</p> <ol> <li>\u8fdb\u5165 fastboot \u6a21\u5f0f <code>adb reboot bootloader</code>\uff0c \u5982\u4eca\u6ca1\u6709adb reboot fastboot\u547d\u4ee4\u4e86\uff0c fastboot\u6a21\u5f0f\u548cbootloader\u6a21\u5f0f\u5e94\u8be5\u662f\u4e00\u6837\u7684</li> <li>\u5237\u5165\u65b0\u7684recovery <code>fastboot flash recovery ~/Downloads/recovery.img</code></li> <li>\u8fdb\u5165recovery\uff0c\u683c\u5f0f\u5316data\u5206\u533a</li> <li>\u5728recovery\u4e2d\u70b9\u51fbApply Update\uff0c \u518d\u70b9\u51fbApply from ADB\uff0c \u6267\u884c\u7ebf\u5237</li> <li>\u5728\u7535\u8111\u8f93\u5165<code>adb sideload ~/Downloads/lineage-20.0-20250102-RELEASE-btvw09.zip</code></li> </ol> <p>\u4f46\u662f\u7b2c5\u6b65\u51fa\u73b0\u9519\u8bef <pre><code>adb sideload ~/Downloads/lineage-20.0-20250102-RELEASE-btvw09.zipmain  \nadb: sideload connection failed: insufficient permissions for device: missing udev rules? user is in the plugdev group\nSee [http://developer.android.com/tools/device.html] for more information\nadb: trying pre-KitKat sideload method...\nadb: pre-KitKat sideload connection failed: insufficient permissions for device: missing udev rules? user is in the plugdev group\nSee [http://developer.android.com/tools/device.html] for more information \n</code></pre></p> <p>\u67e5\u770b\u8bbe\u5907\u60c5\u51b5\u63d0\u793a <pre><code>adb devices\nList of devices attached\nSLYDU17401001667        no permissions (missing udev rules? user is in the plugdev group); see [http://developer.android.com/tools/device.html]\n</code></pre></p> <p>\u7f51\u4e0a\u67e5\u627e\u89e3\u51b3\u529e\u6cd5\uff0c\u5c1d\u8bd5\u4e86\u597d\u51e0\u4e2a\uff0c\u6700\u7ec8\u901a\u8fc7 <pre><code># \u6dfb\u52a0udev\u89c4\u5219\ncat /etc/udev/rules.d/51-android.rules\nSUBSYSTEM==\"usb\", ATTR{idVendor}==\"id_you_copied\", MODE=\"0666\", GROUP=\"plugdev\"\n\nsudo chmod a+r /etc/udev/rules.d/51-android.rules\nsudo udevadm control --reload-rules\nsudo udevadm trigger\n</code></pre></p> <p>\u4e0a\u9762\u8fd8\u662f\u4e0d\u884c\uff0c\u6700\u540e\u62d4\u6389usb\u7ebf\u53c8\u91cd\u65b0\u63d2\u5165\u5c31\u6b63\u5e38\u4e86</p>","tags":["android","lineage"]},{"location":"blog/ibus-setup/","title":"ibus-setup","text":"<p>\u8fd9\u91cc\u8bb0\u5f55\u4e0bibus\u7684\u914d\u7f6e\u8bb0\u5f55\uff0c\u91cd\u65b0\u5b89\u88c5\u4e86\u7cfb\u7edf\uff0c\u9ed8\u8ba4\u5b89\u88c5\u7684ibus\u3002\u4e4b\u524d\u7528\u7684fcitx5\u8fd8\u4e0d\u9519\uff0c\u4e0d\u8fc7\u90fd\u5c1d\u8bd5\u4e0b\u3002\u9047\u5230\u4e24\u4e2a\u95ee\u9898\uff1a</p>","tags":["ibus","linux"]},{"location":"blog/ibus-setup/#firefox","title":"firefox\u91cc\u9762\u5355\u51fb\u9009\u4e2d\u7684\u6587\u5b57\u89e6\u53d1\u5220\u9664","text":"<p>\u4e4b\u524d\u5b89\u88c5\u7684ibus-pinyin, \u91cd\u65b0\u5b89\u88c5ibus-libpinyin\u540e\u89e3\u51b3\u3002\u53c2\u8003</p>","tags":["ibus","linux"]},{"location":"blog/ibus-setup/#_1","title":"\u914d\u7f6e\u9ed8\u8ba4\u8f93\u5165\u6cd5","text":"<p>\u4f5c\u4e3a\u4e00\u540d\u7a0b\u5e8f\u5458\uff0c\u9ed8\u8ba4\u82f1\u6587\u8f93\u5165\u662f\u57fa\u672c\u7d20\u8d28\uff0c\u5728fcitx5\u4e2d\u5f3a\u5236\u7684\u82f1\u6587\u8f93\u5165\u6cd5\u662f\u9ed8\u8ba4\u8f93\u5165\u6cd5\u3002\u4f46ibus\u4e2d\u4e0d\u662f\uff0c\u4f46\u53ef\u4ee5\u901a\u8fc7dbus\u6765\u4fee\u6539\u3002\u6253\u5f00dconf-editor\uff0c\u4f9d\u6b21\u627e\u5230<code>dconf-editor</code> -&gt; <code>desktop</code> -&gt; <code>ibus</code> -&gt; <code>general</code>\uff0c\u76f4\u63a5\u4fee\u6539<code>preload-engines</code>\u7684\u7528\u6237\u5b9a\u4e49\u987a\u5e8f\uff0c<code>engines-order</code>\u4f1a\u8ddf\u968f\u53d8\u5316\u3002\u5c06<code>ibus:us:en</code>\u63d0\u5230<code>ibus-pinyin</code>\u6570\u7ec4\u524d\u9762\u5c31\u53ef\u4ee5\u4e86\u3002\u53c2\u8003</p>","tags":["ibus","linux"]},{"location":"blog/ibus-setup/#ibus","title":"ibus \u4f53\u9a8c","text":"<p>ibus\u4e2d\u7684\u597d\u50cf\u8f93\u5165\u8868\u60c5\u8981\u5bb9\u6613\u4e9b\u3002</p>","tags":["ibus","linux"]},{"location":"blog/ibus-setup/#gnome-ibus","title":"gnome \u914d\u7f6eibus","text":"<p>\u6700\u8fd1\u5207\u6362\u5230gnome-wayland\uff0c \u914d\u7f6eibus\u82b1\u4e86\u633a\u591a\u65f6\u95f4\u3002\u95ee\u9898\u8ddf\u7f51\u4e0a\u8bf4\u7684\u4ec0\u4e48locale\u65e0\u5173\uff0cgnome\u4e2d\u7684locale\u6587\u4ef6\u662f\u4fee\u6539\u914d\u7f6e\u65f6\u81ea\u52a8\u66f4\u65b0\u7684\u3002\u6700\u7ec8\u65e0\u5934\u65e0\u8111\u5378\u8f7d\u4e86fcitx\u76f8\u5173\u7684\u4e1c\u897f\uff0c\u5e76\u4e14\u91cd\u88c5\u4e86ibus\u548cibus-libpinyin\uff0c\u7136\u540e\u53ef\u80fd\u662f\u91cd\u542f\u540e\u6210\u529f\u3002</p>","tags":["ibus","linux"]},{"location":"blog/%E6%90%AD%E5%BB%BAk8s%E9%9B%86%E7%BE%A4/","title":"\u642d\u5efak8s\u96c6\u7fa4","text":"<p>\u5f15\u7528 https://blog.piaoruiqing.com/2019/09/17/kubernetes-1-installation/ \u7167\u7740\u6587\u7ae0\u642d\u5efak8s\u96c6\u7fa4\uff0c\u5199\u5f97\u633a\u597d\uff0c\u8bb0\u5f55\u4e00\u4e0b\u81ea\u5df1\u7684\u642d\u5efa\u65b9\u6cd5\u548c\u95ee\u9898</p>","tags":["k8s","docker"]},{"location":"blog/%E6%90%AD%E5%BB%BAk8s%E9%9B%86%E7%BE%A4/#_1","title":"\u73af\u5883","text":"<ol> <li>2\u4e2akvm\u865a\u62df\u673a, \u5b89\u88c5\u7684centos7\u7cfb\u7edf</li> <li>\u4e24\u4e2a\u865a\u62df\u673a\u90fd\u914d\u7f6e\u4e86\u53cc\u7f51\u5361\uff0ceth0\u548ceth1\uff0c eth0\u6865\u63a5\u5bbf\u4e3b\u673a\u7684bridge\uff0c eth1 \u63a5\u5165libvirt default NAT\u7f51\u7edc</li> <li>\u5b98\u65b9\u63a8\u8350\u914d\u7f6e\uff1a CPU &gt; 2\uff0c\u5185\u5b58 &gt; 2G</li> <li>eth1 \u7684ip \u5206\u522b\u4e3a 192.168.122.61, 192.168.122.161</li> </ol>","tags":["k8s","docker"]},{"location":"blog/%E6%90%AD%E5%BB%BAk8s%E9%9B%86%E7%BE%A4/#masterworker","title":"Master\u548cWorker \u5171\u540c\u6b65\u9aa4","text":"<p>\u9700\u8981\u5728\u6240\u6709\u8282\u70b9\u6267\u884c</p>","tags":["k8s","docker"]},{"location":"blog/%E6%90%AD%E5%BB%BAk8s%E9%9B%86%E7%BE%A4/#hostname","title":"\u4fee\u6539hostname","text":"<p>\u7f16\u8f91hostname <pre><code>vim /etc/hostname # \u4fee\u6539hostname\n</code></pre> \u914d\u7f6ehost\u6587\u4ef6\uff0c \u5c06\u6240\u6709\u8282\u70b9\u90fd\u6307\u5b9ahost </p>","tags":["k8s","docker"]},{"location":"blog/%E6%90%AD%E5%BB%BAk8s%E9%9B%86%E7%BE%A4/#_2","title":"\u5173\u95ed\u9632\u706b\u5899","text":"<ol> <li>systemctl disable --now firewalld</li> <li>\u4fee\u6539 /etc/seconfig\uff0c \u5c06selinux \u914d\u7f6e\u6210disable </li> </ol>","tags":["k8s","docker"]},{"location":"blog/%E6%90%AD%E5%BB%BAk8s%E9%9B%86%E7%BE%A4/#swap","title":"\u5173\u95ed swap \u5206\u533a","text":"<ol> <li>swapoff -a </li> <li>\u4fee\u6539 /etc/fstab\uff0c \u6ce8\u91ca\u6389swap \u8bb0\u5f55</li> </ol>","tags":["k8s","docker"]},{"location":"blog/%E6%90%AD%E5%BB%BAk8s%E9%9B%86%E7%BE%A4/#docker","title":"\u5b89\u88c5docker \u914d\u7f6e\u955c\u50cf\u6e90","text":"<p>\u4fee\u6539 /etc/docker/daemon.json \u6587\u4ef6</p> <pre><code>{\n  \"registry-mirrors\": [\"https://xxxxxxxx.mirror.aliyuncs.com\"],\n  \"exec-opts\": [\"native.cgroupdriver=systemd\"],\n  \"log-driver\": \"json-file\",\n  \"log-opts\": {\n    \"max-size\": \"100m\"\n  },\n  \"storage-driver\": \"overlay2\"\n}\n</code></pre> <p>### \u6dfb\u52a0k8s \u8f6f\u4ef6\u6e90 </p> <p>\u5982\u4e0b\u6dfb\u52a0\u7684aliyun\u7684\u955c\u50cf\u6e90</p> <p>```  cat &lt; /etc/yum.repos.d/kubernetes.repo [kubernetes] name=Kubernetes baseurl=http://mirrors.aliyun.com/kubernetes/yum/repos/kubernetes-el7-x86_64 enabled=1 gpgcheck=1 repo_gpgcheck=1 gpgkey=http://mirrors.aliyun.com/kubernetes/yum/doc/yum-key.gpg http://mirrors.aliyun.com/kubernetes/yum/doc/rpm-package-key.gpg exclude=kube* EOF <pre><code>### \u5b89\u88c5k8s\n\n\u5b89\u88c5\u7ec4\u4ef6 \n</code></pre> yum install -y kubelet kubeadm kubectl --disableexcludes=kubernetes systemctl enable kubelet &amp;&amp; systemctl start kubelet <pre><code>### \u914d\u7f6e\u7f51\u7edc\n</code></pre> cat &lt;  /etc/sysctl.d/k8s.conf net.bridge.bridge-nf-call-ip6tables = 1 net.bridge.bridge-nf-call-iptables = 1 EOF sysctl --system <pre><code>\u4e0a\u9762\u7684\u6b65\u9aa4\u9700\u8981\u5728\u4e3b\u5907\u4e0a\u6267\u884c\n\n## Master \u64cd\u4f5c \n\n\u4e0b\u9762\u7684\u6b65\u9aa4\u53ea\u5728Master\u8282\u70b9\u8fd0\u884c\n\n### \u751f\u6210k8s\u521d\u59cb\u5316\u914d\u7f6e\u6587\u4ef6 \n</code></pre> [root@k8s-master ~]$ kubeadm config print init-defaults &gt; kubeadm-init.yaml <pre><code>\u5f97\u5230 kubeadm-init.yaml \u6587\u4ef6\n\n\u4fee\u6539kubeadm-init.yaml \u6587\u4ef6\n1. \u4fee\u6539 `advertiseAddress: 1.2.3.4` \u4e3a\u672c\u673a\u5730\u5740 192.168.122.61\n2. \u4fee\u6539 `imageRepository: k8s.gcr.io ` \u4e3a imageRepository: registry.cn-hangzhou.aliyuncs.com/google_containers \n\n\u4fee\u6539\u955c\u50cf\u5730\u5740\uff0c\u8fd9\u6837\u5c31\u907f\u514d\u4e0b\u8f7dk8s \u955c\u50cf\u8d85\u65f6\n\n\u4fee\u6539\u540e\u7684kubeadm-init.yaml\n\n```yaml\napiVersion: kubeadm.k8s.io/v1beta2\nbootstrapTokens:\n- groups:\n  - system:bootstrappers:kubeadm:default-node-token\n  token: abcdef.0123456789abcdef\n  ttl: 24h0m0s\n  usages:\n  - signing\n  - authentication\nkind: InitConfiguration\nlocalAPIEndpoint:\n  advertiseAddress: 10.33.30.92\n  bindPort: 6443\nnodeRegistration:\n  criSocket: /var/run/dockershim.sock\n  name: k8s-master\n  taints:\n  - effect: NoSchedule\n    key: node-role.kubernetes.io/master\n---\napiServer:\n  timeoutForControlPlane: 4m0s\napiVersion: kubeadm.k8s.io/v1beta2\ncertificatesDir: /etc/kubernetes/pki\nclusterName: kubernetes\ncontrollerManager: {}\ndns:\n  type: CoreDNS\netcd:\n  local:\n    dataDir: /var/lib/etcd\nimageRepository: registry.cn-hangzhou.aliyuncs.com/google_containers\nkind: ClusterConfiguration\nkubernetesVersion: v1.15.0\nnetworking:\n  dnsDomain: cluster.local\n  serviceSubnet: 10.96.0.0/12\nscheduler: {}\n</code></pre>","tags":["k8s","docker"]},{"location":"blog/%E6%90%AD%E5%BB%BAk8s%E9%9B%86%E7%BE%A4/#k8s_1","title":"\u4e0b\u8f7dk8s\u7684\u7ec4\u4ef6\u955c\u50cf","text":"<pre><code>kubeadm config images pull --config kubeadm-init.yaml\n</code></pre>","tags":["k8s","docker"]},{"location":"blog/%E6%90%AD%E5%BB%BAk8s%E9%9B%86%E7%BE%A4/#k8s_2","title":"\u521d\u59cb\u5316 k8s","text":"<p><pre><code>kubeadm init --config kubeadm-init.yaml\n</code></pre> \u6267\u884c\u65e0\u8bef\u540e\uff0c\u5f97\u5230worker \u8282\u70b9\u52a0\u5165\u96c6\u7fa4\u7684\u547d\u4ee4  <pre><code>...\nYour Kubernetes control-plane has initialized successfully!\n...\nThen you can join any number of worker nodes by running the following on each as root:\n\nkubeadm join 10.33.30.92:6443 --token abcdef.0123456789abcdef \\\n    --discovery-token-ca-cert-hash sha256:2883b1961db36593fb67ab5cd024f451b934fc0e72e2fa3858dda3ad3b225837 \n</code></pre></p> <p>\u8bb0\u5f55\u8fd9\u4e2a\u547d\u4ee4\uff0c \u4e22\u5931\u7684\u8bdd\u4e5f\u53ef\u4ee5\u91cd\u65b0\u6267\u884c <code>kubeadmin create token</code> \u627e\u56de</p>","tags":["k8s","docker"]},{"location":"blog/%E6%90%AD%E5%BB%BAk8s%E9%9B%86%E7%BE%A4/#kubectl","title":"\u914d\u7f6e\u666e\u901a\u7528\u6237\u6267\u884ckubectl \u547d\u4ee4","text":"<p>\u7528\u666e\u901a\u7528\u6237\u6267\u884c\u4e00\u4e0b\u547d\u4ee4\uff0c \u8fd9\u6837\u666e\u901a\u7528\u6237\u4e5f\u80fd\u7ba1\u7406\u96c6\u7fa4  <pre><code>mkdir -p $HOME/.kube\nsudo cp -i /etc/kubernetes/admin.conf $HOME/.kube/config\nsudo chown $(id -u):$(id -g) $HOME/.kube/config\n</code></pre></p>","tags":["k8s","docker"]},{"location":"blog/%E6%90%AD%E5%BB%BAk8s%E9%9B%86%E7%BE%A4/#master","title":"\u67e5\u770bMaster \u8282\u70b9\u72b6\u6001","text":"<p>\u53ef\u89c1\uff0cMaster\u8282\u70b9\u672a\u5c31\u7eea\uff0c\u8fd9\u662f\u56e0\u4e3a\u8fd8\u6ca1\u5b89\u88c5\u7f51\u7edc\u7ec4\u4ef6 <pre><code>[root@k8s-master kubernetes]$ kubectl get node\nNAME         STATUS     ROLES    AGE     VERSION\nk8s-master   NotReady   master   3m25s   v1.15.3\n</code></pre></p>","tags":["k8s","docker"]},{"location":"blog/%E6%90%AD%E5%BB%BAk8s%E9%9B%86%E7%BE%A4/#_3","title":"\u914d\u7f6e\u7f51\u7edc","text":"<ol> <li> <p>\u4e0b\u8f7dcalico \u63cf\u8ff0\u6587\u4ef6  wget https://docs.projectcalico.org/v3.8/manifests/calico.yaml</p> </li> <li> <p>\u4fee\u6539calico \u63cf\u8ff0\u6587\u4ef6\u91cc\u7684serviceSubnet\uff0c\u4fee\u6539\u4e3a\u8ddfkubeadmin-init.yaml\u4e00\u81f4 <pre><code>cat kubeadm-init.yaml | grep serviceSubnet:\nserviceSubnet: 10.96.0.0/12\n</code></pre></p> </li> </ol> <p>\u6ce8\u610f  1. calico \u7684\u5730\u5740\u5fc5\u987b\u548c kubeadm-init.yaml \u4fdd\u6301\u4e00\u81f4\uff0c kubeadm-init.yaml \u9ed8\u8ba4\u4e3a <code>serviceSubnet: 10.96.0.0/12</code>\uff0c \u800ccalico\u7684\u9ed8\u8ba4\u5730\u5740\u4e3a<code>192.168.0.0/16</code>, \u6240\u4ee5\u8981\u4e48\u4fee\u6539kubeadmin-init.yaml, \u8981\u4e48\u4fee\u6539calico.yaml\u3002 2. \u8fd9\u91cc\u7684<code>Subnet</code> \u4e0d\u80fd\u6db5\u76d6\u5230\u4e3b\u673a\u7684\u5730\u5740\u8303\u56f4\u5373\u4e0d\u80fd\u5305\u542b <code>192.168.122.0/24</code> </p>","tags":["k8s","docker"]},{"location":"blog/%E6%90%AD%E5%BB%BAk8s%E9%9B%86%E7%BE%A4/#calico","title":"\u5b89\u88c5calico","text":"<pre><code>kubectl apply -f calico.yaml \n</code></pre>","tags":["k8s","docker"]},{"location":"blog/%E6%90%AD%E5%BB%BAk8s%E9%9B%86%E7%BE%A4/#master_1","title":"\u67e5\u770bMaster\u8282\u70b9","text":"<p>\u5f53calico \u5b89\u88c5\u597d\u4e86\uff0c \u53ef\u4ee5\u53d1\u73b0Master \u8282\u70b9\u53d8\u4e3a\u5c31\u7eea\uff0c \u81f3\u6b64Master \u8282\u70b9\u5c31\u914d\u7f6e\u597d\u4e86 <pre><code>[root@k8s-master ~]$ kubectl get node\nNAME         STATUS   ROLES    AGE   VERSION\nk8s-master   Ready    master   15m   v1.15.3\n</code></pre></p>","tags":["k8s","docker"]},{"location":"blog/%E6%90%AD%E5%BB%BAk8s%E9%9B%86%E7%BE%A4/#dashboard","title":"\u5b89\u88c5dashboard","text":"<p>\u4e4b\u524d\u7684\u6b65\u9aa4\u5b89\u88c5\u597d\u4e86Master\u8282\u70b9\uff0c \u53ef\u9009\u62e9\u5b89\u88c5dashboard\uff0c\u901a\u8fc7\u7f51\u9875\u6765\u7ba1\u7406\u96c6\u7fa4 </p> <p>\u6b65\u9aa4\u5f88\u7b80\u5355\uff0c \u5148\u4e0b\u8f7ddashboard\uff0c \u518d\u5b89\u88c5  <pre><code>[root@k8s-master ~]$ wget https://raw.githubusercontent.com/kubernetes/dashboard/v2.0.0-beta4/aio/deploy/recommended.yaml\n[root@k8s-master ~]$ kubectl apply -f recommended.yaml \n</code></pre></p>","tags":["k8s","docker"]},{"location":"blog/%E6%90%AD%E5%BB%BAk8s%E9%9B%86%E7%BE%A4/#dashboard_1","title":"\u521b\u5efadashboard \u7528\u6237","text":"<p>\u5fc5\u987b\u521b\u5efa\u7528\u6237\uff0c\u7136\u540e\u83b7\u53d6token\uff0c\u624d\u80fd\u5728\u96c6\u7fa4\u5916\u8bbf\u95ee\uff0c \u5426\u5219\u5fc5\u987b\u5728Master \u7684localhost \u8bbf\u95eedashboard\u3002  \u4ee5\u4e0b\u662f\u521b\u5efa\u7528\u6237\u7684\u63cf\u8ff0\u6587\u4ef6\uff0c \u6ce8\u610fnamespace\uff0c \u4f8b\u5982\u5b98\u65b9\u7684\u4f8b\u5b50\u662f dashboard\uff0c \u8fd9\u6837\u751f\u6210\u7684token \u4e0d\u4e00\u6837</p> <p>\u6267\u884c\u5b89\u88c5\u7528\u6237 <code>kubectl apply -f dashboard-adminuser.yaml</code></p> <pre><code># dashboard-adminuser.yaml\n\napiVersion: v1\nkind: ServiceAccount\nmetadata:\n  name: admin-user\n  namespace: kube-system\n---\napiVersion: rbac.authorization.k8s.io/v1\nkind: ClusterRoleBinding\nmetadata:\n  name: admin-user\nroleRef:\n  apiGroup: rbac.authorization.k8s.io\n  kind: ClusterRole\n  name: cluster-admin\nsubjects:\n- kind: ServiceAccount\n  name: admin-user\n  namespace: kube-system\n</code></pre> <p>\u521b\u5efa\u8bc1\u4e66\uff0c k8s \u4e0d\u5141\u8bb8\u8fdc\u7a0b\u4f7f\u7528http\uff0c\u6240\u4ee5\u9700\u8981\u7528\u8bc1\u4e66\u8bbf\u95eedashboard </p> <pre><code>[root@k8s-master ~]$ grep 'client-certificate-data' ~/.kube/config | head -n 1 | awk '{print $2}' | base64 -d &gt;&gt; kubecfg.crt\n[root@k8s-master ~]$ grep 'client-key-data' ~/.kube/config | head -n 1 | awk '{print $2}' | base64 -d &gt;&gt; kubecfg.key\n[root@k8s-master ~]$ openssl pkcs12 -export -clcerts -inkey kubecfg.key -in kubecfg.crt -out kubecfg.p12 -name \"kubernetes-client\"\n</code></pre> <p>\u5c06\u751f\u6210\u7684 <code>kubecfg.p12</code> \u6587\u4ef6\u5bfc\u5165\u5230\u96c6\u7fa4\u5916\u7684\u4e3b\u673a\uff0c\u5373kvm\u5bbf\u4e3b\u673a\u4e0a</p> <pre><code>scp root@10.33.30.92:/root/.kube/kubecfg.p12 ./\n</code></pre> <p>\u5728\u5bbf\u4e3b\u673a\u4e0a\u4f7f\u7528chrome \u7684\u9ad8\u7ea7\u529f\u80fd\u91cc\u53ef\u4ee5\u5bfc\u5165\u8bc1\u4e66  </p> <p>\u91cd\u542fchrome \u767b\u5f55\u540e\u767b\u5f55 <pre><code>https://192.168.122.61:6443/api/v1/namespaces/kubernetes-dashboard/services/https:kubernetes-dashboard:/proxy/#/login\n</code></pre></p> <p>\u6253\u5f00\u7f51\u9875\u540e\u9009\u62e9\u8f93\u5165token\uff0c token\u901a\u8fc7\u5728Master \u8282\u70b9\u6267\u884c\u4e00\u4e0b\u547d\u4ee4\u751f\u6210\uff0c \u6ce8\u610f\u53c2\u6570 -n kube-system\uff0c \u9700\u8981\u8ddf\u521b\u5efa\u7528\u6237\u65f6\u7684namespace\u4fdd\u6301\u4e00\u81f4  <pre><code>kubectl -n kube-system describe secret $(kubectl -n kube-system get secret | grep admin-user | awk '{print $1}')\n</code></pre></p> <p>\u590d\u5236token \u5230\u7f51\u9875\u4e0a\uff0c\u5c31\u80fd\u767b\u5f55Dashboard </p>","tags":["k8s","docker"]},{"location":"blog/%E6%90%AD%E5%BB%BAk8s%E9%9B%86%E7%BE%A4/#worker","title":"Worker\u8282\u70b9\u52a0\u5165\u96c6\u7fa4","text":"<p>\u76f4\u63a5\u5728worker\u8282\u70b9\u6267\u884c </p> <pre><code>kubeadm join 10.33.30.92:6443 --token abcdef.0123456789abcdef \\\n    --discovery-token-ca-cert-hash sha256:2883b1961db36593fb67ab5cd024f451b934fc0e72e2fa3858dda3ad3b225837\n</code></pre> <p>\u7136\u540e\u5230Master \u8282\u70b9\u6267\u884c\u4ee5\u4e0b\u547d\u4ee4\uff0c \u8fd9\u91ccName \u663e\u793a\u4e86k8s-worker\u662f\u56e0\u4e3a\u6211\u4eec\u5728Hosts\u6587\u4ef6\u91cc\u6307\u5b9a\u4e86ip\uff0c\u6240\u4ee5k8s\u81ea\u52a8\u8bc6\u522b\u5230\u4e86\uff0c\u5426\u5219\u4f1a\u663e\u793a\u8282\u70b9ip</p> <pre><code>[root@k8s-master ~]$ kubectl get node\nNAME         STATUS   ROLES    AGE   VERSION\nk8s-master   Ready    master   10h   v1.15.3\nk8s-worker   Ready    &lt;none&gt;   96s   v1.15.3\n</code></pre> <p>\u81f3\u6b64\u96c6\u7fa4\u642d\u5efa\u5b8c\u6bd5</p>","tags":["k8s","docker"]},{"location":"blog/%E6%90%AD%E5%BB%BAk8s%E9%9B%86%E7%BE%A4/#_4","title":"\u9047\u5230\u95ee\u9898","text":"<ol> <li>\u56e0\u4e3a\u6211\u7684\u865a\u62df\u673a\u914d\u7f6e\u7684\u53cc\u7f51\u5361\uff0c \u9700\u8981\u5728calico.yaml \u914d\u7f51\u5361interface <pre><code># Cluster type to identify the deployment type\n            - name: CLUSTER_TYPE\n              value: \"k8s,bgp\"\n            - name: IP_AUTODETECTION_METHOD\n              value: \"interface=eth1\"\n</code></pre></li> </ol>","tags":["k8s","docker"]},{"location":"blog/%E5%AE%89%E8%A3%85wordpress%E8%AE%B0%E5%BD%95/","title":"\u5b89\u88c5wordpress\u8bb0\u5f55","text":"<p>\u672c\u6587\u8bb0\u5f55\u5728debian\u4e0a\u5b89\u88c5\u914d\u7f6ewordpress\u7684\u8865\u52a9\uff0c\u5e76\u914d\u7f6e\u4e86ftp\u529f\u80fd\uff0c\u652f\u6301\u81ea\u66f4\u65b0wordpress\u3002</p>","tags":["wordpress"]},{"location":"blog/%E5%AE%89%E8%A3%85wordpress%E8%AE%B0%E5%BD%95/#wordpress_1","title":"\u5b89\u88c5wordpress","text":"<p>\u4e0b\u8f7d\u6700\u65b0\u7684\u5305\uff0c\u89e3\u538b\u5230<code>/var/www/html</code></p>","tags":["wordpress"]},{"location":"blog/%E5%AE%89%E8%A3%85wordpress%E8%AE%B0%E5%BD%95/#_1","title":"\u5b89\u88c5\u914d\u7f6e\u6570\u636e\u5e93","text":"<p>\u5b89\u88c5mariadb, \u521b\u5efa\u6570\u636e\u5e93\u548c\u7528\u6237 <pre><code>mysql -u root\nCREATE DATABASE wordpressdb; \nCREATE USER wordpressuser@localhost IDENTIFIED BY 'password';\nGRANT ALL PRIVILEGES ON wordpressdb.* TO wordpressuser@localhost;\n</code></pre></p>","tags":["wordpress"]},{"location":"blog/%E5%AE%89%E8%A3%85wordpress%E8%AE%B0%E5%BD%95/#nginx-php","title":"\u5b89\u88c5\u914d\u7f6enginx php","text":"<p>\u5b89\u88c5nginx\u548cphp-7.4\uff0c\u8fd8\u6709php\u4e00\u4e9b\u7ec4\u4ef6 nginx \u914d\u7f6e <pre><code>server { \n  listen 80 default_server; \n  listen [::]:80 default_server;\n  server_name your_domain.com;\n\n  root /var/www/html;\n  index index.php index.html index.htm;\n\n  location / {\n    # try_files $uri $uri/ =404;\n    try_files $uri $uri/ /index.php?q=$uri&amp;$args;\n  }\n\n  location ~ \\.php$ {\n      include snippets/fastcgi-php.conf;\n      fastcgi_split_path_info ^(.+\\.php)(/.+)$;\n      fastcgi_pass unix:/run/php/php-fpm.sock;\n  }\n}\n</code></pre></p>","tags":["wordpress"]},{"location":"blog/%E5%AE%89%E8%A3%85wordpress%E8%AE%B0%E5%BD%95/#vsftpd","title":"\u5b89\u88c5\u914d\u7f6evsftpd","text":"<p>\u5b89\u88c5\u540e\uff0c\u4fee\u6539\u914d\u7f6e\u6587\u4ef6<code>/etc/vsftpd.conf</code></p> <pre><code>local_enable=YES\nwrite_enable=YES\nchroot_local_user=YES\nchroot_list_enable=YES\nchroot_list_file=/etc/vsftpd.chroot_list\nallow_writeable_chroot=YES\npm_service_name=ftp\n</code></pre>","tags":["wordpress"]},{"location":"blog/%E5%AE%89%E8%A3%85wordpress%E8%AE%B0%E5%BD%95/#_2","title":"\u6dfb\u52a0\u7528\u6237\uff0c\u5e76\u9650\u5236\u6743\u9650","text":"<p><pre><code>useradd [user_name]\npasswd [user_name]\nusermod -d /var/www/html/wordpress user_name -s /sbin/nologin\n\nsetfacl -m u:ftpsecure:r-x /var/www/html/\n\nsetfacl -R -m u:ftpsecure:rwx /var/www/html/wordpress\nsetfacl -R -d -m u:ftpsecure:rwx /var/www/html/wordpress\n</code></pre> \u5982\u679c\u63d0\u793a\u6ca1\u6709setfacl\u547d\u4ee4\uff0c\u5219\u6267\u884c\u5b89\u88c5acl\u547d\u4ee4 <code>apt install acl</code></p>","tags":["wordpress"]},{"location":"blog/%E5%AE%89%E8%A3%85wordpress%E8%AE%B0%E5%BD%95/#ftp","title":"ftp\u9047\u5230\u95ee\u9898\u548c\u89e3\u51b3\u529e\u6cd5","text":"<ul> <li> <p>\u767b\u9646\u63d0\u793a\"500 OOPS: could not read chroot() list file:/etc/vsftpd.chroot_list\"\uff0c\u9700\u8981\u521b\u5efa\u6587\u4ef6<code>/etc/vsftpd.chroot_list</code></p> </li> <li> <p>\u767b\u9646ftp\u62a5530\u9a8c\u8bc1\u5931\u8d25\u7684\u95ee\u9898\uff0c\u4fee\u6539\u914d\u7f6e\u5982\u4e0b <pre><code>pm_service_name=ftp\n</code></pre></p> </li> <li>\u767b\u9646\u63d0\u793a\"500 OOPS: vsftpd: refusing to run with writable root inside chroot()</li> </ul> <pre><code>allow_writeable_chroot=YES\n</code></pre> <ul> <li>\u767b\u9646\u63d0\u793a 500 OOPS: vsftpd: refusing to run with writable root \uff0c\u610f\u601d\u662f\u767b\u9646\u8005\u5177\u5907\u5bf9\u76ee\u5f55\u7684\u5199\u6743\u9650\uff0c\u8fd9\u662f\u7531\u4e8e\u76ee\u5f55\u8bbe\u5b9a\u6743\u9650\u4e3a777\uff0c\u6240\u4ee5\u8981\u662f\u91cd\u65b0\u8bbe\u5b9a\u4e3a755 <pre><code>chmod 755 /srv/ftp\n</code></pre></li> </ul>","tags":["wordpress"]},{"location":"blog/%E5%AE%89%E8%A3%85wordpress%E8%AE%B0%E5%BD%95/#wordpress_2","title":"\u914d\u7f6ewordpress","text":"<p>\u4fee\u6539<code>wordpress/wp-config.php</code> \u6587\u4ef6, \u6dfb\u52a0\u5982\u4e0b\u5185\u5bb9</p> <p><pre><code>define('FTP_HOST', 'localhost');\ndefine('FTP_USER', 'ftp');\ndefine('FTP_PASS', '');\n</code></pre> \u901a\u8fc7wordpress\u7684api\u53ef\u4ee5\u751f\u6210\u968f\u673atoken\uff0c\u5c06\u8f93\u51fa\u66ff\u6362\u5230<code>wordpress/wp-config.php</code> </p> <pre><code>$curl -s https://api.wordpress.org/secret-key/1.1/salt/\n\ndefine('AUTH_KEY',         'uOeyPW$K[P}23x^0l##N+qP#xzUlIBV[ZQlATs!7J?+5^!w0*bgEw|V6)k:YU0en');\ndefine('SECURE_AUTH_KEY',  'Ad*-`eK|U4Z*7g}7CdX&lt;q0^EuGqT1Tt}CaDRgF%NX-|fmk(:BACtws+^_0Pb8ZRA');\ndefine('LOGGED_IN_KEY',    ':Z$}=h~z-[]8W}wZ(|/;]ZY;U{&gt;u3K&gt;P|u6/d:6}&amp;h*);0ewhrcGm8$/tPii#{,%');\ndefine('NONCE_KEY',        'd}Ue8.+KPDGdH^%2t~fTljDj8e{q{raR!Q0piqM(gcQP&amp;7-$L3u0u|!Bn(-gh/?B');\ndefine('AUTH_SALT',        'UQh.k&gt;4UBTK6IecZe~lL6|J/w^KFROIeCdZw^g=(x?(L+j(-|%C FCt =V*XVz+k');\ndefine('SECURE_AUTH_SALT', 'hHr&amp;dDCApb14yz@ks+;}mk,s&lt;-[]KUj*UAhl0+&lt;pqT*!j;wxc+[mU[czh =&gt;&lt;#em');\ndefine('LOGGED_IN_SALT',   'WO,U^A||&amp;:E@2A2_|MS W1l`fguj-7E{Fz6QkC+OM96Ho49&lt;agM?O=G2FloxuF?6');\ndefine('NONCE_SALT',       'uDN.1::MJ&gt;~9Yp+e39y%o?r &gt;:+OcUSqg5_g&lt;Jt:Sr!um?U:U|MJ2q2qKiLDfmr@');\n</code></pre> <p>\u66f4\u65b0\u6570\u636e\u5e93\u914d\u7f6e\u5230wp-config.php</p>","tags":["wordpress"]},{"location":"blog/%E5%AE%89%E8%A3%85wordpress%E8%AE%B0%E5%BD%95/#url","title":"\u66f4\u65b0url","text":"<p>\u5f00\u59cb\u4f7f\u7528http\u8bbf\u95ee\uff0c\u540e\u9762\u5207\u6362\u5230https\u540e\u4e00\u76f4\u63d0\u793a\u9519\u8bef\u8bf4\u8df3\u8f6c\u592a\u591a\u6b21\u3002\u540e\u6765\u53d1\u73b0\u539f\u56e0\u662f\u5957\u4e86cloudflare\uff0ccloudflare\u8bbe\u7f6e\u7684\u662f\u524d\u7aefhttps\u540e\u7aefhttp, \u540e\u7aef\u4ee5http\u8bbf\u95ee\u771f\u5b9e\u670d\u52a1\u5668\u540e\u53c8\u8df3\u8f6c\u5230https\u3002\u6240\u4ee5\u8bf7\u6c42\u4e00\u76f4\u5728cf&lt;-&gt;wordpress\u4e4b\u95f4\u65e0\u9650\u8df3\u8f6c\u3002\u6240\u4ee5\u9996\u5148\u8981\u8bbe\u7f6ecloudflare\u7684\u4ee3\u7406\u6a21\u5f0f\u4e3a\u4e25\u683c\u5b89\u5168\uff0cstrict full safe\uff0c\u4e5f\u5c31\u662f\u524d\u7aef\u548c\u540e\u7aef\u90fd\u7528\u8bc1\u4e66\u3002\u7136\u540e\u4fee\u6539wordpress\u7684url\u65b9\u6cd5\u6709\u5f88\u591a\uff0c\u4e4b\u524d\u901a\u8fc7\u76f4\u63a5\u4fee\u6539\u6570\u636e\u5e93\uff0c\u8fd9\u6b21\u53d1\u73b0wordpress\u6709\u4e2awp\u7684\u547d\u4ee4\u884c\u5de5\u5177\uff0c\u4e00\u952e\u4fee\u6539\u3002</p>","tags":["wordpress"]},{"location":"blog/%E5%AE%89%E8%A3%85wordpress%E8%AE%B0%E5%BD%95/#vsftpd_1","title":"vsftpd \u914d\u7f6e\u9ed8\u8ba4\u76ee\u5f55","text":"<p>\u4e3alocal user\u914d\u7f6e\u9ed8\u8ba4\u76ee\u5f55\uff0c\u4f8b\u5982\u6240\u6709\u7528\u6237\u767b\u5f55\u540e\u8fdb\u5165/home\u76ee\u5f55, \u6dfb\u52a0\u914d\u7f6e<code>local_root=/home</code>\uff0c\u4e3a\u533f\u540d\u7528\u6237\u914d\u7f6e\u9ed8\u8ba4\u76ee\u5f55\u4e3atmp\u76ee\u5f55\uff0c\u5219\u6dfb\u52a0\u914d\u7f6e<code>anon_root=/tmp</code></p>","tags":["wordpress"]},{"location":"blog/%E5%AE%89%E8%A3%85wordpress%E8%AE%B0%E5%BD%95/#_3","title":"\u53c2\u8003","text":"<p>https://serverfault.com/questions/544850/create-new-vsftpd-user-and-lock-to-specify-home-login-directory https://shiftedbits.org/2012/01/29/enable-wordpress-automatic-updates-on-a-debian-server/</p>","tags":["wordpress"]},{"location":"blog/ipsec-%E5%92%8C-vowifi/","title":"ipsec \u548c vowifi","text":"<p>\u8bb0\u5f55\u4e86ipsec\u548cvowifi\u7684\u5fc3\u5f97\u3002</p>","tags":["ipsec","vowifi"]},{"location":"blog/ipsec-%E5%92%8C-vowifi/#ip","title":"ip \u5206\u7247","text":"<p>\u5f53ip\u5305\u957f\u5ea6\u5927\u8fc7MTU\uff08\u4ee5\u592a\u7f51\u901a\u5e38\u662f1500\uff09\u65f6\uff0c\u7f51\u5361\uff08\u5185\u6838\uff09\u4f1a\u5206\u6210\u591a\u4e2aip\u5305\u53d1\u9001\u3002</p>","tags":["ipsec","vowifi"]},{"location":"blog/ipsec-%E5%92%8C-vowifi/#ipsecmtu","title":"ipsec\u96a7\u9053\u7684MTU","text":"<p>\u4ee5\u592a\u7f51\u7684MTU\u90fd\u662f1500, \u4f46\u662f\u56e0\u4e3aipsec\u5e26\u6765\u7684overhead, MTU\u4f1a\u8bbe\u7f6e\u5c0f\u4e00\u70b9\u907f\u514d\u8def\u7531\u4e8c\u6b21\u5206\u5305\u3002</p>","tags":["ipsec","vowifi"]},{"location":"blog/ipsec-%E5%92%8C-vowifi/#nat-vowifi","title":"NAT\u6a21\u5f0f\uff0c\u624b\u673a\u8fde\u63a5\u8def\u7531\u5668, \u771f\u5b9evowifi\u573a\u666f","text":"<p>\u8fdb\u5165adb\u53ef\u4ee5\u770b\u5230ipsec\u96a7\u9053ipsec272@lo \u6b64\u65f6\u6ca1\u6709\u6ce8\u518c\u3002 </p> <p>\u624b\u673a\u6ce8\u518cvowifi\u6210\u529f\u540e\uff0c\u83b7\u5f97\u4e86\u865a\u62dfip, \u4fee\u6539\u4e86ipsec\u96a7\u9053\u7f51\u5361\u7684MTU\u3002    </p>","tags":["ipsec","vowifi"]},{"location":"blog/ipsec-%E5%92%8C-vowifi/#nattunnel","title":"\u975eNAT\uff0ctunnel\u6a21\u5f0f","text":"<p>\u5148\u4e86\u89e3ESP\u5e26\u6765\u7684\u6d88\u8017  </p> <p> * \u5916\u5c42ip\u5934\u603b\u957f\u5ea61496 * ESP SPI \u5b57\u6bb5\u957f\u5ea64 * ESP Sequence \u5b57\u6bb5\u957f\u5ea64 * ESP IV \u957f\u5ea616  AES-CBC * ESP ICV \u957f\u5ea612 SHA1-96  * ESP Pad \u957f\u5ea61 \u65e0padding * ESP Next Header \u957f\u5ea61</p> <p>ESP\u603b\u5171\u662f38 byte\u3002\u5916\u5c42ip\u603b\u957f\u5ea6(1496) - \u5185\u5c42ip\u603b\u957f\u5ea6(1438) - \u5916\u5c42ip\u5934(20)= 38 byte\u3002 \u5916\u5c42ip\u5934+ESP\u4e00\u5171\u662f58\u3002 \u6240\u4ee5\uff1a  1. \u907f\u514d\u8def\u7531\u4e0b\u4e00\u8df3\u4e8c\u6b21\u5206\u5305\uff0c\u9700\u8981\u9884\u7559\u7a7a\u95f4\u7ed9ipsec\u5934\u3002ipsec\u96a7\u9053\u7f51\u5361\u7684MTU\u5e94\u8be5\u8bbe\u7f6e\u4e3a1500 - 58 = 1442 2. \u4e3a\u4e86\u907f\u514d\u672c\u5730\u7f51\u5361\u5206\u5305\uff0cip\u5305\u7684\u5927\u5c0f\u4e5f\u5e94\u8be5\u5c0f\u4e8eMTU 1442\u3002\u5219:    * TCP MSS = 1442 - ip\u5934\uff0820\uff09 - tcp\u593420 = 1402    * UDP payload = 1442 - ip\u5934\uff0820\uff09 - udp\u59348 = 1414</p>","tags":["ipsec","vowifi"]},{"location":"blog/ipsec-%E5%92%8C-vowifi/#dpdk","title":"dpdk","text":"<p>dpdk \u652f\u6301 ipsec \u7684\u52a0\u89e3\u5bc6\uff0c\u53ef\u4ee5\u7ba1\u7406\u786c\u4ef6\u52a0\u89e3\u5bc6\u8bbe\u5907\uff08\u667a\u80fd\u7f51\u5361\uff09\u548c\u8f6f\u4ef6\u52a0\u89e3\u5bc6\u8bbe\u5907\uff08\u901a\u7528cpu\u4e0a\u8ba1\u7b97\uff09\u3002\u8fd9\u91cc\u90fd\u662f\u8f6f\u4ef6\u52a0\u89e3\u5bc6\uff0cx86\u548carm\u4e0a\u7528\u4e0d\u540c\u7684\u8f6f\u4ef6\u52a0\u89e3\u5bc6\u5e93\u3002</p>","tags":["ipsec","vowifi"]},{"location":"blog/ipsec-%E5%92%8C-vowifi/#advantages-of-rte_security_action_type_cpu_crypto-over-rte_security_action_type_none","title":"advantages of RTE_SECURITY_ACTION_TYPE_CPU_CRYPTO over RTE_SECURITY_ACTION_TYPE_NONE","text":"<p>None\u6a21\u5f0f\u7684\u6ca1\u8d70SECURITY\u7684api , \u8981\u81ea\u5df1\u5f80\u961f\u5217\u91cc\u9001op\uff08operation\uff09, \u6240\u4ee5\u6709 ipsec_process \u548c drain \u64cd\u4f5c\u3002 \u800ccpu\u6a21\u5f0f\u662f\u4e32\u8fde\u5230\u4e00\u8d77\u7684\u3002 \u6ca1\u6709\u9001\u548c\u6536\uff0c\u76f4\u63a5\u8c03\u7528\u52a0\u89e3\u5bc6\u8bbe\u5907\uff08\u8f6f\u4ef6/\u786c\u4ef6\uff09\u3002</p>","tags":["ipsec","vowifi"]},{"location":"blog/ipsec-%E5%92%8C-vowifi/#tcp-over-esp","title":"tcp over ESP \u5206\u6790\u5c0f\u8bb0","text":"<p>\u5728\u6392\u67e5\u7f51\u7edc\u95ee\u9898\u65f6\uff0c\u4e0d\u5f97\u4e0d\u5206\u6790tcp\u62a5\u6587\uff0c\u79ef\u7d2f\u4e86\u4e00\u4e9b\u77e5\u8bc6\uff1a</p> <ol> <li>wireshark\u4e2d\u7528\u65b9\u62ec\u53f7[]\u5305\u8d77\u6765\u7684\u662fwireshark\u5206\u6790\u63d0\u4f9b\u7684\uff0c\u800c\u4e0d\u662f\u62a5\u6587\u7684\u5b57\u6bb5\u3002\u4f8b\u5982[TCP Retransmission]</li> <li>wireshark\u4e2d\u7528\u7528 tcp.seq = SEQ \u548ctcp.ack = SEQ+LEN \u6765\u5b9a\u4f4d\u53d1\u9001\u548c\u56de\u590d\u62a5\u6587</li> <li>TCP\u91cd\u53d1\u95f4\u9694\uff0cTCP\u7684\u9632\u5eb8\u585e\uff0c\u91cd\u4f20\u7684\u95f4\u9694\u662f\u53d8\u5316\u7684\uff0c\u7b2c\u4e00\u6b21\u91cd\u4f20\u53ef\u80fd200ms, \u7b2c\u4e8c\u6b21\u53ef\u80fd400ms, \u7b2c\u4e09\u6b21\u53ef\u80fd1600\u4e86\uff0c\u611f\u89c9\u662f\u6307\u6570\u9012\u589e\u3002</li> <li>TCP\u91cd\u4f20\u95f4\u9694\u8fd8\u8ddfACK\u7b49\u5f85\u6709\u5173\uff0cACK\u4f1a\u665a\u4e00\u70b9\u56de\u590d\uff0c\u770b\u662f\u5426\u6709\u66f4\u591a\u5305\u8fc7\u6765\uff0c\u7136\u540e\u5408\u5e76ACK\u3002</li> <li>TCP\u53d1\u9001\u65f6\uff0c\u5173\u952e\u5b57\u6bb5\u6709SEQ\u548cLEN, \u5206\u522b\u8868\u793a\u6570\u636e\u504f\u79fb\u8d77\u70b9\u548c\u6570\u636e\u957f\u5ea6\u3002\u800cACK\u6d88\u606f\u7684ACK\u8868\u793a\u6536\u5230\u4e86\u591a\u5c11\u5b57\u8282\u6570\u636e\uff0c\u800c\u4e14ACK\u603b\u662f\u7d2f\u8ba1\u503c\uff0c\u5c31\u662f\u5168\u90e8\u6536\u5230\uff0c\u800c\u4e0d\u662f\u90e8\u5206\u6536\u5230\u3002\u4f8b\u5982\u53d1\u9001\u7aef\u53d1\u4e86\u4e24\u4e2a\u62a5\u6587SEQ=100/LEN=50, SEQ=150/LEN=50, \u7136\u540e\u5bf9\u7aef\u56de\u590dACK=200\uff0c\u610f\u601d\u662f\u4e24\u4e2a\u62a5\u6587\u90fd\u6536\u5230\u4e86\u3002</li> </ol>","tags":["ipsec","vowifi"]},{"location":"blog/ipsec-%E5%92%8C-vowifi/#sackselective-ack","title":"SACK(Selective ACK)","text":"<p>\u524d\u9762\u8bf4\u4e86TCP\u7684ACK\u603b\u662f\u7d2f\u79ef\u7684(cumulative)\uff0c \u800c\u5f53\u542f\u7528\u4e86SACK\uff0c \u6211\u9047\u5230\u662f\u9ed8\u8ba4\u542f\u7528\u4e86\u3002\u5982\u679c\u7b2c\u4e00\u4e2a\u5305\u6ca1\u6709\u6536\u5230\uff0c\u5c31\u6536\u5230\u7b2c\u4e8c\u4e2a\u5305\u548c\u540e\u9762\u7684\u5305\uff0c\u4f1a\u56de\u590dSACK\u5305\uff0cSACK\u7684\u5173\u952e\u4fe1\u606f\u5982\u4e0b <pre><code>[TCP Dup ACK #NB1] SLE=NB2 SRE=NB3 \n</code></pre> \u8fd9\u8868\u793a\u63a5\u6536\u7aef\u7f3a\u5c11\u4e86<code>SEQ=NB1, LEN</code>\u8fd9\u4e2a\u5305\uff0c\u5e76\u6536\u5230\u4e86\u4eceNB2-&gt;NB3\u7684\u5305\u3002\u63a5\u6536\u7aef\u8bf7\u6c42\u91cd\u53d1NB1\u5305\uff0c\u5e76\u4e14\u4e0d\u4f1a\u4e22\u5f03NB2-&gt;NB3\u4e4b\u95f4\u7684\u5305\u3002</p>","tags":["ipsec","vowifi"]},{"location":"blog/ipsec-%E5%92%8C-vowifi/#_1","title":"\u53c2\u8003","text":"<p>SLE/SRE </p>","tags":["ipsec","vowifi"]},{"location":"blog/linux%E5%88%9B%E5%BB%BA%E7%83%AD%E7%82%B9/","title":"Linux\u521b\u5efa\u70ed\u70b9","text":"<p>iptables \u7528\u6765\u914d\u7f6e\u8f6c\u53d1\u6570\u636e\u5305\u89c4\u5219\u7684\u5de5\u5177\uff0cLinux\u7684\u9632\u706b\u5899\u914d\u7f6e\u5c31\u662f\u5229\u7528\u7684iptables\u3002\u666e\u901a\u7684\u8def\u7531\u5668\u4e5f\u662f\u4f7f\u7528\u7684iptables\u6765\u5b9e\u73b0NAT\u5730\u5740\u8f6c\u6362\u3002</p>","tags":["linux","iptables"]},{"location":"blog/linux%E5%88%9B%E5%BB%BA%E7%83%AD%E7%82%B9/#iptables","title":"\u4f7f\u7528iptables\u8f6c\u53d1\u6d41\u91cf","text":"<p>\u8def\u7531\u5668\u4f7f\u7528\u7684\u5c40\u57df\u7f51ip\uff0c\u4f8b\u5982\u53ef\u4f7f\u7528\u7684\u5c40\u57df\u7f51\u67093\u7c7b * A\u7c7b\u5730\u5740\uff1a10.0.0.0 - 10.255.255.255  ==&gt; 10.0.0.0/8 * B\u7c7b\u5730\u5740\uff1a172.16.0.0 - 172.31.255.255 ==&gt;  * C\u7c7b\u5730\u5740\uff1a192.168.0.0 -192.168.255.255 ==&gt; 192.168.0.0/16</p>","tags":["linux","iptables"]},{"location":"blog/linux%E5%88%9B%E5%BB%BA%E7%83%AD%E7%82%B9/#lan","title":"\u516c\u7f51\u8bbf\u95ee\u8def\u7531LAN\uff0c\u5e38\u89c1\u9632\u706b\u5899\u540e\u7684\u670d\u52a1\u5668","text":"<p>\u5047\u8bbe\u516c\u7f51\u5ba2\u6237\uff088.8.8.8\uff09\u8bbf\u95ee\u8def\u7531\u5668\u4e0b\u7684\u670d\u52a1\uff08192.168.0.2\uff09\u3002\u8bf7\u6c42\u5148\u5230\u8fbe\u8def\u7531\u7684\u516c\u7f51\u5730\u5740\u5047\u8bbe1.1.1.1, \u6b64\u65f6\u7684ip\u5c42\u6e90\u5730\u5740\u548c\u76ee\u7684\u5730\u5740\u5206\u522b\u4e3a\uff088.8.8.8/1.1.1.1)\uff0c \u7136\u540e\u8def\u7531\u5668\u9700\u8981\u5c06\u76ee\u7684\u5730\u5740\u6539\u5199\u4e3a192.168.0.2\uff0c\u6b64\u65f6ip\u5305\u7684\u5730\u5740\u4e3a\uff088.8.8.8/192.168.0.2)\uff0c\u8fd9\u9700\u8981\u7684iptable\u89c4\u5219\u4e3a</p> <p><pre><code>iptables -t nat -A PREROUTING -d 1.1.1.1 -j DNAT --to-destination 192.168.0.2\n</code></pre> ip\u5305\u5c31\u80fd\u6b63\u5e38\u5230\u8fbe192.168.0.2\uff0c\u5904\u7406\u5b8c\u6210\u4e4b\u540e\uff0cip\u5305\u53d8\u6210(192.168.0.2/8.8.8.8)\uff0c\u8fd9\u662f\u53ef\u80fd\u6709\u51e0\u79cd\u60c5\u51b5\uff1a * \u6ca1\u6709\u8def\u7531\u89c4\u5219\u80fd\u5339\u914d8.8.8.8\uff0c\u5219\u4f1a\u88ab\u4e22\u5f03\u3002 * \u4e00\u822c\u4f1a\u53d1\u9001\u5230\u9ed8\u8ba4\u7f51\u5173\uff0c\u7136\u540e\u7531\u7f51\u5173\u53d1\u9001\u6b63\u786e\u53d1\u9001\u52308.8.8.8\uff0c\u4f468.8.8.8\u5ba2\u6237\u4e0d\u8ba4\u8bc6\u6e90\u5730\u5740192.168.0.2\uff0c\u6240\u4ee5\u5305\u4f1a\u88ab\u4e22\u5f03 * \u76f4\u63a5\u5728\u7b2c\u4e00\u4e2a\u8def\u7531\u4e0a\u88ab\u4e22\u5f03\uff0c\u56e0\u4e3a192.168.0.2\u662f\u4e00\u4e2a\u79c1\u6709\u5730\u5740\uff0c\u4e0d\u80fd\u88ab\u8f6c\u53d1\u3002</p> <p>\u6240\u4ee5\u9700\u8981\u53e6\u5916\u4e00\u6761iptables\u89c4\u5219\uff0c\u5c06192.168.0.2\u53d1\u51fa\u7684ip\u5305\u6539\u6210\uff081.1.1.1/8.8.8.8\uff09</p> <pre><code>iptables -t nat -A POSTROUTING -s 192.168.0.2 -j SNAT --to-source 1.1.1.1\n</code></pre>","tags":["linux","iptables"]},{"location":"blog/linux%E5%88%9B%E5%BB%BA%E7%83%AD%E7%82%B9/#reference","title":"Reference","text":"<p>https://serverfault.com/questions/627608/redirect-all-incoming-traffic-from-a-secondary-public-ip-to-an-internal-ip-addre</p>","tags":["linux","iptables"]},{"location":"blog/%E4%BD%BF%E7%94%A8iwd%E5%88%9B%E5%BB%BAap%E7%83%AD%E7%82%B9/","title":"\u4f7f\u7528iwd\u521b\u5efaap\u70ed\u70b9","text":"<p>windows\u4e2d\u6709\u5f88\u591a\u8f6f\u4ef6\u80fd\u521b\u5efa\u70ed\u70b9\uff0c\u73b0\u5728Linux\u4e5f\u53ef\u4ee5\u521b\u5efa\u70ed\u70b9\u4e86\uff0c\u4e0b\u9762\u8bb0\u5f55\u65b9\u6cd5</p>","tags":["linux","iptables"]},{"location":"blog/%E4%BD%BF%E7%94%A8iwd%E5%88%9B%E5%BB%BAap%E7%83%AD%E7%82%B9/#ap","title":"\u786e\u8ba4\u7f51\u5361\u652f\u6301AP","text":"<p>\u4f7f\u7528<code>iw list</code>\u67e5\u770bwifi\u7f51\u5361\u4fe1\u606f\uff0c\u5982\u679c\u5728Supported interface modes\u80fd\u627e\u5230AP\uff0c\u8bf4\u660e\u7f51\u5361\u652f\u6301\u521b\u5efa\u70ed\u70b9\u3002</p>","tags":["linux","iptables"]},{"location":"blog/%E4%BD%BF%E7%94%A8iwd%E5%88%9B%E5%BB%BAap%E7%83%AD%E7%82%B9/#iwd","title":"\u4f7f\u7528iwd","text":"<p>\u4e4b\u524d\u7814\u7a76\u7684wifi\u68d2\u5b50\uff0c\u90fd\u662f\u7528wpa_supplicant\u6765\u521b\u5efa\u70ed\u70b9\u3002\u800c\u5728\u6211\u81ea\u5df1\u7684\u7535\u8111\u91cc\u4e00\u76f4\u4f7f\u7528\u7684intel\u7684iwd\u3002 1. \u5148\u4fee\u6539iwd\u7684\u914d\u7f6e\u6587\u4ef6/etc/iwd/main.conf <pre><code>[General]\nEnableNetworkConfiguration=true\n</code></pre> 2. \u5728iwd\u4fdd\u5b58\u5bc6\u7801\u7684\u76ee\u5f55\u521b\u5efaap\u5b50\u76ee\u5f55 <pre><code>mkdir -p /var/lib/iwd/ap/\n</code></pre> 3. \u5728ap\u76ee\u5f55\u521b\u5efa\u914d\u7f6e\u6587\u4ef6\u540d\u5b57\u5982main.ap\uff0c\u5185\u5bb9\u5982\u4e0b <pre><code>[Security]\nPassphrase=password123\n\n[IPv4]\nAddress=192.168.250.1\nGateway=192.168.250.1\nNetmask=255.255.255.0\nDNSList=8.8.8.8\n</code></pre> 4. \u6267\u884ciwctl\u547d\u4ee4\u8fdb\u5165\u5230iwd\u4ea4\u4e92\u6a21\u5f0f <pre><code>[iwd]# device wlan0 set-property Mode ap\n[iwd]# ap wlan0 start-profile main\n[iwd]# \n</code></pre> 5. \u542f\u52a8\u5185\u6838\u8f6c\u53d1 <pre><code># sudo sysctl -w net.ipv4.ip_forward=1\nnet.ipv4.ip_forward = 1\n# sudo iptables -t nat -A POSTROUTING -s 192.168.250.0/24 -j MASQUERADE\n</code></pre></p> <p>\u6211\u505a\u5b8c\u4e0a\u9762\u7684\u6b65\u9aa4\u540e\uff0c\u53d1\u73b0wifi\u8fde\u63a5\u4e0d\u4e0a\uff0c\u4e5f\u6709\u62a5\u9519\u3002\u7136\u540e\u91cd\u542f\u4e86iwd\u670d\u52a1\uff0c\u53d1\u73b0\u6ca1\u6709\u4e86main\u8fd9\u4e2a\u70ed\u70b9\uff0c\u6240\u4ee5\u8fd9\u4e2a\u70ed\u70b9\u4e0d\u4f1a\u81ea\u52a8\u542f\u52a8\u3002\u5728\u6267\u884c4\u6b65\u9aa4\u540e\uff0c\u5c31\u80fd\u6b63\u5e38\u8fde\u63a5wifi\u4e86\u3002</p>","tags":["linux","iptables"]},{"location":"blog/%E4%BD%BF%E7%94%A8iwd%E5%88%9B%E5%BB%BAap%E7%83%AD%E7%82%B9/#ad-hoc-ap","title":"ad-hoc \u548c ap \u7684\u533a\u522b","text":"<p>ad-hoc\u662f\u53bb\u4e2d\u5fc3\u5316\u7684\u7ec4\u7f51\u65b9\u5f0f\uff0c\u5404\u8fde\u63a5\u8282\u70b9\u53ef\u4ee5\u76f4\u63a5\u901a\u8baf\uff0c\u800c\u6709\u4e9b\u7ec8\u7aef\u53ef\u80fd\u4e0d\u652f\u6301\u3002AP\u6a21\u5f0f\u53c8\u53eb\u505ainfrustructure Mode\uff0c\u5c31\u662f\u7c7b\u4f3c\u4f20\u7edf\u7684\u8def\u7531\u5668\u6a21\u5f0f\uff0c\u6240\u4ee5\u517c\u5bb9\u6027\u66f4\u597d\u3002</p>","tags":["linux","iptables"]},{"location":"blog/%E4%BD%BF%E7%94%A8iwd%E5%88%9B%E5%BB%BAap%E7%83%AD%E7%82%B9/#_1","title":"\u4f7f\u7528\u603b\u7ed3","text":"<p>\u8fd9\u4e2aap\u4e0d\u7a33\u5b9a\uff0c\u957f\u65f6\u95f4\u4f7f\u7528\u540e\u6ca1\u6709\u7f51\u7edc\uff0c \u9700\u8981\u91cd\u5efaap\uff0c \u4e0d\u63a8\u8350\u3002\u6700\u7ec8\u8fd8\u662f\u88c5\u4e86\u4e2a\u4fbf\u5b9c\u8def\u7531\u5668MI-mini\u3002\u8001\u65e7\u8def\u7531\u5668\u7684\u6027\u80fd\u5dee\uff0c\u5f53\u8def\u7531\uff08NAT\uff09\u7684\u4e22\u5305\u7387\u592a\u9ad8\uff0c \u4f46\u5f53\u6865\u63a5\u5165\u53e3\uff08\u4ea4\u6362\u673a\uff09\u6b63\u5e38\u3002</p>","tags":["linux","iptables"]},{"location":"blog/%E4%BD%BF%E7%94%A8iwd%E5%88%9B%E5%BB%BAap%E7%83%AD%E7%82%B9/#_2","title":"\u53c2\u8003","text":"<p>https://iwd.wiki.kernel.org/ap_mode</p>","tags":["linux","iptables"]},{"location":"blog/%E5%AD%90%E4%B8%B2%E6%9F%A5%E6%89%BE%E7%AE%97%E6%B3%95/","title":"\u5b50\u4e32\u67e5\u627e\u7b97\u6cd5","text":"<p>leetcode\u7684\u9898\u76ee, \u5b9e\u73b0strstr,\u5373\u67e5\u627e\u5b50\u5b57\u7b26\u4e32</p>","tags":["\u7b97\u6cd5","\u67e5\u627e"]},{"location":"blog/%E5%AD%90%E4%B8%B2%E6%9F%A5%E6%89%BE%E7%AE%97%E6%B3%95/#_2","title":"\u6700\u7b80\u5355\u7684\u7b97\u6cd5","text":"<pre><code>int strStr(char * haystack, char * needle){\n    char *tmp = haystack;\n    while(*tmp != 0){\n        if(strncmp(tmp, needle,strlen(needle))==0){\n            return tmp - haystack;\n        }\n        tmp ++;\n    }\n    return -1;\n}\n</code></pre>","tags":["\u7b97\u6cd5","\u67e5\u627e"]},{"location":"blog/%E5%AD%90%E4%B8%B2%E6%9F%A5%E6%89%BE%E7%AE%97%E6%B3%95/#kmp","title":"kmp \u7b97\u6cd5","text":"<pre><code>// C++ program for implementation of KMP pattern searching \n// algorithm \n#include &lt;bits/stdc++.h&gt; \n\nvoid computeLPSArray(char* pat, int M, int* lps); \n\n// Prints occurrences of txt[] in pat[] \nvoid KMPSearch(char* pat, char* txt) \n{ \n    int M = strlen(pat); \n    int N = strlen(txt); \n\n    // create lps[] that will hold the longest prefix suffix \n    // values for pattern \n    int lps[M]; \n\n    // Preprocess the pattern (calculate lps[] array) \n    computeLPSArray(pat, M, lps); \n\n    int i = 0; // index for txt[] \n    int j = 0; // index for pat[] \n    while (i &lt; N) { \n        if (pat[j] == txt[i]) { \n            j++; \n            i++; \n        } \n\n        if (j == M) { \n            printf(\"Found pattern at index %d \", i - j); \n            j = lps[j - 1]; \n        } \n\n        // mismatch after j matches \n        else if (i &lt; N &amp;&amp; pat[j] != txt[i]) { \n            // Do not match lps[0..lps[j-1]] characters, \n            // they will match anyway \n            if (j != 0) \n                j = lps[j - 1]; \n            else\n                i = i + 1; \n        } \n    } \n} \n\n// Fills lps[] for given patttern pat[0..M-1] \nvoid computeLPSArray(char* pat, int M, int* lps) \n{ \n    // length of the previous longest prefix suffix \n    int len = 0; \n\n    lps[0] = 0; // lps[0] is always 0 \n\n    // the loop calculates lps[i] for i = 1 to M-1 \n    int i = 1; \n    while (i &lt; M) { \n        if (pat[i] == pat[len]) { \n            len++; \n            lps[i] = len; \n            i++; \n        } \n        else // (pat[i] != pat[len]) \n        { \n            // This is tricky. Consider the example. \n            // AAACAAAA and i = 7. The idea is similar \n            // to search step. \n            if (len != 0) { \n                len = lps[len - 1]; \n\n                // Also, note that we do not increment \n                // i here \n            } \n            else // if (len == 0) \n            { \n                lps[i] = 0; \n                i++; \n            } \n        } \n    } \n} \n\n// Driver program to test above function \nint main() \n{ \n    char txt[] = \"ABABDABACDABABCABAB\"; \n    char pat[] = \"ABABCABAB\"; \n    KMPSearch(pat, txt); \n    return 0; \n} \n</code></pre>","tags":["\u7b97\u6cd5","\u67e5\u627e"]},{"location":"blog/%E5%AD%90%E4%B8%B2%E6%9F%A5%E6%89%BE%E7%AE%97%E6%B3%95/#strstr","title":"\u4f7f\u7528\u54c8\u5e0c\u67e5\u627e\u548cstrstr\u901f\u5ea6\u6bd4\u8f83","text":"<p>hash\u5728\u67e5\u627e\u5b57\u7b26\u4e32\u65f6\uff0c\u6bcf\u6b21\u504f\u79fb1\u4e2a\u5b57\u8282\uff0c\u5e76\u8ba1\u7b97hash, \u4e3a\u4e86\u4e0d\u91cd\u590d\u8ba1\u7b97\u91cd\u53e0\u90e8\u5206\uff0c\u6709\u4e2a\u7b97\u6cd5'Karp-Rabin with Rolling Hash'\u3002 \u4f46\u662f\u901f\u5ea6\u90fd\u4e0d\u5982glibc\u7684 strstr\uff0c \u56e0\u4e3a\u8fd9\u91cc\u7684hash\u51fd\u6570\u6ca1\u6709\u7528\u5230\u786c\u4ef6\u52a0\u901f\uff0c\u4f46\u662fstrstr\u7528\u4e86\u3002</p> <pre><code>#define BASE 256         // Alphabet size (ASCII)\n#define MOD 101          // A prime number to avoid overflow\n\n// Rolling hash version of strstr()\nconst char* rabin_karp_strstr(const char* haystack, const char* needle) {\n    int n = strlen(haystack);\n    int m = strlen(needle);\n\n    if (m == 0) return haystack;\n    if (m &gt; n) return NULL;\n\n    int i;\n    int hash_needle = 0;  // Hash for needle\n    int hash_window = 0;  // Hash for current window in haystack\n    int h = 1;\n\n    // The value of h is BASE^(m-1) % MOD\n    for (i = 0; i &lt; m - 1; i++)\n        h = (h * BASE) % MOD;\n\n    // Calculate the hash value of needle and first window\n    for (i = 0; i &lt; m; i++) {\n        hash_needle  = (BASE * hash_needle + needle[i]) % MOD;\n        hash_window = (BASE * hash_window + haystack[i]) % MOD;\n    }\n\n    // Slide the pattern over text\n    for (i = 0; i &lt;= n - m; i++) {\n        if (hash_needle == hash_window) {\n            // Verify characters to avoid false positive\n            if (strncmp(&amp;haystack[i], needle, m) == 0)\n                return &amp;haystack[i];\n        }\n\n        // Calculate hash for next window\n        if (i &lt; n - m) {\n            hash_window = (BASE * (hash_window - haystack[i] * h) + haystack[i + m]) % MOD;\n            if (hash_window &lt; 0)\n                hash_window += MOD;  // Ensure non-negative\n        }\n    }\n\n    return NULL;\n}\n</code></pre>","tags":["\u7b97\u6cd5","\u67e5\u627e"]},{"location":"blog/rhel%E7%B3%BB%E5%88%97%E4%BF%AE%E6%94%B9%E5%AF%86%E7%A0%81/","title":"rhel\u7cfb\u5217\u4fee\u6539\u5bc6\u7801","text":"<p>\u8003rhce8 \u683d\u5728\u6539\u5bc6\u7801\u4e86\uff0c \u73b0\u5728\u5f7b\u5e95\u5f04\u660e\u767d</p>","tags":["linux","rhce"]},{"location":"blog/rhel%E7%B3%BB%E5%88%97%E4%BF%AE%E6%94%B9%E5%AF%86%E7%A0%81/#selinux","title":"\u5173\u4e8eselinux","text":"<p>\u8fd9\u662frhel\u548c\u5176\u4ed6\u53d1\u884c\u7248\u7684\u6700\u5927\u533a\u522b\uff0c\u4e5f\u662f\u6211\u5ffd\u7565\u7684\u70b9\u3002\u542f\u7528selinux \u65f6\uff0c\u6539\u5bc6\u7801\u540e\uff0c\u989d\u5916\u8981\u6267\u884c<code>touch /.autorelabel</code>\uff0c \u65b0\u5bc6\u7801\u624d\u80fd\u751f\u6548\uff0c\u800c\u5e73\u65f6\u6211\u4f7f\u7528centos\u4e00\u76f4\u662f\u7981\u7528selinux\u7684\u3002</p>","tags":["linux","rhce"]},{"location":"blog/rhel%E7%B3%BB%E5%88%97%E4%BF%AE%E6%94%B9%E5%AF%86%E7%A0%81/#selinux_1","title":"\u542f\u7528selinux","text":"<p>selinux \u9ed8\u8ba4\u72b6\u6001\u662fenforcing, \u7981\u7528\u65f6\u4e3adisable, \u901a\u8fc7<code>sestate</code> \u67e5\u770b\u72b6\u6001\u3002</p>","tags":["linux","rhce"]},{"location":"blog/rhel%E7%B3%BB%E5%88%97%E4%BF%AE%E6%94%B9%E5%AF%86%E7%A0%81/#etcselinuxconfig","title":"\u7f16\u8bd1'/etc/selinux/config'","text":"<p>\u4fee\u6539selinux\u914d\u7f6e\uff0c\u4ecedisable \u5230enforcing</p>","tags":["linux","rhce"]},{"location":"blog/rhel%E7%B3%BB%E5%88%97%E4%BF%AE%E6%94%B9%E5%AF%86%E7%A0%81/#_1","title":"\u6267\u884c\u4e24\u6b21\u4e0b\u9762\u52a8\u4f5c","text":"<p>\u521b\u5efa\u8fd9\u4e2a\u6587\u4ef6\u7684\u610f\u4e49\u662f\u91cd\u65b0label selinux, \u4e0d\u4ec5\u662f\u5f53\u4fee\u6539selinux\u914d\u7f6e\u9700\u8981\u505a\uff0c\u5728\u91cd\u7f6eroot\u5bc6\u7801\u65f6\u4e5f\u662f\u9700\u8981 <pre><code>touch /.autorelabel\nreboot\n</code></pre></p>","tags":["linux","rhce"]},{"location":"blog/rhel%E7%B3%BB%E5%88%97%E4%BF%AE%E6%94%B9%E5%AF%86%E7%A0%81/#_2","title":"\u53d9\u8bf4\u6539\u5bc6","text":"<p>rhel5~8\u6709\u4e24\u79cd\u65b9\u5f0f\u91cd\u7f6e\u5bc6\u7801\uff0c\u8001\u7248\u672c\u4e3a\u7ed9linux\u542f\u52a8\u53c2\u6570\u52a0\u4e0a'init=/bin/sh', \u65b0\u7248\u672c\u4e3a\u52a0<code>rd.break</code> \u8001\u7248\u672c\u9002\u7528\u4e8ecentos8\uff08\u5df2\u6d4b\uff09, \u800c\u65b0\u7248\u672c\u5e94\u8be5\u4e0d\u652f\u6301rhel5\uff0c6\uff08\u672a\u6d4b\uff09\uff0c\u4e0b\u9762\u662f\u5b8c\u6574\u6b65\u9aa4</p>","tags":["linux","rhce"]},{"location":"blog/rhel%E7%B3%BB%E5%88%97%E4%BF%AE%E6%94%B9%E5%AF%86%E7%A0%81/#_3","title":"\u8001\u7248\u672c","text":"<ol> <li>\u8fdb\u5165grub\u754c\u9762\uff0c\u6309e\u8fdb\u5165\u7f16\u8f91\u542f\u52a8\u53c2\u6570\uff0c\u5230linux \u884c\uff0c\u6309ctrl+e\u6216\u8005end\u952e\u5230\u672b\u5c3e\uff0c\u8ffd\u52a0'init=/bin/sh'</li> <li>\u6309ctrl+x\u7ee7\u7eed\uff0c\u7cfb\u7edf\u81ea\u52a8\u8fdb\u5165\u5185\u5b58\u6587\u4ef6\u7cfb\u7edf\u7684\u6839\u76ee\u5f55</li> <li>\u6267\u884c<code>/sbin/load_policy -i</code>\u6765\u521d\u59cb\u5316selinux</li> <li>\u6b64\u65f6\u7cfb\u7edf\u5904\u4e8ero\u6a21\u5f0f\uff0c\u6267\u884c<code>mount -oremount,rw /</code> \u91cd\u65b0\u6302\u8f7d\u6839\u5206\u533a\uff0c\u4f7f\u7cfb\u7edf\u53ef\u5199</li> <li><code>passwd</code> \u8bbe\u7f6eroot\u5bc6\u7801</li> <li>\u5982\u679c\u542f\u7528\u4e86selinux, \u989d\u5916\u8981\u6267\u884c<code>touch /.autorelabel</code></li> <li>\u6700\u540e\u6267\u884c<code>exit</code>\u6216\u8005 <code>exec /sbin/reboot</code> \u6216\u8005<code>exec /sbin/init</code></li> </ol>","tags":["linux","rhce"]},{"location":"blog/rhel%E7%B3%BB%E5%88%97%E4%BF%AE%E6%94%B9%E5%AF%86%E7%A0%81/#_4","title":"\u65b0\u7248\u672c","text":"<ol> <li>\u8fdb\u5165grub\u754c\u9762\uff0c\u6309e\u8fdb\u5165\u7f16\u8f91\u542f\u52a8\u53c2\u6570\uff0c\u5230linux \u884c\uff0c\u6309ctrl+e\u6216\u8005end\u952e\u5230\u672b\u5c3e\uff0c\u8ffd\u52a0'rd.break'</li> <li>\u6309ctrl+x\u7ee7\u7eed\uff0c\u7cfb\u7edf\u81ea\u52a8\u8fdb\u5165root\u7cfb\u7edf\uff0c\u6b64\u65f6\u771f\u6b63\u7684\u6587\u4ef6\u7cfb\u7edf\u4ee5ro\u6302\u8f7d\u5728/sysroot</li> <li>\u6267\u884c<code>mount -oremount,rw /sysrot</code> \u91cd\u65b0\u6302\u8f7d</li> <li>\u6267\u884c<code>chroot /sysroot</code> \u8fdb\u5165\u7cfb\u7edf</li> <li>\u6267\u884c<code>passwd</code>\u8bbe\u7f6eroot\u5bc6\u7801</li> <li>\u5982\u679c\u542f\u7528\u4e86selinux, \u9700\u8981\u989d\u5916\u521b\u5efa\u6587\u4ef6<code>touch /.autorelabel</code></li> <li>\u6267\u884c<code>exit</code> \u9000\u51fa\uff0c\u7136\u540e\u6267\u884c <code>umount /sysroot</code> \u6765\u786e\u4fdd\u5199\u5165</li> <li>reboot \u6765\u91cd\u65b0\u8fdb\u5165</li> </ol>","tags":["linux","rhce"]},{"location":"blog/rhel%E7%B3%BB%E5%88%97%E4%BF%AE%E6%94%B9%E5%AF%86%E7%A0%81/#rescue","title":"\u901a\u8fc7rescue\u6a21\u5f0f\u6539\u5bc6\u7801","text":"<p>\u4efb\u4f55\u53d1\u884c\u7248\u90fd\u53ef\u4ee5\u901a\u8fc7\u5149\u76d8\u5f15\u5bfc\u6765\u6539\u5bc6\u3002\u5982\u679c\u719f\u6089archlinux\u5b89\u88c5\u7684\u65b9\u5f0f\uff0c\u5c31\u77e5\u9053\u8fdb\u5165live os\u4e4b\u540e\u53ef\u4ee5\u6302\u8f7d\u539f\u7cfb\u7edf\u7684\u78c1\u76d8 \u7136\u540echroot\u6210\u4e3aroot\u7528\u6237\uff0c\u5c31\u80fd\u76f4\u63a5\u6267\u884c<code>passwd</code>\u6765\u4fee\u6539\u5bc6\u7801</p>","tags":["linux","rhce"]},{"location":"blog/rhel%E7%B3%BB%E5%88%97%E4%BF%AE%E6%94%B9%E5%AF%86%E7%A0%81/#_5","title":"\u901a\u8fc7\u4fee\u6539\u955c\u50cf\u6539\u5bc6\u7801","text":"<p>\u6700\u66b4\u529b\u7684\u65b9\u5f0f\u5c31\u662f\u7528guestfish\u5de5\u5177, \u4e00\u6761\u547d\u4ee4\u6539\u5bc6\u3002\u5f53\u7136\u5f97\u5148\u83b7\u53d6\u955c\u50cf\u6587\u4ef6 \u5148\u5207\u6362\u5230root\u7528\u6237\uff0c\u4f7f\u7528guestmount\u547d\u4ee4\u6302\u8f7d\u5206\u533a\uff0c-i\u8868\u793a\u81ea\u52a8\u6302\u8f7d <pre><code>guestmount --add base.raw  -i /tmp/hm\n</code></pre> \u7136\u540echroot\u5230\u6302\u8f7d\u70b9 <pre><code>chroot /tmp/hm\n</code></pre> \u7136\u540e\u6539\u5bc6 <pre><code>passwd\n</code></pre></p> <p>virt\u63d0\u4f9b\u4e86\u7b80\u5316\u7248\u672c\uff0c\u4e00\u6761\u547d\u4ee4\u5c31\u80fd\u6539\u5bc6\u7801 <pre><code>virt-customize -a centos8.qcow2 --root-password password:123456\n</code></pre></p> <p>\u53ef\u89c1\u955c\u50cf\u6587\u4ef6\u6709\u591a\u4e48\u4e0d\u5b89\u5168</p>","tags":["linux","rhce"]},{"location":"blog/rhel%E7%B3%BB%E5%88%97%E4%BF%AE%E6%94%B9%E5%AF%86%E7%A0%81/#vmwarekvm","title":"\u6700\u540e\u8bb0\u5f55\u4e00\u4e0bvmware\u865a\u62df\u673a\u955c\u50cf\u8f6c\u6362kvm\u955c\u50cf","text":"<p>\u7531\u4e8e\u6536\u5230\u7684vmware\u955c\u50cf\uff0c\u53c8\u6ca1\u6709\u88c5vmware workstation\uff0c\u6240\u4ee5\u627e\u5230\u8f6c\u6362\u955c\u50cf\u7684\u65b9\u6cd5\uff0c\u4e5f\u5f88\u65b9\u4fbf <pre><code>qemu-img convert  CentOS\\ 5.vmdk  base-000001.raw       \n</code></pre> \u4f46\u95ee\u9898\u662f\u4e0d\u652f\u6301\u8f6c\u6362\u5feb\u7167\u6587\u4ef6</p>","tags":["linux","rhce"]},{"location":"blog/rhel%E7%B3%BB%E5%88%97%E4%BF%AE%E6%94%B9%E5%AF%86%E7%A0%81/#_6","title":"\u5f15\u7528","text":"<p>https://docs.openstack.org/image-guide/convert-images.html</p>","tags":["linux","rhce"]},{"location":"blog/live-c-program/","title":"live c program","text":"<p>\u7a0b\u5e8f\u8fd0\u884c\u65f6\u7f16\u8bd1\u548c\u6267\u884cc\u4ee3\u7801\u3002\u516c\u53f8\u6709\u4e2a\u57fa\u7840\u5e93\u53ef\u4ee5\u4fee\u6539\u548c\u6253\u5370\u8fdb\u7a0b\u7684\u72b6\u6001\uff0c\u8fd9\u4e2a\u5e93\u662f\u57fa\u4e8eGNU\u7684bfd\u7684\uff0c\u4ee3\u7801\u6bd4\u8f83\u590d\u6742\u3002\u5728\u65b0\u9879\u76ee\u4e2d\uff0c\u53d1\u73b0dlsym\uff08libdl\uff09\u53ef\u4ee5\u5b9e\u73b0\u7c7b\u4f3c\u529f\u80fd\uff0c\u5e76\u4e14\u4ee3\u7801\u975e\u5e38\u7b80\u6d01\u3002 \u5728HN\u4e0a\u770b\u5230\u4e00\u4e2a\u5f88\u5f3a\u5927\u7684\u793a\u4f8b\u4e5f\u662f\u7528\u7684libdl https://nullprogram.com/blog/2014/12/23/, \u5728\u8fd0\u884c\u65f6\u6539\u4ee3\u7801\uff0c\u5b9e\u9645\u4e5f\u662f\u4fee\u6539\u4e86\u72b6\u6001\u3002</p>","tags":["c\uff0c libdl"]},{"location":"blog/live-c-program/#dlsym","title":"dlsym","text":"<p>dlopen \u662f\u6253\u5f00\u52a8\u6001\u5e93\u7684\uff0cdlsym\u7528\u6765\u67e5\u8be2\u52a8\u6001\u5e93\u6216\u8005\u53ef\u6267\u884c\u6587\u4ef6\u7684\u7b26\u53f7\uff0c\u7b2c\u4e00\u4e2a\u53c2\u6570\u8868\u793a\u67e5\u8be2\u8303\u56f4\u3002\u5982\u679c\u8bbe\u7f6e\u6210\u52a8\u6001\u5e93\u5219\u8868\u793a\u5728\u52a8\u6001\u5e93\u627e\u3002\u5982\u679c\u8bbe\u7f6e\u6210RTLD_DEFAULT\uff0c\u5219\u8868\u793a\u5728\u53ef\u6267\u884c\u6587\u4ef6\u548c\u4f9d\u8d56\u91cc\u627e\uff0c\u5305\u62ec\u4ee5RTLD_GLOBAL\u65b9\u5f0fdlopen\u7684\u52a8\u6001\u5e93\u3002 <pre><code>NAME\n       dlsym, dlvsym - obtain address of a symbol in a shared object or executable\nLIBRARY\n       Dynamic linking library (libdl, -ldl)\nSYNOPSIS\n       #include &lt;dlfcn.h&gt;\n       void *dlsym(void *restrict handle, const char *restrict symbol);\n</code></pre></p>","tags":["c\uff0c libdl"]},{"location":"blog/live-c-program/#demo","title":"demo","text":"<p><pre><code>#include &lt;stdio.h&gt;\n#include &lt;string.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;dlfcn.h&gt;\nint a;\nint foo(int b){\n        a = b;\n}\nint main(){\n        char *code = NULL;\n        size_t n = 0;\n        getline(&amp;code, &amp;n, stdin);\n        code[n] = 0;\n        char* lstart = code;\n        char* rstart = strchr(code, '=');\n        *rstart = 0;\n        rstart ++;\n        void* var = dlsym(RTLD_DEFAULT, lstart);\n        if(var){\n                *(int*)var = atoi(rstart);\n        }else{\n                printf(\"invalid variable\");\n        }\n        printf(\"a = %d\\n\", a);\n        free(code);\n        return 0;\n}\n</code></pre> \u901a\u8fc7\u5224\u65ad\u7528\u6237\u8f93\u5165\u7684'='\u8fd8\u662f'()'\u6765\u533a\u5206\u662f\u51fd\u6570\u8fd8\u662f\u53d8\u91cf\u3002 \u51fd\u6570\u53ef\u58f0\u660e\u6210 <pre><code>void (*fun)(int) = dlsym(RTLD_DEFAULT, lstart);\nfun();\n</code></pre></p>","tags":["c\uff0c libdl"]},{"location":"blog/live-c-program/#_1","title":"\u7b26\u53f7\u7c7b\u578b\u68c0\u67e5\uff0c\u51fd\u6570\u548c\u53d8\u91cf","text":"<p>dlsym\u653e\u56de\u5230\u662fvoid*\uff0c\u6307\u5411\u4e00\u4e2a\u5730\u5740\uff0c\u4e0d\u77e5\u9053\u662f\u51fd\u6570\u8fd8\u662f\u53d8\u91cf\u3002\u5982\u679cgetline\u8bfb\u5165\u4e86\u8d4b\u503c\u8bed\u53e5\uff08=\uff09\u800c\u5b9e\u9645\u662f\u51fd\u6570\uff0c\u90a3\u53ef\u80fd\u5bfc\u81f4\u7a0b\u5e8f\u9000\u51fa\u3002\u5982\u679c\u8981\u68c0\u67e5\u5730\u5740\u7c7b\u578b\uff0c\u9700\u8981\u7528<code>dlinfo</code>\u3002</p>","tags":["c\uff0c libdl"]},{"location":"blog/live-c-program/#_2","title":"\u51fd\u6570\u7684\u8fd4\u56de\u7c7b\u578b\u533a\u522b","text":"<p>\u5728\u8c03\u7528\u51fd\u6570\u65f6\uff0c\u6700\u597d\u662f\u5ffd\u7565\u8fd4\u56de\u503c\u3002\u56e0\u4e3a\u5982\u679c\u7533\u660e\u51fd\u6570\u8981\u8fd4\u56de\u4e00\u4e2a\u503c\uff0c\u800c\u51fd\u6570\u5b9e\u9645\u662fvoid\u7c7b\u578b\u7684\uff0c\u5219\u5728\u6267\u884c\u65f6\u4f1a\u5bfc\u81f4\u672a\u5b9a\u4e49\u7684\u9519\u8bef\u3002\u76f8\u53cd\u5982\u679c\u51fd\u6570\u6709\u8fd4\u56de\u503c\uff0c\u4f46\u662f\u58f0\u660e\u6210void\u51fd\u6570\uff0c\u5219\u4e0d\u4f1a\u6709\u4efb\u4f55\u95ee\u9898\u3002</p>","tags":["c\uff0c libdl"]},{"location":"blog/live-c-program/#libtcc","title":"\u7c7b\u4f3c\u7684\u8fd8\u6709 LibTCC","text":"","tags":["c\uff0c libdl"]},{"location":"blog/lvm-%E5%8A%9F%E8%83%BD%E4%BB%8B%E7%BB%8D/","title":"LVM \u529f\u80fd\u4ecb\u7ecd","text":"<p>LVM \u662f\u5728\u786c\u4ef6\u548c\u7cfb\u7edf\u4e4b\u95f4\u591a\u52a0\u4e86\u4e00\u5c42\uff0c\u53ef\u4ee5\u5f88\u65b9\u4fbf\u5730\u4fee\u6539\u5206\u533a\u548c\u6269\u5bb9\u3002 \u4ece\u6548\u7387\u4e0a\u770b\u80af\u5b9a\u6709\u6240\u635f\u5931\u7684\uff0c\u4f46\u662f\u5bf9\u4e8e\u4f01\u4e1a\u800c\u8a00\uff0c\u7075\u6d3b\u6027\u4e5f\u5f88\u91cd\u8981 LVM\u5177\u6709\u5728\u7ebf\u6269\u5bb9\u548c\u5feb\u7167\u7684\u91cd\u8981\u529f\u80fd</p>","tags":["linux","lvm"]},{"location":"blog/lvm-%E5%8A%9F%E8%83%BD%E4%BB%8B%E7%BB%8D/#_1","title":"\u5728\u7ebf\u6269\u5bb9","text":"<p>\u5f53\u78c1\u76d8\u5bb9\u91cf\u4e0d\u591f\u6216\u8005\u9700\u8981\u66ff\u6362\u78c1\u76d8\u65f6\uff0c\u5c31\u9700\u8981\u6269\u5bb9, \u5982\u679c\u662f\u66ff\u6362\u78c1\u76d8\u5c31\u518d\u9700\u8981\u6362\u51fa\u65e7\u786c\u76d8</p>","tags":["linux","lvm"]},{"location":"blog/lvm-%E5%8A%9F%E8%83%BD%E4%BB%8B%E7%BB%8D/#_2","title":"\u6269\u5bb9\u6b65\u9aa4","text":"<p>\u4f7f\u7528lvm\u4e2d\u7684pvmove \u547d\u4ee4\u5047\u5982\u539f\u6765\u662f\u4f7f\u7528pv \u4e3a/dev/sda1, \u65b0\u7684\u786c\u76d8\u4e3a/dev/sdb1 1. \u65b0\u5efapv: # pvcreate /dev/sdb1  2. \u6269\u5bb9vg\uff1a# vgextend vg1 /dev/sdb1  3. \u5982\u679c\u8981\u8c03\u6574\u5206\u533a\u5927\u5c0f\uff0c\u4f7f\u7528lvresize -r -S \u65b0\u5927\u5c0f\u3002 \u4e0d\u5e26-r\u7684\u8bdd\u9700\u8981\u91cd\u65b0mount\u624d\u80fd\u751f\u6548\uff0c -S \u662f\u8868\u793a\u6700\u7ec8\u5927\u5c0f\uff0c-s +/- \u662f\u8c03\u6574\u5927\u5c0f</p>","tags":["linux","lvm"]},{"location":"blog/lvm-%E5%8A%9F%E8%83%BD%E4%BB%8B%E7%BB%8D/#_3","title":"\u6362\u51fa\u6b65\u9aa4","text":"<p>vgreduce \u662f\u5c06pv\u8e22\u51favg, pvremove\u662f\u5220\u9664pv\u6807\u8bb0</p> <ol> <li>\u628asda1 \u4e0a\u6570\u636e\u8fc1\u79fb\u5230sdb1\u4e0a\uff1a # pvmove  /dev/sda1  /dev/sdb1 </li> <li>vgreduce \u4ecevg1\u8e22\u51fasda1\u76d8 # vgreduce vg1 /dev/sda1  </li> <li>pvremove \u5220\u9664\u78c1\u76d8\u5206\u533a\u7684pv \u6807\u8bb0 # pvremove /dev/sda1 </li> </ol>","tags":["linux","lvm"]},{"location":"blog/lvm-%E5%8A%9F%E8%83%BD%E4%BB%8B%E7%BB%8D/#_4","title":"\u78c1\u76d8\u6362\u51fa\u662f\u5426\u9700\u8981\u505c\u4e1a\u52a1","text":"<p>LVM\u7684\u5728\u7ebf\u6269\u5bb9\u662f\u4e0d\u9700\u8981\u505c\u6b62\u4e1a\u52a1\u7684\uff0c\u4f46\u662f\u5e94\u8be5\u5728\u4e1a\u52a1\u95f2\u7684\u65f6\u5019\u505a\u3002LVM\u5728\u505apvmove\u7684\u65f6\u5019\uff0c\u4f1a\u51bb\u7ed3\u65e7\u5206\u533a\uff0c\u65b0\u7684\u64cd\u4f5c\u5c31\u9700\u8981\u505a\u5907\u4efd\u3002  pvmove\u6709\u65f6\u5019\u5f88\u6162\uff0c\u4f46\u662f\u4e0d\u80fd\u4e2d\u65ad\uff0c\u5426\u5219\u51fa\u73b0\u5f88\u591a\u9057\u7559\u7684\u5206\u533a\u3002 </p> <p>\u4e0epvmove\u7c7b\u4f3c\u7684\u529f\u80fd\u7684\u8fd8\u6709\u78c1\u76d8\u955c\u50cf\uff0c \u78c1\u76d8\u955c\u50cf\u7684\u597d\u5904\u5f88\u660e\u663e\uff0c\u5373\u4f7f\u590d\u5236\u5931\u8d25\u4e86\uff0c\u539f\u6570\u636e\u4f9d\u7136\u5b58\u5728\u3002</p> <p>\u4f46\u4e24\u4e2a\u6280\u672f\u90fd\u8981\u6c42\u80fd\u591f\u201c\u539f\u5b50\u5316\u201d\uff0c\u6240\u4ee5\u4e0d\u5f97\u4e0d\u5bf9\u4e1a\u52a1\u6709\u6240\u5f71\u54cd\uff0c\u800c\u4e14\u5f71\u54cd\u7684\u662f\u78c1\u76d8IO\uff0c \u65e0\u6cd5\u901a\u8fc7\u964d\u4f4e\u4e1a\u52a1\u7684NICE\u503c\u6765\u51cf\u5f31\u8fd9\u79cd\u5f71\u54cd</p>","tags":["linux","lvm"]},{"location":"blog/lvm-%E5%8A%9F%E8%83%BD%E4%BB%8B%E7%BB%8D/#lvm_1","title":"LVM \u5feb\u7167\u529f\u80fd","text":"<p>\u5f53\u7cfb\u7edf\u662f\u5b89\u88c5\u5728LVM\u6587\u4ef6\u7cfb\u7edf\u4e4b\u4e0a\uff0c\u90a3\u4e48\u5f53\u9700\u8981\u8fdb\u884c\u9ad8\u5371\u64cd\u4f5c\u7684\u65f6\u5019\uff0c\u53ef\u4ee5\u5148\u5bf9\u5206\u533a\u8fdb\u884c\u5feb\u7167\u5907\u4efd\uff0c\u907f\u514d\u64cd\u4f5c\u5931\u8d25\u53c8\u65e0\u6cd5\u6062\u590d\u3002 \u516c\u53f8\u6709\u4e00\u53f0centos7\u7684\u81ea\u7528\u7cfb\u7edf\uff0c \u9700\u8981\u5347\u7ea7\u5230Centos8 \u4ee5\u652f\u6301 Docker buildx\u3002 \u867d\u7136\u56e0\u64cd\u4f5c\u5230\u65e0\u6cd5\u8fd0\u884cyum,dnf \u65f6\u5ba3\u5e03\u5931\u8d25\uff0c\u4f46\u597d\u5728\u6709snapshot\u5907\u4efd\uff0c \u6062\u590d\u540e\u5b8c\u597d\u5982\u521d\uff0c\u592a\u597d\u7528\u3002</p>","tags":["linux","lvm"]},{"location":"blog/lvm-%E5%8A%9F%E8%83%BD%E4%BB%8B%E7%BB%8D/#_5","title":"\u6b65\u9aa4","text":"<ol> <li>\u6302\u8f7d\u5982\u4e0b</li> </ol> <pre><code>$ lsblk \nNAME                  MAJ:MIN RM   SIZE RO TYPE  MOUNTPOINT\nsda                     8:0    0   477G  0 disk  \n\u251c\u2500sda1                  8:1    0   200M  0 part  /boot/efi\n\u251c\u2500sda2                  8:2    0     1G  0 part  /boot\n\u2514\u2500sda3                  8:3    0 475.8G  0 part  \n  \u251c\u2500centos-root       253:2    0    50G  0 lvm   /\n  \u251c\u2500centos-swap       253:4    0  15.7G  0 lvm   [SWAP]\n  \u251c\u2500centos-docker     253:18   0   150G  0 lvm   /var/lib/docker\n</code></pre> <p>\u6839\u5206\u533a\u4e3a50G, \u800c\u5377\u7ec4\u8fd8\u5269\u4f59160G,\u5b8c\u5168\u8db3\u591f\u751f\u6210\u4e00\u4e2a\u955c\u50cf\uff0c50G\u5e76\u672a\u5b8c\u5168\u4f7f\u7528\u3002 <pre><code>$ sudo vgs\n  VG     #PV #LV #SN Attr   VSize   VFree   \n  centos   1   4   0 wz--n- 475.74g  160.05g\n  data     1  13   0 wz--n-  &lt;7.28t &lt;721.91g\n</code></pre></p> <ol> <li> <p>\u5148\u5bf9\u6839\u5206\u533a\u8fdb\u884c\u5feb\u7167\uff0c\u6ce8\u610f\u662f<code>\u6839\u5206\u533a</code> <pre><code># lvcreate -s -n &lt;snapshot_name&gt; -L &lt;size&gt; &lt;logical_volume&gt;\n\n$ lvcreate -s -n backup -L 50G  /dev/centos/root\n</code></pre> \u8fd9\u91cc\u6307\u5b9a\u4e86\u5feb\u7167\u7684\u5927\u5c0f\u4e3a50G, \u7406\u8bba\u4e0a\u662f\u8981\u6bd4\u6e90\u5206\u533a\u5927\uff0c \u8fd9\u91cc\u4e5f\u53ef\u4ee5\u76f4\u63a5\u8bbe\u7f6e100G, \u7cfb\u7edf\u4f1a\u81ea\u52a8\u8c03\u6574\u5927\u5c0f\u5230\u5408\u9002\u3002</p> </li> <li> <p>\u8fdb\u884c\u4e00\u987f\u64cd\u4f5c\u540e\uff0c \u8fdb\u884c\u6062\u590d, \u63d0\u793a\u6839\u5206\u533a\u6b63\u5728\u4f7f\u7528\uff0c \u91cd\u542f\u540e\u751f\u6548\u3002</p> </li> </ol> <pre><code>$ lvconvert --mergesnapshot /dev/centos/backup \n  Delaying merge since origin is open.\n  Merging of snapshot centos/backup will occur on next activation of centos/root.\n</code></pre>","tags":["linux","lvm"]},{"location":"blog/lvm-%E5%8A%9F%E8%83%BD%E4%BB%8B%E7%BB%8D/#_6","title":"\u4fdd\u5b58","text":"<p>\u5982\u679c\u9700\u8981\u5bf9\u5feb\u7167\u8fdb\u884c\u5907\u4efd\u5230\u5176\u4ed6\u4f4d\u7f6e\uff0c \u53ef\u4ee5\u76f4\u63a5\u5c06\u5feb\u7167\u5206\u533a\u6302\u8f7d\uff0c\u7136\u540e\u901a\u8fc7tarball \u6765\u538b\u7f29\u3002</p> <pre><code>tar -cvzf backup.tar.gz /mnt/lv_snapshot\n</code></pre> <p>\u8fd8\u53ef\u4ee5\u76f4\u63a5\u901a\u8fc7rsync \u5c06\u6302\u8f7d\u7684snapshort \u4f20\u8f93\u5230\u5176\u4ed6\u670d\u52a1\u5668\u4e0a</p> <pre><code>rsync -aPh /mnt/lv_snapshot  &lt;remote_user&gt;@&lt;destination_server&gt;:&lt;remote_destination&gt;\n</code></pre>","tags":["linux","lvm"]},{"location":"blog/lvm-%E5%8A%9F%E8%83%BD%E4%BB%8B%E7%BB%8D/#_7","title":"\u5feb\u7167\u56de\u6eda","text":"<p>lvm\u7684snapshort \u4e5f\u662f\u5199\u65f6\u590d\u5236\u7684\uff08copy on write\uff09\uff0c\u6240\u4ee5\u521b\u5efa\u5feb\u7167\u64cd\u4f5c\u975e\u5e38\u5feb\uff0c  \u5f53\u5206\u533a\u8fdb\u884c\u5220\u9664\u548c\u4fee\u6539\u64cd\u4f5c\u7684\u65f6\u5019\uff0c lvm\u6587\u4ef6\u7cfb\u7edf\u4f1a\u62f7\u8d1d\u6587\u4ef6\u5230\u5176\u4ed6\u5730\u65b9\u4fdd\u5b58\u3002</p>","tags":["linux","lvm"]},{"location":"blog/lvm-%E5%8A%9F%E8%83%BD%E4%BB%8B%E7%BB%8D/#_8","title":"\u95ee\u9898","text":"<p>lvm\u5feb\u7167\u4e0d\u7b49\u4e8e\u5907\u4efd\uff0c \u4ec5\u6709\u5feb\u7167\u662f\u4e0d\u80fd\u6062\u590d\u7684</p>","tags":["linux","lvm"]},{"location":"blog/lxc-enable-tun-device/","title":"lxc enable tun device","text":"<p>\u5728lxc\u4e2d\u8fd0\u884ctailscale\u65f6\uff0c\u9ed8\u8ba4\u4f7f\u7528tun\u6a21\u5f0f\uff0c\u5c31\u662f\u521b\u5efa\u4e00\u4e2a\u865a\u62df\u7f51\u5361\uff0c\u7136\u540e\u7528\u8def\u7531\u89c4\u5219\u5c06\u51fa\u53bb\u7684\u6d41\u91cf\u90fd\u8def\u7531\u5230tun\u7684\u865a\u62df\u7f51\u5361\u4e2d\u3002\u4f46\u662flxc\u4e2d\u9ed8\u8ba4\u6ca1\u6709'/dev/net/tun'\uff0c\u8fd9\u65f6tailscaled \u542f\u52a8\u65f6\u4f1a\u5c1d\u8bd5\u6267\u884c'modprobe tun'\uff0c\u7ed3\u679clxc\u7684\u5185\u6838\u7248\u672c\u548c\u5bbf\u4e3b\u7684\u4e0d\u4e00\u81f4\uff0c\u6240\u4ee5\u5bfc\u81f4\u4e0b\u9762\u7684\u62a5\u9519\u3002\u89e3\u51b3\u529e\u6cd5\u67092\u4e2a\uff0c\u4e00\u662f\u4f7f\u7528tailscale\u7684userspace networking\uff08\u4e5f\u5c31\u662fsock5\u4ee3\u7406\uff09\uff0c\u4e8c\u662f\u5c06\u5bbf\u4e3b\u673a\u7684tun\u8bbe\u5907\u7ed1\u5b9a\u5230lxc\u5bb9\u5668\u4e2d\u3002</p> <pre><code>Aug 21 15:20:22 debian-dockers tailscaled[22673]\uff1aLinux kernel version: 6.1.10-1-pve\nAug 21 15:20:22 debian-dockers tailscaled[22673]: is CONFIG_TUN enabled in your kernel? `modprobe tun` failed with: modprobe: FATAL: Module tun not found in directory /lib/modules/6.1.10-1-pve\nAug 21 15:20:22 debian-dockers tailscaled[22673]: kernel/drivers/net/tun.ko found on disk, but not for current kernel; are you in middle of a system update and haven't rebooted? found: linux-image-5.10.0-32-rt-am&gt;\nAug 21 15:20:22 debian-dockers tailscaled[22673]: wgengine.NewUserspaceEngine(tun \"tailscale0\") error: tstun.New(\"tailscale0\"): CreateTUN(\"tailscale0\") failed; /dev/net/tun does not exist\n</code></pre>","tags":["pve"]},{"location":"blog/lxc-enable-tun-device/#userspace-networking","title":"\u4f7f\u7528userspace networking","text":"<p>\u4fee\u6539/etc/default/tailscaled\u6587\u4ef6\uff0c\u4fee\u6539FLAG\u4e3a'FLAGS=\"--tun=userspace-networking\"'\uff0c\u8fd9\u6837tailscaled\u5c31\u4e0d\u4f1a\u53bb\u521b\u5efatun\u8bbe\u5907\uff0c\u800c\u53ea\u662f\u66b4\u9732\u4e00\u4e2a\u7aef\u53e3\uff0c\u4f9b\u5e94\u7528\u6765\u4f7f\u7528\u3002  </p> <p>\u4f7f\u7528tailscale\u7684\u65b9\u6cd5 <pre><code>ALL_PROXY=socks5://localhost:1055/ HTTP_PROXY=http://localhost:1055/ http_proxy=http://localhost:1055/ ./my-app\n</code></pre></p> <p>\u53e6\u5916\u4e5f\u53ef\u4ee5\u624b\u52a8\u542f\u52a8tailscaled <pre><code>tailscaled --tun=userspace-networking --socks5-server=localhost:1055 --outbound-http-proxy-listen=localhost:1055 &amp;\ntailscale up --auth-key=&lt;your-auth-key&gt;\n</code></pre></p>","tags":["pve"]},{"location":"blog/lxc-enable-tun-device/#lxctun","title":"\u7ed9lxc\u5bb9\u5668\u6dfb\u52a0tun\u8bbe\u5907","text":"<p>\u5c06\u4e0b\u9762\u4e24\u884c\u6dfb\u52a0\u5230\u5bb9\u5668\u914d\u7f6e\u6587\u4ef6\uff0c\u4f8b\u5982\u5bb9\u5668id\u4e3a100, \u5219\u914d\u7f6e\u6587\u4ef6\u7684\u8def\u5f84\u662f/etc/pve/nodes/lxc/100.conf <pre><code>lxc.cgroup2.devices.allow: c 10:200 rwm\nlxc.mount.entry: /dev/net dev/net none bind,create=dir\n</code></pre></p>","tags":["pve"]},{"location":"blog/lxc-enable-tun-device/#lxc-enable-fuse","title":"lxc enable fuse","text":"<p>\u5f53lxc\u6302\u8f7dwebdav\u6587\u4ef6\u7cfb\u7edf\u65f6\uff0c\u4f9d\u8d56fuse \u9a71\u52a8\uff0c\u53ef\u4ee5\u5728pve\u7684lxc\u9009\u9879\u91cc\u6dfb\u52a0feature\u3002 \u53c2\u8003 </p>","tags":["pve"]},{"location":"blog/lxc-enable-tun-device/#_1","title":"\u53c2\u8003","text":"<p>https://tailscale.com/kb/1112/userspace-networking https://github.com/tailscale/tailscale/issues/6941</p>","tags":["pve"]},{"location":"blog/linux%E4%B8%8B%E7%9A%84%E9%82%AE%E4%BB%B6%E9%85%8D%E7%BD%AE/","title":"Linux\u4e0b\u7684\u90ae\u4ef6\u914d\u7f6e","text":"<p>\u8fd9\u91cc\u8bb0\u5f55Linux\uff08debian\uff09\u4e0b\u5982\u4f55\u4f7f\u7528Mutt\u67e5\u770b\u90ae\u4ef6\uff0c\u7528fetchmail\u63a5\u6536\u90ae\u4ef6\uff0c\u7528msmtp\u53d1\u9001\u90ae\u4ef6\u4ee5\u53ca\u4f7f\u7528maildrop\u6765\u7b5b\u9009\u90ae\u4ef6\u3002\u4e0e\u5176\u4ed6\u90ae\u4ef6\u5ba2\u6237\u7aef\u76f8\u6bd4\uff0c\u5982thunderbird\uff0c\u4ed6\u4eec\u4f7f\u7528\u7684\u5728\u7ebf\u767b\u9646\u65b9\u5f0f\uff0c\u6ca1\u6709\u4e0b\u8f7d\u90ae\u4ef6\u6765\u79bb\u7ebf\u8bbf\u95ee\u3002\u800cmutt\u652f\u6301\u79bb\u7ebf\u8bbf\u95ee\u672c\u5730\u7684\u90ae\u4ef6\uff0c\u4e5f\u53ef\u4ee5\u914d\u7f6e\u4e3a\u8bbf\u95ee\u90ae\u4ef6\u670d\u52a1\u5668\uff0c\u67e5\u770b\u670d\u52a1\u5668\u4e0a\u7684\u90ae\u4ef6\u3002 \u5728\u7ebf\u65b9\u5f0f\u9664\u4e86\u79bb\u7ebf\u4e0d\u53ef\u7528\u7684\u7f3a\u70b9\u4e4b\u5916\uff0c\u6bcf\u6b21\u6253\u5f00mutt\u9700\u8981\u767b\u9646\uff0c\u975e\u5e38\u6162\u3002 \u6211\u8fd9\u91cc\u7684\u914d\u7f6e\u662f\u6bd4\u8f83\u7b80\u964b\uff0c\u9002\u5408\u516c\u53f8\u5c11\u91cf\u90ae\u4ef6\u7684\u573a\u666f\u3002\u53c8\u56e0\u4e3a\u76ee\u524d\u4f7f\u7528\u7684Byobu-terminal\u7ec8\u7aef\uff0c\u5176\u90ae\u4ef6\u63d0\u9192\u662f\u57fa\u4e8e/var/mail/spool/$USER\u6587\u4ef6\u3002\u90ae\u4ef6\u6bd4\u8f83\u591a\u6216\u8005\u9644\u4ef6\u6bd4\u8f83\u5927\u7684\u8bdd\uff0c\u76f8\u8f83\u4e8e\u7528\u6587\u4ef6\u5939\u6765\u5b58\u50a8\u90ae\u4ef6\uff0c\u8fd9\u79cd\u65b9\u5f0f\u4f1a\u6bd4\u8f83\u6162\u3002</p>","tags":["email","mutt"]},{"location":"blog/linux%E4%B8%8B%E7%9A%84%E9%82%AE%E4%BB%B6%E9%85%8D%E7%BD%AE/#_1","title":"\u8f6f\u4ef6\u5b89\u88c5","text":"<p>\u9700\u8981\u5b89\u88c5 fetchmail, maildrop, mutt</p>","tags":["email","mutt"]},{"location":"blog/linux%E4%B8%8B%E7%9A%84%E9%82%AE%E4%BB%B6%E9%85%8D%E7%BD%AE/#_2","title":"\u63a5\u6536\u914d\u7f6e","text":"<p>\u5728\u5bb6\u76ee\u5f55\u4e0b\u521b\u5efa\u6587\u4ef6.fetchmailrc <pre><code>poll imap.exmail.qq.com\n  protocol IMAP\n  user \"example@example.com\"\n  password \"password\"\n  keep\n  #fetchall\n  ssl\n\nmimedecode\nmda \"/usr/bin/maildrop\"\n</code></pre> keep \u65b9\u5f0f\u4e0d\u4f1a\u5220\u9664\u670d\u52a1\u5668\u4e0a\u7684\u90ae\u4ef6\u3002\u7136\u540e\u542f\u52a8\u5b9a\u65f6\u4efb\u52a1\uff0c\u81ea\u52a8\u68c0\u67e5\u65b0\u90ae\u4ef6 <pre><code>systemctl --user enable --now fetchmail.service\n</code></pre></p> <p>service \u5185\u5bb9 <pre><code># /usr/lib/systemd/user/fetchmail.service\n# or any other location per man:systemd.unit(5)\n[Unit]\nDescription=Fetchmail Daemon\nDocumentation=man:fetchmail(1)\n\n[Service]\nExecStart=fetchmail --nodetach --daemon 300\nExecStop=fetchmail --quit\nRestart=always\n\n[Install]\nWantedBy=default.target\n</code></pre></p>","tags":["email","mutt"]},{"location":"blog/linux%E4%B8%8B%E7%9A%84%E9%82%AE%E4%BB%B6%E9%85%8D%E7%BD%AE/#_3","title":"\u53d1\u9001\u914d\u7f6e","text":"<p>\u5728\u5bb6\u76ee\u5f55\u521b\u5efa\u6587\u4ef6.msmtproc\uff0c\u586b\u5165\u53d1\u9001\u7684\u9a8c\u8bc1\u4fe1\u606f <pre><code>defaults\nauth           on\ntls            on\ntls_starttls off\ntls_trust_file /etc/ssl/certs/ca-certificates.crt\nlogfile        ~/.msmtp.log\n\n# exmail\naccount        office\nhost           smtp.exmail.qq.com\nport           465\nfrom           example@example.com\nuser           example@example.com\npassword       password\n</code></pre></p>","tags":["email","mutt"]},{"location":"blog/linux%E4%B8%8B%E7%9A%84%E9%82%AE%E4%BB%B6%E9%85%8D%E7%BD%AE/#mutt","title":"mutt\u914d\u7f6e","text":"<p>\u7531\u4e8e\u6211\u4e0d\u60f3\u5220\u9664/var/mail/\u91cc\u9762\u7684\u90ae\u4ef6\uff0c\u8fd9\u6837\u624d\u80fd\u5728byobu-terminal\u4e2d\u63d0\u9192\uff0c\u6240\u4ee5\u6ca1\u6709\u914d\u7f6emaildrop\u3002\u6700\u540e\u9700\u8981\u914d\u7f6emutt\u8bfb\u53d6/var/mail/$USER\u3002\u5728\u5bb6\u76ee\u5f55\u6216\u8005xdg\u914d\u7f6e\u76ee\u5f55\uff08~/.config/mutt\uff09\u521b\u5efa\u6587\u4ef6.muttrc/muttrc <pre><code>set spoolfile=/var/spool/mail/jimery\nset header_cache=~/.cache/mutt\nset send_charset=\"utf-8\"\n</code></pre></p> <p>\u8fd9\u6837\u5c31\u80fd\u67e5\u770b\u90ae\u4ef6\u4e86\u3002 \u5728mutt\u91cc\u9762\u624b\u52a8\u7ba1\u7406\u90ae\u4ef6\uff0c\u5b58\u6863\u6216\u8005\u5220\u9664\u3002</p>","tags":["email","mutt"]},{"location":"blog/linux%E4%B8%8B%E7%9A%84%E9%82%AE%E4%BB%B6%E9%85%8D%E7%BD%AE/#mutt_1","title":"mutt\u4f7f\u7528","text":"<p>\u5176\u5b9e\u4e0d\u7528mutt, \u76f4\u63a5\u7528mail\u4e5f\u53ef\u4ee5\uff0c\u8fd9\u4e2a\u9ed8\u8ba4\u8bbf\u95ee/var/mail/$USER,\u662fLinux\u9ed8\u8ba4\u7684\u90ae\u4ef6\u5de5\u5177\u3002 mutt\u80fd\u5f88\u65b9\u4fbf\u8c03\u7528msmtproc\u6765\u53d1\u9001\u90ae\u4ef6\u3002</p>","tags":["email","mutt"]},{"location":"blog/linux%E4%B8%8B%E7%9A%84%E9%82%AE%E4%BB%B6%E9%85%8D%E7%BD%AE/#maildrop-in-arch","title":"maildrop in Arch","text":"<p>\u53c8\u6362\u56deArch\u4e86\uff0c\u53d1\u73b0maildrop\u5728AUR\u91cc\uff0c\u800c\u4e14\u8fd8\u4f9d\u8d56\u597d\u51e0\u4e2aAUR, \u800c\u81ea\u5df1\u7f16\u8bd1\u53ea\u4f9d\u8d56courier-unicode\u5e93\u3002</p> <ol> <li>\u4e0b\u8f7dcourier-unicode\u6e90\u7801</li> <li>./configure --prefix=$HOME/.local --enable-shared=no --with-pic  # \u9759\u6001\u7f16\u8bd1\uff0c\u6307\u5b9a\u5b89\u88c5\u5230\u7528\u6237\u6839\u76ee\u5f55</li> <li>make &amp;&amp; make install # \u5fc5\u987b\u5b89\u88c5\u5426\u5219\u7f16\u8bd1maildrop\u7684\u65f6\u5019\u627e\u4e0d\u5230\u8fd9\u4e2a\u5e93\uff0c\u5373\u4f7f\u6307\u5b9a\u8def\u5f84\u4e5f\u4e0d\u884c\u3002 </li> <li>\u4e0b\u8f7dmaildrop\u6e90\u7801</li> <li>./configure --prefix=/home/hst/.local --enable-shared=no # \u9759\u6001\u7f16\u8bd1\uff0c\u6307\u5b9a\u5b89\u88c5\u5230\u7528\u6237\u6839\u76ee\u5f55</li> <li>make</li> <li>\u9a8c\u8bc1\u662f\u9759\u6001\u94fe\u63a5\u7684courier-unicode\uff0c\u786e\u8ba4<code>ldd ./libs/maildrop/maildrop</code> \u91cc\u9762\u6ca1\u6709'courier-unicode'</li> </ol> <p>Arch\u91cc\u9762\u521b\u5efa\u7528\u6237\u65f6\u9ed8\u8ba4\u6ca1\u6709\u5bf9\u5e94\u7684\u90ae\u7bb1\u6587\u4ef6\uff0c\u76f4\u63a5\u624b\u52a8\u521b\u5efa<code>sudo touch \"/var/spool/mail/$(whoami)\"</code>, \u8fd8\u6709chmod</p>","tags":["email","mutt"]},{"location":"blog/%E6%B5%85%E8%B0%88%E5%86%85%E5%AD%98%E7%AE%A1%E7%90%86/","title":"\u6d45\u8c08\u5185\u5b58\u7ba1\u7406","text":"<p>\u8fd9\u91cc\u8bb0\u5f55\u4e00\u4e0b\u770b\u4e66\u6240\u5f97\uff0c\u5e94\u7528\u7a0b\u5e8f\u7684\u5185\u5b58\u7ba1\u7406\uff0c\u5373glibc\u7684malloc\u548c\u76f8\u5173\u51fd\u6570</p>","tags":["memory","malloc"]},{"location":"blog/%E6%B5%85%E8%B0%88%E5%86%85%E5%AD%98%E7%AE%A1%E7%90%86/#_2","title":"\u5185\u5b58\u7ba1\u7406\u7684\u91cd\u8981\u6027","text":"<p>\u8fc7\u53bbLinux\u901a\u8fc7\u9ed8\u8ba4\u7684dlmalloc\u6765\u7533\u8bf7\u5185\u5b58\uff0c\u4f46\u4e0d\u652f\u6301\u591a\u7ebf\u7a0b\uff0c\u8fd9\u5bfc\u81f4\u7684\u7ade\u4e89\u548c\u6027\u80fd\u964d\u4f4e\uff0c\u800cptmalloc2\u652f\u6301\u591a\u7ebf\u7a0b\uff0c\u4e5f\u6210\u4e3a\u4e86Linux\u65b0\u7684\u9ed8\u8ba4\u65b9\u5f0f ptmalloc2\u901a\u8fc7\u4e3a\u6bcf\u4e2a\u7ebf\u7a0b\u5355\u72ec\u7ef4\u62a4\u4e00\u4e2a\u5e27\uff0c\u8fd9\u6837\u6bcf\u4e2a\u7ebf\u7a0b\u7684\u7533\u8bf7\u548c\u91ca\u653e\u53ef\u4ee5\u5e76\u884c\u6267\u884c\uff0c\u4f46\u5f53\u7ebf\u7a0b\u8fc7\u591a\u65f6\uff0c\u7ebf\u7a0b\u4e5f\u5c06\u5171\u4eab\u5e27\u3002\u8fd9\u79cd\u5e27\u53eb\u505a<code>per thread arena</code></p>","tags":["memory","malloc"]},{"location":"blog/%E6%B5%85%E8%B0%88%E5%86%85%E5%AD%98%E7%AE%A1%E7%90%86/#_3","title":"\u4e3b\u7ebf\u7a0b\u548c\u7ebf\u7a0b\u7684\u5185\u5b58\u7533\u8bf7\u65b9\u5f0f","text":"<p>\u4e3b\u7ebf\u7a0b\u4e2d\u4f7f\u7528brk\u6765\u7533\u8bf7\u5927\u5757\u5185\u5b58\uff0c\u5176\u5b9e<code>brk</code>\u4e0d\u8fc7\u662f\u4fee\u6539\u4e86\u5bc4\u5b58\u5668\u7684\u503c\u3002\u800c\u4e14\u8fd4\u56de\u7684\u5927\u5c0f\u901a\u5e38\u8981\u6bd4malloc\u7533\u8bf7\u7684\u591a\uff0c\u5982\u540c\u6d4b\u8bd5\u4e2d\u7684\u5728\u4e3b\u7ebf\u7a0b\u4e2d\u7533\u8bf7100\u4e2a\u5b57\u8282\u5927\u5c0f\u7684\u5185\u5b58\uff0c\u8fd4\u56de\u4e86132 KB\u3002 <pre><code>55f7b402c000-55f7b404d000 rw-p 00000000 00:00 0                          [heap]\n</code></pre> \u800c\u5728\u7ebf\u7a0b\u4e2d\uff0cmalloc\u4f7f\u7528mmap\u6765\u7533\u8bf7\u5185\u5b58\uff0c\u8fd4\u56de\u5927\u5c0f\u4e5f\u6bd4\u7533\u8bf7\u5927\u5c0f\u591a\uff0c\u6d4b\u8bd5\u4e2d\u7684\u5728\u7ebf\u7a0b\u4e2d\u7533\u8bf7100\u5b57\u8282\uff0c\u8fd4\u56de\u4e8664M\u7684\u5730\u5740\u7a7a\u95f4\uff0c \u4f46\u53ea\u67098MB\u662f\u53ef\u7528\u7684\u5806\u5185\u5b58\u3002 <pre><code>7fb738000000-7fb738021000 rw-p 00000000 00:00 0      \n7fb738021000-7fb73c000000 ---p 00000000 00:00 0      \n</code></pre></p> <p>\u4e3b\u7ebf\u7a0b\u4e2d\u7533\u8bf7\u7684\u5730\u5740\u5927\u4e8eData Section\u7684\u5730\u5740\uff0c\u8bf4\u660e\u4f7f\u7528\u7684<code>brk</code>\uff0c\u800c\u540e\u8005\u7533\u8bf7\u65f6\u7528\u4e86mmap\uff0c\u5bf9\u6bd4\u9644\u5f55\u6587\u6863\u53ef\u4ee5\u770b\u51fa32\u4f4d\u548c64\u4f4d\u533a\u522b\u6bd4\u8f83\u5927</p>","tags":["memory","malloc"]},{"location":"blog/%E6%B5%85%E8%B0%88%E5%86%85%E5%AD%98%E7%AE%A1%E7%90%86/#arena","title":"arena","text":"<p>\u4e3b\u7ebf\u7a0b\u548c\u7ebf\u7a0b\u4f7f\u7528\u4e0d\u540c\u7684arena\uff0c\u8fd9\u6837\u4e3b\u7ebf\u7a0b\u548c\u7ebf\u7a0b\u540c\u65f6\u7533\u8bf7\u5185\u5b58\u65f6\u4e0d\u5b58\u5728\u7ade\u4e89\u3002\u4f46\u4e0d\u662f\u6240\u6709\u7684\u7ebf\u7a0b\u90fd\u72ec\u4eab\u4e00\u4efdarena, arena\u7684\u4e2a\u6570\u9650\u5236\u5982\u4e0b</p> <pre><code>For 32 bit systems:\n     Number of arena = 2 * number of cores.\nFor 64 bit systems:\n     Number of arena = 8 * number of cores.\n</code></pre> <p>\u5f53\u7ebf\u7a0b\u4e2a\u6570\u592a\u591a\u65f6\uff0c\u4f1a\u516c\u7528\u4e3b\u7ebf\u7a0b\u7684arena</p>","tags":["memory","malloc"]},{"location":"blog/%E6%B5%85%E8%B0%88%E5%86%85%E5%AD%98%E7%AE%A1%E7%90%86/#main-arena-per-thread-arena","title":"main arena \u548c per thread arena","text":"<p>main arena \u6307\u5728\u4e3b\u7ebf\u7a0b\uff08main\uff09\u4e2d\u4f7f\u7528\u7684\uff0c\u800c\u540e\u8005\u662f\u5b50\u7ebf\u7a0b\u4e2d\u4f7f\u7528\uff0c\u4e24\u8005\u6709\u5f88\u5927\u533a\u522b \u4e3b\u7ebf\u7a0b\u53ea\u6709\u4e00\u5757heap\uff0c\u6240\u4ee5\u6ca1\u6709heapinfo\u7ed3\u6784\uff0c\u800c\u5b50\u7ebf\u7a0b\u6709\u3002\u4e3b\u7ebf\u7a0b\u7684<code>Arena header</code>\u662f\u5168\u5c40\u53d8\u91cf\uff0c\u6240\u4ee5\u5b58\u5728\u4e8elibc.so\u7684Data Segment\u4e2d  </p> <p>\u7ebf\u7a0b\u7684arena\u542b\u6709\u591a\u4e2aheap, \u6bcf\u4e2aheap\u90fd\u6709heapinfo\u7ed3\u6784\uff0c\u591a\u4e2aheapinfo\u7ec4\u6210\u94fe\u8868\u3002\u7ebf\u7a0b\u7684\u591a\u4e2aheap\u5171\u4eab\u4e00\u4e2a<code>malloc_state</code> \u4e5f\u79f0\u4e3a<code>Arena header</code> </p> <p><code>Arena header</code>\u5305\u542b\u4e86bin\u3001top chunk\u7b49\u4fe1\u606f  </p> <p>\u6bcf\u4e2aheap\u6709\u591a\u4e2achunk\uff0c\u6bcf\u4e2achunk\u6709\u4e2a<code>malloc_chunk</code>\u7ed3\u6784\uff0c\u5176\u7ba1\u7406chunk\u7684\u72b6\u6001\u548c\u5176\u5728heap\u4e2d\u7684\u504f\u79fb\u5927\u5c0f\uff0c\u6709\u4ee5\u4e0b\u51e0\u79cd\u72b6\u6001</p> <ul> <li>Allocated chunk </li> <li>Free chunk</li> <li>Top chunk</li> <li>Last Remainder chunk</li> </ul> <p>Top chunk \u5904\u4e8earena\u7684\u9876\u90e8\uff0c\u5728freelist\u6ca1\u6709\u5408\u9002\u5927\u5c0f\u7684chunk\u65f6\u4f7f\u7528\uff0c\u5982\u679cTop chunk\u6bd4\u7533\u8bf7\u7684\u5927\uff0c\u5219\u53c8\u5206\u4e3a\u4e24\u90e8\u5206\uff08\u65b0Top chunk\u548c\u7528\u6237\u7533\u8bf7\u7684chunk\uff09  </p> <p>Last Remainder chunk, \u662f\u5f53\u7528\u6237\u8bf7\u6c42small chunk\u65f6\uff0c\u4f1a\u5148\u904d\u5386small bin\u548cUnsorted bin\uff0c \u5982\u679c\u90fd\u65e0\u6cd5\u6ee1\u8db3\uff0c\u5219\u904d\u5386\u5176\u4ed6bin\u3002 \u5982\u679c\u627e\u5230\u7684chunk\u8fd8\u6709\u5269\u4f59\uff0c\u5219\u8fd9\u4e2achunk\u53d8\u4e3a<code>Last Remainder chunk</code>\uff0c\u4e14\u5c06\u88ab\u52a0\u5165\u5230<code>Unsorted bin</code> \u8fd9\u6837\u7684\u597d\u5904\u662f\u591a\u6b21\u7533\u8bf7small chunk\u65f6\uff0c\u4f1a\u5148\u5411<code>Unsorted bin</code>\u7684<code>Last Remainder chunk</code>\u7533\u8bf7\uff0c \u6240\u4ee5\u5c0f\u5185\u5b58\u5757\u4f1a\u96c6\u4e2d\u5206\u5e03\u5728<code>Last Remainder chunk</code>\uff0c\u63d0\u9ad8\u5c0f\u5757\u5185\u5b58\u7684\u5c40\u90e8\u6027  </p>","tags":["memory","malloc"]},{"location":"blog/%E6%B5%85%E8%B0%88%E5%86%85%E5%AD%98%E7%AE%A1%E7%90%86/#bin","title":"bin","text":"<p>\u5f53malloc\u7684\u5185\u5b58\u88abfree\u540e\uff08\u4ec5\u4ec5\u662f\u4f8b\u5b50\u4e2d\u7684100\u5b57\u8282chunk\uff09\uff0c\u5e76\u4e0d\u4f1a\u91ca\u653e\u7ed9\u5185\u6838\uff0c\u800c\u662f\u8fdb\u5165\u5230glibc\u7684bin\u4e2d\uff0c\u4e5f\u53eb\u505a<code>freelist</code>\u3002 \u5f53\u4e0b\u6b21\u7533\u8bf7\u5185\u5b58\u65f6\uff0c\u4f1a\u4ecebin\u4e2d\u67e5\u627e\u5408\u9002\u7684chunk\uff0c\u800c\u53ea\u6709\u5f53\u6ca1\u6709\u5408\u9002\u7684\u5927\u5c0f\u65f6\uff0c\u624d\u5411\u5185\u6838\u7533\u8bf7\u3002</p> <p>\u6240\u4ee5bin\u7528\u6765\u4fdd\u5b58free\u8fc7\u7684chunk, \u57fa\u4e8echunk\u7684\u5927\u5c0f\u5206\u4e3a - Fast bin - Unsorted bin - Small bin - Large bin</p> <p>\u4f46\u4e0d\u540c\u7684bin\u90fd\u4f7f\u7528\u94fe\u8868\u6765\u7ba1\u7406\u8fd9\u4e9bchunk</p>","tags":["memory","malloc"]},{"location":"blog/%E6%B5%85%E8%B0%88%E5%86%85%E5%AD%98%E7%AE%A1%E7%90%86/#_4","title":"\u6d4b\u8bd5\u65b9\u6cd5","text":"<p>\u83b7\u53d6\u7a0b\u5e8f\u8fd0\u884c\u65f6\u7684pid, \u5047\u8bbe\u4e3a949293, \u90a3\u4e48\u901a\u8fc7\u4ee5\u4e0b\u547d\u4ee4\u53ef\u4ee5\u83b7\u53d6\u7a0b\u5e8f\u7684\u5185\u5b58\u7ed3\u6784 <pre><code>cat /proc/949632/maps\n# address                 perms offset  dev    inode             pathname\n55f7b378a000-55f7b378b000 r--p 00000000 103:02 4727634                   /tmp/a.out (deleted)\n55f7b378b000-55f7b378c000 r-xp 00001000 103:02 4727634                   /tmp/a.out (deleted)\n55f7b378c000-55f7b378d000 r--p 00002000 103:02 4727634                   /tmp/a.out (deleted)\n55f7b378d000-55f7b378e000 r--p 00002000 103:02 4727634                   /tmp/a.out (deleted)\n55f7b378e000-55f7b378f000 rw-p 00003000 103:02 4727634                   /tmp/a.out (deleted)\n55f7b402c000-55f7b404d000 rw-p 00000000 00:00 0                          [heap]\n7f4808000000-7f4808021000 rw-p 00000000 00:00 0 \n7f4808021000-7f480c000000 ---p 00000000 00:00 0 \n7f480ea3d000-7f480ea3e000 ---p 00000000 00:00 0 \n7f480ea3e000-7f480f241000 rw-p 00000000 00:00 0 \n...\n</code></pre> * address \u662f\u8d77\u59cb\u5730\u5740-\u7ed3\u675f\u5730\u5740\uff0c\u5dee\u503c\u4e3a\u7a7a\u95f4\u5927\u5c0f * perm \u662f\u6307\u6743\u9650\uff0c\u5206\u4e3arwx[p,s], [p,s]\u6307\u6700\u540e\u4e00\u4f4d\u53ef\u4ee5\u662fprivate\u6216\u8005shared, \u8fd9\u4e9b\u80fd\u901a\u8fc7<code>mprotect</code>\u547d\u4ee4\u4fee\u6539(c\u4e2d\u7684const\u5b9e\u73b0) * offset \u4ec5\u5bf9mmap\u7684\u533a\u57df\u6709\u6548\uff0c\u6307\u6620\u5c04\u504f\u79fb\u91cf * pathname \u5982\u679c\u6b64\u533a\u57df\u662f\u6620\u5c04\u7684\u6587\u4ef6\uff0c\u5219\u663e\u793a\u6587\u4ef6\u540d\u3002\u5982\u679c\u6620\u5c04\u7684\u662f\u533f\u540d\u6620\u5c04\u5219\u663e\u793a\u7a7a\u767d, \u533f\u540d\u6620\u5c04\u5305\u62ec\u7ebf\u7a0b\u901a\u8fc7mmap\u7533\u8bf7\u7684\u5806\u5185\u5b58\uff0c\u800c[heap]\u662fmain\u51fd\u6570\u7684\u5806 </p> <p>\u6240\u4ee5\u901a\u8fc7\u8ba1\u7b97address\u53ef\u4ee5\u77e5\u9053glibc\u7533\u8bf7\u7684\u5185\u5b58\u60c5\u51b5</p>","tags":["memory","malloc"]},{"location":"blog/%E6%B5%85%E8%B0%88%E5%86%85%E5%AD%98%E7%AE%A1%E7%90%86/#malloc","title":"<code>malloc</code>\u7684\u8fd4\u56de\u503c\u6709\u610f\u4e49\u5417","text":"<p>\u5728\u6211\u672c\u673a\uff08gcc (Debian 10.2.1-6) 10.2.1 20210110 12GB\uff09\u4e0a\u6d4b\u8bd5\u4e86\u4e00\u6bb5\u7a0b\u5e8f 1. \u5982\u679c\u4e00\u6b21\u6027\u7533\u8bf713GB\uff0cmalloc\u8fd4\u56de\u5931\u8d25 2. \u5982\u679c\u6bcf\u6b21\u53ea\u7533\u8bf72GB\u4f46\u4e0d\u91ca\u653e\uff0c\u7b2c10\u6b21\u7533\u8bf7\uff0820GB\uff09malloc\u8fd4\u56de\u6210\u529f 3. \u5982\u679c\u6bcf\u6b21\u53ea\u7533\u8bf72GB\u4f46\u4e0d\u91ca\u653e\u4e14<code>\u8bbf\u95ee</code>\uff0c\u7b2c\u4e09\u6b21\u7533\u8bf7\uff086GB\uff09malloc\u8fd4\u56de\u6210\u529f\uff0c\u4f46\u8bbf\u95ee\u65f6OOM</p> <p>\u6240\u4ee5\u8bf4\uff0cmalloc\u7684\u8fd4\u56de\u503c\u662f\u6ca1\u6709\u592a\u5927\u610f\u4e49\u7684</p> <pre><code>void foo(size_t large) {\n  char *buffer = (char *)malloc(large);\n  if (buffer == NULL) {\n    printf(\"error!\\n\");\n    exit(EXIT_FAILURE);\n  }\n  printf(\"Memory allocated\\n\");\n  //  for (size_t i = 0; i &lt; large; i += 4096) {\n  //    buffer[i] = 0;\n  //  }\n  printf(\"Travalse done\\n\");\n}\nint main() {\n  // size_t large = 1099511627776;\n  size_t large = 13958643712;\n  for (int i = 0; i &lt; 100; i++) {\n    foo(2147483648);\n  }\n\n  return EXIT_SUCCESS;\n}\n</code></pre>","tags":["memory","malloc"]},{"location":"blog/%E6%B5%85%E8%B0%88%E5%86%85%E5%AD%98%E7%AE%A1%E7%90%86/#_5","title":"\u5176\u4ed6","text":"<p>\u5185\u5b58\u7ba1\u7406\u4e0d\u4ec5\u5b58\u5728\u5e94\u7528\u7a0b\u5e8f\uff08\u6216\u8005\u8bf4glibc\uff09\u4e2d\uff0cLinux\u5185\u6838\u4e5f\u6709\u5185\u5b58\u7ba1\u7406\u3002\u4e5f\u4e0d\u53ea\u6709glibc\u7684\u5185\u5b58malloc\u4e00\u79cd\u5b9e\u73b0\uff0c\u8fd8\u6709</p> <ul> <li>dlmalloc \u2013 General purpose allocator</li> <li>ptmalloc2 \u2013 glibc</li> <li>jemalloc \u2013 FreeBSD \u7684libc\u5b9e\u73b0, \u76f8\u6bd4\u5176\u4ed6\u7b2c\u4e09\u65b9\uff0c\u8fd9\u4e2a\u6bd4\u8f83\u6d41\u884c</li> <li>tcmalloc \u2013 Google \u4e3a\u591a\u7ebf\u7a0b\u573a\u666f\u5f00\u53d1</li> <li>libumem \u2013 Solaris</li> </ul> <p>malloc\u662fglibc\u5bf9ptmalloc2\u7684\u5305\u88c5\uff0c\u800c<code>ptmalloc2</code>\u662f<code>dlmalloc</code>\u7684\u91cd\u6784\uff0c\u533a\u522b\u5f88\u5927  </p> <p>\u6700\u540e\u603b\u7ed3\uff0cglibc\u7684malloc\u901a\u8fc7\u4e24\u4e2a\u7cfb\u7edf\u8c03\u7528\u51fd\u6570brk\u548cmmap\u6765\u5411\u5185\u6838\u7533\u8bf7\u5185\u5b58\uff0c\u4f46\u5185\u5b58\u91ca\u653e\u540e\u4e0d\u4f1a\u5f52\u8fd8\u5185\u6838\uff0c\u800c\u662f\u653e\u5230freelist\u7b49\u5f85\u518d\u6b21\u88ab\u5229\u7528</p>","tags":["memory","malloc"]},{"location":"blog/%E6%B5%85%E8%B0%88%E5%86%85%E5%AD%98%E7%AE%A1%E7%90%86/#_6","title":"\u5f15\u7528","text":"<p>https://man7.org/linux/man-pages/man5/proc.5.html https://sploitfun.wordpress.com/2015/02/10/understanding-glibc-malloc/comment-page-1/ https://lemire.me/blog/2021/10/27/in-c-how-do-you-know-if-the-dynamic-allocation-succeeded/</p>","tags":["memory","malloc"]},{"location":"blog/mutex-error/","title":"mutex error","text":"<p>\u8bb0\u4e00\u6b21\u5355\u5143\u6d4b\u8bd5\u7528\u4f8b\u65f6\u5931\u8d25\uff0c\u4e14\u51fa\u73b0\u5947\u602a\u7684\u62a5\u9519 <pre><code>tpp.c:63: __pthread_tpp_change_priority: Assertion `new_prio == -1 ||(new_prio &gt;= __sched_fifo_min_prio &amp;&amp; new_prio &lt;=__sched_fifo_max_prio)' failed\n</code></pre></p>","tags":["mutex","c","cpp"]},{"location":"blog/mutex-error/#_1","title":"\u539f\u56e0","text":"<p>\u51fd\u6570\u5b9a\u4e49\u5982\u4e0b\uff0c\u539f\u56e0\u662f\u4e0b\u9762\u7684\u7b2c\u4e00\u4e2aassert\u6761\u4ef6\u4e0d\u6210\u7acb\uff0cnew_prio != -1\u3002\u8fd9\u4e2a\u51fd\u6570\u7684\u6ce8\u91ca\u8bf4\u660e\u4e86\u9700\u8981\u4f7f\u7528\u8005\u786e\u4fdd\u8c03\u7528\u524d\u5df2\u521d\u59cb\u5316\u3002</p> <pre><code>/* We only want to initialize __sched_fifo_min_prio and __sched_fifo_max_prio\n   once.  The standard solution would be similar to pthread_once, but then\n   readers would need to use an acquire fence.  In this specific case,\n   initialization is comprised of just idempotent writes to two variables\n   that have an initial value of -1.  Therefore, we can treat each variable as\n   a separate, at-least-once initialized value.  This enables using just\n   relaxed MO loads and stores, but requires that consumers check for\n   initialization of each value that is to be used; see\n   __pthread_tpp_change_priority for an example.\n */\n</code></pre> <pre><code>int\n__pthread_tpp_change_priority (int previous_prio, int new_prio)\n{\n  struct pthread *self = THREAD_SELF;\n  struct priority_protection_data *tpp = THREAD_GETMEM (self, tpp);\n  int fifo_min_prio = atomic_load_relaxed (&amp;__sched_fifo_min_prio);\n  int fifo_max_prio = atomic_load_relaxed (&amp;__sched_fifo_max_prio);\n  if (tpp == NULL)\n    {\n      /* See __init_sched_fifo_prio.  We need both the min and max prio,\n         so need to check both, and run initialization if either one is\n         not initialized.  The memory model's write-read coherence rule\n         makes this work.  */\n      if (fifo_min_prio == -1 || fifo_max_prio == -1)\n        {\n          __init_sched_fifo_prio ();\n          fifo_min_prio = atomic_load_relaxed (&amp;__sched_fifo_min_prio);\n          fifo_max_prio = atomic_load_relaxed (&amp;__sched_fifo_max_prio);\n        }\n      size_t size = sizeof *tpp;\n      size += (fifo_max_prio - fifo_min_prio + 1)\n              * sizeof (tpp-&gt;priomap[0]);\n      tpp = calloc (size, 1);\n      if (tpp == NULL)\n        return ENOMEM;\n      tpp-&gt;priomax = fifo_min_prio - 1;\n      THREAD_SETMEM (self, tpp, tpp);\n    }\n  assert (new_prio == -1\n          || (new_prio &gt;= fifo_min_prio\n              &amp;&amp; new_prio &lt;= fifo_max_prio));\n  assert (previous_prio == -1\n          || (previous_prio &gt;= fifo_min_prio\n              &amp;&amp; previous_prio &lt;= fifo_max_prio));\n</code></pre> <p>\u7f51\u4e0a\u5e16\u5b50\u7684\u539f\u56e0\u662f\u7ed9\u521d\u59cb\u5316mutex\u5e76\u8bbe\u7f6eRECURSIVE\u7c7b\u578b\u65f6\uff0c\u5fd8\u4e86\u5bf9mutexattr\u8fdb\u884c\u521d\u59cb\u5316\uff0c\u5bfc\u81f4\u4f7f\u7528\u4e86\u810f\u5185\u5b58 \u5373<code>pthread_mutexattr_init(&amp;mutexattr)</code></p> <pre><code>pthread_mutexattr_t mutexattr;\n\n// Set the mutex as a recursive mutex\npthread_mutexattr_settype(&amp;mutexattr, PTHREAD_MUTEX_RECURSIVE_NP);\n\n// create the mutex with the attributes set\npthread_mutex_init(&amp;CritSec, &amp;mutexattr);\n\n// After initializing the mutex, the thread attribute can be destroyed\npthread_mutexattr_destroy(&amp;mutexattr);\n</code></pre> <p>\u603b\u4e4b\uff0c\u8981\u5728\u7ebf\u7a0b\u542f\u52a8\u524d\u521d\u59cb\u5316\u597dmutex</p>","tags":["mutex","c","cpp"]},{"location":"blog/mutex-error/#_2","title":"\u5176\u4ed6\u95ee\u9898","text":"<p>\u8fd9\u4e2a\u95ee\u9898\u5176\u5b9e\u662fc++\u4ee3\u7801\u629b\u51fa\u6765\u7684\uff0c\u591a\u7ebf\u7a0b\u6267\u884c\u4e86\u4e0b\u9762\u7684\u4ee3\u7801\uff0c\u5bfc\u81f4\u4e86\u4e0a\u9762\u7684\u95ee\u9898\u3002</p> <p>AppCache\u4e2d\u6709\u4e2a\u5c0f\u7c92\u5ea6\u7684\u9501\uff0c\u4f46\u8fd9\u4e2a\u9501\u8fd8\u672a\u521d\u59cb\u5316\u5c31\u88ab\u5176\u4ed6\u7ebf\u7a0b\u53bblock\u4e86\uff0c\u5bfc\u81f4\u51fa\u73b0\u95ee\u9898\u3002\u6240\u4ee5\u8981mutex\u6700\u597d\u8981\u5728\u7ebf\u7a0b\u542f\u52a8\u524d\u521d\u59cb\u5316</p> <pre><code>AppCache{\nstd::mutex\n}\uff1b\n</code></pre> <pre><code>  auto app = m_app_cache.find(app_path);\n  if (app == m_app_cache.end()) {\n    // create a new monitor element\n    m_app_cache.insert_or_assign(app_path, std::make_shared&lt;AppCache&gt;());\n  }\n  std::lock_guard&lt;std::mutex&gt; lk(app-&gt;second-&gt;cache_mutex);\n</code></pre>","tags":["mutex","c","cpp"]},{"location":"blog/mutex-error/#_3","title":"\u5f15\u7528","text":"<p>https://sourceware.org/legacy-ml/libc-help/2008-05/msg00072.html?utm_source=pocket_mylist</p>","tags":["mutex","c","cpp"]},{"location":"blog/urxvt%E9%85%8D%E7%BD%AE/","title":"urxvt\u914d\u7f6e","text":"<p>\u81ea\u4f7f\u7528arch\u4ee5\u6765\uff0c\u4e00\u76f4\u5728\u7528urxvt, \u5b83\u7b80\u6d01\uff0c\u8f7b\u91cf\uff0c\u4f46\u4e0d\u53ef\u5426\u8ba4\u7684\u6709\u95ee\u9898\uff0c\u6bd4\u5982\u4e2d\u6587\u8f93\u5165\u6a21\u5f0f\u957f\u65f6\u95f4\u65f6\u4f1a\u65e0\u6cd5\u8f93\u5165\u4e2d\u6587\uff0c\u914d\u7f6e\u9ebb\u70e6, \u9700\u8981\u5728\u542f\u52a8\u811a\u672c\u914d\u7f6e.xresource \u8fd9\u91cc\u8981\u8bb0\u4e00\u4e0b\u81ea\u5df1\u7684urxvt\u7684\u914d\u7f6e\u4ee5\u505a\u5907\u4efd  </p>","tags":["linux","urxvt","terminal"]},{"location":"blog/urxvt%E9%85%8D%E7%BD%AE/#urxvt_1","title":"\u4f7f\u7528urxvt\u7684\u4e3b\u8981\u529f\u80fd","text":"<p>urxvt \u975e\u5e38\u7b80\u6d01\u7684tab\u529f\u80fd,\u652f\u6301\u591a\u8def\u590d\u7528\u4ee5\u53ca\u53f3\u952e\u83dc\u5355\u683c\u5f0f\u5316\u5b57\u7b26\u4e32\uff0c\u800c\u4e14\u652f\u6301\u5047\u900f\u660e\uff0c\u975e\u5e38\u8f7b\u91cf\u3002</p> <p>urxvt\u4e0d\u591f\u73b0\u4ee3\u5316\uff0c\u4e0d\u662f\u5f00\u7bb1\u5373\u7528\u7684\uff0c\u9700\u8981\u5982\u4e0b\u4fee\u6539\uff1a  * tab\u529f\u80fd\u9700\u8981\u4fee\u6539perl\u7684\u5305\uff0c\u56e0\u4e3a\u9ed8\u8ba4\u60c5\u51b5\u4e0b\u4e0d\u652f\u6301\u5207\u6362tab * \u4e0d\u652f\u6301icon, \u9700\u8981\u5728\u914d\u7f6e\u6587\u4ef6\u624b\u52a8\u6307\u5b9aicon\u7684\u4f4d\u7f6e * tab\u529f\u80fd\u9700\u8981\u989d\u5916\u542f\u52a8\u53c2\u6570\uff0c\u6240\u4ee5\u987a\u4fbf\u7f16\u4e00\u4e2adesktop\u542f\u52a8\u6587\u4ef6</p>","tags":["linux","urxvt","terminal"]},{"location":"blog/urxvt%E9%85%8D%E7%BD%AE/#perl","title":"perl\u4fee\u6539","text":"<p>\u590d\u5236/usr/lib/perl/ext/tabbed\u5230\u7528\u6237\u76ee\u5f55~/.urxvt/ext/, \u4fee\u6539<code>tab_key_press</code>\u51fd\u6570\u5982\u4e0b</p> <pre><code># if ($keysym == 0xff51 || $keysym == 0xff53)  \u8868\u793a\u4f7f\u7528ctrl+shift \u548c\u65b9\u5411\u952e\u6765\u79fb\u52a8tab\nsub tab_key_press {\n   my ($self, $tab, $event, $keysym, $str) = @_;\n\n   if ($event-&gt;{state} &amp; urxvt::ShiftMask &amp;&amp; !($event-&gt;{state} &amp; urxvt::ControlMask) ) {\n      if ($keysym == 0xff51 || $keysym == 0xff53) {\n         my ($idx) = grep $self-&gt;{tabs}[$_] == $tab, 0 .. $#{ $self-&gt;{tabs} };\n\n         --$idx if $keysym == 0xff51;\n         ++$idx if $keysym == 0xff53;\n\n         $self-&gt;make_current ($self-&gt;{tabs}[$idx % @{ $self-&gt;{tabs}}]);\n\n         return 1;\n      } elsif ($keysym == 0xff54) {\n         $self-&gt;new_tab;\n\n         return 1;\n      }\n   }elsif ($event-&gt;{state} &amp; urxvt::ControlMask &amp;&amp; $event-&gt;{state} &amp; urxvt::ShiftMask) {\n      if ($keysym == 0xff51 || $keysym == 0xff53) {\n         my ($idx1) = grep $self-&gt;{tabs}[$_] == $tab, 0 .. $#{ $self-&gt;{tabs} };\n         my  $idx2  = ($idx1 + ($keysym == 0xff51 ? -1 : +1)) % @{ $self-&gt;{tabs} };\n\n         ($self-&gt;{tabs}[$idx1], $self-&gt;{tabs}[$idx2]) =\n            ($self-&gt;{tabs}[$idx2], $self-&gt;{tabs}[$idx1]);\n\n         $self-&gt;make_current ($self-&gt;{tabs}[$idx2]);\n\n         return 1;\n      }\n   }\n\n   ()\n}\n</code></pre>","tags":["linux","urxvt","terminal"]},{"location":"blog/urxvt%E9%85%8D%E7%BD%AE/#urxvt_2","title":"urxvt \u542f\u52a8\u6587\u4ef6","text":"<p>\u521b\u5efa\u542f\u52a8\u6587\u4ef6\uff0c\u4f7f\u5176\u9ed8\u8ba4\u4e3atab\u6a21\u5f0f '.local/share/applications/urxvtq.desktop' <pre><code>[Desktop Entry]\nVersion=1.0\nName=urxvtq\nComment=An unicode capable rxvt clone\nExec=urxvt -pe tabbed\nIcon=utilities-terminal\nTerminal=false\nType=Application\nCategories=System;TerminalEmulator;\n</code></pre></p>","tags":["linux","urxvt","terminal"]},{"location":"blog/urxvt%E9%85%8D%E7%BD%AE/#urxvt_3","title":"urxvt \u914d\u7f6e","text":"<p>\u521b\u5efa\u5982\u4e0b\u7684\u6587\u4ef6\uff0c\u5e76\u8981\u5728\u5408\u9002\u7684\u542f\u52a8\u811a\u672c\u91cc\u6dfb\u52a0\u4e00\u884c<code>[ -f \"$HOME/.Xresources\" ] &amp;&amp;  xrdb -merge \"$HOME/.Xresources\"</code> <pre><code>!!$HOME/.Xresources\n\n!! dbi\nXft.dpi:98\n\n/* Couleurs Tango */\n\n!! \u4e0b\u5212\u7ebf\u8272\nURxvt.colorUL:  #87afd7\nURxvt.colorBD:  white\nURxvt.colorIT:  green\n\n!! tab \u914d\u8272\nURxvt.tabbed.tabbar-fg: 2\nURxvt.tabbed.tabbar-bg: 0\nURxvt.tabbed.tab-fg:    3\nURxvt.tabbed.tab-bg:    2\nURxvt.tabbed.tabren-bg: 3\nURxvt.tabbed.tabdiv-fg: 8\nURxvt.tabbed.tabsel-fg: 1\nURxvt.tabbed.tabsel-bg: 8\n\n!! fake transparent\nURxvt.transparent: true\nURxvt.shading:     10\nURxvt.fading:      40\n!! font\nURxvt.font:        xft:Monospace,xft:Awesome:pixelsize=14\nURxvt.boldfont:    xft:Monospace,xft:Awesome:style=Bold:pixelsize=16\n\n!! scroll behavior\nURxvt.scrollBar:         false\nURxvt.scrollTtyOutput:   false\nURxvt.scrollWithBuffer:  true\nURxvt.scrollTtyKeypress: true\n\n!! addtional\nURxvt.internalBorder:     0\nURxvt.cursorBlink: true\nURxvt.saveLines:          2000\nURxvt.mouseWheelScrollPage:             false\n\n! Restore Ctrl+Shift+(c|v)\nURxvt.keysym.Shift-Control-V: eval:paste_clipboard\nURxvt.keysym.Shift-Control-C: eval:selection_to_clipboard\nURxvt.iso14755: false\nURxvt.iso14755_52: false\n\n! alt+s \u641c\u7d22\nURxvt.perl-ext:   default,matcher,searchable-scrollback\nURxvt.keysym.M-s: searchable-scrollback:start\n\n! url match \u95ee\u9898\u662ftab\u6a21\u5f0f\u4e0b\u4e0d\u652f\u6301\u8df3\u8f6c\u6d4f\u89c8\u5668\nURxvt.url-launcher:       /usr/bin/firefox\nURxvt.matcher.button:     1\n\n\nURxvt.termName:         xterm-256color\nURxvt.iconFile:     /usr/share/icons/gnome/32x32/apps/gnome-terminal-icon.png\n! fast key\nURxvt.keysym.Control-Up:     \\033[1;5A\nURxvt.keysym.Control-Down:   \\033[1;5B\nURxvt.keysym.Control-Left:   \\033[1;5D\nURxvt.keysym.Control-Right:  \\033[1;5C\n</code></pre></p>","tags":["linux","urxvt","terminal"]},{"location":"blog/urxvt%E9%85%8D%E7%BD%AE/#_1","title":"\u6700\u540e","text":"<p>\u7528\u4e86kitty\u5c31\u4e0d\u4f1a\u6709\u8f93\u5165\u6cd5\u7684\u95ee\u9898\uff0c\u5b57\u4f53\u4e5f\u5f88\u4e30\u5bcc, \u63a8\u8350\u73b0\u4ee3\u5316\u6a21\u62df\u7ec8\u7aefkitty</p>","tags":["linux","urxvt","terminal"]},{"location":"blog/mysql-sql%E8%AF%AD%E5%8F%A5%E4%BC%98%E5%85%88%E7%BA%A7/","title":"mysql sql\u8bed\u53e5\u4f18\u5148\u7ea7","text":"<pre><code>The actual execution of MySQL statements is a bit tricky. However, the standard does specify the order of interpretation of elements in the query. This is basically in the order that you specify, although I think HAVING and GROUP BY could come after SELECT:\n\n    FROM clause\n    WHERE clause\n    SELECT clause\n    GROUP BY clause\n    HAVING clause\n    ORDER BY clause\n\nThis is important for understanding how queries are parsed. You cannot use a column alias defined in a SELECT in the WHERE clause, for instance, because the WHERE is parsed before the SELECT. On the other hand, such an alias can be in the ORDER BY clause.\n\nAs for actual execution, that is really left up to the optimizer. For instance:\n\n. . .\nGROUP BY a, b, c\nORDER BY NULL\n\nand\n\n. . .\nGROUP BY a, b, c\nORDER BY a, b, c\n\nboth have the effect of the ORDER BY not being executed at all -- and so not executed after the GROUP BY (in the first case, the effect is to remove sorting from the GROUP BY and in the second the effect is to do nothing more than the GROUP BY already does).\n</code></pre>","tags":["mysql"]},{"location":"blog/mysql-sql%E8%AF%AD%E5%8F%A5%E4%BC%98%E5%85%88%E7%BA%A7/#_1","title":"\u5f15\u7528","text":"<p>https://stackoverflow.com/questions/24127932/mysql-query-clause-execution-order</p>","tags":["mysql"]},{"location":"blog/%E8%AE%B0%E5%BD%95%E5%9C%A8%E9%83%A8%E7%BD%B2%E4%B8%80%E4%B8%AAnginx-fastcgi-%E9%A1%B9%E7%9B%AE%E6%97%B6%E5%A4%B1%E8%B4%A5-fastcgi-%E9%80%9A%E8%BF%87unix-socket-%E9%80%9A%E8%AE%AF/","title":"\u8bb0\u5f55\u5728\u90e8\u7f72\u4e00\u4e2anginx fastcgi \u9879\u76ee\u65f6\u5931\u8d25\uff0c fastcgi \u901a\u8fc7unix socket \u901a\u8baf","text":"<p>\u8fd9\u662f\u4e00\u4e2aflask \u9879\u76ee\uff0c \u4f7f\u7528flup\u521b\u5efa\u7684fastcgi</p> <pre><code>#!/usr/bin/env python\nfrom flup.server.fcgi import WSGIServer\nfrom main import app\n\nif __name__ == '__main__':\n    # for apache\n    # WSGIServer(app).run()\n    # for nginx, need to set conmunication sock between nginx and the cgiserver\n    WSGIServer(app, bindAddress='/tmp/myflask-fcgi.sock').run()\n</code></pre> <p>\u8fd9\u91cc\u76f4\u63a5\u8bf4\u660e\u7ed3\u679c\uff0c socket \u6587\u4ef6\u4e0d\u80fd\u521b\u5efa\u5728/tmp/ \u6216\u8005 /vat/tmp \u76ee\u5f55\u3002</p> <p>nginx \u9519\u8bef\u914d\u7f6e <pre><code>    location / { try_files $uri @myflask; }\n    location @myflask {\n        include fastcgi_params;\n        fastcgi_param PATH_INFO $fastcgi_script_name;\n        fastcgi_param SCRIPT_NAME \"\";\n        fastcgi_pass unix:/tmp/fcgi.sock;\n    }\n</code></pre></p> <p>nginx \u9519\u8bef\u63d0\u793a <pre><code> connect() to unix:/tmp/fcgi.sock failed (2: No such file or directory) while connecting to upstream\n</code></pre></p>","tags":["flask","webserver"]},{"location":"blog/%E8%AE%B0%E5%BD%95%E5%9C%A8%E9%83%A8%E7%BD%B2%E4%B8%80%E4%B8%AAnginx-fastcgi-%E9%A1%B9%E7%9B%AE%E6%97%B6%E5%A4%B1%E8%B4%A5-fastcgi-%E9%80%9A%E8%BF%87unix-socket-%E9%80%9A%E8%AE%AF/#_1","title":"\u539f\u56e0","text":"<p>\u5982\u679csocket\u521b\u5efa\u5728/tmp \u6216\u8005 /var/tmp \u76ee\u5f55\uff0c \u53ea\u80fd\u88absocket\u7684\u8fdb\u7a0b\u53d1\u73b0\u3002 \u610f\u601d\u662f\u53ea\u6709cgi\u7a0b\u5e8f\u80fd\u53d1\u73b0\uff0c\u6240\u4ee5nginx \u65e0\u6cd5\u8fde\u63a5\u4e86</p> <p>\u6b63\u786e\u914d\u7f6e\u662f\u521b\u5efa\u5230/var/sockets \u76ee\u5f55\uff0c\u5e76\u6ce8\u610f\u6743\u9650\u95ee\u9898 <pre><code>    location / { try_files $uri @myflask; }\n    location @myflask {\n        include fastcgi_params;\n        fastcgi_param PATH_INFO $fastcgi_script_name;\n        fastcgi_param SCRIPT_NAME \"\";\n        fastcgi_pass unix:/var/sockets/myflask-fcgi.sock;\n    }\n</code></pre></p>","tags":["flask","webserver"]},{"location":"blog/%E8%AE%B0%E5%BD%95%E5%9C%A8%E9%83%A8%E7%BD%B2%E4%B8%80%E4%B8%AAnginx-fastcgi-%E9%A1%B9%E7%9B%AE%E6%97%B6%E5%A4%B1%E8%B4%A5-fastcgi-%E9%80%9A%E8%BF%87unix-socket-%E9%80%9A%E8%AE%AF/#unix-socket","title":"\u5173\u4e8eunix socket","text":"<p>\u4ee5\u4e0a\u662f\u4e00\u79cd\u89e3\u51b3\u529e\u6cd5\uff0c\u5f53\u7136\u4f7f\u7528ip\u6765\u8fde\u63a5nginx\u548ccgi\u4e5f\u662f\u53ef\u4ee5\u7684\uff0c\u4f46\u662funix socket \u6709\u4e0d\u5c11\u597d\u5904\u3002 </p>","tags":["flask","webserver"]},{"location":"blog/%E8%AE%B0%E5%BD%95%E5%9C%A8%E9%83%A8%E7%BD%B2%E4%B8%80%E4%B8%AAnginx-fastcgi-%E9%A1%B9%E7%9B%AE%E6%97%B6%E5%A4%B1%E8%B4%A5-fastcgi-%E9%80%9A%E8%BF%87unix-socket-%E9%80%9A%E8%AE%AF/#cgi","title":"\u5173\u4e8ecgi","text":"<p>\u4e0a\u9762\u65e0\u8bba\u4f7f\u7528unix socket \u8fd8\u662f ip \u6765\u8bbf\u95eecgi\uff0c \u8fd9\u4e24\u79cd\u65b9\u5f0f\u90fd\u662f\u901a\u8fc7cgi\u6765\u63d0\u4f9bweb\u670d\u52a1\u3002 \u800cnginx \u4e0d\u652f\u6301cgi\uff0c \u6240\u4ee5\u9700\u8981\u81ea\u5df1\u6765\u901a\u8fc7python\u7684 flup \u6765\u5b9e\u73b0fastcgi\u3002 nginx \u53ea\u4e0d\u8fc7\u662f\u4e00\u4e2a\u4ee3\u7406\u7684\u4f5c\u7528\u3002\u800capache\u548ctomcat \u90fd\u80fd\u652f\u6301cgi</p> <pre><code>cgi \u7684\u5b9a\u4e49\u662f common gateway interface\uff0c \u662f\u4e00\u4e2a\u534f\u8bae\u3002 fastcgi\uff0cuwcgi\u90fd\u662f\u5347\u7ea7\u7248\u6216\u8005\u53d8\u79cd\u3002  \nflup\u5b9e\u73b0\u4e86cgi\u7684\u670d\u52a1\u7a0b\u5e8f\uff0c\u4e5f\u5c31\u662f\u53ef\u4ee5\u7528\u6765\u89e3\u6790\u811a\u672c\uff08python php \u7b49\u7b49\uff09\uff0c\u63d0\u4f9bweb\u670d\u52a1\u3002\n</code></pre> <p>\u53e6\u5916\u9664\u4e86\u4ee5\u4e0a\u65b9\u5f0f\uff0c nginx\u4e5f\u53ef\u4ee5\u4f7f\u7528pypass proxy \u6765\u8f6c\u53d1\u8bf7\u6c42\uff0c\u7531\u5e94\u7528\u81ea\u5df1\u6765\u5b9e\u73b0\u7f51\u7edc\u5904\u7406\u3002 </p> <pre><code>location / {\n        proxy_pass https://localhost:8080\n        proxy_set_header Host            $host;\n        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;\n        proxy_set_header X-Real-IP       $remote_addr;\n        proxy_set_header X-Scheme        $scheme;\n        access_log /var/log/nginx/access.log my_tracking;\n    }\n</code></pre> <p>\u5982\u8fc7\u662fpython \u5c31\u9700\u8981\u76d1\u542c\u67d0\u4e2a\u7aef\u53e3\uff0c\u8fd9\u79cd\u662f\u4e0d\u7a33\u5b9a\u7684\u3002 \u4e0d\u9002\u5408\u751f\u4ea7\u6a21\u5f0f\u4e0b\u4f7f\u7528\u3002 </p>","tags":["flask","webserver"]},{"location":"blog/notes/","title":"Notes","text":"","tags":["ffmpeg"]},{"location":"blog/notes/#_1","title":"\u7b14\u8bb0\u672c\u7684\u7b14\u8bb0\u6574\u7406\u548c\u8a8a\u6284","text":"<p>\u4e3b\u8981\u662f\u5173\u4e8effmpeg\u7684\u77e5\u8bc6\u603b\u7ed3</p>","tags":["ffmpeg"]},{"location":"blog/notes/#ffmpeg","title":"FFmpeg","text":"<p>\u8bfb\u6cd5\"F-F-M-\u6d3e\u683c\", \u7531\u4e09\u4e2a\u53ef\u6267\u884c\u6587\u4ef6\u7ec4\u6210\"ffmpeg/ffplay/ffprobe\"\u3002</p>","tags":["ffmpeg"]},{"location":"blog/notes/#ffmpeg_1","title":"ffmpeg","text":"<ul> <li>\u652f\u6301\u7684\u5bb9\u5668 <code>ffmpeg -muxers</code> \u5206\u4e3aDemuxing\u548cMuxing\uff08D/E\uff09\u5c01\u88c5\u548c\u89e3\u5c01\u88c5\uff0c\u652f\u6301Muxing\u80af\u5b9a\u652f\u6301Demuxing\u3002</li> <li>\u652f\u6301\u7684\u7f16\u7801 <code>ffmpeg -codecs</code> \u5206\u4e3a\u89e3\u7801\u548c\u7f16\u7801(decoder/encoder)\uff0c\u652f\u6301\u7f16\u7801\u4e00\u822c\u80fd\u652f\u6301\u89e3\u7801\u3002</li> <li>\u5bb9\u5668\u5e2e\u52a9\u4fe1\u606f <code>ffmpeg -h muxer=mp4</code> <code>ffmpeg -h demuxer=mp4</code> \u52a0\u4e0a<code>-h full</code>\u67e5\u770b\u66f4\u591a\u4fe1\u606f</li> <li>\u7f16\u7801\u5e2e\u52a9\u4fe1\u606f <code>ffmpeg -h encoder=h264</code> <code>ffmpeg -h decoder=h264</code> \u52a0\u4e0a<code>-h full</code>\u67e5\u770b\u66f4\u591a\u4fe1\u606f</li> <li>\u652f\u6301\u7684\u6ee4\u955c <code>ffmpeg -filters</code> \u8fd9\u91cc\u7684\u6ee4\u955c\u4e0d\u662fPS\u7b49\u56fe\u7247\u7f16\u8f91\u8f6f\u4ef6\u91cc\u9762\u7684\u6ee4\u955c\uff0c\u800c\u5e94\u8be5\u79f0\u505a\u7279\u6548\uff0c\u652f\u6301\u89c6\u9891\u548c\u97f3\u9891\u8fd8\u6709\u5b57\u5e55\u3002</li> </ul> <p>\u5f53\u8f6c\u7801\u6216\u8f6c\u5bb9\u5668\u683c\u5f0f\u65f6\uff0c-map\u53c2\u6570\u7528\u6765\u624b\u52a8\u9009\u62e9\u6d41\uff0c\u53c2\u6570\u683c\u5f0f -map n:m:x \u5176\u4e2dn\u8868\u793a\u9009\u62e9\u7b2cn\u4e2a\u8f93\u5165\uff0cm\u4ee3\u8868\u7b2cn\u4e2a\u8f93\u5165\u4e2d\u7684\u7b2cm\u4e2a\u6d41\uff0c\u800cx\u8868\u793a\u7b2cn\u4e2a\u8f93\u5165\u4e2d\u7684\u7b2cm\u4e2a\u6d41\u7684\u7b2cx\u4e2a\u901a\u9053\u3002\u5f53\u6ca1\u6709-map\u53c2\u6570\u65f6\uff0cffmpeg\u4f1a\u6839\u636e\u5bb9\u5668\u7c7b\u578b\u81ea\u52a8\u9009\u62e9\u5408\u9002\u7684\u6d41\u3002-map\u8fd8\u80fd\u7528\u6765\u9009\u62e9filtergraph\u4e2d\u7684\u6ee4\u955c\u8f93\u51fa\u3002</p>","tags":["ffmpeg"]},{"location":"blog/notes/#filter","title":"filter \u6ee4\u955c","text":"<p>\u5206\u4e3a filtergraph filterchain \u548c filter * filtergraph \u662f\u5305\u542b\u5f88\u591a\u4e2afilter\u7684\u6709\u5411\u56fe\uff0c\u6bcf\u4e24\u4e2a\u6ee4\u955c\u4e4b\u95f4\u90fd\u53ef\u4ee5\u6709\u591a\u4e2a\u8fde\u63a5\u3002 * filter \u5206\u4e3asource filter, sink filter, filter\uff0c\u5176\u4e2dsource filter\u6ca1\u6709\u8f93\u5165\u7aef\uff0csink filter\u6ca1\u6709\u8f93\u51fa\u7aef\u3002 </p> <p>\u591a\u4e2afilter\u7528\",\"\u6765\u8fde\u63a5\uff0c\u5f62\u6210filterchain\uff0c\u800c\u591a\u4e2achain\u7528\";\"\u6765\u8fde\u63a5\uff0c\u5f62\u6210fitergraph\u3002</p> <p>\u7b80\u5355\u6ee4\u955c\u683c\u5f0f\u53c2\u6570\u683c\u5f0f -f:v \u6216 -f:a [\u8f93\u5165\u6d41\u6216\u6807\u8bb0\u540d]\u6ee4\u955c\u53c2\u6570[\u4e34\u65f6\u6807\u8bb0\u540d];(\u91cd\u590dn\u4e2a)\u3002\u590d\u6742\u6ee4\u955c\u683c\u5f0f -filter_complex overlay\u6ee4\u955c\u7528\u6765\u8bbe\u7f6e\u663e\u793a\u5c42\u6b21\uff0c\u4f8b\u5982[overlay]filter \u5c06\u8f93\u5165\u663e\u793a\u5728\u53e6\u4e00\u4e2a\u4e0a\u9762\u3002</p>","tags":["ffmpeg"]},{"location":"blog/notes/#_2","title":"\u52a0\u901f","text":"<p>\u4f7f\u7528\u6ee4\u955c\u6765\u52a0\u901f\u64ad\u653e</p>","tags":["ffmpeg"]},{"location":"blog/notes/#_3","title":"\u52a0\u901f\u89c6\u9891","text":"<p>\u4f7f\u7528setpts\u6765\u52a0\u901f\u89c6\u9891 -f:v setpts=0.5*PTS, \u6ce8\u610f\uff1a1\u8c03\u6574\u8303\u56f4[0.25,4]\uff0c\u8d8a\u5c0f\u8d8a\u5feb\uff0c\u4ece\u52a0\u901f4\u500d\u5230\u51cf\u901f4\u500d\u30022\u82e5\u53ea\u662f\u8c03\u6574\u89c6\u9891\u5219\u5c06\u97f3\u9891\u5173\u6389\u30023\u5bf9\u89c6\u9891\u52a0\u901f\u65f6\uff0c\u5982\u679c\u4e0d\u60f3\u4e22\u5e27\uff0c\u5219\u4f7f\u7528-r\u53c2\u6570\u8c03\u6574\u8f93\u51fa\u7684FPS\u3002</p>","tags":["ffmpeg"]},{"location":"blog/notes/#_4","title":"\u52a0\u901f\u97f3\u9891","text":"<p>\u6700\u7b80\u5355\u7684\u65b9\u6cd5\u662f\u8c03\u6574\u91c7\u6837\u7387\uff0c\u4f46\u8fd9\u6837\u4f1a\u6539\u53d8\u97f3\u8272\uff0c\u4e00\u822c\u4f7f\u7528\u5bf9\u539f\u97f3\u8fdb\u884c\u91cd\u91c7\u6837\u3002 -f:a atempo:2.0\u3002\u8303\u56f4 [0.5,2.0]\uff0c\u82e5\u89814\u500d\u52a0\u901f\uff0c\u4f7f\u7528\u6ee4\u955c\u7ec4\u5408 -f:a atempo=2.0,atempo=2</p>","tags":["ffmpeg"]},{"location":"blog/notes/#_5","title":"\u540c\u65f6\u52a0\u901f\u97f3\u9891\u548c\u89c6\u9891","text":"<p>\u53ef\u4ee5\u7528 -filter_complex \"[0:v]setpts=0.5*PTS[v];[0:a]atempo=2.0[a]\" -map [v] -map [a] \u3002\u4e5f\u53ef\u4ee5\u7ec4\u5408\u4f7f\u7528\u4e0a\u9762\u7684\u4e24\u4e2a\u6ee4\u955c\u3002</p>","tags":["ffmpeg"]},{"location":"blog/notes/#_6","title":"\u89c6\u9891\u88c1\u526a","text":"<p>-ss \u9009\u9879seek\uff0c\u4ece\u5f00\u5934\u8df3\u8fc7\u4e00\u6bb5\u7247\u957f\uff0c\u53c2\u6570\u4e24\u79cd\u5f62\u5f0f 00:00:00\u6216\u8005\u79d2\u6570\u3002-ss\u8bbe\u7f6e\u5728\u8f93\u5165\u5bf9\u8c61\u548c\u8f93\u51fa\u5bf9\u8c61\u4e0a\u6709\u4e0d\u540c\u6548\u679c\u3002 * -ss \u6307\u5b9a\u5728\u8f93\u5165\u65f6\uff0c\u4e0d\u4ec5\u53ef\u4ee5\u7528\u4e8e\u590d\u5236\uff0c\u4e5f\u53ef\u4ee5\u7528\u4e8e\u8f6c\u7801\u3002\u5e76\u4e14\u90fd\u662f\u57fa\u4e8e\u5173\u952e\u5e27\u6765\u5bfb\u627e\u4f4d\u7f6e\uff0c\u9ed8\u8ba4\u542f\u7528\u9009\u9879\u201cframe_accurate\" * -ss \u6307\u5b9a\u5728\u8f93\u51fa\u65f6\uff0c\u6e90\u6587\u4ef6\u4f9d\u65e7\u4f1a\u6bcf\u5e27\u90fd\u8981\u89e3\u7801\u5e76\u4e22\u5f03\uff0c\u77e5\u9053\u8df3\u8fc7\u6307\u5b9a\u7684\u65f6\u95f4\u6240\u4ee5\u8981\u7b49\u5f85\u3002\u4f46\u662f-SS\u7528\u5728\u8f93\u51fa\u65f6\uff0c\u6700\u5927\u7684\u4f18\u70b9\u662f\u5f53\u4f7f\u7528\u6ee4\u955c\u65f6\uff0c\u5176timestamp\u4e0d\u4f1a\u91cd\u7f6e0,\u8fd9\u4e2a\u5728\u5f55\u5236\u5b57\u5e55\u65f6\u6709\u7528\uff0c\u4e0d\u9700\u8981\u4fee\u6539\u5b57\u5e55\u7684\u65f6\u95f4\u6233\u3002</p>","tags":["ffmpeg"]},{"location":"blog/notes/#frame_accurate_seek-noaccurate_seek","title":"\u5728\u88c1\u526a\u65f6\u6709\u4e24\u4e2a\u9009\u9879 frame_accurate_seek \u548c -noaccurate_seek \u533a\u522b, \u540e\u8005\u4f1a\u4f7f\u7528\u9644\u8fd1\u7684\u5173\u952e\u5e27\u3002","text":"","tags":["ffmpeg"]},{"location":"blog/notes/#-ss-t-ss-to-ss-10-t-2010s30s-ss-10-to-20-10s20s","title":"-ss -t \u4e0e -ss -to\u7684\u533a\u522b\uff0c-ss 10 -t 20\u8868\u793a\u622a\u53d610s~30s\u7684\u89c6\u9891\uff0c\u800c -ss 10 -to 20 \u8868\u793a\u622a\u53d610s~20s\u7684\u89c6\u9891\u3002","text":"<p>\u622a\u53d6\u89c6\u9891\u4e0d\u51c6\u786e\u95ee\u9898\uff1a * \u5f53\u4f7f\u7528-ss\u548c-c:copy\u65f6\uff0c\u7531\u4e8effmpeg\u5f3a\u5236\u4f7f\u7528I\u5e27\uff0c\u6240\u4ee5\u53ef\u80fd\u8c03\u6574\u8d77\u59cb\u65f6\u95f4\u5230\u8d1f\u503c\uff0c\u5373\u63d0\u524d\u4e8ess\u8bbe\u7f6e\u7684\u65f6\u95f4 * \u4f8b\u5982 -ss 157 \u4f46\u76f4\u5230159\u65f6\u624d\u6709I\u5e27\uff0c\u5b83\u4f1a\u67092\u79d2\u7684\u65f6\u95f4\u53ea\u6709\u58f0\u97f3\u6ca1\u6709\u753b\u9762\u3002 </p>","tags":["ffmpeg"]},{"location":"blog/notes/#_7","title":"\u7f16\u8bd1\u95ee\u9898","text":"<ul> <li>\u7f16\u8bd1ffmpeg\u652f\u6301h265, \u56e0\u4e3ah265\u5e93\u662f\u7528c++\u5199\u7684\uff0c\u6240\u4ee5\u7f16\u8bd1ffmpeg\u65f6\u8981\u52a0\u4e0a\u989d\u5916\u5e93<code>-lstdc++</code></li> <li>\u5982\u679cpc\u6587\u4ef6\u4e0d\u5728\u6807\u51c6\u8def\u5f84\uff0c\u9700\u8981\u4fee\u6539\u73af\u5883\u53d8\u91cf<code>export PKG_CONFIG_PATH=$PKG_CONFIG_PATH:\"pc\u6587\u4ef6\u8def\u5f84\"</code></li> <li>\u5982\u679c\u94fe\u63a5\u5230\u4e86\u52a8\u6001\u5e93\uff0c\u53ef\u4ee5\u4f7f\u7528enable-rpath\u8bbe\u7f6e\u8fd0\u884c\u65f6\u627e\u5e93\u8def\u5f84</li> </ul>","tags":["ffmpeg"]},{"location":"blog/notes/#ffplay","title":"ffplay \u64ad\u653e\u5a92\u4f53\u6587\u4ef6","text":"<ul> <li>\u5728\u89c6\u9891\u4e2d\u63d2\u5165\u5b57\u5e55 <code>ffplay -f:v \"subtitle=input.srt\" input.mp4</code></li> <li>\u97f3\u9891\u53ef\u89c6\u5316 <code>ffplay -showmode 1 input.mp3</code> \u9ed8\u8ba4\u662f0, \u7528\u5085\u7acb\u53f6\u53d8\u6362\u663e\u793a\u58f0\u97f3\u7684\u9891\u7387\u9891\u8c31\uff0c\u5904\u7406\u65f6\u957f\u5dee\u4e0d\u591a\u662f1s\u3002</li> <li>\u89c6\u9891\u663e\u793a\u8fd0\u52a8\u65b9\u5411 <code>ffplay -flags2 +export_mvs  -vf codecview=mv=pf -i input.mp4</code></li> </ul> <p>ffplay \u6307\u5b9a\u89c6\u9891\u663e\u793a\u5927\u5c0f\uff0c\u5f53\u64ad\u653e\u539f\u59cb\u89c6\u9891\u65f6\u5982input.h264\uff0c\u7528-video_size\u6765\u6307\u5b9a\u89c6\u9891\u5927\u5c0f\uff0c\u800c\u975e\u8bbe\u7f6e\u64ad\u653e\u5668\u663e\u793a\u5927\u5c0f\u3002\u5982\u679c\u8981\u63a7\u5236\u64ad\u653e\u5668\u663e\u793a\u5927\u5c0f\u7528 scale/resize\u6ee4\u955c\u3002</p> <p>-s \u9009\u9879\uff0c\u5f53\u7528\u5728\u8f93\u5165\u9009\u9879\u65f6\uff0c\u53ef\u4ee5\u66ff\u4ee3video_size\u3002\u5f53\u7528\u5728\u8f93\u51fa\u9009\u9879\u65f6\uff0c\u53ef\u4ee5\u66ff\u4ee3scale\u6ee4\u955c\uff0c\u4f46\u53ea\u80fd\u4e8efiltergraph\u6700\u540e\u7684filter\uff0c\u82e5\u60f3\u4f5c\u7528\u5728filtergraph\u5176\u5b83\u4f4d\u7f6e\uff0c\u5219\u5fc5\u987b\u663e\u793a\u4f7f\u7528scale\u3002</p>","tags":["ffmpeg"]},{"location":"blog/notes/#ptsdts","title":"\u65f6\u95f4\u6233 PTS/DTS","text":"<p>PTS\u662f\u663e\u793a\u65f6\u95f4\u6233, presentation timestamp \u6307\u8868\u793a\u6e32\u67d3\u7684\u65f6\u95f4\u70b9\uff0c\u800cDTS\u662fDecode timestamp\uff0c\u89e3\u7801\u65f6\u95f4\u6233\uff0c\u8868\u793a\u89e3\u7801\u65f6\u95f4\u70b9\u3002\u56e0\u4e3a\u89c6\u9891\u7684B\u5e27\u8981\u7b49\u5f85\u4e0b\u4e00\u4e2aI\u5e27\uff0c\u6240\u4ee5B\u5e27\u4f1a\u5148\u4fdd\u5b58\u5728\u7f13\u51b2\u533a\u3002 \u5728ffplay\u548cffmpeg \u64ad\u653e/\u8f6c\u7801\u89c6\u9891\u65f6\uff0c\u63a7\u5236\u53f0\u663e\u793a\u4e86tbn\uff0ctbc\uff0ctbr\uff0c \u8fd9\u4e9b\u90fd\u662ftimebase\uff0c\u4e5f\u53eb\u65f6\u95f4\u7cbe\u5ea6\u3002\u6bcf\u6b21\u5904\u7406\u540e\u5f53\u524d\u7684\u65f6\u95f4\u6233\u4f1a\u589e\u52a0\u4e00\u4e2atimebase\u3002 * tbn: timebase of AVstream, \u8868\u793a\u4ece\u5bb9\u5668\u4e2d\u8bfb\u53d6\u7684timestamp\u7684\u589e\u52a0\u4e00\u6b21timebase\u3002  * tbc: timebase of codec, \u8868\u793a\u67d0\u4e2a\u6d41\u7684\u5bf9\u5e94\u7684\u7f16\u7801\u91c7\u7528\u7684\u65f6\u95f4\u57fa\uff0c\u6bcf\u6b21\u89e3\u7801\u90fd\u589e\u52a0\u4e00\u6b21timebase\u3002 50tbc\u65f6\uff0c1S\u670950\u5e27\u3002 * tbr: \u4e00\u5e27\u7684timebase\uff0c\u662f\u9884\u4f30\u503c\u3002 </p>","tags":["ffmpeg"]},{"location":"blog/notes/#ffprobe","title":"ffprobe \u67e5\u770b\u5a92\u4f53\u6587\u4ef6\u4fe1\u606f","text":"<p>\u89c6\u9891\u5206\u6790\u8f6f\u4ef6\u9664\u4e86ffprobe\u8fd8\u6709 mp4info\u3002</p>","tags":["ffmpeg"]},{"location":"blog/notes/#_8","title":"\u76f4\u64ad","text":"<p>\u89c6\u9891\u76f4\u64ad\u6280\u672f\u91cc\uff0c HLS\u548cDASH\u7b49\u5206\u7247\u6280\u672f\u6bd4\u8f83\u6d41\u884c\u3002</p>","tags":["ffmpeg"]},{"location":"blog/notes/#rtp","title":"rtp\u6d41","text":"<p>rtp\u662f\u901a\u4fe1\u8bed\u97f3\u884c\u4e1a\u7684\u5e38\u7528\u534f\u8bae\uff0c\u53ef\u4ee5\u53d1\u9001\u89c6\u9891\u548c\u8bed\u97f3\u4e4b\u4e00\uff0c\u4e0d\u53ef\u4ee5\u540c\u65f6\u53d1\u9001\u89c6\u9891\u548c\u8bed\u97f3\uff0c\u8bed\u97f3\u4e5f\u53ea\u652f\u6301\u5355\u901a\u9053\uff08\u5bf9\u4e8ePCM\u7c7b\u578b\u7684\u8bed\u8a00\u800c\u8a00\uff0c\u800crtp\u652f\u6301OPUS\u53d1\u9001\u591a\u901a\u9053\uff09\u3002rtp\u6709\u591a\u6d41\u540c\u6b65\u673a\u5236\uff0c\u63a5\u6536\u7ec8\u7aef\u53ef\u4ee5\u5c06\u591a\u4e2artp\u6d41\u5408\u5e76\uff0c\u652f\u6301\u7c7b\u4f3cwebrtc\u7684\u4f1a\u8bae\u6a21\u5f0f\uff0crtp\u4e5f\u80fd\u652f\u63015G\u7684\u89c6\u9891\u901a\u8bdd\u3002</p>","tags":["ffmpeg"]},{"location":"blog/notes/#rtpsdp","title":"rtp\u7684sdp","text":"<p>\u5728\u5efa\u7acbrtp\u8fde\u63a5\u4e4b\u524d\uff0c\u4e24\u4e2a\u7ec8\u7aef\u8981\u534f\u5546\u4e00\u4e2a\u4e24\u8fb9\u90fd\u652f\u6301\u7684\u89c6\u9891\u548c\u8bed\u97f3\u7f16\u7801\uff0c\u5426\u5219\u65e0\u6cd5\u5efa\u7acb\u3002 sdp\u5219\u63cf\u8ff0\u4e86ip/\u7aef\u53e3/\u5a92\u4f53\u7f16\u7801\u76f8\u5173\u7684\u4fe1\u606f\uff0c\u8fd9\u4e9b\u4e0d\u80fd\u901a\u8fc7rtp\u534f\u8bae\u6765\u4f20\u9001\uff08in-band\uff09\u3002</p>","tags":["ffmpeg"]},{"location":"blog/notes/#clockrate","title":"clockrate \u65f6\u949f\u9891\u7387","text":"<p>sdp\u4e2d\u7684a\u5c5e\u6027\u6709clok</p>","tags":["ffmpeg"]},{"location":"blog/notes/#ffmpegrtp","title":"ffmpeg\u53d1\u9001\u63a5\u6536rtp","text":"<p>rtp\u5bf9\u4e8effmpeg\u800c\u8a00\u662f\u4e00\u79cd\u5bb9\u5668\uff0c\u4e0e\u5176\u5b83\u7684mp4/avi\u7c7b\u4f3c\uff0c\u4ee3\u7801\u5b9e\u73b0\u4e5f\u540c\u6837\u5728libavformat\u91cc\u3002\u53ea\u662f\u4e0d\u540c\u5728\u4e8e\u524d\u7740\u662f\u5199\u6587\u4ef6\uff0crtp\u5bb9\u5668\u5219\u662f\u53d1\u9001\u7f51\u7edc\u5305\u3002\u4f8b\u5982\u8bfb\u53d6mp4\u6587\u4ef6\u5e76\u53d1\u9001\u97f3\u9891\u7684\u547d\u4ee4<code>ffmpeg -i input.mp4 -vn -ac 1 -f rtp rtp://ip:port</code>\uff0c<code>-vn</code>\u8868\u793a\u4e0d\u53d1\u9001\u89c6\u9891\uff0c<code>-ac 1</code>\u8868\u793a\u5408\u5e76\u97f3\u9891\u591a\u901a\u9053\u4e3a\u5355\u901a\u9053\u3002</p>","tags":["ffmpeg"]},{"location":"blog/notes/#_9","title":"\u5e38\u89c1\u5206\u8fa8\u7387","text":"<p>640x480\uff08480p\uff09\u5206\u8fa8\u7387\u6bd44:3 1280x720\uff08720p HD\uff09 1920x1080(1080p FHD\uff09 3840x2160(4k UHD)</p>","tags":["ffmpeg"]},{"location":"blog/notes/#h264","title":"h264","text":"<p>I/P/B \u4e09\u79cd\u7c7b\u578b\u7684\u5e27: * I\u5e27, Index frame, \u662f\u5b8c\u6574\u7684\u4e00\u5e45\u56fe\u7247\uff0c\u4e0d\u4f9d\u8d56\u5176\u5b83\u5e27\u5c31\u80fd\u89e3\u7801\u663e\u793a\u3002 * P\u5e27, Delta frame, \u662f\u5411\u524d\u5e27\uff0c\u4f9d\u8d56I\u5e27\u6765\u89e3\u7801\u3002\u53ea\u6709\u8fd0\u52a8\u7684\u5bf9\u8c61\uff0c\u800c\u6ca1\u6709\u80cc\u666f\u4fe1\u606f\u3002 * B\u5e27\uff0c Bidirectional pridict picture, B\u5e27\u5219\u4f9d\u8d56P\u5e27\u548c\u4e0b\u4e00\u4e2aI\u5e27\u6765\u89e3\u7801<code>I-&gt;P-&gt;B-&gt;I</code>\uff0c\u6700\u8282\u7701\u5b57\u8282\u3002 \u6240\u4ee5\u89c6\u9891\u79cd\u7684B\u5e27\u8d8a\u591a\uff0c\u89c6\u9891\u6587\u4ef6\u7684\u4f53\u79ef\u8d8a\u5c0f\uff0c\u800c\u89e3\u7801\u7684\u590d\u6742\u5ea6\u8d8a\u9ad8\u3002</p> <p>ffmpeg\u8f6c\u7801h264\u7684\u547d\u4ee4\uff0c<code>ffmpeg -i input.mp4 -av sample-rate -crf {17~23} -b:v video-bitrate -r frame-rate -profile {baseline|main|high}</code> * -av \u6307\u5b9asample rate\u91c7\u6837\u7387 * -crf \u6307\u5b9a\u89c6\u9891\u8d28\u91cf * -b:v video bitrate \u89c6\u9891\u7684\u6bd4\u7279\u7387 * -b:a audio bitrate \u97f3\u9891\u7684\u6bd4\u7279\u7387 * -r frame rate \u6307\u5b9a\u5e27\u7387 * -profile \u6307\u5b9a\u89c6\u9891\u7684\u6863\u6b21 * -level \u6307\u5b9a\u89c6\u9891\u7b49\u7ea7</p> <p>\u4f7f\u7528baseline prfile\u65f6\uff0c\u4e0d\u4f1a\u5305\u542bB\u5e27\uff0c\u5f53\u4f7f\u7528\u5b9e\u65f6\u6d41\u5a92\u4f53\u76f4\u64ad\u65f6\uff0c\u91c7\u7528baseline\u7f16\u7801\u76f8\u5bf9main\u548chigh\u76f8\u5bf9\u53ef\u9760\uff0c\u4f46\u52a0\u5165B\u5e27\u53ef\u4ee5\u51cf\u5c0f\u6bd4\u7279\u7387\u3002</p>","tags":["ffmpeg"]},{"location":"blog/notes/#pi","title":"\u89c6\u9891\u683c\u5f0fP/I","text":"<p>p\u4ee3\u8868progressive\u4ee3\u8868\u9010\u884c\u626b\u63cf\uff0cI\u4ee3\u8868interlaced \u9694\u884c\u626b\u63cf\uff0c\u4f46\u662f\u4e00\u65e6\u89c6\u9891\u635f\u574f\u65f6\uff0c\u89c6\u9891\u51e0\u4e4e\u65e0\u6cd5\u89c2\u770b\u3002</p>","tags":["ffmpeg"]},{"location":"blog/notes/#_10","title":"\u97f3\u89c6\u9891\u540c\u6b65","text":"<p>\u97f3\u9891\u548c\u89c6\u9891\u90fd\u662f\u72ec\u7acb\u7684\u7ebf\u7a0b\u5904\u7406\uff0c\u4e3b\u8981\u901a\u8fc7\u5404\u81eaPTS\u6765\u540c\u6b65\uff0c\u4f46\u5b9e\u9645\u4e0a\u97f3\u89c6\u9891\u5927\u90e8\u5206\u60c5\u51b5\u662f\u4e0d\u540c\u6b65\u7684\uff0c\u5076\u5c14\u662f\u540c\u6b65\u7684\u3002\u5f53\u97f3\u9891\u548c\u89c6\u9891\u65f6\u95f4\u8bef\u5dee\u8d85\u8fc7\u9608\u503c\u65f6\uff0c\u5c31\u4f1a\u53bb\u91cd\u540c\u6b65\u3002\u91cd\u540c\u6b65\u4e3b\u8981\u662f\u8c03\u6574\u89c6\u9891\uff0c\u56e0\u4e3a\u4eba\u773c\u5bf9\u89c6\u9891\u7684\u654f\u611f\u5ea6\u4e0d\u5982\u5bf9\u97f3\u9891\u7684\u654f\u611f\u5ea6\u3002</p>","tags":["ffmpeg"]},{"location":"blog/notes/#ffmpegh264bpsbit-per-second","title":"ffmpeg\u64ad\u653eh264\u65f6\uff0c\u9650\u5236\u6bd4\u7279\u7387\uff08bps,bit per second)","text":"<p>\u89c6\u9891\u7684\u6bd4\u7279\u7387\u5206\u4e3a\u4e24\u4e2a\u7801\u7387\uff0cCBR\u6052\u5b9a\u6bd4\u7279\u7387\uff0cVBR\u6ce2\u52a8\u6bd4\u7279\u7387\u3002\u4e92\u8054\u7f51\u89c6\u9891\u591a\u4e3aVBR\u3002\u5982\u679c\u60f3\u7528CBR\uff0c-b:v \u8bbe\u7f6e\u7f16\u7801\u6bd4\u7279\u7387\uff0c\u4f46\u8fd9\u91cc\u8bbe\u5b9a\u7684\u5e73\u5747\u503c\uff0c\u4e0d\u80fd\u5f88\u597d\u63a7\u5236\u6700\u5927\u548c\u6700\u5c0f\u7801\u7387\u3002\u8981\u63a7\u5236\u6700\u5927\u6700\u5c0f\u6bd4\u7279\u7387\uff0c\u9700\u8981\u7ec4\u5408\u4f7f\u7528 -b:v\uff0cmaxrate\uff0cminrate\u3002\u53e6\u5916\u8fd8\u8981\u8bbe\u7f6ebuff\u6253\u5c0f<code>-bufsize</code>\u3002\u4f8b\u5982: <pre><code>ffmpeg -i input.avi -bo 15M -minrate 0.5M -maxrate 0.5M -bufsize 1M out.mkv\n</code></pre> bufsize \u8bf4\u660e\uff0c\u5982\u679c\u4e0d\u4f7f\u7528bufsize\uff0c\u5176\u53d8\u5316\u8303\u56f4\u5c06\u6bd4\u6211\u4eec\u7684\u9884\u671f\u5927\u5f88\u591a\u3002\u5f53\u8bbe\u7f6ebufsize\u5f88\u5927\u65f6\u6d6e\u52a8\u8303\u56f4\u6bd4\u8f83\u5927\uff0c\u8bbe\u7f6e\u592a\u5c0f\u65f6\uff0c\u4f1a\u5bfc\u81f4\u89c6\u9891\u8d28\u91cf\u964d\u4f4e\u3002\u6700\u5408\u9002\u7684\u5927\u5c0f\u65f6-b:v\u7684\u5927\u5c0f\u4e00\u534a\uff0c\u7136\u540e\u9010\u6e10\u589e\u52a0bufsize\uff0c\u76f4\u5230bitrate\u53d8\u5316\u6bd4\u8f83\u660e\u663e\u65f6\uff0c\u8fd9\u662f\u8d28\u91cf\u6700\u9ad8\u800c\u4e14\u6bd4\u8f83\u6052\u5b9a\u7684\u5927\u5c0f\u3002</p>","tags":["ffmpeg"]},{"location":"blog/notes/#_11","title":"\u901a\u8fc7\u6bd4\u7279\u7387\u6765\u8ba1\u7b97\u6587\u4ef6\u5927\u5c0f\uff1a","text":"<p>\u89c6\u9891\u5927\u5c0f = \u6bd4\u7279\u7387 * time_in_second / 8 \u672a\u538b\u7f29\u97f3\u9891\u5927\u5c0f = \u91c7\u6837\u7387 * \u91c7\u6837\u6df1\u5ea6 * channel\u6570 * time_in_second / 8 \u538b\u7f29\u97f3\u9891\u6587\u4ef6\u5927\u5c0f = \u6bd4\u7279\u7387 * time_in_second /8</p>","tags":["ffmpeg"]},{"location":"blog/notes/#_12","title":"\u56fe\u7247","text":"<p>alpha \u901a\u9053\u662fRGB\u901a\u9053\u5916\u7684\u4e00\u4e2a\u901a\u9053\uff0c\u7528\u6765\u8868\u793a\u50cf\u7d20\u7684\u900f\u660e\u5ea6\uff0c\u662f\u53e6\u4e00\u4e2a\u7ef4\u5ea6\u3002 * \u5f53\u4f7f\u752816bit\u7684\u4f4d\u56fe\u65f6\uff0c\u5bf9\u4e8e\u6bcf\u4e2a\u50cf\u7d205bit\u8868\u793a\u7ea2\uff0c5bite\u8868\u793a\u7eff\uff0c5\u8868\u793a\u84dd\uff0c\u6700\u540e\u4e00\u4e2abit\u8868\u793aalpha\u3002\u6240\u4ee5\u8fd9\u65f6\u53ea\u67091/0\u9009\u62e9\uff0c\u6240\u4ee5\u53ea\u6709\u900f\u660e\u548c\u4e0d\u900f\u660e\u7684\u3002 * \u5f53\u4f7f\u752832bit\u7684\u4f4d\u56fe\u65f6\uff0c8bit\u6765\u8868\u793aalpha\u901a\u9053\uff0c\u5c31\u67090\uff5e255\u4e2a\u503c\u8868\u793a\u4e0d\u540c\u7a0b\u5ea6\u7684\u900f\u660e\u3002\u800calpha\u7684\u503c\u4e0d\u76f4\u63a5\u8868\u793a\u900f\u660e\u5ea6\u800c\u662f\u901a\u8fc7\u4e0eRGB\u4e09\u4e2a\u901a\u9053\u7684\u503c\u76f8\u4e58\uff0c\u8fd9\u6837\u5f97\u9053\u4e86\u663e\u793a\u7684\u503c\u3002</p>","tags":["ffmpeg"]},{"location":"blog/notes/#outline","title":"\u9ad8\u9891\u6d17\u52ab\u4f4e\u9891\u8f6e\u5ed3 outline","text":"<p>\u5728\u5085\u91cc\u53f6\u8fb9\u6362\u4e2d\uff0c\u7528\u4e0d\u540c\u9891\u7387\u76f8\u4f4d\u7684\u6b63\u5f26\u6ce2\uff0c\u53ef\u4ee5\u6a21\u62df\u51fa\u5404\u79cd\u7c7b\u578b\u7684\u4fe1\u53f7\u3002\u5176\u4e2d\u9ad8\u9891\u4fe1\u53f7\u8d8a\u9ad8\uff0c\u8fd8\u539f\u6548\u679c\u8d8a\u597d\u3002</p>","tags":["ffmpeg"]},{"location":"blog/notes/#avframe-avpacket","title":"Avframe \u5b58\u50a8\u4e00\u5e27\u89e3\u7801\u540e\u7684\u50cf\u7d20\u6570\u636e\uff0cAvpacket \u5b58\u50a8\u4e00\u5e27\u538b\u7f29\u7684\u6570\u636e\u3002","text":"","tags":["ffmpeg"]},{"location":"blog/notes/#pcm","title":"\u97f3\u9891pcm","text":"<ul> <li>\u91c7\u6837\uff1a\u662f\u5c06\u97f3\u9891\u6a21\u62df\u4fe1\u53f7\u5b9a\u65f6\u53d6\u503c\uff0c\u5f97\u5230\u4e00\u4e2a\u79bb\u6563\u5e8f\u5217\u3002\u4e3a\u4e86\u80fd\u5c06\u79bb\u6563\u5e8f\u5217\u6062\u590d\u6210\u4e3a\u6a21\u62df\u4fe1\u53f7\u4f9b\u64ad\u653e\u5668\u64ad\u653e\uff0c\u91c7\u6837\u9891\u7387\u8981\u662f\u58f0\u97f3\u9891\u7387\u7684\u81f3\u5c11\u4e24\u500d\u3002\u6240\u4ee5\u82e5\u8981\u91c7\u68371k\u9891\u7387\u7684\u58f0\u97f3\uff0c\u9700\u8981\u75282k\u91c7\u6837\u7387\u3002</li> <li>\u91c7\u6837\u6df1\u5ea6\uff1a\u5355\u4e2a\u91c7\u6837\u7684\u50a8\u5b58\u957f\u5ea6\u3002</li> <li>\u97f3\u9891\u5e27\uff1a\u5355\u4f4d\u65f6\u95f4\u91cc\u7684\u591a\u4e2a\u91c7\u6837\u3002</li> </ul>","tags":["ffmpeg"]},{"location":"blog/notes/#_13","title":"\u6570\u5b66","text":"","tags":["ffmpeg"]},{"location":"blog/notes/#difference-equation-differential-equation","title":"\u5dee\u5206\u548c\u5fae\u5206 difference equation / differential equation","text":"<p>\u5dee\u5206\u662f\u79bb\u6563\uff0c\u5404\u4e2a\u8fde\u7eed\u9879\u4e4b\u95f4\u4e0d\u5b58\u5728\u5176\u5b83\u5143\u7d20\u3002\u4f8b\u59821,2,3,4,5 \u4e0d\u5b58\u57281.1,1.2,1.3\u3002\u800c\u5fae\u5206\u662f\u8fde\u7eed\u7684\uff0c1\u548c2\u4e4b\u95f4\u53ef\u4ee5\u67091.1,1.11,1.12,1.2\u7b49\u3002\u603b\u7ed3\u662f\u5dee\u5206\u662f\u5fae\u5206\u7684\u79bb\u6563\u5316\u3002</p>","tags":["ffmpeg"]},{"location":"blog/notes/#_14","title":"\u4fe1\u53f7\u548c\u7cfb\u7edf","text":"<p>\u79bb\u6563\u5085\u91cc\u53f6\u8fb9\u6362 DFT discret fourier transform\uff0c\u5085\u91cc\u53f6\u53d8\u6362\u51fa\u6765\u7684\u7ed3\u679c\u662f\u590d\u6570=X+YI\uff0cI^2=-1\u3002 \u8c10\u6ce2\u662f\u4ec0\u4e48\uff0c\u4e3a\u4f55\u5085\u91cc\u53f6\u53d8\u6362\u8981\u590d\u6570\uff0c\u56e0\u4e3a\u8868\u793a\u6ce2\u7684\u65b9\u6cd5\u8981\u7528\u5230\u9891\u7387\u548c\u76f8\u4f4d\u8fd8\u6709\u632f\u5e45\u3002  \u590d\u6570\u6a21\u7b49\u4e8e\u632f\u5e45 <code>e^(jwb) = cos(wb) + isin(wb)</code></p> <p>\u6ce2\u7684\u8868\u793a\u65b9\u6cd5\uff1a y=Asin(B(x+C)), A\u632f\u5e45\uff0cB\u9891\u7387\uff0cC\u76f8\u4f4d\u3002</p>","tags":["ffmpeg"]},{"location":"blog/oauth2-%E8%AE%A4%E8%AF%81%E8%AF%B4%E6%98%8E/","title":"oauth2 \u8ba4\u8bc1\u8bf4\u660e","text":"<p>oauth2 \u662f\u4f9d\u8d56\u7b2c\u4e09\u65b9\u7684\u8ba4\u8bc1\u65b9\u5f0f\uff0c \u4f8b\u5982\u73a9\u6e38\u620f\u7684\u65f6\u5019\u5f39\u51faQQ\u767b\u5f55\uff0c\u5fae\u4fe1\u767b\u5f55\u3002 \u8fd9\u79cd\u6e38\u620f\u8fd0\u8425\u5546\u5e76\u4e0d\u9700\u8981\u7528\u6237\u6ce8\u518c\uff0c\u800c\u662f\u76f4\u63a5\u4eceQQ\u6216\u8005\u5fae\u4fe1\u90a3\u91cc\u83b7\u53d6\u7528\u6237\u7684OPENID\uff0c \u7136\u540e\u6e38\u620f\u6e38\u620f\u8fd0\u8425\u5546\u5b58\u50a8\u5e76\u901a\u8fc7OPENID\u6765\u8bc6\u522b\u7528\u6237</p> <p>\u800c\u4e14\uff0c \u6709\u8d44\u8d28\u7684\u6e38\u620f\u8fd0\u8425\u5546\u8fd8\u53ef\u4ee5\u901a\u8fc7\u73a9\u5bb6\u7684openid\u6765\u83b7\u53d6\u7528\u6237\u7684\u4fe1\u606f\uff0c \u4f8b\u5982\u7528\u6237\u7684\u624b\u673a\u53f7\uff0c\u7f51\u540d\uff0c\u5e74\u9f84\u7b49\u4fe1\u606f\u3002 \u4f46<code>\u6709\u8d44\u8d28</code>\u8fd9\u4e2a\u662f\u6709QQ\u548c\u5fae\u4fe1\u6765\u51b3\u5b9a\u7684\uff0c\u6e38\u620f\u8fd0\u8425\u5546\u9700\u8981\u5148\u53bb\u817e\u8baf\u90a3\u91cc\u6ce8\u518c\u8ba4\u8bc1\u3002\u817e\u8baf\u613f\u610f\u7ed9\u6e38\u620f\u8fd0\u8425\u5546\u5206\u4eab\u591a\u5c11\u4fe1\u606f\u662f\u817e\u8baf\u8bf4\u4e86\u7b97\u3002 \u6240\u4ee5\u6709\u7528\u6237\u7684\u6570\u636e\u5728\u624b\uff0c \u817e\u8baf\u7a33\u7a33\u5f53\u56fd\u5185\u8001\u5927</p> <p>\u4ee5QQ\u767b\u5f55\u4e3a\u4f8b\uff0c\u5f53\u73a9\u5bb6\u767b\u5f55\u6e38\u620f\u65f6\uff0c\u6e38\u620f\u8fd0\u8425\u5546\u5148\u8ba9\u7528\u6237\u8bbf\u95eeQQ\u7684auth2\u670d\u52a1\u5668\uff0c\u5e76\u5e26\u4e0a\u6e38\u620f\u8fd0\u8425\u5546\u7684id\u3002\u5f85QQ\u8ba4\u8bc1\u540e\u4f1a\u56de\u8c03\u8fd0\u8425\u5546\u6ce8\u518c\u7684\u56de\u8c03\u63a5\u53e3 \u4e00\u822c\u4e3a<code>oauth/callback</code>\uff0c\u5e76\u4e14\u5e26\u4e0a\u7528\u6237\u7684openid\u3002 \u8fd9\u6837\u6e38\u620f\u8fd0\u8425\u5546\u5c31\u77e5\u9053\u662f\u8c01\u767b\u5f55\u4e86\u3002</p> <p>\u5982\u679c\u6e38\u620f\u8fd0\u8425\u5546\u9700\u8981\u66f4\u591a\u7528\u6237\u8d44\u6599\u65f6\uff0c\u4f8b\u5982\u6ce8\u518c\uff0c \u8fd0\u8425\u5546\u53ef\u4ee5\u901a\u8fc7QQ\u7684\u67e5\u8be2\u63a5\u53e3\uff0c\u5bc6\u94a5\u4ee5\u53ca\u7528\u6237\u7684openid \u53bb\u67e5\u8be2\u3002 \u8fd9\u6837\u5c31\u62c9\u53d6\u5230\u4e86\u7528\u6237\u7684\u4fe1\u606f\u3002 \u7136\u540e\u5982\u679c\u8d44\u6599\u4e0d\u5168\uff0c \u518d\u8ba9\u73a9\u5bb6\u8865\u5145\uff0c\u4f8b\u5982\u8f93\u5165\u8eab\u4efd\u8bc1\u53f7\u3002\u8fd9\u5e94\u8be5\u56fd\u5bb6\u4e0d\u51c6\u817e\u8baf\u5411\u522b\u4eba\u5206\u4eab\u7684\uff0c\u5fc5\u987b\u8981\u7528\u6237\u81ea\u5df1\u8f93\u5165\u3002\u3002</p>","tags":["tool"]},{"location":"blog/oauth2-%E8%AE%A4%E8%AF%81%E8%AF%B4%E6%98%8E/#githuboauth","title":"\u4f7f\u7528github\u7684oauth\u8ba4\u8bc1","text":"<ol> <li> <p>\u5148\u53bbgithub -&gt; developer \u521b\u5efaoauth\u5e94\u7528\uff0c \u8f93\u5165\u81ea\u5df1\u7684\u56de\u8c03\u5730\u5740\u3002 \u5f53\u7528\u6237\u88abgithub\u8ba4\u8bc1\u540e\uff0c\u4f1a\u8c03\u7528\u8fd9\u4e2a\u5730\u5740</p> </li> <li> <p>\u5728\u670d\u52a1\u7aef\u914d\u7f6e\uff0c\u5229\u7528\u4e00\u4e2a\u5f00\u6e90 <code>oauth2_proxy</code>\u5de5\u5177, \u9879\u76ee\u5730\u5740\uff1a</p> </li> </ol> <pre><code>https://github.com/oauth2-proxy/oauth2-proxy\n</code></pre> <ol> <li>\u914d\u7f6enginx</li> </ol>","tags":["tool"]},{"location":"blog/oauth2-%E8%AE%A4%E8%AF%81%E8%AF%B4%E6%98%8E/#oauth2_proxy","title":"\u914d\u7f6e`oauth2_proxy","text":"<p>\u4e4b\u524d\u9047\u5230\u95ee\u9898\uff0c\u4e00\u76f4\u6388\u6743\u4e0d\u6210\u529f\uff0c \u539f\u56e0\u662fcookie_secure \u914d\u6210\u4e86true\uff0c \u5373\u4f7f\u662fhttps\u4e0b\u3002\u539f\u56e0\u672a\u77e5 <pre><code>auth_logging = true\nauth_logging_format = \"{{.Client}} - {{.Username}} [{{.Timestamp}}] [{{.Status}}] {{.Message}}\"\n## pass HTTP Basic Auth, X-Forwarded-User and X-Forwarded-Email information to upstream\npass_basic_auth = true\n# pass_user_headers = true\n## pass the request Host Header to upstream\n## when disabled the upstream Host is used as the Host Header\npass_host_header = true\n## Email Domains to allow authentication for (this authorizes any email on this domain)\n## for more granular authorization use `authenticated_emails_file`\n## To authorize any email addresses use \"*\"\n# email_domains = [\n#     \"yourcompany.com\"\n# ]\nemail_domains=\"*\"\n## The OAuth Client ID, Secret\nprovider=\"github\"\nclient_id = \"cef54714c84e3b0c2248\"\nclient_secret = \"a96d3d94771273b5295202d03c0c2d3ca7f625dc\"\n## Pass OAuth Access token to upstream via \"X-Forwarded-Access-Token\"\npass_access_token = false\n## Authenticated Email Addresses File (one email per line)\n# authenticated_emails_file = \"\"\n## Htpasswd File (optional)\n## Additionally authenticate against a htpasswd file. Entries must be created with \"htpasswd -s\" for SHA encryption\n## enabling exposes a username/login signin form\n# htpasswd_file = \"\"\n## Templates\n## optional directory with custom sign_in.html and error.html\n# custom_templates_dir = \"\"\n## skip SSL checking for HTTPS requests\n# ssl_insecure_skip_verify = false\n## Cookie Settings\n## Name     - the cookie name\n## Secret   - the seed string for secure cookies; should be 16, 24, or 32 bytes\n##            for use with an AES cipher when cookie_refresh or pass_access_token\n##            is set\n## Domain   - (optional) cookie domain to force cookies to (ie: .yourcompany.com)\n## Expire   - (duration) expire timeframe for cookie\n## Refresh  - (duration) refresh the cookie when duration has elapsed after cookie was initially set.\n##            Should be less than cookie_expire; set to 0 to disable.\n##            On refresh, OAuth token is re-validated.\n##            (ie: 1h means tokens are refreshed on request 1hr+ after it was set)\n## Secure   - secure cookies are only sent by the browser of a HTTPS connection (recommended)\n## HttpOnly - httponly cookies are not readable by javascript (recommended)\n# cookie_name = \"_oauth2_proxy\"\ncookie_secret = \"beautyfly\"\ncookie_domains = \"beautyflying.cn\"\ncookie_expire = \"168h\"\n# cookie_refresh = \"\"\ncookie_secure = false\n# cookie_httponly = true\n</code></pre></p> <p>\u53ef\u4ee5\u5c06oauth2 \u914d\u7f6e\u6210\u670d\u52a1</p> <pre><code>[Unit]\nDescription = OAuth2 proxy for www blog\n\n[Service]\nType=simple\nExecStart=/usr/bin/oauth2_proxy -config /etc/oauth2-proxy.cfg\n[Install]\nWantedBy=multi-user.target\n</code></pre>","tags":["tool"]},{"location":"blog/oauth2-%E8%AE%A4%E8%AF%81%E8%AF%B4%E6%98%8E/#nginx","title":"nginx \u914d\u7f6e","text":"<pre><code>    location /oauth2/ {\n            proxy_pass       http://127.0.0.1:4180;\n            proxy_set_header Host                    $host;\n            proxy_set_header X-Real-IP               $remote_addr;\n            proxy_set_header X-Scheme                $scheme;\n            proxy_set_header X-Auth-Request-Redirect $request_uri;\n        # or, if you are handling multiple domains:\n        # proxy_set_header X-Auth-Request-Redirect $scheme://$host$request_uri;\n    }\n\n    location = /oauth2/auth {\n    proxy_pass       http://127.0.0.1:4180;\n    proxy_set_header Host             $host;\n    proxy_set_header X-Real-IP        $remote_addr;\n    proxy_set_header X-Scheme         $scheme;\n    # nginx auth_request includes headers but not body\n    proxy_set_header Content-Length   \"\";\n    proxy_pass_request_body           off;\n    }\n\n    location / {\n\n    auth_request /oauth2/auth;\n    error_page 401 = /oauth2/sign_in;\n\n    # pass information via X-User and X-Email headers to backend,\n    # requires running with --set-xauthrequest flag\n    auth_request_set $user   $upstream_http_x_auth_request_user;\n    auth_request_set $email  $upstream_http_x_auth_request_email;\n    proxy_set_header X-User  $user;\n    proxy_set_header X-Email $email;\n\n    # if you enabled --pass-access-token, this will pass the token to the backend\n    auth_request_set $token  $upstream_http_x_auth_request_access_token;\n    proxy_set_header X-Access-Token $token;\n\n    # if you enabled --cookie-refresh, this is needed for it to work with auth_request\n    auth_request_set $auth_cookie $upstream_http_set_cookie;\n    add_header Set-Cookie $auth_cookie;\n\n    # When using the --set-authorization-header flag, some provider's cookies can exceed the 4kb\n    # limit and so the OAuth2 Proxy splits these into multiple parts.\n    # Nginx normally only copies the first `Set-Cookie` header from the auth_request to the response,\n    # so if your cookies are larger than 4kb, you will need to extract additional cookies manually.\n    auth_request_set $auth_cookie_name_upstream_1 $upstream_cookie_auth_cookie_name_1;\n\n    # Extract the Cookie attributes from the first Set-Cookie header and append them\n    # to the second part ($upstream_cookie_* variables only contain the raw cookie content)\n    if ($auth_cookie ~* \"(; .*)\") {\n        set $auth_cookie_name_0 $auth_cookie;\n        set $auth_cookie_name_1 \"auth_cookie_name_1=$auth_cookie_name_upstream_1$1\";\n    }\n\n    # Send both Set-Cookie headers now if there was a second part\n    if ($auth_cookie_name_upstream_1) {\n        add_header Set-Cookie $auth_cookie_name_0;\n        add_header Set-Cookie $auth_cookie_name_1;\n    }\n\n        root   /usr/share/nginx/html/blog;\n        index  index.html index.htm;\n    }\n\n    #error_page  404              /404.html;\n\n    # redirect server error pages to the static page /50x.html\n    #\n    error_page   500 502 503 504  /50x.html;\n    location = /50x.html {\n        root   /usr/share/nginx/html;\n    }\n</code></pre>","tags":["tool"]},{"location":"blog/oauth2-%E8%AE%A4%E8%AF%81%E8%AF%B4%E6%98%8E/#baidu-oauth","title":"\u4f7f\u7528baidu \u7684oauth \u8ba4\u8bc1","text":"","tags":["tool"]},{"location":"blog/gdb%E4%B8%AD%E6%89%93%E5%8D%B0optarg%E6%B0%B8%E8%BF%9C%E6%98%AF0x0-%E4%BD%86%E6%98%AF%E4%BE%9D%E7%84%B6%E8%83%BD%E4%BC%A0%E9%80%92%E5%8F%82%E6%95%B0/","title":"gdb\u4e2d\u6253\u5370optarg\u6c38\u8fdc\u662f0x0, \u4f46\u662f\u4f9d\u7136\u80fd\u4f20\u9012\u53c2\u6570","text":"","tags":["gdb"]},{"location":"blog/gdb%E4%B8%AD%E6%89%93%E5%8D%B0optarg%E6%B0%B8%E8%BF%9C%E6%98%AF0x0-%E4%BD%86%E6%98%AF%E4%BE%9D%E7%84%B6%E8%83%BD%E4%BC%A0%E9%80%92%E5%8F%82%E6%95%B0/#optarg","title":"\u53d1\u73b0\u4e24\u4e2aoptarg\u4e0d\u76f8\u540c","text":"<pre><code>(gdb) p &amp;optarg\n$7 = (char **) 0x7ffff7fa5840 &lt;optarg&gt;\n(gdb) x/1gx &amp;optarg\n0x7ffff7fa5840 &lt;optarg&gt;:        0x0000000000000000\n(gdb) x/1gx $rip+7+0x2edf    // from disassembly of what *actually* gets passed to printf\n0x555555558040 &lt;optarg@GLIBC_2.2.5&gt;:    0x00007fffffffdf32\n</code></pre>","tags":["gdb"]},{"location":"blog/%E8%83%8C%E5%8C%85%E9%97%AE%E9%A2%98/","title":"\u80cc\u5305\u95ee\u9898","text":"<p>\u6709\u4e00\u4e2a\u627f\u91cd\u4e3aV\u7684\u80cc\u5305\uff0c\u6709N\u4e2a\u7269\u54c1\uff0c\u91cd\u91cf\u5206\u522b\u4e3aCost[i], \u4ef7\u503c\u5206\u522b\u4e3aValue[i], \u95ee\u9009\u62e9\u653e\u54ea\u4e9b\u7269\u54c1\u65f6\u5305\u7684\u4ef7\u503c\u6700\u5927</p>","tags":["\u7b97\u6cd5","dp"]},{"location":"blog/%E8%83%8C%E5%8C%85%E9%97%AE%E9%A2%98/#_2","title":"\u72b6\u6001\u65b9\u7a0b","text":"<p>\u89e3\u51b3\u52a8\u6001\u7f16\u7a0b\u7684\u5173\u952e\u662f\u627e\u5230\u72b6\u6001\u65b9\u7a0b\uff0c\u5982\u4e0b\u3002 \u89e3\u51b3\u80cc\u5305\u95ee\u9898\u5c31\u662f\u6bd4\u8f83<code>\u653e</code>\u4e0e<code>\u4e0d\u653e</code>\u54ea\u4e2a\u4ef7\u503c\u9ad8 <pre><code>F [i, v] \u2190 max{F [i \u2212 1, v], F [i \u2212 1, v \u2212 Ci] + Wi}\n</code></pre></p>","tags":["\u7b97\u6cd5","dp"]},{"location":"blog/%E8%83%8C%E5%8C%85%E9%97%AE%E9%A2%98/#01","title":"01\u80cc\u5305","text":"<p>\u8981\u6c42\u7269\u54c1\u6700\u5927\u4e3a1\u4e2a, \u8fd9\u91cc\u6709\u51e0\u4e2a\u7248\u672c</p> <pre><code>#include &lt;stdio.h&gt;\n#include &lt;sys/param.h&gt;\n\nconst int V = 4, N = 3;\nconst int cost[N] = {1, 3, 4};\nconst int value[N] = {15, 20, 30};\n\n// const int V = 10, N = 5;\n// const int cost[N] = {2, 3, 5, 2, 4};\n// const int value[N] = {2, 2, 1, 1, 2};\n\nvoid O1Package_N() {\n  int dp[N][V + 1];\n\n  // 0\u5bb9\u91cf\u7684\u4ef7\u503c\u4e3a0, \u5408\u6cd5\n  for (int i = 0; i &lt;= V; i++) {\n    dp[0][i] = 0;\n  }\n\n  // \u521d\u59cb\u5316\u5f53\u5305\u627f\u91cd\u5927\u4e8e\u7269\u54c10\u91cd\u91cf\u7684\u60c5\u51b5\n  for (int j = cost[0]; j &lt;= V; j++) {\n    // \u5f53\u53ea\u88c5\u7269\u54c10\u65f6\uff0c\u5305\u7684\u4ef7\u503c\u5c31\u662f\u7269\u54c10\u7684\u4ef7\u503c\n    dp[0][j] = value[0];\n  }\n\n  // \u5148\u904d\u5386\u7269\u54c1\uff0c\u540e\u904d\u5386\u91cd\u91cf\n  for (int i = 1; i &lt; N; i++) {\n    for (int v = 0; v &lt;= V; v++) {\n      // F [i, v] \u2190 max{F [i \u2212 1, v], F [i \u2212 1, v \u2212 Ci] + Wi}\n      // F[i][v] = MAX(F[i - 1][v], F[i - 1][v - cost[i]] + value[i]);\n      int bufang = dp[i - 1][v];\n      dp[i][v] = bufang;\n      if (v &gt;= cost[i]) {\n        int fang = dp[i - 1][v - cost[i]] + value[i];\n        dp[i][v] = MAX(bufang, fang);\n      }\n    }\n  }\n\n  for (int i = 0; i &lt; N; i++) {\n    for (int j = 0; j &lt;= V; j++) {\n      printf(\"%d\\t\", dp[i][j]);\n    }\n    printf(\"\\n\");\n  }\n  printf(\"%d\\n\", dp[N - 1][V]);\n}\n\nvoid O1Package_N_plus_1() {\n\n  int dp[N + 1][V + 1];\n\n  // \u4f7f\u75280\u4e2a\u7269\u54c1\u7684\u4ef7\u503c\u4e3a0\n  for (int i = 0; i &lt;= V; i++) {\n    dp[0][i] = 0;\n  }\n\n  // \u5148\u904d\u5386\u7269\u54c1\uff0c\u540e\u904d\u5386\u91cd\u91cf\n  for (int i = 1; i &lt;= N; i++) {\n    for (int v = 0; v &lt;= V; v++) {\n      dp[i][v] = dp[i - 1][v]; //\u5f53\u91cd\u91cf\u4e0d\u591f\u88c5i\u65f6\uff0c\u4ef7\u503c\u4e3a\u88c5i-1\u7684\u4ef7\u503c,\n                               //\u6b64\u6b65\u9aa4\u4ee5\u5907i+1\u65f6\u4f7f\u7528\uff08\u4e0b\u4e00\u4e2ai\u5faa\u73af\uff09\n      if (v &gt;= cost[i - 1]) {\n        dp[i][v] = MAX(dp[i - 1][v], dp[i - 1][v - cost[i - 1]] + value[i - 1]);\n      }\n    }\n  }\n\n  for (int i = 0; i &lt;= N; i++) {\n    for (int j = 0; j &lt;= V; j++) {\n      printf(\"%d\\t\", dp[i][j]);\n    }\n    printf(\"\\n\");\n  }\n  printf(\"%d\\n\", dp[N][V]);\n}\n\nvoid O1Package_N_plus_1_origin() {\n\n  int dp[N + 1][V + 1];\n\n  // \u4f7f\u75280\u4e2a\u7269\u54c1\u7684\u4ef7\u503c\u4e3a0\n  for (int i = 0; i &lt;= V; i++) {\n    dp[0][i] = 0;\n  }\n\n  // \u5148\u904d\u5386\u7269\u54c1\uff0c\u540e\u904d\u5386\u91cd\u91cf\n  for (int i = 0; i &lt; N; i++) {\n    for (int v = 0; v &lt;= V; v++) {\n      // 1. \u5f53\u7269\u54c1\u5927\u4e8e\u627f\u91cd\uff0c\u7269\u54c1\u4e0d\u4f1a\u653e\u5230\u80cc\u5305\uff0c\u4ef7\u503c\u7b49\u4e8e\u4e0d\u653e\u6b64\u7269\u54c1\u65f6\u7684\u60c5\u51b5\n      // \u5373\u4f7f\u7269\u54c1\u5c0f\u4e8e\u627f\u91cd\uff0c\u8bf4\u660e\u7269\u54c1\u4f1a\u653e\u5230\u80cc\u5305\u3002\u63d0\u524d\u591a\u8d4b\u503c\u4e00\u6b21\u4e5f\u662f\u5141\u8bb8\u7684\n      dp[i + 1][v] = dp[i][v];\n      if (v &gt;= cost[i]) {\n        dp[i + 1][v] = MAX(dp[i][v], dp[i][v - cost[i]] + value[i]);\n      }\n    }\n  }\n\n  for (int i = 0; i &lt;= N; i++) {\n    for (int j = 0; j &lt;= V; j++) {\n      printf(\"%d\\t\", dp[i][j]);\n    }\n    printf(\"\\n\");\n  }\n  printf(\"%d\\n\", dp[N][V]);\n}\n\nvoid O1Package_one_array_n() {\n\n  int dp[V + 1];\n\n  // \u4f7f\u75280\u4e2a\u7269\u54c1\u7684\u4ef7\u503c\u4e3a0\n  for (int i = 0; i &lt;= V; i++) {\n    dp[i] = 0;\n  }\n\n  // \u5148\u904d\u5386\u7269\u54c1\uff0c\u540e\u904d\u5386\u91cd\u91cf\n  for (int i = N - 1; i &gt;= 0; i--) {\n    for (int v = V; v &gt;= cost[i]; v--) {\n      int bufang = dp[v];\n      int fang = dp[v - cost[i]] + value[i];\n      dp[v] = MAX(bufang, fang);\n    }\n  }\n\n  for (int j = 0; j &lt;= V; j++) {\n    printf(\"%d\\t\", dp[j]);\n  }\n  printf(\"\\n\");\n  printf(\"%d\\n\", dp[V]);\n}\n</code></pre>","tags":["\u7b97\u6cd5","dp"]},{"location":"blog/%E8%83%8C%E5%8C%85%E9%97%AE%E9%A2%98/#_3","title":"\u5b8c\u5168\u80cc\u5305","text":"<p>\u8981\u6c42\u7269\u54c1\u53ef\u4ee5\u53d6\u65e0\u9650\u4e2a\uff0c\u4f46\u7531\u4e8e\u5305\u7684\u627f\u91cd\u4e3aV,\u6240\u4ee5\u6bcf\u79cd\u7269\u54c1\u6700\u5927\u6570\u91cf\u4e3a V/cost[i] <pre><code>void CompletePackage_use_n() {\n\n  int dp[N][V + 1];\n\n  // 0\u5bb9\u91cf\u7684\u4ef7\u503c\u4e3a0, \u5408\u6cd5\n  for (int i = 0; i &lt; cost[0]; i++) {\n    dp[0][i] = 0;\n  }\n\n  // \u521d\u59cb\u5316\u5f53\u5305\u627f\u91cd\u5927\u4e8e\u7269\u54c10\u91cd\u91cf\u7684\u60c5\u51b5\n  for (int i = cost[0]; i &lt;= V; i++) {\n    // \u5f53\u53ea\u88c5\u7269\u54c10\u65f6\uff0c\u5305\u7684\u4ef7\u503c\u5c31\u662f\u7269\u54c10\u7684\u4ef7\u503c\n    dp[0][i] = i / cost[0] * value[0];\n  }\n\n  // \u5148\u904d\u5386\u7269\u54c1\uff0c\u540e\u904d\u5386\u91cd\u91cf\n  for (int i = 1; i &lt; N; i++) {\n    for (int v = 0; v &lt;= V; v++) {\n      dp[i][v] = dp[i - 1][v]; //\u5f53\u91cd\u91cf\u4e0d\u591f\u88c5i\u65f6\uff0c\u4ef7\u503c\u4e3a\u88c5i-1\u7684\u4ef7\u503c,\n                               //\u6b64\u6b65\u9aa4\u4ee5\u5907i+1\u65f6\u4f7f\u7528\uff08\u4e0b\u4e00\u4e2ai\u5faa\u73af\uff09\n      for (int k = 1; k &lt;= v / cost[i]; k++) {\n        dp[i][v] = MAX(dp[i - 1][v], dp[i - 1][v - k * cost[i]] + k * value[i]);\n      }\n    }\n  }\n\n  for (int i = 0; i &lt; N; i++) {\n    for (int j = 0; j &lt;= V; j++) {\n      printf(\"%d\\t\", dp[i][j]);\n    }\n    printf(\"\\n\");\n  }\n  printf(\"%d\\n\", dp[N - 1][V]);\n}\n\nvoid CompletePackage_use_n_plus_1() {\n\n  int dp[N + 1][V + 1];\n\n  // 0\u5bb9\u91cf\u7684\u4ef7\u503c\u4e3a0, \u5408\u6cd5\n  for (int i = 0; i &lt;= V; i++) {\n    dp[0][i] = 0;\n  }\n\n  // \u5148\u904d\u5386\u7269\u54c1\uff0c\u540e\u904d\u5386\u91cd\u91cf\n  for (int i = 1; i &lt;= N; i++) {\n    for (int v = 0; v &lt;= V; v++) {\n      dp[i][v] = dp[i - 1][v]; //\u5f53\u91cd\u91cf\u4e0d\u591f\u88c5i\u65f6\uff0c\u4ef7\u503c\u4e3a\u88c5i-1\u7684\u4ef7\u503c,\n                               //\u6b64\u6b65\u9aa4\u4ee5\u5907i+1\u65f6\u4f7f\u7528\uff08\u4e0b\u4e00\u4e2ai\u5faa\u73af\uff09\n      for (int k = 1; k &lt;= v / cost[i-1]; k++) {\n        dp[i][v] = MAX(dp[i - 1][v], dp[i - 1][v - k * cost[i-1]] + k * value[i-1]);\n      }\n    }\n  }\n\n  for (int i = 0; i &lt;= N; i++) {\n    for (int j = 0; j &lt;= V; j++) {\n      printf(\"%d\\t\", dp[i][j]);\n    }\n    printf(\"\\n\");\n  }\n  printf(\"%d\\n\", dp[N][V]);\n}\n\nvoid CompletePackage_use_one_array_no_reverse_V() {\n\n  int dp[V + 1];\n\n  // 0\u5bb9\u91cf\u7684\u4ef7\u503c\u4e3a0, \u5408\u6cd5\n  for (int i = 0; i &lt;= V; i++) {\n    dp[i] = 0;\n  }\n\n  // \u5148\u904d\u5386\u7269\u54c1\uff0c\u540e\u904d\u5386\u91cd\u91cf\n  for (int i = 1; i &lt;= N; i++) {\n    for (int v = 0; v &lt;= V; v++) {\n      for (int k = 1; k &lt;= v / cost[i-1]; k++) {\n        dp[v] = MAX(dp[v], dp[v - k * cost[i-1]] + k * value[i-1]);\n      }\n    }\n  }\n\n  for (int j = 0; j &lt;= V; j++) {\n    printf(\"%d\\t\", dp[j]);\n  }\n  printf(\"\\n\");\n  printf(\"%d\\n\", dp[V]);\n}\n\nvoid CompletePackage_use_one_array_reverse_V() {\n\n  int dp[V + 1];\n\n  // 0\u5bb9\u91cf\u7684\u4ef7\u503c\u4e3a0, \u5408\u6cd5\n  for (int i = 0; i &lt;= V; i++) {\n    dp[i] = 0;\n  }\n\n  // \u5148\u904d\u5386\u7269\u54c1\uff0c\u540e\u904d\u5386\u91cd\u91cf\n  for (int i = 1; i &lt;= N; i++) {\n    for (int v = V; v &lt;= cost[i-1]; v--) {\n      for (int k = 1; k &lt;= v / cost[i-1]; k++) {\n        dp[v] = MAX(dp[v], dp[v - k * cost[i-1]] + k * value[i-1]);\n      }\n    }\n  }\n\n  for (int j = 0; j &lt;= V; j++) {\n    printf(\"%d\\t\", dp[j]);\n  }\n  printf(\"\\n\");\n  printf(\"%d\\n\", dp[V]);\n}\n</code></pre></p>","tags":["\u7b97\u6cd5","dp"]},{"location":"blog/%E8%83%8C%E5%8C%85%E9%97%AE%E9%A2%98/#_4","title":"\u591a\u91cd\u80cc\u5305","text":"<p>\u591a\u91cd\u80cc\u5305\u89c4\u5b9a\u4e86\u6bcf\u4e2a\u7269\u54c1\u7684\u6700\u5927\u6570\u91cfcap[i], \u4f46\u7531\u4e8e\u8981\u8003\u8651\u80cc\u5305\u627f\u91cd\uff0c\u6240\u4ee5\u771f\u6b63\u53ef\u4ee5\u5bb9\u7eb3\u7269\u54c1\u7684\u6700\u5927\u4e2a\u6570\u662fmax\uff08cap[i], V/cost[i])</p>","tags":["\u7b97\u6cd5","dp"]},{"location":"blog/%E8%83%8C%E5%8C%85%E9%97%AE%E9%A2%98/#_5","title":"\u7591\u95ee","text":"","tags":["\u7b97\u6cd5","dp"]},{"location":"blog/%E8%83%8C%E5%8C%85%E9%97%AE%E9%A2%98/#_6","title":"\u4e3a\u4f55\u4e0d\u9700\u8981\u5c06\u80cc\u5305\u6392\u5e8f\uff0c \u6bd4\u5982\u6309\u91cd\u91cf\u6392\u5e8f\u6216\u6309\u4ef7\u503c\u6392\u5e8f\uff0c\u518d\u5c06\u91cd\u91cf\u4e0b\u800c\u4ef7\u503c\u9ad8\u7684\u7269\u54c1\u4f18\u5148\u8ba1\u7b97\uff1f","text":"<p>\u5373\u4f7f\u6ca1\u6709\u6392\u5e8f\uff0c\u7531\u4e8e\u7b2c\u4e8c\u5c42\u5faa\u73af\u90fd\u662f\u4ece<code>0-&gt;V</code>\u904d\u5386\u548c\u653e\u7269\u54c1i\u4e0e\u4e0d\u653e\u7269\u54c1i\u6bd4\u8f83\uff0c\u6240\u4ee5\u987a\u5e8f\u4e0d\u91cd\u8981 <pre><code>  for (int i = 1; i &lt; N; i++) {\n    for (int v = 0; v &lt;= V; v++) {\n      int bufang = dp[i - 1][v];\n      dp[i][v] = bufang;\n      if (v &gt;= cost[i]) {\n        int fang = dp[i - 1][v - cost[i]] + value[i];\n        dp[i][v] = MAX(bufang, fang);\n      }\n    }\n  }\n</code></pre></p>","tags":["\u7b97\u6cd5","dp"]},{"location":"blog/%E8%83%8C%E5%8C%85%E9%97%AE%E9%A2%98/#_7","title":"\u7b97\u6cd5\u590d\u6742\u5ea6\u548c\u4f18\u5316","text":"<p>\u77e9\u9635\u6570\u7ec4\u7684\u65f6\u95f4\u590d\u6742\u5ea6\u4e3aO(VN),\u5373\u4e24\u5c42for\u5faa\u73af\uff1b\u7a7a\u95f4\u590d\u6742\u5ea6\u4e3aO(VN) \u5373\u7533\u8bf7\u4e00\u4e2a\u77e9\u5f62\u6570\u7ec4\uff0c\u7ecf\u8fc7\u4e00\u5143\u6570\u7ec4\u4f18\u5316\u540e\uff0c\u7a7a\u95f4\u590d\u6742\u5ea6\u53d8\u4e3aO(V) \u9664\u6b64\u4e4b\u5916\uff0c \u5927\u591a\u60c5\u51b5\u4e0b\uff0c\u901a\u8fc7\u4e24\u5c42\u904d\u5386\uff0c\u53ef\u4ee5\u53ea\u4fdd\u7559\u91cd\u91cf\u76f8\u540c\u4e14\u4ef7\u503c\u6700\u5927\u7684\u90a3\u4e2a\u7269\u54c1\uff0c\u8fd9\u4e2a\u64cd\u4f5c\u7684\u65f6\u95f4\u590d\u6742\u5ea6\u4e3aO(N^2), \u4f46\u5f53\u6700\u7cdf\u7cd5\u7684\u60c5\u51b5\uff0c\u5373\u7cbe\u5fc3\u8bbe\u8ba1\u7684\u7269\u54c1\u6ca1\u6709\u76f8\u540c\u91cd\u91cf\u6216\u8005\u76f8\u540c\u4ef7\u503c\u7684\u60c5\u51b5\u5219\u6b64\u4f18\u5316\u65e0\u6548 \u53e6\u5916\uff0c\u5148\u52a0\u7269\u54c1\u91cd\u91cf\u5927\u4e8e\u80cc\u5305\u91cd\u91cf\u7684\u7269\u54c1\u5ffd\u7565\uff0c\u53ef\u4ee5\u52a0\u5feb\u901f\u5ea6</p>","tags":["\u7b97\u6cd5","dp"]},{"location":"blog/%E8%83%8C%E5%8C%85%E9%97%AE%E9%A2%98/#_8","title":"\u7406\u89e3\u4f18\u5316","text":"<p>\u65e0\u8bba\u662f\u7528\u77e9\u9635\u6570\u7ec4\u8fd8\u662f\u4f18\u5316\u6210\u4e00\u5143\u6570\u7ec4\uff0c\u6700\u597d\u7684\u7406\u89e3\u65b9\u5f0f\u662f\u5355\u6b65\u8c03\u8bd5\u4e00\u904d</p>","tags":["\u7b97\u6cd5","dp"]},{"location":"blog/%E8%83%8C%E5%8C%85%E9%97%AE%E9%A2%98/#nn1","title":"N\u884c\u4e0eN+1\u884c","text":"<p>\u4e24\u79cd\u65b9\u5f0f\u53ef\u4ee5\u901a\u7528\uff0c\u53ea\u662f\u5f53N\u884c\u65f6\uff0c\u9700\u8981\u63d0\u524d\u521d\u59cb\u5316\u7269\u54c10\u7684\u60c5\u51b5</p>","tags":["\u7b97\u6cd5","dp"]},{"location":"blog/%E8%83%8C%E5%8C%85%E9%97%AE%E9%A2%98/#_9","title":"\u521d\u59cb\u5316\u95ee\u9898","text":"<p>\u6211\u4eec\u770b\u5230\u7684\u6c42\u6700\u4f18\u89e3\u7684\u80cc\u5305\u95ee\u9898\u9898\u76ee\u4e2d\uff0c\u4e8b\u5b9e\u4e0a\u6709\u4e24\u79cd\u4e0d\u592a\u76f8\u540c\u7684\u95ee\u6cd5\u3002\u6709\u7684\u9898\u76ee\u8981\u6c42\u201c\u6070\u597d\u88c5\u6ee1\u80cc\u5305\u201d\u65f6\u7684\u6700\u4f18\u89e3\uff0c\u6709\u7684\u9898\u76ee\u5219\u5e76\u6ca1\u6709\u8981\u6c42\u5fc5\u987b\u628a\u80cc\u5305\u88c5\u6ee1\u3002\u4e00\u79cd\u533a\u522b\u8fd9\u4e24\u79cd\u95ee\u6cd5\u7684\u5b9e\u73b0\u65b9\u6cd5\u662f\u5728\u521d\u59cb\u5316\u7684\u65f6\u5019\u6709\u6240\u4e0d\u540c\u3002</p> <p>\u5982\u679c\u662f\u7b2c\u4e00\u79cd\u95ee\u6cd5\uff0c\u8981\u6c42\u6070\u597d\u88c5\u6ee1\u80cc\u5305\uff0c\u90a3\u4e48\u5728\u521d\u59cb\u5316\u65f6\u9664\u4e86 F[0] \u4e3a 0\uff0c\u5176\u5b83F[1..V ] \u5747\u8bbe\u4e3a \u2212\u221e\uff0c\u8fd9\u6837\u5c31\u53ef\u4ee5\u4fdd\u8bc1\u6700\u7ec8\u5f97\u5230\u7684 F[V ] \u662f\u4e00\u79cd\u6070\u597d\u88c5\u6ee1\u80cc\u5305\u7684\u6700\u4f18\u89e3\u3002 \u5982\u679c\u5e76\u6ca1\u6709\u8981\u6c42\u5fc5\u987b\u628a\u80cc\u5305\u88c5\u6ee1\uff0c\u800c\u662f\u53ea\u5e0c\u671b\u4ef7\u683c\u5c3d\u91cf\u5927\uff0c\u521d\u59cb\u5316\u65f6\u5e94\u8be5\u5c06 F[0..V ]\u5168\u90e8\u8bbe\u4e3a 0\u3002</p> <p>\u8fd9\u662f\u4e3a\u4ec0\u4e48\u5462\uff1f\u53ef\u4ee5\u8fd9\u6837\u7406\u89e3\uff1a\u521d\u59cb\u5316\u7684 F \u6570\u7ec4\u4e8b\u5b9e\u4e0a\u5c31\u662f\u5728\u6ca1\u6709\u4efb\u4f55\u7269\u54c1\u53ef\u4ee5\u653e\u5165\u80cc\u5305\u65f6\u7684\u5408\u6cd5\u72b6\u6001\u3002\u5982\u679c\u8981\u6c42\u80cc\u5305\u6070\u597d\u88c5\u6ee1\uff0c\u90a3\u4e48\u6b64\u65f6\u53ea\u6709\u5bb9\u91cf\u4e3a 0 \u7684\u80cc\u5305\u53ef\u4ee5\u5728\u4ec0\u4e48\u4e5f\u4e0d\u88c5\u4e14\u4ef7\u503c\u4e3a 0 \u7684\u60c5\u51b5\u4e0b\u88ab\u201c\u6070\u597d\u88c5\u6ee1\u201d\uff0c\u5176\u5b83\u5bb9\u91cf\u7684\u80cc\u5305\u5747\u6ca1\u6709\u5408\u6cd5\u7684\u89e3\uff0c\u5c5e\u4e8e\u672a\u5b9a\u4e49\u7684\u72b6\u6001\uff0c\u5e94\u8be5\u88ab\u8d4b\u503c\u4e3a -\u221e \u4e86\u3002\u5982\u679c\u80cc\u5305\u5e76\u975e\u5fc5\u987b\u88ab\u88c5\u6ee1\uff0c\u90a3\u4e48\u4efb\u4f55\u5bb9\u91cf\u7684\u80cc\u5305\u90fd\u6709\u4e00\u4e2a\u5408\u6cd5\u89e3\u201c\u4ec0\u4e48\u90fd\u4e0d\u88c5\u201d\uff0c\u8fd9\u4e2a\u89e3\u7684\u4ef7\u503c\u4e3a 0\uff0c\u6240\u4ee5\u521d\u59cb\u65f6\u72b6\u6001\u7684\u503c\u4e5f\u5c31\u5168\u90e8\u4e3a 0\u4e86\u3002</p>","tags":["\u7b97\u6cd5","dp"]},{"location":"blog/%E8%83%8C%E5%8C%85%E9%97%AE%E9%A2%98/#_10","title":"\u8d2a\u5fc3\u7b97\u6cd5","text":"<p>\u7531\u4e8e\u80cc\u5305\u95ee\u9898\u91cc\u7684\u7269\u54c1\u5177\u5907\u91cd\u91cf\u548c\u4ef7\u503c\u4e24\u4e2a\u7ef4\u5ea6\uff0c\u6240\u4ee5\u65e0\u6cd5\u7528\u8d2a\u5fc3\u7b97\u6cd5\u89e3\u51b3\u3002\u800c\u5f53\u7ef4\u5ea6\u4e3a1\u7684\u65f6\u5019\uff0c\u53ef\u4ee5\u7528\u8d2a\u5fc3\u7b97\u6cd5\uff0c\u4f8b\u5982<sub>~\u96f6\u94b1\u95ee\u9898</sub>~\u548c\u4f1a\u8bae\u5b89\u6392\u95ee\u9898\uff0c\u56e0\u4e3a\u4e0d\u540c\u96f6\u94b1\u4ef7\u503c\u4e0d\u540c\u4f46\u5176\u201c\u91cd\u91cf\u201d\u90fd\u4e3a1\uff0c\u4f1a\u8bae\u7684\u201c\u91cd\u91cf\u201d\u4e5f\u4e3a1 \u6ce8: leetcode\u4e0a\u7684\u96f6\u94b1\u95ee\u9898\u4e0d\u80fd\u7528\u8d2a\u5fc3\u7b97\u6cd5</p>","tags":["\u7b97\u6cd5","dp"]},{"location":"blog/%E8%83%8C%E5%8C%85%E9%97%AE%E9%A2%98/#_11","title":"\u53c2\u8003","text":"<p>\u300a\u80cc\u5305\u95ee\u9898\u4e5d\u8bb2\u300b</p>","tags":["\u7b97\u6cd5","dp"]},{"location":"blog/pci-passthrough/","title":"pci passthrough","text":"<p>Linux\u4e2d\u53ef\u4ee5\u5c06\u786c\u4ef6\u5206\u914d\u7ed9\u865a\u62df\u673a\u72ec\u5360\u4f7f\u7528\uff0c\u6216\u8005\u7ed9\u5e94\u7528\u72ec\u5360\uff08dpdk\uff09\uff0c\u6b64\u65f6\u5185\u6838\u4e0d\u8d1f\u8d23\u8be5\u786c\u4ef6\u3002\u8fd9\u6d89\u53ca\u4e00\u7cfb\u5217\u4e1c\u897f\uff08\u5185\u6838\u9a71\u52a8\u5378\u8f7d\uff0cvfio, iommu\u7b49\uff09</p>","tags":["dpdk","pve","linux"]},{"location":"blog/pci-passthrough/#dpdk","title":"dpdk","text":"<p>\u5bf9\u4e8e\u652f\u6301vfio\uff08\u652f\u6301\u6216\u4e0d\u652f\u6301iommu\uff09\u7684\u4e3b\u673a\uff0cdpdk\u6216\u8005\u5bbf\u4e3b\u673a\u53ef\u4ee5\u7ed1\u5b9avfio\u9a71\u52a8\u3002\u9664\u6b64\u4e4b\u5916dpdk\u8fd8\u652f\u6301uio\u3002</p>","tags":["dpdk","pve","linux"]},{"location":"blog/pci-passthrough/#sr-iov","title":"sr-iov \u57fa\u4e8e\u786c\u4ef6\u865a\u62df\u5316","text":"<p>\u7ed1\u5b9avfio-pci\u9a71\u52a8\u540e\uff0c\u53ef\u4ee5\u652f\u6301\u4e00\u4e9b\u786c\u4ef6offload\u529f\u80fd</p>","tags":["dpdk","pve","linux"]},{"location":"blog/pci-passthrough/#iommu-dma","title":"IOMMU \u662f DMA \u7684\u8fdb\u5316","text":"<p>\u5f53CPU\u8981\u8bfb\u53d6\u5916\u8bbe\u7684\u6570\u636e\u65f6\uff0c\u53d1\u5185\u5b58\u4f20\u8f93\u6307\u4ee4\uff0c\u7531DMA\u6267\u884c\uff0c\u6b64\u65f6cpu\u53ef\u4ee5\u505a\u522b\u7684\u4e8b\u60c5\u3002\u800cDMA\u662f\u76f4\u63a5\u5185\u5b58\u6620\u5c04\uff0c\u9700\u8981\u8fde\u7eed\u7684\u7a7a\u95f4\u6765\u652f\u6301\u5927\u5757\u7684\u5185\u5b58\uff0c\u800cIOMMU\u5219\u4e0d\u9700\u8981\uff0c\u800c\u4e14\u8fd8\u80fd\u652f\u6301\u7533\u8bf7\u6bd4\u7cfb\u7edf\u5bfb\u5740\u80fd\u529b\u66f4\u5927\u7684\u5185\u5b58\uff0c\uff08\u4f8b\u598232\u4f4d\u53ea\u80fd\u652f\u63014G\uff0c IOMMU\u80fd\u652f\u63014G\u4ee5\u4e0a\uff09\u3002 \u4f46IOMMU\u9700\u8981\u786c\u4ef6\u652f\u6301\u7684\u529f\u80fd\uff0cintel vt-d \u548c amd amd-vi\u652f\u6301iommu\uff0c\u4f46arm\u4e0d\u652f\u6301\u3002</p> <p></p>","tags":["dpdk","pve","linux"]},{"location":"blog/pci-passthrough/#reference","title":"reference","text":"<p>https://pve.proxmox.com/wiki/PCI(e)_Passthrough https://doc.dpdk.org/guides/linux_gsg/linux_drivers.html#vfio-noiommu https://en.wikipedia.org/wiki/Input%E2%80%93output_memory_management_unit</p>","tags":["dpdk","pve","linux"]},{"location":"blog/%E4%B9%90%E8%A7%82%E9%94%81%E6%82%B2%E8%A7%82%E9%94%81/","title":"\u4e50\u89c2\u9501\u60b2\u89c2\u9501","text":"<p>\u5148\u8bf4\u8fd9\u4e24\u79cd\u9501\u90fd\u4e0d\u662f\u7f16\u7a0b\u91cc\u9762\u7528\u5230\u7684\u9501\uff0c \u800c\u662f\u4e00\u79cd\u7b56\u7565\u3002 \u5728\u6570\u636e\u5e93\u4e2d\u7528\u7684\u591a\u3002 \u800c\u4e14\u5728java\u91cc\u9762\u6709\u4e2a\u539f\u5b50bool AtomicBoolean \u7684\u5b9e\u73b0\u4e5f\u7528\u5230\u4e50\u89c2\u9501\u7684\u7b56\u7565\uff0c <code>AtomicBoolean::compareandswap</code> </p> <p>\u8fd9\u91cc\u4ee5\u6570\u636e\u5e93\u7ba1\u7406\u670d\u52a1\uff08DBMS\uff09\u6765\u8bf4\u660e\u8fd9\u4e24\u79cd\u9501\u7684\u533a\u522b\uff0c\u5728\u5e76\u53d1\u7684\u60c5\u51b5\u4e0b</p>","tags":["c","cpp","lock"]},{"location":"blog/%E4%B9%90%E8%A7%82%E9%94%81%E6%82%B2%E8%A7%82%E9%94%81/#_2","title":"\u60b2\u89c2\u9501","text":"<p>\u60b2\u89c2\u9501\u7b56\u7565\u9884\u671f\u662f\u591a\u4e2a\u8bf7\u6c42\u4f1a\u64cd\u4f5c\u540c\u4e00\u4e2a\u6570\u636e\uff0c\u5bfc\u81f4\u6570\u636e\u4e0d\u53ef\u9760\u3002 \u60b2\u89c2\u9501\u7684\u7b56\u7565\u5c31\u662f\u4e0a\u9501\uff0c\u4e0d\u8ba9\u5176\u5b83\u8bf7\u6c42\u4fee\u6539\uff0c \u5373\u6392\u4ed6\u9501\u3002</p> <p>\u8fd9\u79cd\u6392\u4ed6\u9501\u4e0e\u6211\u4eec\u5e73\u5e38\u7f16\u7a0b\u7528\u7684\u4e92\u65a5\u9501\u9053\u7406\u76f8\u540c\uff0c \u662f\u6027\u80fd\u6bd4\u8f83\u4f4e\u7684\u4e00\u79cd\u9501\uff0c\u4f46\u80fd\u4fdd\u8bc1\u6570\u636e\u51c6\u786e\u3002</p>","tags":["c","cpp","lock"]},{"location":"blog/%E4%B9%90%E8%A7%82%E9%94%81%E6%82%B2%E8%A7%82%E9%94%81/#_3","title":"\u4e50\u89c2\u9501","text":"<p>\u4e50\u89c2\u9501\u5b9e\u9645\u662f\u4e0d\u4e0a\u9501\uff0c \u9884\u671f\u591a\u4e2a\u8bf7\u6c42\u4e0d\u4f1a\u4fee\u6539\u540c\u4e00\u5206\u6570\u636e\u3002\u800c\u662f\u5728\u6700\u540e\u63d0\u4ea4\u7684\u65f6\u5019\u518d\u53bb\u786e\u8ba4\u6570\u636e\u662f\u5426\u4e00\u81f4\uff0c\u5982\u679c\u4e00\u81f4\u5219\u63d0\u4ea4\uff0c\u5982\u679c\u4e0d\u4e00\u81f4\u5219\u62a5\u9519\uff0c\u9700\u8981\u8ba4\u4e3a\u5e72\u6d89</p> <p>\u6240\u4ee5\u4e50\u89c2\u9501\u7684\u6570\u636e\u4e5f\u662f\u53ef\u9760\u7684\uff0c \u4e14\u6027\u80fd\u8f83\u597d\u3002 \u8fd9\u91cc\u5173\u952e\u662f\u5982\u4f55\u786e\u8ba4\u6570\u636e\u4e00\u81f4  </p>","tags":["c","cpp","lock"]},{"location":"blog/%E4%B9%90%E8%A7%82%E9%94%81%E6%82%B2%E8%A7%82%E9%94%81/#_4","title":"\u4e50\u89c2\u9501\u7684\u786e\u8ba4\u5e76\u63d0\u4ea4","text":"<p>\u8fd9\u91cc\u4e3e\u4f8bsql\u7684\u6765\u8bf4\u660e </p> <p><pre><code>select quanity from items where id =1;\n\n//\u5f97\u5230quanity=3\uff0c\u7136\u540e\u66f4\u65b0\n\nupdate items set quantity=2 where id=2 and quantity=3\n</code></pre> \u66f4\u65b0\u65f6\uff0c\u4f1a\u786e\u8ba4quantity\u4e3a\u9884\u671f\u76843\uff0c\u5426\u5219\u4e0d\u6267\u884c\u6216\u8005\u62a5\u9519\u3002</p> <p>\u8fd9\u6837\u6709\u4e2a\u95ee\u9898\uff0c \u867d\u7136\u5355\u6761\u8bed\u53e5\u662f\u539f\u5b50\u7684\uff0c\u4f46\u662f\u4e24\u6761\u8bed\u53e5\u4e0d\u662f\uff0c \u4f1a\u51fa\u73b0ABA\u7684\u60c5\u51b5</p> <p>\u4f8b\u5982\u5f53\u4e00\u4e2a\u8bf7\u6c421\u6267\u884c\u5230select\u540e\uff0c\u5f97\u77e5<code>quantity=3</code>\uff0c \u7136\u540e\u8bf7\u6c422\u5148\u66f4\u65b0quantity=2\uff0c\u7136\u540e\u53c8\u66f4\u65b0\u4e3aquantity=3  \u7136\u540e\u8bf7\u6c421\u7ee7\u7eed\u6267\u884cupdate\uff0c\u8fd9\u4f1a\u6210\u529f\uff0c\u867d\u7136quantity=3\u662f\u4e00\u81f4\u7684\uff0c\u4f46\u662f\u4e0d\u80fd\u4fdd\u8bc1\u5176\u5b83\u6570\u636e\u662f\u4e00\u81f4\u7684\u6216\u8005\u5b8c\u5168\u6ca1\u6709\u5f15\u8d77\u5b89\u5168\u95ee\u9898</p> <p>\u56e0\u6b64\u53e6\u4e00\u79cd\u529e\u6cd5\u662f\u5224\u65ad\u53ea\u589eversion\u6216\u8005timestamp\uff0c\u6bcf\u6b21\u8bf7\u6c42\u65f6\u53bb\u66f4\u65b0\u3002\u8fd9\u4e24\u79cd\u529e\u6cd5\u90fd\u80fd\u786e\u4fdd\u6570\u636e\u4e00\u81f4\u3002 \u4f46\u662f\u56e0\u4e3a\u6570\u636e\u5e93\u540c\u65f6\u53ea\u5141\u8bb8\u4e00\u4e2a\u8bf7\u6c42\u4fee\u6539version\uff0c\u90a3\u4e48\u5c31\u51fa\u73b0\u4e86\u7ade\u4e89\u60c5\u51b5\uff0c\u4f1a\u5bfc\u81f4\u5176\u5b83\u8bf7\u6c42\u5931\u8d25</p> <p>\u4f8b\u5982\u591a\u4e2a\u8bf7\u6c42\u540c\u65f6\u8bb0\u5f55\u4e86version=1, \u5219\u5f53\u4e00\u4e2a\u8bf7\u6c42\u5b8c\u6210\u7684\u65f6\u5019\uff0cversion=2\uff0c \u90a3\u4e48\u5176\u5b83\u8bf7\u6c42\u63d0\u4ea4\u65f6\u53d1\u73b0verison\u53d8\u4e86\uff0c\u53ea\u80fd\u62a5\u544a\u5931\u8d25 \u867d\u7136\u8fd9\u6837\u80fd\u4fdd\u8bc1\u6570\u636e\u6b63\u786e\uff0c\u4f46\u662f\u4f1a\u5bfc\u81f4\u5176\u5b83\u8bf7\u6c42\u5931\u8d25</p> <p>\u800c\u7535\u5546\u5e73\u53f0\u4e2d\uff0c \u5219\u91c7\u7528\u53e6\u4e00\u79cd\u65b9\u5f0f\u786e\u8ba4</p> <pre><code>select quanity from items where id =1;\n\n//\u5f97\u5230quanity=3\uff0c\u7136\u540e\u66f4\u65b0\n\nupdate items set quantity=2 where id=2 and quantity &gt; 0\n</code></pre> <p>\u8fd9\u6837\u5c31\u89c4\u907f\u4e86\u4e0a\u9762\u4e24\u4e2a\u65b9\u6cd5\u7684\u7f3a\u70b9</p>","tags":["c","cpp","lock"]},{"location":"blog/%E4%B9%90%E8%A7%82%E9%94%81%E6%82%B2%E8%A7%82%E9%94%81/#compareandswap","title":"compareandswap","text":"<pre><code>compareAndSet(expect_val, new_val)\n</code></pre> <p>\u4e0a\u9762\u7684\u4e50\u89c2\u9501\u5c31\u662fcompareandswap\u7684\u89e3\u91ca\uff1a</p> <p>\u5148\u5bf9\u6bd4\uff0c\u5982\u679c\u4e00\u81f4\u5219\u66f4\u65b0</p> <p>\u518d\u8bf4\u4e00\u4e0bjava\u7684\u5b9e\u73b0, <pre><code>    UNSAFE_ENTRY(jboolean, Unsafe_CompareAndSwapInt(JNIEnv *env, jobject unsafe, jobject obj, jlong offset, jint e, jint x))  \n      UnsafeWrapper(\"Unsafe_CompareAndSwapInt\");  \n      oop p = JNIHandles::resolve(obj);  \n      jint* addr = (jint *) index_oop_from_field_offset_long(p, offset);  \n      return (jint)(Atomic::cmpxchg(x, addr, e)) == e;  \n    UNSAFE_END  \n</code></pre></p> <p>\u5728unsafe.cpp \u627e\u5230\u5b9e\u73b0\u5982\u4e0b</p> <p><pre><code>#define LOCK_IF_MP(mp) __asm cmp mp, 0 \\\n__asm je L0 \\\n__asm _emit 0xF0 \\\n__asm L0:\n\nint mp = os::is_MP();\n__asm {\nmov edx, dest\nmov ecx, exchange_value\nmov eax, compare_value\nLOCK_IF_MP(mp)\ncmpxchg dword ptr [edx], ecx\n}\n</code></pre> _emit \u662f\u7528\u4e8e\u751f\u6210\u6307\u4ee4\u7684\uff0c \u751f\u6210\u9501\u7684\u6307\u4ee4\uff0c\u6709cpu\u63d0\u4f9b\u9501\u673a\u5236 \u4ece\u4e0a\u4e0b\u6587\u770b\uff0c \u8fd9\u4e2a\u6307\u4ee4\u5e94\u8be5\u662f\u4e0a\u9501\uff0c \u5982\u679cmp != 0 \u5219\u4e0a\u9501\u3002 </p>","tags":["c","cpp","lock"]},{"location":"blog/c%E8%AF%AD%E8%A8%80%E4%B8%ADpointer%E5%92%8Carray%E7%9A%84%E5%8C%BA%E5%88%AB/","title":"c\u8bed\u8a00\u4e2dpointer\u548carray\u7684\u533a\u522b","text":"<p>\u5728stackoverflow\u4e0a\u641c\u5230\u4e00\u4e2a\u6709\u8da3\u5e16\u5b50 \u8ba8\u8bba\u4e86\u6307\u9488\u89e3\u5f15\u7528\u548c\u6570\u7ec4\u4e0b\u6807\u8bbf\u95ee\u7684\u533a\u522b\uff0c\u800c\u6839\u672c\u539f\u56e0\u5c31\u662f<code>\u6307\u9488\u6709\u65f6\u4e0d\u540c\u4e8e\u6570\u7ec4</code>\uff0c\u8fd9\u662f\u300ac\u4e13\u5bb6\u7f16\u7a0b\u300b\u6709\u4ed4\u7ec6\u8ba8\u8bba\u7684\uff0c\u6545\u518d\u770b\u4e86\u4e00\u904d</p>","tags":["c"]},{"location":"blog/c%E8%AF%AD%E8%A8%80%E4%B8%ADpointer%E5%92%8Carray%E7%9A%84%E5%8C%BA%E5%88%AB/#_1","title":"\u95ee\u9898","text":"<p>\u5e16\u5b50\u7684\u95ee\u9898\u53ef\u4ee5\u7528<code>\u7c7b\u578b\u4e0d\u540c</code>\u548c<code>\u6307\u9488\u5728extern\u58f0\u660e\u65f6\u4e0d\u540c\u4e8e\u6570\u7ec4</code>\u6765\u76f4\u63a5\u4e86\u5f53\u5730\u89e3\u91ca\u3002\u800c\u7c7b\u578b\u4e0d\u5339\u914d\u5982\u4f55\u5bfc\u81f4\u7a0b\u5e8f\u5d29\u6e83\u7684\u5462</p> <pre><code>//file file1.c\n\nint a[2] = {800, 801};\nint b[2] = {100, 101};\n</code></pre> <pre><code>//file file2.c\n\nextern int a[2];\n\n// here b is declared as pointer,\n// although the external unit defines it as an array\nextern int *b; \n\nint main() {\n\n  int x1, x2;\n\n  x1 = a[1]; // ok\n  x2 = b[1]; // crash at runtime, segment fault\n\n  return 0;\n}\n</code></pre> <p>\u5f53\u58f0\u660e\u4e3a<code>extern \u6570\u7ec4</code>\u65f6\uff0c\u7f16\u8bd1\u540e\u7b26\u53f7\u8868\u4fdd\u5b58\u4e86\u6570\u7ec4\u7684\u5730\u5740\uff0c\u90a3\u4e48a[1]\u89e3\u5f15\u7528\u53ea\u662f\u5728\u6570\u7ec4\u5730\u5740\u4e0a\u52a0\u504f\u79fb\u91cf<code>a+1</code>\u5f97\u5230\u65b0\u5730\u5740\uff0c\u7136\u540e\u53d6\u65b0\u5730\u5740\u7684\u5185\u5bb9\uff0c\u6240\u4ee5\u6570\u7ec4\u7684\u5730\u5740\u63d0\u524d\u53ef\u77e5 \u5f53\u58f0\u660e\u4e3a<code>extern \u6307\u9488</code>\u65f6\uff0c\u7f16\u8bd1\u540e\u7b26\u53f7\u8868\u4fdd\u5b58\u7684\u662f\u7b26\u53f7b\uff0c\u8ba9\u7f16\u8bd1\u5668\u4ee5\u6307\u9488\u7684\u65b9\u5f0f\u5904\u7406b\uff0c\u6240\u4ee5b\u662f\u4e00\u4e2a\u6307\u9488\uff0c\u5176\u6307\u9488\u5730\u5740\u88ab\u8d4b\u503c\u4e3a\u6570\u7ec4\u7684\u5185\u5bb9\uff08101100\uff09\u3002\u5728\u8fd0\u884c\u65f6\uff0c\u5148\u53d6\u51fab\u7684\u5730\u5740\u4e3a\uff08101100\uff09\uff0c \u518d\u52a0\u4e0a\u504f\u79fb\u91cf\u5f97\u5230\u65b0\u5730\u5740(101101), \u6700\u540e\u8bbf\u95ee\u8fd9\u4e2a\u975e\u6cd5\u5730\u5740\u5bfc\u81f4\u5d29\u6e83</p> <p>\u56e0\u4e3a\u5f53\u58f0\u660e\u4e3a<code>extern int *b</code>\u65f6\uff0c\u5728file1\u4e2d\u7684b\u5e94\u8be5\u662f\u5b58\u653e\u4e00\u4e2a\u5185\u5b58\u5730\u5740\u800c\u5b9e\u9645\u5b58\u653e\u7684\u662f\u6570\u7ec4\u5185\u5bb9\uff0c\u5c31\u5bfc\u81f4\u7a0b\u5e8f\u628a\u6570\u7ec4\u7684\u5185\u5bb9\u5f53\u5730\u5740\u8bbf\u95ee\u3002</p>","tags":["c"]},{"location":"blog/c%E8%AF%AD%E8%A8%80%E4%B8%ADpointer%E5%92%8Carray%E7%9A%84%E5%8C%BA%E5%88%AB/#_2","title":"\u6253\u5370\u6307\u9488\u5730\u5740","text":"<p>\u5982\u679c\u5728coredump\u4e4b\u524d\uff0c\u5148\u6253\u5370b\u7684\u5730\u5740\uff0c\u5f97\u5230\u7684\u662fb\u6570\u7ec4\u7684\u503c\u4e3a'0x6500000064', \u6b63\u597d\u6307\u9488\u957f\u5ea6\u662f\u4e24\u4e2aint\u4e4b\u548c\u3002\u6240\u4ee5file2\u4e2d\u628a\u6570\u7ec4\u5185\u5bb9\u5f53\u6210\u4e86\u6307\u9488\u5730\u5740\uff0c\u7136\u540e\u504f\u79fb\u4e00\u4e2aint\u957f\u5ea6\u540e\uff0c\u5730\u5740\u662f'0x6500000068', \u7136\u540e\u8fd9\u4e2a\u65e0\u6548\u5730\u5740\u5bfc\u81f4\u6bb5\u9519\u8bef\u3002 <pre><code>printf(\"%p\\n\", (void*)b);\n</code></pre></p>","tags":["c"]},{"location":"blog/c%E8%AF%AD%E8%A8%80%E4%B8%ADpointer%E5%92%8Carray%E7%9A%84%E5%8C%BA%E5%88%AB/#_3","title":"\u4ece\u6c47\u7f16\u89d2\u5ea6\u770b\u8fd9\u4e2a\u95ee\u9898","text":"<p>b\u5b58\u653e\u7684\u662f\u5185\u5bb9\uff0c\u800c\u7a0b\u5e8f\u4ee5\u4e3a\u662f\u5730\u5740\u3002\u56e0\u4e3a\u5b9e\u9645\u4e0a\u7f16\u8bd1\u5668\u4e0d\u4f1a\u4e3a\u6570\u7ec4\u989d\u5916\u5206\u914d\u7a7a\u95f4\u6765\u5b58\u50a8\u6307\u9488, \u4f46\u662f\u8981\u4e3a\u6307\u9488\u5206\u914d\u7a7a\u95f4\u3002 <pre><code>int main() {\n    int *a = 0;\n    int b[4];\n    *b = 0;\n    // \u4e3a\u4e86\u663e\u793a\u6808\u5927\u5c0f\n    foo();\n}\n</code></pre> \u4ece\u6c47\u7f16\u4ee3\u7801\u53ef\u89c1\uff0c\u5206\u914d\u4e8632\u4e2a\u5b57\u8282\u7684\u7a7a\u95f4\uff0c\u6307\u94888 + 4*4 =  <pre><code>        sub     rsp, 32\n        mov     QWORD PTR -8[rbp], 0\n        mov     DWORD PTR -32[rbp], 0\n</code></pre></p>","tags":["c"]},{"location":"blog/c%E8%AF%AD%E8%A8%80%E4%B8%ADpointer%E5%92%8Carray%E7%9A%84%E5%8C%BA%E5%88%AB/#_4","title":"\u5f31\u7b26\u53f7","text":"","tags":["c"]},{"location":"blog/%E6%8C%87%E6%95%B0%E5%92%8C%E5%AF%B9%E6%95%B0/","title":"\u6307\u6570\u548c\u5bf9\u6570","text":"","tags":["math"]},{"location":"blog/%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80%E4%B8%AD%E5%B0%8F%E6%95%B0%E7%B2%BE%E5%BA%A6%E9%97%AE%E9%A2%98/","title":"\u7f16\u7a0b\u8bed\u8a00\u4e2d\u5c0f\u6570\u7cbe\u5ea6\u95ee\u9898","text":"<p>\u8ba1\u7b97\u673a\u4f7f\u75282\u8fdb\u5236\u5b58\u50a8\u6570\u636e\uff0c\u800c2\u8fdb\u5236\u53ef\u4ee5\u8868\u793a\u6240\u6709\u768410\u8fdb\u5236\u6574\u6570\uff0c\u8fd9\u6837\u5728\u6574\u6570\u8303\u56f4\u5185\u4e0d\u5b58\u5728\u95ee\u9898\uff0c\u4f46\u5bfc\u81f4\u5c0f\u6570\u7684\u7cbe\u5ea6\u4e0d\u591f\u3002</p> <p>\u4f8b\u5982\u8868\u793a\u6574\u6570\u65f6\uff0c\u4e8c\u8fdb\u5236\u4e0d\u5b58\u5728\u95ee\u9898:  |\u5341\u8fdb\u5236|\u4e8c\u8fdb\u5236| |--|--| |0| 0| |1|2^0| |2|2^1| |3|2^2 + 2^1|</p> <p>\u800c\u8868\u793a\u5c0f\u6570\u65f6\uff0c\u4e8c\u8fdb\u5236\u53ea\u80fd\u67090.5, 0.25, 0.125...\u3002 |\u4e8c\u8fdb\u5236|\u5341\u8fdb\u5236| |--|--| |2^-1| 0.5| |2^-2|0.25| |2^-3|0.125|</p> <p>\u6240\u4ee5\u4e8c\u8fdb\u5236\u8868\u793a10\u8fdb\u5236\u7684\u5c0f\u6570\u9897\u7c92\u6bd4\u8f83\u5927\uff0c\u82e5\u60f3\u8868\u793a0.6: \u5c31\u8981\u4f7f\u7528<code>\u4e8c\u8fdb\u5236\u5c0f\u6570</code> <code>*</code> <code>2^n</code>\u6765\u8868\u793a\uff0c\u6709\u4e9b\u6570\u59cb\u7ec8\u65e0\u6cd5\u76f8\u7b49</p>","tags":["c"]},{"location":"blog/%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80%E4%B8%AD%E5%B0%8F%E6%95%B0%E7%B2%BE%E5%BA%A6%E9%97%AE%E9%A2%98/#_2","title":"\u6d6e\u70b9\u578b\u548c\u53cc\u7cbe\u5ea6","text":"<p>\u8ba1\u7b97\u673a\u663e\u7136\u6ca1\u6709\u65e0\u7a77\u5927\u7684\u4f4d\u7f6e\u6765\u5b58\u50a8\u201d\u9ad8\u9636\u7684X\u201c\uff0c\u53ea\u80fd\u6298\u8877\u4e00\u4e0b\u3002\u6545\u5728c/c++\u4e2d\uff0c\u6709\u4e24\u79cd\u7c7b\u578b\u6765\u8868\u793a\u5c0f\u6570\uff0c\u5bf9\u5e94\u4e0d\u540c\u7cbe\u5ea6:   \u5185\u5b58\u5206\u5e03\uff0c\u4e24\u79cd\u7c7b\u578b\u7684\u5185\u5b58\u5206\u5e03\u90fd\u4e3a: \u7b26\u53f7\u4f4d(sign)+\u504f\u79fb\u4f4d(exponent)+\u5c3e\u6570\u4f4d(mantissa)\uff0c \u5176\u503c\u5219\u4e3a (-1)^sign * mantissa * 2^exponent</p>","tags":["c"]},{"location":"blog/%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80%E4%B8%AD%E5%B0%8F%E6%95%B0%E7%B2%BE%E5%BA%A6%E9%97%AE%E9%A2%98/#float","title":"float: \u6d6e\u70b9\u7c7b\u578b","text":"<p>\u5360\u75284\u5b57\u8282\uff0832\u4f4d\uff09\uff0c\u7cbe\u5ea6\u4e3a10^-6, \u5373\u7b2c7\u4f4d\u5c0f\u6570\u5f00\u59cb\u53ef\u80fd\u56db\u820d\u4e94\u5165\u6216\u8005\u76f4\u63a5\u5ffd\u7565</p> <p>\u5185\u5b58\u5206\u5e03\uff1a \u7b2c\u4e00\u4f4d\u662f\u7b26\u53f7\u4f4d\uff0c\u540e8\u4f4d\u4e3a\u504f\u79fb\u4f4d\uff0c\u6700\u540e23\u4f4d\u4e3a\u5c3e\u6570\u4f4d\uff0c\u5219\u670923+1\u4f4d\u6765\u8868\u793a\u5c0f\u6570\uff0c10^7 &lt; 2^23+1 &lt; 10^8\uff0c\u6240\u4ee5\u53ef\u4ee5\u7cbe\u786e\u5230\u7b2c7\u4f4d\uff0c \u4f46\u6700\u540e\u4ee5\u4e3a\u53ef\u80fd\u4f1a4\u56db\u820d\u4e94\u5165\uff0c\u7cbe\u786e\u5230\u7b2c6\u4f4d</p>","tags":["c"]},{"location":"blog/%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80%E4%B8%AD%E5%B0%8F%E6%95%B0%E7%B2%BE%E5%BA%A6%E9%97%AE%E9%A2%98/#double","title":"double: \u53cc\u7cbe\u5ea6\u7c7b\u578b","text":"<p>\u5360\u75288\u5b57\u8282\uff0864\u4f4d\uff09\uff0c\u7cbe\u5ea6\u4e3a10^-15, \u5373\u7b2c16\u4f4d\u5c0f\u6570\u5f00\u59cb\u53ef\u80fd\u56db\u820d\u4e94\u5165\u6216\u8005\u76f4\u63a5\u5ffd\u7565</p> <p>\u5185\u5b58\u5206\u5e03\uff1a \u7b2c\u4e00\u4f4d\u662f\u7b26\u53f7\u4f4d\uff0c\u540e11\u4f4d\u4e3a\u504f\u79fb\u4f4d\uff0c\u6700\u540e52\u4f4d\u4e3a\u5c3e\u6570\u4f4d\uff0c\u5219\u670952+1\u4f4d\u6765\u8868\u793a\u5c0f\u6570\uff0c10^16 &lt; 2^52+1 &lt; 10^17\uff0c\u6240\u4ee5\u53ef\u4ee5\u7cbe\u786e\u5230\u7b2c16\u4f4d\uff0c \u4f46\u6700\u540e\u4ee5\u4e3a\u53ef\u80fd\u4f1a4\u56db\u820d\u4e94\u5165\uff0c\u7cbe\u786e\u5230\u7b2c15\u4f4d</p>","tags":["c"]},{"location":"blog/%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80%E4%B8%AD%E5%B0%8F%E6%95%B0%E7%B2%BE%E5%BA%A6%E9%97%AE%E9%A2%98/#_3","title":"\u8ba1\u7b97\u95ee\u9898","text":"<p>\u7531\u4e8e\u7cbe\u5ea6\u95ee\u9898\uff0c\u7cbe\u5ea6\u4e4b\u5916\u7684\u5c0f\u6570\u5c31\u4f1a\u88ab\u5ffd\u7565\u6389\uff0c\u5bfc\u81f4\u51fa\u73b0\u4e0b\u9762\u7684\u76f8\u7b49 </p> <p><pre><code>double i = 0.1;\ndouble j = 0.2;\ni+j == 0.3 + 4e-17;// \u540e\u9762\u7684\u6570\u88ab\u5ffd\u7565\u4e86\n</code></pre> \u6ce8\u610f\u5982\u679c\u8981\u4f7f\u7528float\u7c7b\u578b\uff0c\u9700\u8981\u663e\u5f0f\u4f7f\u7528'0.1f', \u56e0\u4e3a\u9ed8\u8ba4\u4ee5double\u5904\u7406  </p>","tags":["c"]},{"location":"blog/%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80%E4%B8%AD%E5%B0%8F%E6%95%B0%E7%B2%BE%E5%BA%A6%E9%97%AE%E9%A2%98/#_4","title":"\u5982\u4f55\u6bd4\u8f83\u4e24\u4e2a\u6d6e\u70b9\u6570","text":"<p>\u6d6e\u70b9\u6570\u6bd4\u8f83\u4e0d\u53ef\u80fd100%\u6b63\u786e\uff0c\u4f46\u4e0b\u9762\u90fd\u662f\u9519\u7684 <pre><code>float a = 0.15 + 0.15\nfloat b = 0.1 + 0.2\nif(a == b) // can be false!\nif(a &gt;= b) // can also be false!\nif( Math.abs(a-b) &lt; 0.00001) // wrong - don't do this\nif( Math.abs((a-b)/b) &lt; 0.00001 ) // still not right!\n</code></pre></p> <p>\u4e0b\u9762\u7684\u624d\u662f\u5927\u90e8\u5206\u6b63\u786e <pre><code>float absA = fabs(a);\nfloat absB = fabs(b);\nfloat diff = fabs(a - b);\nif (a == b) { // shortcut, handles infinities\n    return true;\n} else if (a == 0 || b == 0 || (absA + absB &lt; 1e-16)) {\n            // a or b is zero or both are extremely close to it\n            // relative error is less meaningful here\n    return diff &lt; (epsilon * Float.MIN_NORMAL);\n} else { // use relative error\n    return diff / Math.min((absA + absB), Float.MAX_VALUE) &lt; epsilon;\n}\n</code></pre></p> <p>\u4f46\u5982\u679c\u77e5\u9053\u7cbe\u5ea6\uff0c\u76f4\u63a5\u5c06\u5176\u4e58\u4ee510^n\u53d8\u6210\u6574\u6570\u6765\u6bd4\u8f83\u662f\u6700\u4f73\u7684\u65b9\u6cd5</p>","tags":["c"]},{"location":"blog/pve%E5%85%A5%E9%97%A8/","title":"pve\u5165\u95e8","text":"","tags":["pve"]},{"location":"blog/pve%E5%85%A5%E9%97%A8/#lxc","title":"lxc \u914d\u7f6e","text":"<p>pve\u4f7f\u7528lxc\u6765\u8fd0\u884c\u5bb9\u5668\u800c\u4e0d\u662fdocker\u3002 docker\u5bf9\u5e94\u7684\u201c\u955c\u50cf\u201d\u6982\u5ff5\u5728pve\u91cc\u53eb<code>\u6a21\u677f(template)</code>\uff0c\u9ed8\u8ba4\u7684pve\u5bb9\u5668\u6a21\u677f\u662f\u4ece\u5b98\u7f51\u4e0b\u8f7d\uff0c\u975e\u5e38\u6162\uff0c\u53ef\u4ee5\u66ff\u6362\u6210\u6e05\u534e\u6e90\u3002\u53e6\u5916\u5728\u6a21\u677f\u5217\u8868\u91cc\u9762\u7684\u6a21\u677f\u90fd\u662f\u6bd4\u8f83\u65b0\u7684\uff0c\u8001\u7248\u672c\u53ef\u4ee5\u4e0a\u6e05\u534e\u6e90\u4e0a\u627e\uff0c\u4f8b\u5982centos7\uff0c\u7136\u540e\u901a\u8fc7url\u6765\u4e0a\u4f20\uff0c\u600e\u6837\u90fd\u975e\u5e38\u65b9\u4fbf\u3002</p>","tags":["pve"]},{"location":"blog/pve%E5%85%A5%E9%97%A8/#_1","title":"\u5bb9\u5668\u7f51\u7edc\u95ee\u9898","text":"<p>\u6709\u7684\u5bb9\u5668\u6a21\u677f\u6ca1\u6709\u5b89\u88c5\u7ea2\u5e3d\u7684NetworkManger\uff0c\u8fd9\u5bfc\u81f4\u521b\u5efa\u5bb9\u5668\u65f6\u9009\u62e9\u7684DHCP\u7f51\u5361\u914d\u7f6e\u4e0d\u4f1a\u751f\u6548\uff0c\u5373\u4f7f\u7ed9\u7f51\u5361\u8bbe\u7f6e\u9759\u6001ip\u4e5f\u4e0d\u884c\u3002\u6709\u4e2a\u89e3\u51b3\u529e\u6cd5\u662f\u542f\u52a8\u540e\u518d\u52a0\u4e00\u4e2a\u9759\u6001ip\u7684\u7f51\u5361\uff0c\u8fd9\u6837\u5bb9\u5668\u5c31\u6709\u7f51\u7edc\u8bbf\u95ee\u6743\u9650\u4e86\uff0c\u7136\u540e\u8d76\u7d27\u5b89\u88c5NetworkManger\u5427\u3002</p>","tags":["pve"]},{"location":"blog/pve%E5%85%A5%E9%97%A8/#console","title":"\u4f4e\u7248\u672c\u5bb9\u5668\u542f\u52a8\u4e0d\u80fd\u8fdb\u5165console\u7684\u95ee\u9898","text":"<p>\u5982\u679csystemd\u7684\u7248\u672c\u4f4e\u4e8e232\uff0c\u542f\u52a8\u5bb9\u5668\u65f6pve\u63d0\u793a:WARN: old systemd (&lt; v232) detected, container won't run in a pure cgroupv2 environment! \u4e5f\u6253\u4e0d\u5f00\u63a7\u5236\u53f0\uff0c\u53ea\u80fd\u901a\u8fc7\u5728\u5bbf\u4e3b\u673a\u4e0a\u6267\u884c <code>pct enter id</code>\u6765\u8fdb\u5165\u5bb9\u5668\u3002\u7f51\u4e0a\u6709\u5e16\u5b50\u8bf4\u5728\u5bb9\u5668\u91cc\u9762\u6267\u884c\u8f6f\u4ef6\u66f4\u65b0\u540e\uff0c\u53ef\u4ee5\u6062\u590d\uff0c\u4e5f\u8bb8\u662fsystemd\u7248\u672c\u66f4\u65b0\u4e86\uff0c\u4f46\u662f\u8fd9\u4e2a\u65b9\u6cd5\u4e0d\u9002\u7528\u4e8ecentos7\u3002\u6700\u540e\u53ea\u80fd\u901a\u8fc7\u4fee\u6539\u5bbf\u4e3b\u673a\u7684grub\uff0c\u4fee\u6539\u542f\u52a8\u53c2\u6570: <pre><code>#/etc/default/grub\nGRUB_CMDLINE_LINUX_DEFAULT=\"systemd.unified_cgroup_hierarchy=0 quiet\"\n</code></pre> \u518d\u6267\u884c<code>update-grub</code>\u547d\u4ee4\uff0c\u6700\u540e\u91cd\u542f\u5bbf\u4e3b\u673a\u540e\u95ee\u9898\u89e3\u51b3\u3002</p>","tags":["pve"]},{"location":"blog/pve%E5%85%A5%E9%97%A8/#_2","title":"\u4f4e\u7248\u672c\u5bb9\u5668\u95ee\u9898","text":"<p>pve\u7684\u5bb9\u5668ENTERPOINT\u90fd\u662f<code>/sbin/init</code>\uff0c\u8ddf\u6211\u73b0\u5728\u516c\u53f8\u7684\u7ba1\u7406docker\u65b9\u5f0f\u76f8\u540c\u3002 \u4f1a\u542f\u52a8systemd\uff0c\u5305\u62ecsshd\u7b49\uff0c\u5bf9\u4e8e\u8fdc\u7a0b\u8bbf\u95ee\u975e\u5e38\u65b9\u4fbf\u3002\u4f46\u662f\u7248\u672c\u4f4e\u7684\u5bb9\u5668\u542f\u52a8\u65f6\u4e0d\u4ec5\u65e0\u6cd5\u8fdb\u5165\u63a7\u5236\u53f0\uff0c\u800c\u4e14\u4e0d\u4f1a\u542f\u52a8systemd\u3002\u624b\u52a8\u4f7f\u7528systemctl\u542f\u52a8sshd\u65f6\u4f1a\u5931\u8d25\uff0c\u56e0\u4e3adbus\u6ca1\u6709\u542f\u52a8\uff0c\u800c\u542f\u52a8dbus\u4e5f\u5931\u8d25\u3002\u603b\u4e4b\u65b0\u7248\u672c\u5bb9\u5668\u5c31\u4e0d\u4f1a\u6709\u8fd9\u4e2a\u95ee\u9898\uff0c\u603b\u4e4b\u8981\u914d\u7f6e\u542f\u52a8\u53c2\u6570\u3002</p> <p>\u5bf9\u4e8e\u901a\u8fc7/sbin/init\u6765\u542f\u52a8sshd\u7684\u65b9\u5f0f\u503c\u5f97\u8ba8\u8bba\uff0c\u56e0\u4e3a\u901a\u8fc7\u5728Dockerfile\u4e2d\u8bbe\u7f6e<code>ENTRYPOINT service ssh restart &amp;&amp; bash</code>\u4e5f\u53ef\u4ee5\u6709\u76f8\u540c\u7684\u6548\u679c\u3002\u800c\u516c\u53f8\u7684\u5927\u91cf\u5bb9\u5668\u90fd\u542f\u52a8systemd\u65f6\uff0c\u4f1a\u542f\u52a8udev\u670d\u52a1\uff0c\u8fd9\u65f6\u786c\u4ef6\u6545\u969c\uff0c\u76f4\u63a5\u5bfc\u81f4\u5bbf\u4e3b\u673a\u5361\u6b7b\u3002</p>","tags":["pve"]},{"location":"blog/pve%E5%85%A5%E9%97%A8/#map-directory-to-lxc-container","title":"map directory to lxc container","text":"<p>pct set 110 -mp0 /srv/music,mp=/srv/music</p>","tags":["pve"]},{"location":"blog/pve%E5%85%A5%E9%97%A8/#_3","title":"\u865a\u62df\u673a\u914d\u7f6e\u58f0\u97f3","text":"<p>\u6211\u5b89\u88c5\u8fc7\u4e00\u4e2awin7\u7684\u865a\u62df\u673a\u4f5c\u4e3a\u6d4b\u8bd5\u73af\u5883\u7528\uff0c\u800c\u4e14\u9700\u8981\u4f7f\u7528\u97f3\u9891\uff0c\u5728\u6dfb\u52a0\u97f3\u9891\u7f51\u5361\u65f6\uff0c\u4f7f\u7528\u4e86SPICE\u9a71\u52a8\uff0c\u4f1a\u5bfc\u81f4\u865a\u62df\u673a\u65e0\u6cd5\u542f\u52a8\uff0c\u5fc5\u987b\u5c06\u663e\u793a\u5668\u7684\u9a71\u52a8\u4e5f\u6539\u6210SPICE\u3002\u7136\u800c\u6211\u4f7f\u7528remmina\u6765\u8fdc\u7a0b\u8bbf\u95ee\u8fd9\u4e2a\u865a\u62df\u673a\uff0c\u542c\u4e0d\u5230\u58f0\u97f3\u3002 \u6700\u540e\u5c06\u97f3\u9891\u9a71\u52a8\u6539\u4e3aNone\uff0c\u7136\u540eremmina\u7684advance\u6807\u7b7e\u5361\u7684<code>Auido output mode</code>\u8bbe\u7f6e<code>Local</code>\u5c31\u80fd\u542c\u5230\u58f0\u97f3\u4e86\uff0c\u867d\u7136\u58f0\u97f3\u8d28\u91cf\u4e0d\u4f73\uff0c\u4e0d\u8fc7\u52c9\u5f3a\u80fd\u7528!</p>","tags":["pve"]},{"location":"blog/pve%E5%85%A5%E9%97%A8/#_4","title":"\u53c2\u8003","text":"<ul> <li>https://forum.proxmox.com/threads/solved-warn-old-systemd-v232-detected-container-wont-run-in-a-pure-cgroupv2-environment.114736/</li> <li>https://stackoverflow.com/questions/25135897/how-to-automatically-start-a-service-when-running-a-docker-container/32179054#32179054</li> </ul>","tags":["pve"]},{"location":"blog/python-arguement-types/","title":"python arguement types","text":"<pre><code># accept tupe and list\ndef calc(numbers):\n    sum = 0\n    for n in numbers:\n        sum = sum + n\n    print(sum)\n\ncalc([1,2])\ncalc((1,2,3))\n\n# accept varidict argument\ndef calc2(*numbers):\n    sum = 0\n    for n in numbers:\n        sum = sum + n\n    return sum\n\ncalc2(0)\ncalc2(1,2,3,4)\n\nnumbers = [1,2,3]\n# transform list to varidcit argument\nprint(calc(*numbers))\n\n\n# varidict named arguments will be transformed to dict\n\n# only accept named varidict argument\ndef person2(**kw):\n    if 'hello' in kw:\n        passs\n\n    print(kw)\n\n# accept compose argument in sequence: normal argument &amp; named varidict argument\ndef person(name, age, **kw):\n    print('name', name, 'age', age, 'other', kw)\n\nperson('mike',12)\nperson('mike',12, city='sh')\nperson('mike',12, city='sh', birth=1990)\nperson2(name='mike',age = 12, city='sh', birth=1990)\n\n# compose normal type argument, varidict type argument, and varidict named type argument \ndef f2(a, b, c=0, *d, **kw):\n    print('a =', a, 'b =', b, 'c =', c, 'd =', d, 'kw =', kw)\n\ncs=[3,4]\nf2(1,2,*cs,hello='hello')\n\n\n# use * to sepcify named type argument\ndef f3(a,b,c,*,d,e):\n    print('a =', a, 'b =', b, 'c =', c, 'd =', d, 'e =', e)\n\n# don't accept other named argument\nf3(1,2,3,d=4,e=5)\n\n# use tupe and dict can call all kind of function\n# so *arg and **kw are always used to forward all argument to another function of any type of argument\nargs = (1,2,3)\nkw = {'c':1,'d':2}\nf2(*arg, **kw)\n\n# at last, use base type for default value\n</code></pre>","tags":["python"]},{"location":"blog/python-%E5%8C%85%E7%9A%84%E7%AE%A1%E7%90%86/","title":"python \u5305\u7684\u7ba1\u7406","text":"<p>python \u6709 sdist \u548c wheel \u4e24\u79cd\u65b9\u5f0f\u7ba1\u7406\u5305\uff1a</p> <p>sdist \u662f\u5728 <code>python setup.py sdist</code>\u65f6\u4ea7\u751f\u7684\u5305\uff0c\u662f\u4e00\u4e2a\u6e90\u7801\u538b\u7f29\u5305\uff0c\u5728\u5b89\u88c5\u65f6\u9700\u8981\u7f16\u8bd1\uff0c\u6240\u4ee5\u73af\u5883\u4f9d\u8d56make\u548cgcc wheel \u662f\u5728<code>python setup.py  bdist_wheel</code>\u662f\u4ea7\u751f\u7684whl \u683c\u5f0f\u5305</p> <p>\u4ece\u547d\u4ee4\u90fd\u53ef\u4ee5\u770b\u51fa\u6765sdist\u5373source\u6e90\u7801\u5305\uff0c bdist \u5373binary\u4e8c\u8fdb\u5236\u5305  </p> <p>sdist \u7531distutils\u3001setuptools \u5b9a\u4e49\u548c\u4f9d\u8d56\u7684\u7f16\u8bd1\u7cfb\u7edf\uff0c \u53ef\u4ee5\u8fd0\u884c\u4efb\u610f\u7684\u4ee3\u7801 wheel \u5305\u4e3a\u7f16\u8bd1\u548c\u5b89\u88c5\u65f6\u63d0\u4f9b\u4e86\u7b80\u5355\u7684\u63a5\u53e3\uff0c\u91cc\u9762\u5305\u542b\u4e86\u4e8c\u8fdb\u5236\u7684\u5305\uff0c\u53ef\u4ee5\u8ba9\u5b89\u88c5\u8005\u4e0d\u9700\u8981\u77e5\u9053\u7f16\u8bd1\u4f53\u7cfb,\u4f9d\u8d56wheel <pre><code>pip install wheel\n</code></pre></p>","tags":["python","\u5305\u7ba1\u7406"]},{"location":"blog/python-%E5%8C%85%E7%9A%84%E7%AE%A1%E7%90%86/#_1","title":"\u4e24\u79cd\u5305\u7684\u6253\u5305\u547d\u4ee4","text":"<p>\u524d\u63d0\u662f\u73af\u5883\u5b89\u88c5\u4e86setuptools\u548cwheel, \u4e14\u7f16\u5199\u4e86setup.py\u6587\u4ef6\u5982  </p> <p><pre><code># setup.py\n\nfrom setuptools import setup,find_namespace_packages\n#import pathlib\n#import pkg_resources\n#import os\n#import sys\n\n#sys.path.insert(0, os.path.join(\n#    os.path.dirname(os.path.abspath(__file__)), 'src'))\n\n# \u89e3\u6790\u6587\u672c\u6587\u4ef6\n#with pathlib.Path('requirements.txt').open() as requirements_txt:\n#    install_requires = [str(requirement) for requirement in pkg_resources.parse_requirements(requirements_txt) ]\n\nsetup(name='myflask',\n      version='1.3',\n      install_requires=[\n            'Bootstrap-Flask==1.4',\n            'Flask==1.1.2',\n            'Flask-Login==0.5.0',\n            'SQLAlchemy==1.3.18',\n            'Werkzeug==1.0.1',\n            'WTForms==2.3.1'\n          ],\n      entry_points={\n             'console_scripts':[\n                   'myflask=wsgi:main'\n                   ]\n            },\n      package_data = {\n        '': ['*.html'],\n        '': ['*.css'],\n        '': ['*.js'],\n        '': ['static/*'],\n        '': ['templates/*'],\n      },\n      py_modules=['myflask'],\n      packages=find_namespace_packages(),\n      zip_safe=False,\n      include_package_data=True,\n      )\n</code></pre> \u6211\u8fd9\u91cc\u5b9a\u4e49\u4e86\u5b89\u88c5\u6a21\u5757\uff0cmyflask,\u53ef\u4ee5\u88abuwsgi \u6587\u4ef6\u5f15\u5165\uff0c\u65b9\u4fbf\u7ba1\u7406\uff0c \u540c\u65f6\u4e5f\u52a0\u5165\u4e86\u5f88\u591ahtml\u7684\u9759\u6001\u6587\u4ef6\uff0c \u662f\u4e00\u4e2a\u5b8c\u6574\u7684\u7f51\u7ad9  </p> <ol> <li> <p>\u751f\u6210sdist\u5305\uff0c \u5728\u9879\u76ee\u76ee\u5f55\u6267\u884c<code>python setup.py sdist</code>\uff0c\u53ef\u4ee5\u5728sdit\u76ee\u5f55\u770b\u5230tar\u5305 <pre><code># myflask &gt; ls dist                                                                                                                                                                                                      \nmyflask-1.3.tar.gz\n</code></pre></p> </li> <li> <p>\u751f\u6210wheel\u5305\uff0c\u5728\u9879\u76ee\u76ee\u5f55\u6267\u884c<code>python setup.py bdist_wheel</code>\uff0c\u53ef\u4ee5\u5728sdit\u76ee\u5f55\u770b\u5230whl\u5305 <pre><code># myflask &gt; ls dist\nmyflask-1.3-py3-none-any.whl  myflask-1.3.tar.gz\n</code></pre></p> </li> </ol>","tags":["python","\u5305\u7ba1\u7406"]},{"location":"blog/python-%E5%8C%85%E7%9A%84%E7%AE%A1%E7%90%86/#_2","title":"\u5b89\u88c5","text":"<p>\u5b89\u88c5\u547d\u4ee4\u76f8\u540c\uff0c<code>pip install myflask-1.3.tar.gz</code> <code>pip instal myflask-1.3-py3-none-any.whl</code>\u3002\u4f46\u8fc7\u7a0b\u4e0d\u540c</p> <p>\u4e3e\u4f8b\u5b89\u88c5yarl \u7684\u6e90\u7801\u5305, \u6e90\u7801\u5305\u9700\u8981\u7f16\u8bd1\uff0c\u5982\u679c\u73af\u5883\u6ca1\u6709gcc,\u5c31\u4f1a\u5b89\u88c5\u5931\u8d25 <pre><code>Collecting yarl&lt;2.0,&gt;=1.0 (from aiohttp==3.6.2)\n  Downloading yarl-1.6.2.tar.gz (177kB)\n  Installing build dependencies: started\n  Installing build dependencies: finished with status 'done'\n  Getting requirements to build wheel: started\n  Getting requirements to build wheel: finished with status 'done'\n    Preparing wheel metadata: started\n    Preparing wheel metadata: finished with status 'done'\n...\n\n  gcc -pthread -Wno-unused-result -Wsign-compare -DNDEBUG -g -fwrapv -O3 -Wall -fPIC -I/opt/ha/include/python3.8 -c yarl/_quoting_c.c -o build/temp.linux-x86_64-3.8/yarl/_quoting_c.o\n  error: command 'gcc' failed with exit status 1\n  ----------------------------------------\n  ERROR: Failed building wheel for yarl\n  Running setup.py clean for yarl\nFailed to build yarl\n</code></pre></p> <p>\u6b64\u65f6\uff0c\u5982\u679c\u4f7f\u7528wheel\u5305\u5c31\u4e0d\u4f1a\u51fa\u95ee\u9898\uff0c\u4f46\u5982\u679cwheel\u5305\u91cc\u9762\u4f9d\u8d56\u4e86\u4e8c\u8fdb\u5236\u6587\u4ef6\uff0c\u5219\u9700\u8981\u533a\u5206cpu\u67b6\u6784\u548c\u7cfb\u7edf\u4e86 \u6211\u7684myflask\u4e0d\u4f9d\u8d56\u4efb\u4f55\u4e8c\u8fdb\u5236\u6587\u4ef6\uff0c\u6240\u4ee5\u662fnone, \u6240\u6709cpu\u548c\u7cfb\u7edf\u90fd\u53ef\u4ee5\u5b89\u88c5 <pre><code>myflask-1.3-py3-none-any.whl \n</code></pre> \u5bf9\u4e8eyarl\u4e0d\u540c\uff0c \u5728pypi.org \u4e0b\u8f7d\u65f6\uff0c\u9700\u8981\u9009\u62e9\u6b63\u786e\u7684\u5305\u3002\u6216\u8005\u9009\u62e9\u6e90\u7801\u5305<code>yarl-1.6.2.tar.gz</code>\u6765\u5b89\u88c5\u7f16\u8bd1  </p> <p>\u5f53\u7136\u5982\u679c\u8ba9pip\u9009\u62e9\u5728\u7ebf\u5b89\u88c5\u5c31\u4e0d\u9700\u8981\u8003\u8651\uff0c \u4ed6\u4f1a\u81ea\u52a8\u5e2e\u4f60\u5bfb\u627e\u5bf9\u5e94\u4f60\u7cfb\u7edf\u7684\u7248\u672c</p> <pre><code>Download files\n\nDownload the file for your platform. If you're not sure which to choose, learn more about installing packages.\nFiles for yarl, version 1.6.2\nFilename, size  File type   Python version  Upload date     Hashes\nyarl-1.6.2-cp36-cp36m-macosx_10_14_x86_64.whl (128.3 kB)    Wheel   cp36    Oct 13, 2020    View\nyarl-1.6.2-cp36-cp36m-manylinux1_i686.whl (293.5 kB)    Wheel   cp36    Oct 13, 2020    View\nyarl-1.6.2-cp36-cp36m-manylinux2014_aarch64.whl (294.5 kB)  Wheel   cp36    Oct 13, 2020    View\n\n...\n\nyarl-1.6.2.tar.gz (177.5 kB)    Source  None    Oct 13, 2020    View \n</code></pre>","tags":["python","\u5305\u7ba1\u7406"]},{"location":"blog/python-decoder-%E4%BB%8B%E7%BB%8D/","title":"python decoder \u4ecb\u7ecd","text":"<p>python decoder\uff08\u88c5\u9970\u5668\uff09\u662fpython\u7684\u9ad8\u7ea7\u7528\u6cd5\uff0c\u7528\u6765\u62d3\u5c55\u51fd\u6570\u6216\u7c7b\u7684\u529f\u80fd\u3002\u4e0d\u8fc7\u4e5f\u589e\u52a0\u521d\u5b66\u8005 \u9605\u8bfb\u4ee3\u7801\u7684\u96be\u5ea6</p> <p>\u4f8b\u5982flask\u53ef\u4ee5\u5728\u9700\u8981\u9a8c\u8bc1\u7528\u6237\u767b\u5f55\u7684\u8bf7\u6c42\u51fd\u6570\u4e0a\u6dfb\u52a0\u88c5\u9970\u5668\uff0c\u53ea\u6709\u5f53\u7528\u6237\u767b\u5f55\u4e86\u624d\u53ef\u4ee5\u8c03\u7528\u8be5&gt;\u9875\u9762\uff0c\u975e\u5e38\u65b9\u4fbf</p>","tags":["python"]},{"location":"blog/python-decoder-%E4%BB%8B%E7%BB%8D/#_1","title":"\u539f\u7406","text":"<p>decoder \u5176\u5b9e\u4e5f\u662f\u4e00\u4e2a\u51fd\u6570\uff0c\u88c5\u9970\u5668\u51fd\u6570\u4f1a\u8fd4\u56de\u771f\u5b9e\u51fd\u6570\uff0c\u5e76\u4f1a\u589e\u52a0\u989d\u5916\u7684\u4ee3\u7801\uff0c\u5982</p> <p><pre><code># \u5b9a\u4e49wraper\ndef log(func):\n    def wrapper(*arg):\n        print('func called')\n        return func(*arg)\n\n    return wrapper\n\n# \u4f7f\u7528\ndef hello(Name=None):\n    print('Hello %s'%Name)\n\nnew_hello = log(hello)\n\nnew_hello('bob')\n</code></pre> \u8f93\u51fa func called Hello bob</p>","tags":["python"]},{"location":"blog/python-decoder-%E4%BB%8B%E7%BB%8D/#wraper","title":"\u4f7f\u7528wraper \u7684\u539f\u56e0","text":"<p>\u63d0\u4f9b\u989d\u5916\u7684\u529f\u80fd\uff0c\u4f8b\u5982\u8ba1\u65f6\uff0c\u65e5\u5fd7\u7b49\u3002 \u53e6\u5916wraper\u8fd8\u6709\u66f4\u591a\u5f3a\u5927\u7684\u529f\u80fd</p> <pre><code>def fib(n):\n    if n &lt;= 1: return 1\n    return fib(n-1) + fib(n-2)\n</code></pre> <p>\u8fd9\u79cd\u9012\u5f52\u8c03\u7528\u975e\u5e38\u8d39\u65f6\uff0c\u800c\u4f7f\u7528wraper \u53ef\u4ee5\u63d0\u4f9b\u4e00\u4e2a\u7f13\u5b58\u5668</p> <p><pre><code>def memory(func):\n    cache = {}\n    def wrapper(*args):\n        if args not in cache:\n            cache[args] = func(*args)\n        return cache[args]\n    return wrapper\n\n@memory\ndef fib(n):\n    if n &lt;= 1: return 1\n    return fib(n-1) + fib(n-2)\n\n\n## \u7ed9\u7c7bwraper\n\n\u4e0a\u9762\u662f\u51fd\u6570wraper\uff0c \u7c7b\u4e5f\u53ef\u4ee5\u4f5c\u4e3awraper\uff0c \u4f46\u9700\u8981\u7c7b\u652f\u6301\uff08\uff09\u8c03\u7528\uff0c\u7c7b\u4f3cc++\u7684\u7c7b\u51fd\u6570\u3002\n\u5728python\u91cc\u9700\u8981\u5b9e\u73b0 `__call__` \u65b9\u6cd5\n\n```python\nimport functools\n\nclass MemoryClass():\n    def __init__(self, is_logging, func):\n        self.is_logging = is_logging\n        self.func = func\n        if self.is_logging:\n            print('logging')\n        self.cache = {}\n\n    def __call__(self, *args):\n        if args not in self.cache:\n            self.cache[args] = self.func(*args)\n\n        return self.cache[args]\n\ndef memory(is_logging):\n    return functools.partitial(MemoryClass, is_logging)\n\n\n@memory(is_loging=True)\ndef fib(n):\n    if n &lt;= 1: return 1\n    return fib(n-1) + fib(n-2)\n\n\nprint(fib(5))\n</code></pre> \u7c7bwrapr \u53ef\u4ee5\u589e\u52a0\u53c2\u6570\uff0c\u76f8\u6bd4\u51fd\u6570\u88c5\u9970\u5668\uff0c\u7c7b\u88c5\u9970\u5668\u5177\u6709\u66f4\u52a0\u7075\u6d3b\uff0c\u5c01\u88c5\u6027\u66f4\u597d\u7b49\u4f18\u70b9~</p>","tags":["python"]},{"location":"blog/python-decoder-%E4%BB%8B%E7%BB%8D/#wraper_1","title":"wraper \u5e26\u6765\u7684\u95ee\u9898","text":"<ol> <li>\u6539\u53d8\u539f\u6765\u7684\u51fd\u6570\u5c5e\u6027\uff0c\u4f8b\u5982\u51fd\u6570\u540d\uff0c \u56e0\u4e3a\u88c5\u9970\u5668\u7528\u65b0\u51fd\u6570\u66ff\u6362\u4e86\u539f\u6765\u7684\u65e7\u51fd\u6570\u3002 \u6240\u4ee5\u65b0\u51fd&gt;\u6570\u5c11\u4e86\u65e7\u51fd\u6570\u7684\u5c5e\u6027 \u89e3\u51b3\u529e\u6cd5</li> </ol> <pre><code>import functools\n\ndef advertising(func):\n    @functools.wraps(func)\n    def wrapper(*args):\n        print('\u6b22\u8fce\u5173\u6ce8\u5fae\u4fe1\u516c\u4f17\u53f7: Charles\u7684\u76ae\u5361\u4e18')\n        return func(*args)\n    return wrapper\n\n@advertising\ndef add_1(a, b):\n    '''\u52a0\u6cd5\u8fd0\u7b97'''\n    return a + b\n</code></pre> <ol> <li>\u83b7\u53d6\u53c2\u6570</li> </ol> <pre><code>import inspect\nimport functools\n\ndef check(func):\n    a = 0\n    @functools.wraps(func)\n    def wraper(*args, **kwargs):\n        a += 1\n        print(a)\n        # \u5728wraper\u91cc\u68c0\u67e5\u53c2\u6570\n        getcallargs = inspect.getcallargs(func, *args, **kwargs)\n        if getcallargs.get('divisor') &lt;= 1e-6 and getcallargs.get('divisor') &gt;= -1e-6:\n            return False\n        return func(*args, **kwargs)\n\n    return wraper\n\n\n@check\ndef dowork(arg1, arg2):\n    return arg1 + arg2\n\ndowork(1,2)\n</code></pre> <p>\u6b64\u65f6\u4f1a\u62a5\u9519\uff0ca\u5728\u8d4b\u503c\u4e4b\u524d\u5f15\u7528\u4e86\u3002 \u9700\u8981\u5c06a\u58f0\u660e\u4e3a <code>nonlocal</code></p>","tags":["python"]},{"location":"blog/%E4%BD%BF%E7%94%A8%E6%AD%A3%E5%88%99%E6%9D%A5%E6%A0%A1%E9%AA%8C%E8%BE%93%E5%85%A5%E5%90%88%E6%B3%95%E6%80%A7/","title":"\u4f7f\u7528\u6b63\u5219\u6765\u6821\u9a8c\u8f93\u5165\u5408\u6cd5\u6027","text":"<p>\u8f6f\u4ef6\u52a0\u56fa\u91cc\u9762\u7ecf\u5e38\u4f7f\u7528\u7684\u529e\u6cd5\u5c31\u662f\u6821\u9a8c\u7528\u6237\u8f93\u5165\uff0c\u4f8b\u5982\u8981\u6c42\u540d\u8bcd\u9700\u8981\u662f\u5927\u5c0f\u5199\u6216_\u5f00\u5934\uff0c \u652f\u6301\u5305\u542b\u5927\u5c0f\u5199 \uff0c\u4e2d\u5212\u7ebf -\uff0c\u4e0b\u5212\u7ebf_\u4ee5\u53ca\u70b9.</p> <p>\u90a3\u4e48\u76f8\u5e94\u7684\u6b63\u5219\u8868\u5230\u5f0f\u4e3a<code>^[a-zA-Z_][-a-zA-Z1-9_.]*$</code>\uff0c\u6821\u9a8c\u65b9\u6cd5\u4e3a</p> <pre><code>echo $1 | grep -q '^[a-zA-Z_][-a-zA-Z1-9_.]*$'\ntest $? -eq 0 &amp;&amp; echo \"yes\" || echo \"no\"\n</code></pre> <p>\u7528python\u5b9e\u73b0</p> <pre><code>Type \"help\", \"copyright\", \"credits\" or \"license\" for more information.\n&gt;&gt;&gt; import re\n&gt;&gt;&gt; print(re.match('^[a-zA-Z_][a-zA-Z0-9\\-_.]*$', '_abcdedf.', flags=0))\n&lt;re.Match object; span=(0, 9), match='_abcdedf.'&gt;\n&gt;&gt;&gt; print(re.match('^[a-zA-Z_][a-zA-Z0-9\\-_.]*$', '._abcdedf.', flags=0))\nNone\n</code></pre>","tags":["tool"]},{"location":"blog/c-%E4%B8%AD-register-%E5%85%B3%E9%94%AE%E5%AD%97/","title":"c \u4e2d register \u5173\u952e\u5b57","text":"<p>register \u5173\u952e\u5b57\u662fc/c++ \u91cc\u9762\u552f\u4e00\u80fd\u64cd\u4f5c\u5bc4\u5b58\u5668\u7684\u6307\u4ee4\uff0c\u5f3a\u5236\u5c06\u6570\u636e\u5b58\u653e\u5728\u5bc4\u5b58\u5668\u91cc\uff0c\u800c\u4e0d\u662f\u653e\u5728\u5806\u6808\u91cc\uff0c\u8fd9\u6837\u8bfb\u5199\u901f\u5ea6\u6700\u5feb\u3002</p> <p>\u800c\u6c47\u7f16\u8bed\u8a00\u5f3a\u5927\u4e4b\u5904\u662f\u80fd\u76f4\u63a5\u64cd\u4f5c\u5bc4\u5b58\u5668\uff0c\u4e14\u53ef\u4ee5\u6307\u5b9a\u4f7f\u7528\u54ea\u4e9b\u5bc4\u5b58\u5668\u3002 </p> <p>\u901a\u8fc7\u6c47\u7f16\u4e00\u6bb5\u4ee3\u7801\u6765\u6f14\u793aregister\u7684\u4f5c\u7528  </p> <p>\u5148\u662fc\u8bed\u8a00\u4ee3\u7801 <pre><code>int main(){\n\n    register int i;\n\n    for(i = 0 ;i&lt;10;i++){\n        int j = i;\n    }\n\n}\n</code></pre> \u5bf9\u5e94\u7684\u6c47\u7f16 <pre><code>main:\n.LFB0:\n        .cfi_startproc\n        pushq   %rbp\n        .cfi_def_cfa_offset 16\n        .cfi_offset 6, -16\n        movq    %rsp, %rbp\n        .cfi_def_cfa_register 6\n        pushq   %rbx\n        .cfi_offset 3, -24\n        movl    $0, %ebx\n        jmp     .L2\n.L3:\n        movl    %ebx, -12(%rbp)\n        addl    $1, %ebx\n.L2:\n        cmpl    $9, %ebx\n        jle     .L3\n        movl    $0, %eax\n        movq    -8(%rbp), %rbx\n        leave\n        .cfi_def_cfa 7, 8\n        ret\n</code></pre></p> <p>\u6ca1\u6709register\u5173\u952e\u5b57\u7684\u65f6\u5019  <pre><code>int main(){\n\n    int i;\n\n    for(i = 0 ;i&lt;10;i++){\n        int j = i;\n    }\n\n}\n</code></pre></p> <pre><code>main:\n.LFB0:\n    .cfi_startproc\n    pushq   %rbp\n    .cfi_def_cfa_offset 16\n    .cfi_offset 6, -16\n    movq    %rsp, %rbp\n    .cfi_def_cfa_register 6\n    movl    $0, -8(%rbp)\n    jmp .L2\n.L3:\n    movl    -8(%rbp), %eax\n    movl    %eax, -4(%rbp)\n    addl    $1, -8(%rbp)\n.L2:\n    cmpl    $9, -8(%rbp)\n    jle .L3\n    movl    $0, %eax\n    popq    %rbp\n    .cfi_def_cfa 7, 8\n    ret\n</code></pre> <p>\u53ef\u89c1\uff0c\u5f53register\u4fee\u9970int i\u65f6\uff0c i\u7684\u503c\u5b58\u653e\u5728%ebx\u91cc\uff0c\u5f53\u6ca1\u6709register\u4fee\u9970\u65f6\uff0ci\u7684\u503c\u653e\u5728\u6808\u91cc<code>%rbp -8</code>\u7684\u4f4d\u7f6e <code>movl    %ebx, -12(%rbp)</code> \u53ef\u89c1\u5f53register\u65f6\uff0c j\u7684\u503c\u590d\u7528\u4e86ebx\u7684\u9ad832\u4f4d\u3002 \u6b64\u65f6\u7684\u5185\u5b58\u5982\u4e0b</p> <pre><code>--- \u6808\u5e95\n\u65e7\u7684rbp 64\u4f4d\n---\n\u65e7\u7684rbx \u9ad832\u4f4d\n---  j\n\u65e7\u7684rbx \u4f4e32\u4f4d\n---\u6808\u9876\n</code></pre> <p>rbp\u8868\u793a\u57fa\u5730\u5740\u6307\u9488\uff0c\u6307\u5411\u7684\u662f\u51fd\u6570\u6808\u7684\u8d77\u59cb\u5730\u5740\uff0c\u8fd9\u4e2a\u8d77\u59cb\u5730\u5740\u53ea\u662f\u5bf9\u4e8e\u5f53\u524d\u51fd\u6570\u800c\u8a00\u7684 rsp\u8868\u793a\u6808\u9876\u6307\u9488\uff0c\u6307\u5411\u5f53\u524d\u7684\u6808\u9876 \u6bcf\u6b21\u51fd\u6570\u8c03\u7528\u65f6(main \u51fd\u6570\u88ab\u5185\u6838<code>_start_main__</code>\u8c03\u7528): 1. \u5c06\u8c03\u7528\u8005\u7684\u51fd\u6570\u6808\u57fa\u5730\u5740\u4fdd\u5b58\u8d77\u6765  2. \u53c2\u6570\u538b\u6808, \u53ef\u80fd\u7531\u8c03\u7528\u8005\u538b\u6808\uff0c\u53ef\u80fd\u7531\u88ab\u8c03\u7528\u8005\u538b\u6808\uff0c\u5f71\u54cd\u7684\u662f\u5f53\u524d\u7684\u6808\u9876\uff0c\u7ee7\u800c\u6808\u9876\u5f71\u54cdrbp 3. \u5c06\u88ab\u8c03\u7528\u51fd\u6570\u5f53\u524d\u7684\u6808\u9876\u590d\u5236\u7ed9\u57fa\u5730\u5740\u5bc4\u5b58\u5668\u3002\u65b0\u7684rbp == rsp\u5373\u5f53\u524d\u7684\u6808\u9876\u3002\u76f8\u5f53\u4e8e\u6784\u9020\u4e86\u65b0\u7684\u51fd\u6570\u8fd0\u884c\u73af\u5883</p>","tags":["c","cpp","asm"]},{"location":"blog/c-%E4%B8%AD-register-%E5%85%B3%E9%94%AE%E5%AD%97/#rbprsp","title":"rbp\u548crsp","text":"<p>\u5b9e\u4f8b\u4ee3\u7801\uff0cmain\u51fd\u6570\u4e2d\u8c03\u7528foo\u51fd\u6570\u3002 <pre><code>int foo(){\n  printf(\"hello\");\n  return 1;\n}\n\nint main(){\n  foo();\n  return 0;\n}\n</code></pre></p> <pre><code>(gdb) disassemble \nDump of assembler code for function main:\n   0x0000555555555158 &lt;+0&gt;: push   %rbp\n   0x0000555555555159 &lt;+1&gt;: mov    %rsp,%rbp\n   0x000055555555515c &lt;+4&gt;: mov    $0x0,%eax\n=&gt; 0x0000555555555161 &lt;+9&gt;: call   0x555555555139 &lt;foo&gt;\n   0x0000555555555166 &lt;+14&gt;:    mov    $0x0,%eax\n   0x000055555555516b &lt;+19&gt;:    pop    %rbp\n   0x000055555555516c &lt;+20&gt;:    ret\n</code></pre> <ol> <li>main \u51fd\u6570&gt; <code>push %rbp</code> \u5c06\u6808\u5e95\u5bc4\u5b58\u5668\u7684\u503c\u4fdd\u5b58\u5230\u5806\u6808\u4e2d</li> <li>main \u51fd\u6570&gt; <code>mov %rsp,%rbp</code> \u5c06\u5f53\u524d\u7684\u6808\u9876\u5bc4\u5b58\u5668\u7684\u503c\u590d\u5236\u5230\u6808\u5e95\u5bc4\u5b58\u5668</li> <li>main \u51fd\u6570&gt; <code>mov $0x0,%eax</code> \u5c06foo\u51fd\u6570\u7684\u8fd4\u56de\u503c\u521d\u59cb\u5316\u62100</li> </ol> <p>\u8fdb\u5165\u5230foo\u51fd\u6570\u4e2d <pre><code>(gdb) disassemble \nDump of assembler code for function foo:\n   0x0000555555555139 &lt;+0&gt;: push   %rbp\n   0x000055555555513a &lt;+1&gt;: mov    %rsp,%rbp\n=&gt; 0x000055555555513d &lt;+4&gt;: lea    0xec0(%rip),%rax        # 0x555555556004\n   0x0000555555555144 &lt;+11&gt;:    mov    %rax,%rdi\n   0x0000555555555147 &lt;+14&gt;:    mov    $0x0,%eax\n   0x000055555555514c &lt;+19&gt;:    call   0x555555555030 &lt;printf@plt&gt;\n   0x0000555555555151 &lt;+24&gt;:    mov    $0x1,%eax\n   0x0000555555555156 &lt;+29&gt;:    pop    %rbp\n   0x0000555555555157 &lt;+30&gt;:    ret\nEnd of assembler dump.\n</code></pre></p> <p>\u9644\u5f55 <pre><code>General-Purpose Registers\n\nThe 64-bit versions of the 'original' x86 registers are named:\n\n    rax - register a extended\n    rbx - register b extended\n    rcx - register c extended\n    rdx - register d extended\n    rbp - register base pointer (start of stack)\n    rsp - register stack pointer (current location in stack, growing downwards)\n    rsi - register source index (source for data copies)\n    rdi - register destination index (destination for data copies)\n\nThe registers added for 64-bit mode are named:\n\n    r8 - register 8\n    r9 - register 9\n    r10 - register 10\n    r11 - register 11\n    r12 - register 12\n    r13 - register 13\n    r14 - register 14\n    r15 - register 15\n\nThese may be accessed as:\n\n    64-bit registers using the 'r' prefix: rax, r15\n    32-bit registers using the 'e' prefix (original registers: e_x) or 'd' suffix (added registers: r__d): eax, r15d\n    16-bit registers using no prefix (original registers: _x) or a 'w' suffix (added registers: r__w): ax, r15w\n    8-bit registers using 'h' (\"high byte\" of 16 bits) suffix (original registers - bits 8-15: _h): ah, bh\n    8-bit registers using 'l' (\"low byte\" of 16 bits) suffix (original registers - bits 0-7: _l) or 'b' suffix (added registers: r__b): al, bl, r15b\n\nUsage during syscall/function call:\n\n    First six arguments are in rdi, rsi, rdx, rcx, r8d, r9d; remaining arguments are on the stack.\n    For syscalls, the syscall number is in rax.\n    Return value is in rax.\n    The called routine is expected to preserve rsp,rbp, rbx, r12, r13, r14, and r15 but may trample any other registers.\n</code></pre></p>","tags":["c","cpp","asm"]},{"location":"blog/c-%E4%B8%AD-register-%E5%85%B3%E9%94%AE%E5%AD%97/#_1","title":"\u53c2\u8003","text":"<p>https://shikaan.github.io/assembly/x86/guide/2024/09/08/x86-64-introduction-hello.html</p>","tags":["c","cpp","asm"]},{"location":"blog/pve%E4%B8%AD%E7%BB%99windows%E6%89%A9%E5%AE%B9/","title":"pve\u4e2d\u7ed9windows\u6269\u5bb9","text":"<p>\u5f53\u521d\u521b\u5efawindows\u65f6\u7ed9\u768440G\u786c\u76d8\uff0c\u5c31\u4e00\u4e2a\u5206\u533a\uff0c\u540e\u6765\u88c5\u4e86\u4e00\u4e9b\u8f6f\u4ef6\uff0c\u53d1\u73b0\u4e0d\u591f\u7528\u4e86\uff0c\u5c31\u7b2c\u4e00\u6b21\u6269\u5bb9\uff0c\u7136\u540e\u52a0\u4e86\u53e6\u4e00\u4e2a\u5206\u533a\u3002\u540e\u6765\u6709\u4e9b\u4e1c\u897f\u5fc5\u987b\u653e\u5728C\u76d8\u91cc\uff0c\u8fd9\u6b21\u6269\u5bb9\u5c31\u6bd4\u8f83\u590d\u6742\u4e9b\u3002</p>","tags":["pve","vnc","gparted"]},{"location":"blog/pve%E4%B8%AD%E7%BB%99windows%E6%89%A9%E5%AE%B9/#_1","title":"\u7b2c\u4e00\u6b21\u6269\u5bb9","text":"<p>pve\u7684web\u754c\u9762\u70b9\u51fb\u786c\u76d8\u7684resize\u53ef\u4ee5\u4fee\u6539\u786c\u76d8\u5927\u5c0f\uff0c\u8fd9\u4e2a\u786c\u76d8\u5b9e\u9645\u4e0a\u662f\u4e00\u4e2alvm\u5757\u8bbe\u5907\uff0c\u800c\u5bf9\u4e8e\u865a\u62df\u673aWindows\u800c\u8a00\u5c31\u662f\u786c\u76d8\u53d8\u5927\u4e86\u3002</p> <p>\u786c\u76d8\u52a0\u5927\u540e\uff0c\u8fdb\u5165windows\u78c1\u76d8\u7ba1\u7406\uff0c\u53d1\u73b0Windows\u5df2\u7ecf\u67093\u4e2a\u533a\uff1aefi\uff0cC\u76d8\uff0c\u6062\u590d\u5206\u533a\u3002\u4e3a\u4e86\u65b9\u4fbf\u76f4\u63a5\u52a0\u4e86\u4e00\u4e2aD\u76d8\u3002</p> <p>\u5907\u6ce8\uff1apve\u7684\u865a\u62df\u673a\u5b89\u88c5\u5728\u5757\u8bbe\u5907\u4e0a\uff0c\u800cqemu\u662f\u7528\u6587\u4ef6\uff08raw or qcow2\uff09\uff0c\u6240\u4ee5qemu\u7684\u865a\u62df\u673a\u53ef\u4ee5\u590d\u5236\u79fb\u52a8\uff0c\u4e0d\u8fc7pve\u652f\u6301\u5f02\u5730\u90e8\u7f72\u3002</p>","tags":["pve","vnc","gparted"]},{"location":"blog/pve%E4%B8%AD%E7%BB%99windows%E6%89%A9%E5%AE%B9/#_2","title":"\u7b2c\u4e8c\u6b21\u6269\u5bb9","text":"<p>\u8fd9\u6b21\u6269\u5bb9\u662f\u4e3a\u4e86\u589e\u52a0C\u76d8\u5927\u5c0f\uff0c\u800cC\u76d8\u540e\u9762\u6709\u6062\u590d\u5206\u533a\u548cD\u5206\u533a\u3002\u4e0d\u5f97\u4e0d\u5728gparted \u4e2d\u6267\u884c: 1. \u5220\u9664D\u5206\u533a 2. \u79fb\u52a8\u6062\u590d\u5206\u533a\u5230\u78c1\u76d8\u672b\u5c3e 3. \u62d3\u5c55C\u76d8\u5927\u5c0f\u3002 gparted\u64cd\u4f5c\u5f88\u65b9\u4fbf\uff0c\u4e0d\u8fc7windows\u542f\u52a8\u4e0d\u6210\u529f\uff0c\u901a\u8fc7windows\u5b89\u88c5iso\u4fee\u590d\u4e4b\u540e\u6b63\u5e38\u4e86\uff0c\u6062\u590d\u5206\u533a\u4e5f\u8fd8\u5728\u3002</p>","tags":["pve","vnc","gparted"]},{"location":"blog/pve%E4%B8%AD%E7%BB%99windows%E6%89%A9%E5%AE%B9/#virtual-vnc-gparted","title":"virtual vnc \u53ef\u89c6\u5316\u6253\u5f00gparted","text":"<p>\u56e0\u4e3apve\u6ca1\u6709\u8fde\u63a5\u663e\u793a\u5668\uff0c\u53ea\u80fd\u7528\u865a\u62dfvnc\uff0c\u8fdc\u7a0b\u8fde\u63a5\u5230pve\u684c\u9762\u3002</p>","tags":["pve","vnc","gparted"]},{"location":"blog/pve%E4%B8%AD%E7%BB%99windows%E6%89%A9%E5%AE%B9/#tigervnc","title":"\u5b89\u88c5tigervnc\u670d\u52a1\u7aef","text":"<p>pve\u53ea\u9700\u8981\u5b89\u88c5\u670d\u52a1\u7aef\uff0ctigervnc-standalone-server\u3002\u672c\u5730\u7535\u8111\u5b89\u88c5\u5ba2\u6237\u7aef\uff0c\u9009\u62e9\u5f88\u591a\u4f8b\u5982 remmina\u3002</p>","tags":["pve","vnc","gparted"]},{"location":"blog/pve%E4%B8%AD%E7%BB%99windows%E6%89%A9%E5%AE%B9/#_3","title":"\u542f\u52a8","text":"<p>\u521b\u5efa\u5bc6\u7801\u540e\u542f\u52a8vnc \u670d\u52a1\u7aef\u5931\u8d25\uff0c\u63d0\u793a\u6ca1\u6709\u684c\u9762\u3002\u539f\u56e0\u662f\u6ca1\u6709\u5b89\u88c5\u684c\u9762\u73af\u5883\u66f4\u6ca1\u6709\u542f\u52a8\u684c\u9762\uff0c\u597d\u5728tigervnc \u652f\u6301\u6307\u5b9a\u53ef\u89c6\u5316\u8fdb\u7a0b\uff08xVNC\u5c31\u4e0d\u652f\u6301\u8fd9\u79cd\u65b9\u5f0f\uff09\u3002 <pre><code>tigervncserver -xstartup /usr/sbin/gparted  --  /dev/dm-15\n</code></pre></p> <p>\u8fd9\u91cc\u76f4\u63a5\u7ed9\u7684gparted\u53ef\u6267\u884c\u6587\u4ef6\u8def\u5f84\u548c\u53c2\u6570\uff0c<code>--</code>\u8868\u793a\u540e\u9762\u7684\u53c2\u6570\u662f\u7ed9gparted\u7684\uff0c\u4e0d\u662f\u7ed9tigervncserver\u7684\uff0c/dev/dm-15\u662f\u8981\u64cd\u4f5c\u7684windows\u78c1\u76d8\uff0c\u4e5f\u80fd\u5728gparted\u754c\u9762\u91cc\u9762\u518d\u9009\u3002</p>","tags":["pve","vnc","gparted"]},{"location":"blog/pve%E4%B8%AD%E7%BB%99windows%E6%89%A9%E5%AE%B9/#remmina","title":"remmina\u8bbe\u7f6e\u7a97\u53e3\u5927\u5c0f","text":"<p>tigervncserver\u9ed8\u8ba4\u542f\u52a81024x768\u7684\u7a97\u53e3\uff0c\u5f53\u5185\u5bb9\u591a\u65f6\u4e0d\u65b9\u4fbf\u3002\u91cd\u65b0\u542f\u52a8 <pre><code>tigervncserver -geometry 1920x1080 -xstartup /usr/sbin/gparted  --  /dev/dm-15\n</code></pre></p> <p>\u4f46\u662f\u91cd\u65b0\u8fde\u63a5\u53d1\u73b0\u7a97\u53e3\u8fd8\u662f\u5f88\u5c0f\uff0c\u4ee5\u4e3a\u53c2\u6570\u4e0d\u751f\u6548\u3002\u540e\u6765\u53d1\u73b0\u8fd9\u65f6\u5019\u7a97\u53e3\u53f3\u4e0b\u89d2\u53ef\u4ee5\u62d6\u52a8\uff0c\u624b\u52a8\u62d6\u6210\u6ee1\u5c4f</p>","tags":["pve","vnc","gparted"]},{"location":"blog/pve%E4%B8%AD%E7%BB%99windows%E6%89%A9%E5%AE%B9/#gparted","title":"gparted\u95ee\u9898","text":"<p>\u542f\u52a8gparted\u540e\u51fa\u73b0\u6ca1\u6709\u5149\u6807\uff0c\u540e\u9762\u6309\u4e86\u9f20\u6807\u53f3\u952e\u5c31\u6062\u590dX\u5149\u6807\u4e86\u3002arch wiki\u91cc\u9762\u6709\u89e3\u51b3\u529e\u6cd5 </p>","tags":["pve","vnc","gparted"]},{"location":"blog/%E8%AE%B0%E5%BD%95%E4%B8%80%E4%B8%8Brhce8%E4%B8%8A%E8%AF%BE%E7%AC%94%E8%AE%B0/","title":"\u8bb0\u5f55\u4e00\u4e0brhce8\u4e0a\u8bfe\u7b14\u8bb0","text":"<ol> <li>\u8fdb\u5165nfs\uff0cautofs\u76ee\u5f55\u5361\u4f4f\uff0c\u5982\u4f55\u9000\u51fa\uff0c\u5e94\u8be5\u662f\u8fdb\u5165\u4e86D\u72b6\u6001 </li> <li>chrome \u9700\u8981\u7b14\u8bb0\u672c\u63d2\u4ef6\uff0cjs\u63a7\u5236\u63d2\u4ef6</li> <li>\u4fee\u6539root\u5bc6\u7801\u65f6\uff0c\u5728linux \u9009\u9879\u540e\u9762\u6dfb\u52a0 rd.break \u7136\u540e\u9ed8\u8ba4\u8fdb\u5165\u5185\u6838\u6839\u76ee\u5f55\uff0c\u7136\u540erw\u91cd\u65b0\u6302\u8f7d\u7cfb\u7edf\u6839\u76ee\u5f55 /sysroot/ </li> <li>fdisk \u8bbe\u7f6e\u5206\u533a\u7c7b\u578b: \u5728\u521b\u5efa\u5206\u533a\u7ed3\u675f\u540e\uff0c\u4f7f\u7528<code>t</code>\u6765\u6807\u8bb0\u6587\u4ef6\u7c7b\u578b, \u7136\u540e\u4f7f\u7528<code>L</code>\u67e5\u770b\u7c7b\u578b\u4ee3\u7801\uff0c\u67e5\u627e\u5230Linux swap \u5bf9\u5e94\u7684\u4ee3\u7801\u662f85</li> </ol>","tags":["rhce","linux"]},{"location":"blog/%E8%AE%B0%E5%BD%95%E4%B8%80%E4%B8%8Brhce8%E4%B8%8A%E8%AF%BE%E7%AC%94%E8%AE%B0/#rhcia","title":"RHCIA","text":"","tags":["rhce","linux"]},{"location":"blog/%E8%AE%B0%E5%BD%95%E4%B8%80%E4%B8%8Brhce8%E4%B8%8A%E8%AF%BE%E7%AC%94%E8%AE%B0/#nmcli-connection-downup-connection","title":"\u4fee\u6539\u4e86\u7f51\u7edc\u4fe1\u606f\u4e4b\u540e\uff0c\u5fc5\u987b\u4f7f\u7528nmcli connection down\u548cup connection\u624d\u4f1a\u751f\u6548","text":"<pre><code>nmtui connection down Wired_connection1\nnmtui connection up Wired_connection1\n</code></pre>","tags":["rhce","linux"]},{"location":"blog/%E8%AE%B0%E5%BD%95%E4%B8%80%E4%B8%8Brhce8%E4%B8%8A%E8%AF%BE%E7%AC%94%E8%AE%B0/#httpdportportsemanagetagjourneyctl-e","title":"\u914d\u7f6ehttpd\u670d\u52a1\u65f6\uff0c\u4fee\u6539port\u540e\uff0c\u56e0\u4e3aport\u975e\u6807\u51c6\u7aef\u53e3\uff0c\u9700\u8981\u7528semanage\u6253tag\u3002\u5426\u5219\u5931\u8d25\uff0c\u53ef\u4ee5\u67e5\u770bjourneyctl -e \u67e5\u770b\u5230\u9519\u8bef\u4fe1\u606f\u548c\u89e3\u51b3\u529e\u6cd5","text":"<pre><code>semanage port -a -t http_port_t -p tcp 82\n</code></pre>","tags":["rhce","linux"]},{"location":"blog/%E8%AE%B0%E5%BD%95%E4%B8%80%E4%B8%8Brhce8%E4%B8%8A%E8%AF%BE%E7%AC%94%E8%AE%B0/#homeadmins-adminusr-s-","title":"\u521b\u5efa/home/admins \u76ee\u5f55\uff0c\u5e76\u8bbe\u7f6e\u5728\u76ee\u5f55\u4e2d\u521b\u5efa\u7684\u6587\u4ef6\uff0c\u5176\u7ec4\u6240\u6709\u6743\u81ea\u52a8\u8bbe\u7f6e\u4e3a adminusr\u3002 \u8fd9\u91cc\u5c31\u662f\u8bbe\u7f6es\u4f4d\uff0c\u6709\u6570\u503c\u65b9\u6cd5\u548c+-\u6cd5","text":"<pre><code>chmod 2770 /home/admins\n\n# \u6216\n\nchmod o-x /home/admins\nchmod o-r /home/admins\nchmod g+w /home/admins\nchmod g+s /home/admins # \u8fd9\u91cc\u8bbe\u7f6e\u7ec4\u7684s\u4f4d\n</code></pre> <p>\u9a8c\u8bc1\u65b9\u6cd5\uff0c\u8fdb\u5165\u76ee\u5f55\u521b\u5efa\u6587\u4ef6\uff0c\u67e5\u770b\u7ec4\u540d</p>","tags":["rhce","linux"]},{"location":"blog/%E8%AE%B0%E5%BD%95%E4%B8%80%E4%B8%8Brhce8%E4%B8%8A%E8%AF%BE%E7%AC%94%E8%AE%B0/#autofs-etcautomasterd-autofs","title":"autofs \u6302\u8f7d\u6709\u4e24\u4e2a\u5173\u952e\uff0c\u7b2c\u4e00\u5728/etc/auto.master.d/ \u76ee\u5f55\u4e0b\u521b\u5efa\u540e\u7f00\u540d\u4e3aautofs\u7684\u6587\u4ef6\uff0c \u7b2c\u4e8c\u662f\u7f16\u8f91\u6302\u8f7d\u914d\u7f6e\u6587\u4ef6","text":"<p>\u5185\u5bb9\u683c\u5f0f <pre><code># cat /etc/auto.master.d/indirect\n#\u4e3b\u6302\u8f7d\u70b9   \u6302\u8f7d\u914d\u7f6e\n/internal   /etc/auto.demo\n</code></pre></p> <p>\u5185\u5bb9\u914d\u7f6e\uff0c* \u8868\u793a\u6240\u6709\u76ee\u5f55\uff08\u6839\u636enfsserver\u7684\u60c5\u51b5\uff09\uff0c \u548c&amp;\u642d\u914d\u4f7f\u7528 <pre><code># cat /etc/auto.demo\n# \u95f4\u63a5\u6302\u8f7d\u76ee\u5f55    \u6302\u8f7d\u914d\u7f6e    \u6302\u8f7d\u8def\u5f84\uff08nfs\u5730\u5740\uff09\n*   -rw,fstype=nfs4,sync    servera:/shares/indirect/&amp;\n</code></pre></p>","tags":["rhce","linux"]},{"location":"blog/%E8%AE%B0%E5%BD%95%E4%B8%80%E4%B8%8Brhce8%E4%B8%8A%E8%AF%BE%E7%AC%94%E8%AE%B0/#setfacl-getfacl","title":"setfacl \u548cgetfacl \u8bbe\u7f6e\u548c\u663e\u793a\u6587\u4ef6\u5c5e\u6027","text":"<pre><code>\u8bbe\u7f6enatash\u7528\u6237\u8bfb\u5199\u6743\u9650\nsetfacl u:natasha:rw    /var/tmp/fstab\n\u8bbe\u7f6eharry\u7528\u6237\u6ca1\u6709\u4efb\u4f55\u6743\u9650 \nsetfacl u:harry:-   /var/tmp/fstab\n</code></pre>","tags":["rhce","linux"]},{"location":"blog/%E8%AE%B0%E5%BD%95%E4%B8%80%E4%B8%8Brhce8%E4%B8%8A%E8%AF%BE%E7%AC%94%E8%AE%B0/#rootlinux-rdlocal-ctrlx","title":"\u91cd\u7f6eroot\u5bc6\u7801\uff0c\u5728linux \u884c\u672b\u8ffd\u52a0 rd.local, \u6309ctrl+x \u542f\u52a8","text":"<p>\u91cd\u65b0\u6302\u8f7d\u7cfb\u7edf\u6839\u76ee\u5f55, chroot\u5230\u6839\u76ee\u5f55\u548c\u4fee\u6539\u5bc6\u7801 <pre><code>mount -orw,remount /systemroot/\nchroot /systemroot/\npasswd\n</code></pre></p>","tags":["rhce","linux"]},{"location":"blog/%E8%AE%B0%E5%BD%95%E4%B8%80%E4%B8%8Brhce8%E4%B8%8A%E8%AF%BE%E7%AC%94%E8%AE%B0/#_1","title":"\u903b\u8f91\u5377\u6269\u5bb9","text":"<p>\u8bbe\u7f6e\u5206\u533astart\u4f4d\u7f6e\u7684\u65f6\u5019\uff0c\u8f93\u51652048s\u3002 s\u6307\u6247\u533a\uff0c\u4e00\u4e2a\u6247\u533a\u4e3a512\u5b57\u8282\uff0c 2048s\u63071M\uff0c\u8fd91M\u7684\u5206\u533a\u4e3aesp\u5206\u533a</p> <p>\u6269\u5bb9\u547d\u4ee4lvextrend\uff0c\u8fd9\u4e2a\u6269\u5bb9\u53ea\u662f\u5c06\u903b\u8f91\u5377\u6269\u5bb9\uff0c \u800c\u9898\u76ee\u8981\u6c42\u5bf9\u6587\u4ef6\u7cfb\u7edf\u6269\u5bb9\uff0c \u8fd8\u9700\u8981\u6267\u884c\u6587\u4ef6\u7cfb\u7edf\u7c7b\u578b\u5bf9\u5e94\u7684\u6269\u5bb9\u547d\u4ee4\u5982resize2fs(ext), xfs_growfs(xfs)\u3002  \u4f46\u5bf9lvextend\u547d\u4ee4\u6dfb\u52a0 -r \u53c2\u6570\u53ef\u4ee5\u4e00\u6b65\u5230\u4f4d <pre><code># \u6269\u5bb9\u5230300MB\nlvextend -r -L 300MB /dev/new_redhat/lv1\n</code></pre></p>","tags":["rhce","linux"]},{"location":"blog/%E8%AE%B0%E5%BD%95%E4%B8%80%E4%B8%8Brhce8%E4%B8%8A%E8%AF%BE%E7%AC%94%E8%AE%B0/#-s","title":"\u521b\u5efa\u903b\u8f91\u5206\u533a, \u6ce8\u610f\u907f\u514d\u78c1\u76d8\u4e0d\u591f\u7528\uff0c\u5c3d\u91cf\u5171\u7528\u4e0a\u4e00\u9898\u7684\u78c1\u76d8\u3002\u800c\u4e14\u521b\u5efa\u5377\u7ec4\u7684\u65f6\u5019\u4e0d\u8981\u5fd8\u8bb0-s\u53c2\u6570","text":"<p>\u9898\u76ee\u53ef\u80fd\u4e0d\u662f\u76f4\u63a5\u7ed9\u5206\u533a\u5927\u5c0f\uff0c\u800c\u662f\u7ed9\u51fa\u6269\u5c55\u5757\u5927\u5c0f\u548c\u62d3\u5c55\u5757\u4e2a\u6570\uff0c\u5176\u5b9e\u5206\u533a\u5927\u5c0f=\u62d3\u5c55\u5757\u5927\u5c0f \u00d7 \u62d3\u5c55\u5757\u4e2a\u6570\u3002 \u5728lvcreate -l \u6765\u6307\u5b9a\u5757\u4e2a\u6570 </p> <p>\u8fd9\u65f6\u5fc5\u987b\u4f7f\u7528msdos\u5206\u533a\u7c7b\u578b\u624d\u6709\u4e3b\u5206\u533a\u548c\u62d3\u5c55\u5206\u533a\uff0c\u800c\u4e14\u4e3a\u62d3\u5c55\u5206\u533a\u5206\u914d\u5269\u4f59\u7684\u6240\u6709\u7a7a\u95f4\u3002 \u6700\u540e\u5728\u62d3\u5c55\u5206\u533a\u4e0a\u521b\u5efa\u903b\u8f91\u5206\u533a\uff0c \u5e76\u5c06\u521b\u5efa\u7684\u903b\u8f91\u5206\u533a\u52a0\u5165\u5377\u7ec4</p> <p>\u521b\u5efa\u5206\u533a\uff0c\u5927\u5c0f\u901a\u8fc7\u4e0a\u9762\u7684\u7b97\u6cd5\u8ba1\u7b97\u51fa\u6765 <pre><code>parted \nmkpart\nprint\nexit\n</code></pre></p> <p>\u521b\u5efa\u5377\u7ec4 <pre><code>vgcreate -s 20MB -n npgroup /dev/vdb2\n</code></pre> \u521b\u5efa\u903b\u8f91\u5377, \u6ce8\u610f\u662f\u5c0f\u5199l <pre><code>lvcreate -l 45 -n np npgroup\n</code></pre> \u8fd9\u6837\u5c31\u521b\u5efa\u4e86\u4e00\u4e2a 20\u00d745 = 900MB\u7684\u903b\u8f91\u5377</p>","tags":["rhce","linux"]},{"location":"blog/%E8%AE%B0%E5%BD%95%E4%B8%80%E4%B8%8Brhce8%E4%B8%8A%E8%AF%BE%E7%AC%94%E8%AE%B0/#swapfstab","title":"\u521b\u5efa\u65b0\u7684swap\u5206\u533a\uff0c\u6ce8\u610f\u9700\u8981\u4fee\u6539fstab, \u800c\u4e14\u9a8c\u8bc1\u7684\u65f6\u5019\uff0c\u4e0d\u9700\u8981\u91cd\u542f\u7cfb\u7edf\uff0c\u800c\u662f\u6267\u884c","text":"<pre><code>systemctl daemon-reload \nswapon -a  # \u7c7b\u4f3cmount -a\nswapon --show \n</code></pre>","tags":["rhce","linux"]},{"location":"blog/%E8%AE%B0%E5%BD%95%E4%B8%80%E4%B8%8Brhce8%E4%B8%8A%E8%AF%BE%E7%AC%94%E8%AE%B0/#vdo-vdologicalsize-5g-gb","title":"vdo  --vdoLogicalSize 5G, \u4e0d\u80fd\u4f7f\u7528GB","text":"<p><pre><code>vdo create --name test --vdoLogicalSize 5G --device /dev/vdb\n</code></pre> <code>blkid</code> \u67e5\u5230 UUID, \u6700\u540e\u6dfb\u52a0\u5230fstab</p>","tags":["rhce","linux"]},{"location":"blog/%E8%AE%B0%E5%BD%95%E4%B8%80%E4%B8%8Brhce8%E4%B8%8A%E8%AF%BE%E7%AC%94%E8%AE%B0/#vdo-mount","title":"vdo \u6301\u4e45\u6302\u8f7d mount","text":"<pre><code>default,x-systemd.requires=vdo.service\n</code></pre>","tags":["rhce","linux"]},{"location":"blog/%E8%AE%B0%E5%BD%95%E4%B8%80%E4%B8%8Brhce8%E4%B8%8A%E8%AF%BE%E7%AC%94%E8%AE%B0/#rhce","title":"RHCE","text":"<p>ansible\u7684\u6709\u7528\u547d\u4ee4 ansbile-doc -l | grep  \u67e5\u627e\u6a21\u5757\u548c\u4ecb\u7ecd ansible-doc \u6a21\u5757 \u67e5\u770b\u6a21\u5757\u5177\u4f53\u8bf4\u660e</p>","tags":["rhce","linux"]},{"location":"blog/%E8%AE%B0%E5%BD%95%E4%B8%80%E4%B8%8Brhce8%E4%B8%8A%E8%AF%BE%E7%AC%94%E8%AE%B0/#inventory","title":"\u521b\u5efainventory \u6587\u4ef6\uff0c \u5b50\u7ec4\u7684\u5199\u6cd5\u4e3a","text":"<p>[webservices:children] prod</p> <p>prod \u662fwebserverices\u7ec4\u7684\u5b50\u7ec4</p>","tags":["rhce","linux"]},{"location":"blog/%E8%AE%B0%E5%BD%95%E4%B8%80%E4%B8%8Brhce8%E4%B8%8A%E8%AF%BE%E7%AC%94%E8%AE%B0/#ansiblecfg-etcansbileansiblecfg-ansbile","title":"\u521b\u5efaansible.cfg \u6587\u4ef6\uff0c\u53ef\u4ee5\u590d\u5236 /etc/ansbile/ansible.cfg \u5230\uff5e/ansbile/\u76ee\u5f55\u4e0b","text":"<p>\u5bb9\u6613\u5fd8\u8bb0\u7684\u9009\u9879\u662f\u8fdc\u7a0b\u767b\u9646\u8eab\u4efd\uff0c \u5373\u914d\u7f6e remote_user = devops \u5982\u679c\u73af\u5883\u6ca1\u6709\u914d\u7f6e\u514d\u5bc6\u767b\u9646\uff0c\u9700\u8981\u5728[defaults] \u680f\u6dfb\u52a0 <code>ask_pass = True</code></p> <p>\u9a8c\u8bc1\u65b9\u6cd5 <code>ansible all -m ping</code></p>","tags":["rhce","linux"]},{"location":"blog/%E8%AE%B0%E5%BD%95%E4%B8%80%E4%B8%8Brhce8%E4%B8%8A%E8%AF%BE%E7%AC%94%E8%AE%B0/#ansbile-ad-hoc-yum-ansible-ansible-m-a","title":"ansbile ad-hoc \u6dfb\u52a0yum \u6e90  ansible \u6a21\u5757\u7684\u4f7f\u7528\u65b9\u6cd5 ansible \u4e3b\u673a\u540d -m \u6a21\u5757 -a '\u53c2\u6570'","text":"<p>\u811a\u672c\u8981\u6dfb\u52a0\u53ef\u6267\u884c\u6743\u9650</p> <pre><code>#!/bin/bash\n\n# \u5148\u8981\u5207\u6362\u5230\u5de5\u4f5c\u76ee\u5f55\ncd /home/devops/ansible/\n\nansible all -m yum-repository  -a 'name=  description=  baseurl=  enabled= gpgcheck= gpgkey= '\n</code></pre>","tags":["rhce","linux"]},{"location":"blog/%E8%AE%B0%E5%BD%95%E4%B8%80%E4%B8%8Brhce8%E4%B8%8A%E8%AF%BE%E7%AC%94%E8%AE%B0/#_2","title":"\u5b89\u88c5\u8f6f\u4ef6\u5305","text":"<p>\u5b89\u88c5\u8f6f\u4ef6\u5305\u5982'Development Tools', \u9700\u8981\u5728\u5305\u540d\u524d\u9762\u52a0'@'\u5373 '@Development Tools' \u9a8c\u8bc1yaml \u8bed\u6cd5\u683c\u5f0f: <code>ansible-playbook --syntax-check *.yml</code></p> <pre><code>- name: install  development tools\n  hosts: dev\n  tasks:\n    - name: install development tools\n        yum:\n          name: \"@Development Tools\"\n          state: present                  \n</code></pre>","tags":["rhce","linux"]},{"location":"blog/%E8%AE%B0%E5%BD%95%E4%B8%80%E4%B8%8Brhce8%E4%B8%8A%E8%AF%BE%E7%AC%94%E8%AE%B0/#rhel-system-roles-roles","title":"\u540c\u6b65\u65f6\u95f4\u4f9d\u8d56\u89d2\u8272\uff0c\u5b89\u88c5\u89d2\u8272\u5305'rhel-system-roles' \u9700\u8981\u5728\u914d\u7f6e\u6587\u4ef6\u91cc\u6dfb\u52a0\u4e0aroles\u8def\u5f84","text":"<p>playbook \u793a\u4f8b\u5728/usr/share/ansibe/roles/rhel-system-roles.timesync/Readme.md \u73b0\u6210\u7684yml\u793a\u4f8b\u5728/usr/share/doc/rhel-system-roles/timesync/example-timesync-playbook.yml</p> <pre><code># ansible.cfg\n[default]\nroles_path = /home/devops/ansible/roles:/usr/share/ansible/roles\n</code></pre>","tags":["rhce","linux"]},{"location":"blog/%E8%AE%B0%E5%BD%95%E4%B8%80%E4%B8%8Brhce8%E4%B8%8A%E8%AF%BE%E7%AC%94%E8%AE%B0/#ansible-galaxy-roles","title":"\u4f7f\u7528ansible-galaxy \u547d\u4ee4\u5b89\u88c5\u89d2\u8272\uff0c\u5b89\u88c5\u5230\u672c\u5730roles\u76ee\u5f55","text":"<p>yml\u6587\u4ef6\u5f88\u7b80\u5355, \u6267\u884c\u547d\u4ee4 ansible-galaxy install -r roles/requirement.yml -p roles/ -p \u8868\u793a\u5b89\u88c5\u8def\u5f84 </p> <pre><code>- name: balancer\n  file: /home/devops/ansible/files/5/haproxy.tar\n</code></pre>","tags":["rhce","linux"]},{"location":"blog/%E8%AE%B0%E5%BD%95%E4%B8%80%E4%B8%8Brhce8%E4%B8%8A%E8%AF%BE%E7%AC%94%E8%AE%B0/#apache","title":"\u521b\u5efaapache\u89d2\u8272\uff0c \u89d2\u8272\u5bf9\u5e94\u4e00\u7cfb\u5217\u7684\u4efb\u52a1\u548c\u6a21\u677f\u6587\u4ef6","text":"<p>\u901a\u8fc7<code>ansible-galaxy init apache</code> \u6765\u521d\u59cb\u5316\u89d2\u8272\u76ee\u5f55\uff0c\u4fee\u6539\u89d2\u8272\u76ee\u5f55\u4e0b\u7684tasks/mail.yml \u6765\u6dfb\u52a0\u4efb\u52a1\uff0c\u4efb\u52a1\u6240\u9700\u7684\u6a21\u677f\u6587\u4ef6\u5728\u540c\u7ea7\u76ee\u5f55templates\u4e0b \u901a\u8fc7<code>ansible servera -m setup</code> \u6765\u67e5\u8be2\u73af\u5883\u53d8\u91cf\uff0c \u5728\u6a21\u677f\u6587\u4ef6\u4e2d\u4f7f\u7528<code>ansible_facts['fqdn']</code> \u6765\u5f15\u7528\u53d8\u91cf \u9898\u76ee\u8bf4\u7684hostname \u662f<code>serverc.lab.example.com</code> \u5bf9\u5e94\u53d8\u91cf\u662ffqdn, \u53e6\u5916\u4e00\u4e2a\u662fip\u5373 ['default_ipv4']['address']</p> <p>\u4f8b\u5982\uff0c\u5b89\u88c5httpd\u7528\u5230yum\u6a21\u5757\uff0c \u542f\u7528httpd \u7528\u5230service\u6a21\u5757\uff0c \u9632\u706b\u5899\u914d\u7f6e\u7528\u5230firewalld\u6a21\u5757 <pre><code># home/devops/ansible/role/apache/tasks/main.yml\n\n---\n- name: install httpd\n  yum:\n    name: httpd\n    state: present\n\n- name: enable httpd\n  service:\n    name: httpd\n    state: started\n    enabled: yes\n\n- name: firewalld config\n  firewalld:\n    service: httpd\n    immediate: yes\n    permanent: yes\n    state: enabled\n\n- name: install templates\n  template:\n    src: index.html.j2\n    dest: /var/www/html/index.html \n</code></pre></p> <p>\u6a21\u5757\u6587\u4ef6\u653e\u5230templates\u76ee\u5f55\u4e0b <pre><code># home/devops/ansible/role/apache/templates/index.html.j2\nWelcome to {{ ansible_facts['fqdn'] }} on {{ ansible_facts['default_ipv4']['address'] }}\n</code></pre></p> <p>\u6700\u540e\u8fd8\u9700\u8981\u521b\u5efa\u4e00\u4e2aplaybook, \u5982\u540c\u5176\u4ed6playbook \u4e00\u6837\u6267\u884c <pre><code># newrole.yml\n---\n- name: install new role\n  hosts: webservers\n  roles:\n    - apache\n</code></pre></p>","tags":["rhce","linux"]},{"location":"blog/%E8%AE%B0%E5%BD%95%E4%B8%80%E4%B8%8Brhce8%E4%B8%8A%E8%AF%BE%E7%AC%94%E8%AE%B0/#balancer","title":"\u6267\u884cbalancer \u89d2\u8272, \u521b\u5efa\u4e00\u4e2a\u8d1f\u8f7d\u5747\u8861","text":"<p>\u9a8c\u8bc1\uff1a ssh\u5230serverd \u4e0a\uff0ccurl localhost, \u5148\u662f\u8bbf\u95ee\u7684serverb, \u7136\u540e\u8bbf\u95ee\u7684serverc</p> <pre><code>---\n- name: deploy apache on webservers\n  hosts: webservers\n  roles:\n    - apache\n\n- name: deploy balancer on balancer\n  hosts: balancers\n  roles:\n    - balancer\n\n- name: deploy phpinfo on webservers\n  hosts: webservers\n  roles:\n    - phpinfo\n</code></pre>","tags":["rhce","linux"]},{"location":"blog/%E8%AE%B0%E5%BD%95%E4%B8%80%E4%B8%8Brhce8%E4%B8%8A%E8%AF%BE%E7%AC%94%E8%AE%B0/#bindbalance-roletemplate","title":"\u53ef\u80fd\u51fa\u73b0\u7684\u9519\u8bef\uff0c\u63d0\u793a\u5e94\u8be5\u4f7f\u7528bind\uff0c\u8fd9\u662f\u7531\u4e8ebalance role\u7684template \u9519\u8bef","text":"<p>\u4fee\u6539\u529e\u6cd5, \u5c06listen\u884c\u6362\u884c\u5e76\u52a0\u4e0abind</p> <pre><code># /home/devops/ansible/roles/balancer/templates/haproxy.cfg.j2\n\nbackend app\n  {% for host in groups.balancers %}\n-   listen {{ daemonname }} 0.0.0.0:{{ listenport }}\n+   listen {{ daemonname }} \n+   bind 0.0.0.0:{{ listenport }}\n  {% endfor %}\n</code></pre>","tags":["rhce","linux"]},{"location":"blog/%E8%AE%B0%E5%BD%95%E4%B8%80%E4%B8%8Brhce8%E4%B8%8A%E8%AF%BE%E7%AC%94%E8%AE%B0/#blockrescuealways-lvolwhen-play","title":"\u521b\u5efa\u903b\u8f91\u5377\uff0c\u8003\u9a8cblock/rescue/always, \u4f7f\u7528lvol\uff0c<code>when</code> \u548cplay\u5bf9\u9f50","text":"<p>\u4f7f\u7528\u4e86block/rescue/always\u5c31\u4e0d\u9700\u8981tasks\u5173\u952e\u8bcd</p> <pre><code>---\n- name: create a logic volume with size of 5000 and format\n  hosts: all\n  block:\n    - name: create logic volume\n      lvol:\n        vg: research\n        lv: data\n        size: 1500\n    - name: fomat data volume\n        filesystem:\n          fstype: ext4\n          dev: /dev/research/data\n  rescue:\n    - name: debug message\n      debug:\n        msg: can't create a size of 1800\n    - name: create a logical volume with size of 800 and format\n        lvol:\n          vg: research\n          lv: data\n          size: 1500\n    - name: fomat data volume\n        filesystem:\n          fstype: ext4\n          dev: /dev/research/data\n      when: ansible_facts['lvm']['vgs']['research'] is defined\n      ignore_errors: yes\n    - name: debug 2 \n        debug:\n          msg: volume group does not exist\n      when: ansible_facts['lvm']['vgs']['research'] is undefined\n</code></pre>","tags":["rhce","linux"]},{"location":"blog/%E8%AE%B0%E5%BD%95%E4%B8%80%E4%B8%8Brhce8%E4%B8%8A%E8%AF%BE%E7%AC%94%E8%AE%B0/#hosts-jinija-forinventory","title":"\u521b\u5efahosts\u6587\u4ef6\uff0c \u8003\u9a8cjinija \u7684for\u5faa\u73af\u548c\u8bfbinventory\u6587\u4ef6","text":"<p>\u53d6facts\u53d8\u91cf\u7684\u65b9\u6cd5\u53c2\u8003balancer\u7684\u6a21\u677f\uff1a  /home/ansible/roles/balancer/roles/template/haproxy.cfg.j2</p> <p>\u57fa\u4e8e\u7ed9\u7684hosts.j2 \u6587\u4ef6\u4fee\u6539, \u62fc\u51d1\u51fa<code>ip url alias</code>\u683c\u5f0f\uff0c\u5206\u522b\u5bf9\u5e94 default_ipv4.address, fqdn, hostname ansible_facts\u5728hostvars[host]\u4e2d</p> <pre><code># \u53d6\n{% for host in groups.all %}\n{{ hostvars[host]['ansible_facts'] *\u5ffd\u9732\u4e0d\u5199\u4e86* }} \u00d7 \u00d7 \n{% endfor %}\n--- \n\n\u521b\u5efaplaybook\u7684\u8981\u5c0f\u5fc3\uff0c\u9898\u76ee\u8981\u6c42\u751f\u6210\u6240\u6709\u4e3b\u673a\u7684\u7eaa\u5f55\uff0c\u6240\u4ee5hosts\u662fall, \u4f46\u53ea\u90e8\u7f72\u5728dev\u7ec4\u7684\u4e3b\u673a\u4e0a\u8981\u52a0when,   \n\u8981\u52a0`when: 'dev' in group_names`\n\n```yml\n---\n- name: gen hosts and deploy on dev group\n  tasks:\n    - name: gen hosts and deploy\n        template:\n          src: hosts.j2\n          dest: /etc/myhosts\n      when: \"'dev' in group_names\"\n</code></pre>","tags":["rhce","linux"]},{"location":"blog/%E8%AE%B0%E5%BD%95%E4%B8%80%E4%B8%8Brhce8%E4%B8%8A%E8%AF%BE%E7%AC%94%E8%AE%B0/#web-server-setypehttpd_system_content_t","title":"\u521b\u5efaweb server, \u6ce8\u610f\u5c06\u6587\u4ef6\u6807\u6ce8setype\u4e3ahttpd_system_content_t","text":"<p>\u901a\u8fc7man semanager-fcontext \u67e5\u8be2setype, \u6216\u8005\u4f7f\u7528<code>ls -ldZ</code>\u6765\u67e5\u8be2selinux\u6807\u7b7e</p> <p>\u521b\u5efa\u6587\u4ef6\uff0c\u76ee\u5f55\u3001\u94fe\u63a5\u90fd\u7528file\u6a21\u5757\uff0c\u4f46\u64cd\u4f5c\u6587\u4ef6\u5185\u5bb9\u7528copy\u6a21\u5757 \u521b\u5efa\u7ec4\u7528group\u6a21\u5757,\u521b\u5efa\u7528\u6237\u7528user\u6a21\u5757 \u5bb9\u6613\u641e\u53cd\u7684\u94fe\u63a5\u7684src\u662f\u6307\u5411\u7684\u6587\u4ef6\uff0c\u6240\u4ee5\u662f/webdev, \u53ef\u4ee5\u770b\u5e2e\u52a9\u6587\u6863</p> <pre><code>---\n- name: create web server\n  hosts: webservers\n  tasks:\n    - name: add group\n        group:\n           name: webdev\n           state: present\n    - name: create directory\n        file:\n          path: /webdev\n          group: webdev\n          state: directory\n          mode: u+rwx,g+rwxs,o-rx\n -        setype: httpd_system_content_t\n    - name: create a symbolic link\n        file:\n -        src: /var/www/html/webdev\n -        dest: /webdev\n +        src: /webdev\n +        dest: /var/www/html/webdev\n          state: link\n    - name: create index.html\n        copy:\n          content: Development\n          dest: /var/www/html/webdev/index.html\n+         setype: httpd_system_content_t                    \n</code></pre>","tags":["rhce","linux"]},{"location":"blog/%E8%AE%B0%E5%BD%95%E4%B8%80%E4%B8%8Brhce8%E4%B8%8A%E8%AF%BE%E7%AC%94%E8%AE%B0/#loopsitem-regexslineinfile","title":"\u521b\u5efa\u786c\u4ef6\u62a5\u544a\uff0c\u7528\u5230loops\u8fdb\u884c\u6570\u7ec4\u5faa\u73af\uff0c\u5185\u7f6e\u53d8\u91cfitem\u548c regexs\u5339\u914d\uff0clineinfile \u8fdb\u884c\u6587\u4ef6\u7f16\u8f91","text":"<pre><code>---\n- name: generate hw report\n  hosts: all\n  vars:\n    hw_all:\n      - hw_name: HOST\n        hw_content: \"{{ ansible_facts['hostname'] }}\"\n      - hw_name: BIOS_version\n        hw_content: \"{{ ansible_facts['bios_version'] }}\"\n</code></pre>","tags":["rhce","linux"]},{"location":"blog/%E8%AE%B0%E5%BD%95%E4%B8%80%E4%B8%8Brhce8%E4%B8%8A%E8%AF%BE%E7%AC%94%E8%AE%B0/#ansible-vault","title":"\u521b\u5efa\u52a0\u5bc6\u6587\u4ef6\uff0c\u7528\u5230ansible-vault\u547d\u4ee4","text":"<pre><code>ansible-vault encrypt lock.yml --vault-password-file=secret.txt \n</code></pre>","tags":["rhce","linux"]},{"location":"blog/%E8%AE%B0%E5%BD%95%E4%B8%80%E4%B8%8Brhce8%E4%B8%8A%E8%AF%BE%E7%AC%94%E8%AE%B0/#ansible-playbook-vault-password-filesecrettxt","title":"\u6dfb\u52a0\u7528\u6237\uff0c ansible-playbook \u901a\u8fc7 --vault-password-file=secret.txt \u6765\u4f20\u5bc6\u7801\u6587\u4ef6","text":"<p>\u901a\u8fc7<code>vars_files</code>\u6765\u8bfb\u53d6\u53d8\u91cf\u6587\u4ef6\uff0c loop \u6765\u5faa\u73af\u904d\u5386\u6570\u7ec4\u53d8\u91cf\uff0c \u7136\u540e\u6a21\u677f\u76f4\u63a5\u53d6\u5bc6\u7801\u540e\u7528'| password_hash('sha512')' \u6765\u52a0\u5bc6\u5bc6\u7801 \u901a\u5e38\u60c5\u51b5\u4e0b\u5728playbook\u4e2d\uff0c\u5f00\u5934\u4f4d\u7f6e\u5f15\u7528\u4e00\u4e2a\u53d8\u91cf\u65f6\u90fd\u9700\u8981\"{{ variable }}\"\uff0c \u4f46\u662f\u5728when\u5757\u91cc\uff0c\u5219\u76f4\u63a5\u4f7f\u7528 variable\u3002 \u53e6\u5916\u5b57\u7b26\u4e32\u8981\u7528\u201cstring\u201d  </p> <p>\u521b\u5efa\u7528\u6237\u65f6\uff0c \u6307\u5b9a\u9644\u5c5e\u7ec4\u7528groups, \u4e3b\u8981\u7ec4\u662fgroup</p> <pre><code>- {{ variable }} ## \u9519\u8bef\nkey: {{ variable }} ## \u9519\u8bef\n- \"{{ variable}}\" ## \u6b63\u786e\nkey: \"{{ variable }}\" ## \u6b63\u786e\n</code></pre> <p>\u7ed3\u679c <pre><code>---\n- name: create user on dev,test\n  hosts: dev,test\n  vars_files:\n    - lock.yml\n    - user_list.yml\n  tasks:\n    - name: create group devops\n      group:\n        name: devops\n        state: present\n    - name: create user \n      user:\n        name: \"{{ item.name }}\"\n-       group: devops\n+       groups: devops        \n        password: \"{{ pw_developer | password_hash('sha512') }}\"\n      loop: \"{{ user }}\"\n-     when: \"{{ item.job }}\" == developer\n+     when: item.job == \"developer\"\n- name: create user on prod\n  hosts: prod\n  vars_files:\n    - lock.yml\n    - users_list.yml\n  tasks:\n    - name: create group manager\n      group:\n        name: manager\n        state: present\n    - name: create user\n      user:\n        name: \"{{ item.name }}\"\n        groups: manager\n        password: \"{{ pw_manager | password_hash('sha512') }}\"\n      loop: \"{{ user }}\"\n-     when: \"{{ item.job }}\" == manager\n+     when: item.job == \"manager\"\n</code></pre></p>","tags":["rhce","linux"]},{"location":"blog/%E8%AE%B0%E5%BD%95%E4%B8%80%E4%B8%8Brhce8%E4%B8%8A%E8%AF%BE%E7%AC%94%E8%AE%B0/#ansible-vault-rekey","title":"\u4fee\u6539\u5bc6\u7801, \u4f7f\u7528<code>ansible-vault rekey</code> \u4fee\u6539\u5bc6\u7801\uff0c\u6216\u8005\u5148\u89e3\u5bc6\u540e\u52a0\u5bc6","text":"","tags":["rhce","linux"]},{"location":"blog/%E8%AE%B0%E5%BD%95%E4%B8%80%E4%B8%8Brhce8%E4%B8%8A%E8%AF%BE%E7%AC%94%E8%AE%B0/#copywhen","title":"\u4fee\u6539\u6587\u4ef6\u5185\u5bb9, \u4f7f\u7528copy\u6a21\u5757\uff0c\u4ee5\u53cawhen\u6761\u4ef6\u5224\u65ad","text":"<p>\u5728playbook\u7684\u5185\u5efa\u53d8\u91cf inventory_hostname \u8868\u793a\u5b9a\u4e49\u5728inventory\u91cc\u7684\u4e3b\u673a\u540d\u79f0 \u4e5f\u53ef\u4ee5\u4f7f\u7528ansible_facts['hostname'],\u524d\u63d0\u662f\u88ab\u7ba1\u7406\u8282\u70b9\u7684hostname\u5fc5\u987b\u5982\u679c\u7ba1\u7406\u8282\u70b9\u5b9a\u4e49\u540d\u79f0\u4e00\u6837\u3002 \u56e0\u4e3a\u540e\u8005\u662f\u5230\u88ab\u7ba1\u7406\u8282\u70b9\u83b7\u53d6\u3002</p> <p>\u4f7f\u7528when \u9650\u5b9a\u6761\u4ef6\uff0c \u6ee1\u8db3\u6761\u4ef6\u624d\u80fd\u6267\u884c\u8fd9\u4e2atask <pre><code>---\n- name: create issue\n  hosts: all\n  tasks:\n    - name: create issue file\n      copy:\n        content: \"Development\"\n        dest: /etc/issue\n      when: inventory_name in groups.dev  \n</code></pre></p>","tags":["rhce","linux"]},{"location":"blog/%E8%AE%B0%E5%BD%95%E4%B8%80%E4%B8%8Brhce8%E4%B8%8A%E8%AF%BE%E7%AC%94%E8%AE%B0/#_3","title":"\u7b2c\u4e8c\u6b21\u6392\u9519","text":"","tags":["rhce","linux"]},{"location":"blog/%E8%AE%B0%E5%BD%95%E4%B8%80%E4%B8%8Brhce8%E4%B8%8A%E8%AF%BE%E7%AC%94%E8%AE%B0/#ansible-galaxy-srcname","title":"ansible-galaxy \u5b89\u88c5\u89d2\u8272, \u6307\u5b9a\u65b9\u6cd5\u5206\u522b\u662f src/name","text":"<pre><code>- src: files/5/balancer.tar\n  name: balancer\n- src: files/5/phpinfo.tar\n  name: phpinfo\n</code></pre>","tags":["rhce","linux"]},{"location":"blog/%E8%AE%B0%E5%BD%95%E4%B8%80%E4%B8%8Brhce8%E4%B8%8A%E8%AF%BE%E7%AC%94%E8%AE%B0/#timesync-doc-timedatectl-system-clock-syncronize-yes","title":"timesync \u770bdoc \u793a\u4f8b\uff0c \u9a8c\u8bc1\u65b9\u6cd5\u662f\u770btimedatectl \u770bsystem clock syncronize \u4e3a yes","text":"<pre><code>---\n- name: use timesync role\n  hosts: all\n  vars:\n    timesync_ntp_servers:\n      - hostname: \n        iburst: yes\n  roles:\n    - rhel_system_roles.timesync\n</code></pre>","tags":["rhce","linux"]},{"location":"blog/%E8%AE%B0%E5%BD%95%E4%B8%80%E4%B8%8Brhce8%E4%B8%8A%E8%AF%BE%E7%AC%94%E8%AE%B0/#hosts-for-host-in-groupsall-hostvarshostansible_facts-endfor","title":"\u521b\u5efahosts, \u8981\u7528 {% for  host in groups.all %} {{ hostvars[host].ansible_facts }} {% endfor %}","text":"","tags":["rhce","linux"]},{"location":"blog/%E8%AE%B0%E5%BD%95%E4%B8%80%E4%B8%8Brhce8%E4%B8%8A%E8%AF%BE%E7%AC%94%E8%AE%B0/#firewalldimmediate","title":"\u4f7f\u7528firewalld\u6a21\u5757\u65f6\uff0c\u9700\u8981\u6307\u5b9aimmediate \u53c2\u6570\uff0c\u786e\u4fdd\u80fd\u7acb\u5373\u751f\u6548","text":"","tags":["rhce","linux"]},{"location":"blog/%E8%AE%B0%E5%BD%95%E4%B8%80%E4%B8%8Brhce8%E4%B8%8A%E8%AF%BE%E7%AC%94%E8%AE%B0/#urwxgrwxsorw-urwx","title":"\u8bbe\u7f6e\u6587\u4ef6\u7684\u6743\u9650\u65f6\uff0c\u5e94\u4f7f\u7528u=rwx,g=rwxs,o=rw, \u800c\u4e0d\u662fu+rwx\uff0c\u539f\u56e0\u5f88\u597d\u7406\u89e3","text":"","tags":["rhce","linux"]},{"location":"blog/%E5%8D%95%E5%90%91%E9%93%BE%E8%A1%A8%E7%BF%BB%E8%BD%AC%E7%AE%97%E6%B3%95/","title":"\u5355\u5411\u94fe\u8868\u7ffb\u8f6c\u7b97\u6cd5","text":"","tags":["\u7b97\u6cd5"]},{"location":"blog/%E5%8D%95%E5%90%91%E9%93%BE%E8%A1%A8%E7%BF%BB%E8%BD%AC%E7%AE%97%E6%B3%95/#_2","title":"\u4e09\u6307\u9488\u6cd5\u7ffb\u8f6c\u5355\u5411\u94fe\u8868","text":"<p>\u5b9a\u4e493\u4e2a\u6307\u9488, \u539f\u7406\u662f\u4e09\u4e2a\u6307\u9488\u5206\u522b\u6307\u5411\u524d\u4e09\u4e2a\u5143\u7d20\uff0c\u5c06\u7b2c\u4e00\u4e2a\u5143\u7d20\u6307\u5411\u7b2c\u4e8c\u4e2a\u5143\u7d20\uff0c\u7136\u540e\u5168\u90e8\u540e\u79fb 1. \u7b2c\u4e09\u4e2a\u6307\u9488\u5411\u524d\u79fb\u52a8 2. \u5c06\u7b2c\u4e8c\u4e2a\u5143\u7d20\u6307\u5411\u7b2c\u4e00\u4e2a\u5143\u7d20 3. \u7b2c\u4e00\u4e2a\u6307\u9488\u548c\u7b2c\u4e8c\u4e2a\u6307\u9488\u5411\u524d\u79fb\u52a8</p> <pre><code>struct Node{\n\u3000\u3000int data;\n\u3000\u3000Node *next;\n};\n\nNode *reverse(Node *head) {\n  Node *pPrev = nullptr;\n  Node *pHead = head;\n  Node *pNext = nullptr;\n  while (pHead) {\n    pNext = pHead-&gt;next;\n    pHead-&gt;next = pPrev;\n    pPrev = pHead;\n    pHead = pNext;\n  }\n  return pHead;\n}\n</code></pre> <pre><code>Node *reverse(Node *head) {\n  if (!head) {\n    return head;\n  }\n  Node *first = nullptr;\n  Node *second = head;\n  Node *third = head-&gt;next;\n\n  while (third) {\n    second-&gt;next = first;\n\n    first = second;\n    second = third;\n    third = third-&gt;next;\n  }\n\n  second-&gt;next = first;\n\n  return second;\n}\n</code></pre>","tags":["\u7b97\u6cd5"]},{"location":"blog/%E5%8D%95%E5%90%91%E9%93%BE%E8%A1%A8%E7%BF%BB%E8%BD%AC%E7%AE%97%E6%B3%95/#_3","title":"\u7ffb\u8f6c\u94fe\u8868\u7684\u90e8\u5206\u8282\u70b9","text":"<p>\u7ffb\u8f6cnode[m]-&gt;node[N]\u90e8\u5206\uff0c \u7406\u89e3\u65f6\u5148\u5c06\u94fe\u8868\u5206\u4e3a3\u90e8\u5206: part1-&gt;part2-&gt;part3, \u53ea\u7ffb\u8f6cpart2  </p> <p>\u7ffb\u8f6c\u52a8\u4f5c\u5957\u7528\u4e09\u6307\u9488\u6cd5\uff0c\u4f46\u90e8\u5206\u7ffb\u8f6c\u7684\u96be\u70b9\u5728\u4e8e\u5904\u7406part1\u4e3a\u7a7a\u548c\u975e\u7a7a\u7684\u60c5\u51b5\uff0c\u6240\u4ee5\u8981\u5224\u65adm\u65f6\u5019\u4e3a1 * m==1\u5373\u8981\u7ffb\u8f6c\u7b2c\u4e00\u4e2a\u5143\u7d20\u65f6\uff0c\u9700\u8981\u5148\u8bb0\u5f55part2\u7ffb\u8f6c\u540e\u7684tail node\uff0c\u6700\u540e\u5c06\u5176next\u6307\u5411part3\u7684\u7b2c\u4e00\u4e2a\u5143\u7d20 * m!=1\u5373part1\u4e0d\u4e3a\u7a7a\uff0c\u9700\u8981\u5148\u8bb0\u5f55part2\u7ffb\u8f6c\u540e\u7684tail node\u548cpart1\u7684\u6700\u540e\u4e00\u4e2anode\uff0c\u6700\u540e\u5c06\u5176\u6307\u5411part2\u7684\u65b0head,\u4ee5\u53ca\u5c06part2\u7684\u7b2c\u4e00\u4e2anode\u6307\u5411part3</p> <pre><code>struct ListNode *reverseBetween(struct ListNode *head, int m, int n) {\n  if (m == n) {\n    return head;\n  }\n\n  if(!head || !head-&gt;next){\n    return head;\n  }\n\n  // write code here\n  struct ListNode *pleft = NULL;\n  struct ListNode *phead = head;\n  struct ListNode *pright = NULL;\n\n\n  // \u53ea\u6709\u5f53m\uff01=1\u65f6\u624d\u9700\u8981\uff0c\u6307\u5411part1\u7684\u6700\u540e\u4e00\u4e2a\u5143\u7d20\n  struct ListNode *pPart1Tail = NULL;\n  // \u5f53m=1\u65f6\u6307\u5411part2\u7684\u7b2c\u4e00\u4e2a\u5143\u7d20\n  struct ListNode *pPart2NewTail = NULL;\n\n  // skip m\n  for (int i = 1; i &lt; m; i++) {\n    pleft = phead; \n    phead = phead-&gt;next;\n  }\n\n  // \u4fdd\u5b58part2\u7684head,\u4e5f\u662f\u7ffb\u8f6c\u540e\u7684tail\n  pPart2NewTail = phead;\n  // m != 1 \u65f6pleft\u4e0d\u4e3aNULL\n  struct ListNode *pPartOneTail = pleft;\n\n  int i = 0;\n  // \u7ffb\u8f6c\u6b21\u6570\u8981\u6bd4m-n\u59271\n  while (phead &amp;&amp; i &lt; n - m + 1) {\n    pright = phead-&gt;next;\n\n    phead-&gt;next = pleft;\n\n    pleft = phead;\n    phead = pright;\n    i++;\n  }\n\n  if(m==1){\n    // \u6307\u5411part3\u7684\u5934\n    pPart2NewTail-&gt;next = phead;\n    return pleft;\n  }\n\n  pPartOneTail-&gt;next = pleft;\n  pPart2NewTail-&gt;next = phead;\n\n  return head;\n}\n</code></pre>","tags":["\u7b97\u6cd5"]},{"location":"blog/difference-of-lxc-container-and-docker-container/","title":"difference of lxc container and docker container","text":"<ul> <li>creating a lxc container will alloc a new partition from lvm(a new logic partition), create a root-fs and copy image into it, and the image is a zip file. </li> <li>creating a docker container will mount docker image layers one by one into the host's fs</li> </ul>","tags":["pve","docker","lxc"]},{"location":"blog/difference-of-lxc-container-and-docker-container/#best-way","title":"best way","text":"<p>best way of running docker in pve is probably install docker inner a lxc container</p>","tags":["pve","docker","lxc"]},{"location":"blog/difference-of-lxc-container-and-docker-container/#speed-up-docker-installation","title":"speed up docker installation","text":"<p>https://mirrors.tuna.tsinghua.edu.cn/help/docker-ce/</p>","tags":["pve","docker","lxc"]},{"location":"blog/difference-of-lxc-container-and-docker-container/#remove-old","title":"remove old","text":"<p>for pkg in docker.io docker-doc docker-compose podman-docker containerd runc; do apt-get remove $pkg; done</p>","tags":["pve","docker","lxc"]},{"location":"blog/difference-of-lxc-container-and-docker-container/#setup-repository","title":"setup repository","text":"<p>apt-get update apt-get install ca-certificates curl gnupg install -m 0755 -d /etc/apt/keyrings curl -fsSL https://download.docker.com/linux/debian/gpg | gpg --dearmor -o /etc/apt/keyrings/docker.gpg sudo chmod a+r /etc/apt/keyrings/docker.gpg echo \\   \"deb [arch=\\((dpkg --print-architecture) signed-by=/etc/apt/keyrings/docker.gpg] https://mirrors.tuna.tsinghua.edu.cn/docker-ce/linux/debian \\   \"\\)(. /etc/os-release &amp;&amp; echo \"$VERSION_CODENAME\")\" stable\" | \\   tee /etc/apt/sources.list.d/docker.list &gt; /dev/null</p>","tags":["pve","docker","lxc"]},{"location":"blog/difference-of-lxc-container-and-docker-container/#install","title":"install","text":"<p>apt-get update apt-get install docker-ce docker-ce-cli containerd.io docker-buildx-plugin docker-compose-plugin</p>","tags":["pve","docker","lxc"]},{"location":"blog/difference-of-lxc-container-and-docker-container/#copy-image-to-another-host","title":"copy image to another host","text":"<p>docker save  | bzip2 | ssh user@host docker load","tags":["pve","docker","lxc"]},{"location":"blog/difference-of-lxc-container-and-docker-container/#fix-problem-modprobe-fatal-module-fuse-not-found-in-directory-libmodules6110-1-pve","title":"fix problem 'modprobe: FATAL: Module fuse not found in directory /lib/modules/6.1.10-1-pve'","text":"<p>enable the Options of your container (Select the container on the left-hand side &gt; Options &gt; Features) and then enable FUSE</p> <p>warn Just be aware that FUSE in LXC containers can cause some problems (no snapshots, no suspend backup, lower security since there is less containment).</p>","tags":["pve","docker","lxc"]},{"location":"blog/difference-of-lxc-container-and-docker-container/#convert-docker-image-to-lxc-image","title":"convert docker image to lxc image","text":"<p>https://www.reddit.com/r/Proxmox/comments/u9ru5c/comment/i640ixf/?utm_source=share&amp;utm_medium=web3x&amp;utm_name=web3xcss&amp;utm_term=1&amp;utm_content=share_button</p> <p>https://gist.github.com/flaki/9a6c58447e50219a9b77a7cd15433896</p>","tags":["pve","docker","lxc"]},{"location":"blog/run-vllm-qwen3-locally/","title":"run vllm Qwen3 locally","text":"<ul> <li>torch==2.5.1+cu121  https://mirrors.aliyun.com/pytorch-wheels/cu121/torch-2.5.1+cu121-cp313-cp313-linux_x86_64.whl</li> <li>vllm_pascal-0.7.2   https://github.com/sasha0552/pascal-pkgs-ci/releases/download/wheels/vllm_pascal-0.7.2-cp38-abi3-linux_x86_64.whl</li> <li>python 3.9</li> <li>uv 0.9.0</li> <li>Tesla P40</li> <li>Ubuntu 22</li> </ul>","tags":["llm"]},{"location":"blog/run-vllm-qwen3-locally/#cuda","title":"cuda\u7248\u672c","text":"<p>\u7cfb\u7edf\u7684cuda\u5f00\u53d1\u7f16\u8bd1\u73af\u5883\uff08/usr/local/cuda\uff09\u53ef\u4ee5\u4e0d\u5b89\u88c5\uff0c\u9664\u975e\u9700\u8981\u672c\u5730\u7f16\u8bd1\u3002\u4e3a\u4e86\u907f\u514d\u7f16\u8bd1\uff0c\u5c31\u4e0b\u8f7dwhl\u5305\u3002 whl\u5305\u662f\u522b\u4eba\u7528nvcc\u7f16\u8bd1\u7684\u4e8c\u8fdb\u5236\u5305\uff0c\u6240\u4ee5\u56fa\u5b9a\u4e86cuda\u7248\u672c\u3002\u4f8b\u5982torch-2.5.1+cu121\u8868\u793a\u7528\u4e86cuda 12.1\u7684\u7f16\u8bd1\u5de5\u5177\u7f16\u8bd1\u7684\u3002 \u800c\u4e14\u4e3a\u4e86vllm\u80fd\u8c03\u7528pytorch, vllm\u5c31\u5fc5\u987b\u548cpytorch\u4e00\u6837\u7684cu\u7248\u672c\uff0c\u6240\u4ee5\u6211\u4e24\u4e2a\u90fd\u4e0b\u8f7d\u4e86cu121\u3002</p>","tags":["llm"]},{"location":"blog/run-vllm-qwen3-locally/#vllm_pascalvllm","title":"\u5b89\u88c5vllm_pascal\u540e\uff0c\u8fd8\u9700\u8981\u6267\u884c\u4e0b\u9762\u7684\u547d\u4ee4\uff0c\u6765\u751f\u6210\u4e00\u4e2a\u65b0\u7684vllm \u5305","text":"<p>npx \u76f8\u5f53\u4e8enpm -g, \u6765\u5b89\u88c5\u4e00\u4e2a\u5168\u5c40\u7684\u5305+cli\u3002 <pre><code>npx install transient-package\ntransient-package create --source vllm --source-version 0.7.2 --target vllm-pascal --target-version 0.7.2 --output-directory .\nuv pip install vllm-0.7.2-py3-none-any.whl\n</code></pre> \u5982\u679c\u6ca1\u6709\u8fd9\u4e00\u6b65, vllm\u547d\u4ee4\u63d0\u793a\u627e\u4e0d\u5230cuda <pre><code>WARNING 03-14 23:02:38 init.py:26] The vLLM package was not found, so its version could not be inspected. This may cause platform detection to fail.\nINFO 03-14 23:02:38 init.py:211] No platform detected, vLLM is running on UnspecifiedPlatform\n0.7.2\n</code></pre></p>","tags":["llm"]},{"location":"blog/run-vllm-qwen3-locally/#_1","title":"\u5b89\u88c5\u5176\u4ed6\u4f9d\u8d56","text":"<p><code>uv pip install ./*.whl</code>\u547d\u4ee4\u4e0d\u4f1a\u5b89\u88c5\u4f9d\u8d56\uff0c\u8fd0\u884c\u4e00\u4e2a\u4e00\u4e2a\u8fd9\u6837\u62a5\u7f3a\u5305\u518d\u5b89\u88c5\u5305\u5f88\u70e6\uff0c\u6240\u4ee5\u76f4\u63a5\u5230vllm\u7684\u4ee3\u7801\u91cc\u627erequrement,\u4e00\u6b21\u5b89\u88c5\u3002\u8fd8\u6709\u5230pytorch\u5b98\u7f51\u770b\u5bf9\u5e94torch==2.5.1\u7684torch-audio torch-vision\u5305\u3002</p>","tags":["llm"]},{"location":"blog/run-vllm-qwen3-locally/#_2","title":"\u9a8c\u8bc1\u548c\u9a8c\u8bc1\u548c\u4fee\u6539\u53c2\u6570","text":"<ul> <li>\u53c2\u6570\u7c7b\u578b\u4e0d\u5339\u914d\uff0c\u6a21\u578b\u914d\u7f6e\u6587\u4ef6\u91cc\u8bbe\u5b9a\u4e86<code>\"torch_dtype\": \"bfloat16\"</code>, \u800c\u663e\u5361\u53ea\u80fd\u652f\u6301float16, \u6240\u4ee5\u4fee\u6539\u4e86\u6a21\u578b\u914d\u7f6e\u3002</li> <li>\u8f93\u51fatoken\u957f\u5ea6\u592a\u5927\uff0c\u5bfc\u81f4vllm\u4e0d\u652f\u6301\uff0c \u4fee\u6539\u6a21\u578b\u914d\u7f6e\"max_position_embeddings\"\uff0c\u4ece40960\u6539\u6210\u4e8610240\u3002 </li> </ul>","tags":["llm"]},{"location":"blog/run-vllm-qwen3-locally/#install-cuda-117-toolkit-and-driver","title":"Install CUDA 11.7 toolkit and driver","text":"<p>sudo apt install -y cuda-11-7</p>","tags":["llm"]},{"location":"blog/run-vllm-qwen3-locally/#uv-install-uv-add","title":"uv install \u548c uv add \u7684\u533a\u522b","text":"<p>\u65b0\u9879\u76ee\u5e94\u8be5\u7528 uv add, \u5728\u7528 uv add \u4e4b\u524d\uff0c\u9700\u8981\u5148\u6267\u884c * uv init \u521d\u59cb\u5316\u9879\u76ee * uv venv ./.venv \u521b\u9020\u865a\u62df\u73af\u5883</p>","tags":["llm"]},{"location":"blog/run-vllm-qwen3-locally/#nvidia-smi","title":"nvidia-smi \u8f93\u51fa","text":"<p>| NVIDIA-SMI 580.95.05              Driver Version: 580.95.05      CUDA Version: 13.0     |</p> <ul> <li>Driver Version \u662fGPU\u786c\u4ef6\u9a71\u52a8</li> <li>CUDA Version \u662f\u6700\u5927\u652f\u6301\u7684cuda toolkits\uff0c\u4e5f\u53eb\u8fd0\u884c\u65f6\u3002\u800c\u5b9e\u9645\u7684cuda toolkit version \u901a\u8fc7<code>nvcc --version</code>\u6765\u786e\u8ba4</li> </ul>","tags":["llm"]},{"location":"blog/run-vllm-qwen3-locally/#nvcc","title":"nvcc","text":"<p>nvcc \u662f/usr/local/cuda/bin/\u4e0b\u7684\uff0c\u4e5f\u5c31\u662fcuda toolkits\uff0ccuda\u76ee\u5f55\u901a\u5e38\u662f\u8f6f\u94fe\u63a5\u5230\u5b9e\u9645\u7684cuda toolkits <pre><code>lrwxrwxrwx  1 root root   22 Nov  3 18:23 cuda -&gt; /etc/alternatives/cuda\nlrwxrwxrwx  1 root root   25 Nov  3 18:23 cuda-11 -&gt; /etc/alternatives/cuda-11\ndrwxr-xr-x 15 root root 4096 Nov  3 18:23 cuda-11.7\n</code></pre> \u4e0a\u9762\u7684cuda\u548ccuda-11 \u90fd\u94fe\u63a5\u5230cuda-11.7 \u4e5f\u5c31\u662f\u5b9e\u9645\u7684toolkit version, \u5e76\u4e14\u901a\u8fc7<code>nvcc --version</code>\u786e\u8ba4\u7248\u672c nvcc --version nvcc: NVIDIA (R) Cuda compiler driver Copyright (c) 2005-2022 NVIDIA Corporation Built on Wed_Jun__8_16:49:14_PDT_2022 Cuda compilation tools, release 11.7, V11.7.99 Build cuda_11.7.r11.7/compiler.31442593_0</p> <p>11.7 \u5c0f\u4e8e nvidia-smi\u6253\u5370\u7684 13.0, \u6240\u4ee5\u8fd9\u4e2atoolkit\u662f\u652f\u6301\u7684\u3002</p>","tags":["llm"]},{"location":"blog/run-vllm-qwen3-locally/#cuda-capabilities","title":"cuda capabilities","text":"<p>\u867d\u7136GPU driver \u53ef\u4ee5\u5411\u524d\u517c\u5bb9\uff0c\u6240\u4ee5 Driver 535\u53ef\u4ee5\u66ff\u4ee3Driver 515\u3002\u4f46\u662f\u786c\u4ef6\u67b6\u6784\u9650\u5b9a\u4e86cuda capabilities\uff0c\u65e0\u6cd5\u5411\u524d\u517c\u5bb9\u7684\u3002\u4f8b\u5982Tesla P40\u7684\u786c\u4ef6\u67b6\u6784\u662fPascal sm_6.1\uff0c\u800cpytorch \u76842.7.0 \u7248\u672c\u4e0d\u652f\u6301sm_6.1\u4e86\u3002</p>","tags":["llm"]},{"location":"blog/run-vllm-qwen3-locally/#install-pytorch","title":"Install pytorch","text":"<p>\u56e0\u4e3a cuda capability\u9650\u5236\uff0c\u77e5\u9053\u6700\u9ad8\u7248\u672c\u652f\u6301sm 6.1\u7684pytorch\u7248\u672c\u662f2.6.0, \u800cpytroch\u6709\u4e13\u95e8\u5bf9cuda\u7279\u5b9a\u7248\u672c\u7684\u4e8c\u8fdb\u5236\u5305\uff0c\u5728\u5b98\u7f51\u4e0a\u80fd\u627e\u5230 https://pytorch.org/get-started/previous-versions/ \u4e0b\u9762\u53ef\u89c1\uff0c2.6.0\u7248\u672c\u6709 cuda-11.8 cuda-12.4 cuda-12.6\u7248\u672c\u7684\u4e8c\u8fdb\u5236\u5b89\u88c5\u5305\u3002  <pre><code># ROCM 6.1 (Linux only)\npip install torch==2.6.0 torchvision==0.21.0 torchaudio==2.6.0 --index-url https://download.pytorch.org/whl/rocm6.1\n# ROCM 6.2.4 (Linux only)\npip install torch==2.6.0 torchvision==0.21.0 torchaudio==2.6.0 --index-url https://download.pytorch.org/whl/rocm6.2.4\n# CUDA 11.8\npip install torch==2.6.0 torchvision==0.21.0 torchaudio==2.6.0 --index-url https://download.pytorch.org/whl/cu118\n# CUDA 12.4\npip install torch==2.6.0 torchvision==0.21.0 torchaudio==2.6.0 --index-url https://download.pytorch.org/whl/cu124\n# CUDA 12.6\npip install torch==2.6.0 torchvision==0.21.0 torchaudio==2.6.0 --index-url https://download.pytorch.org/whl/cu126\n# CPU only\npip install torch==2.6.0 torchvision==0.21.0 torchaudio==2.6.0 --index-url https://download.pytorch.org/whl/cpu\n</code></pre> \u7136\u540e\u641c\u7d22\u5f97\u77e5 11.8 \u8981\u6c42\u6700\u4f4e\u7684cuda capability \u7248\u672c\u662f 5.0, \u6240\u4ee5\u4e5f\u652f\u63016.1\u7684Tesla P40, \u4e8e\u662f\u5b89\u88c5\u5b89\u88c5\u547d\u4ee4\u662f <pre><code>uv pip install torch==2.6.0 torchvision==0.21.0 torchaudio==2.6.0 --index-url https://download.pytorch.org/whl/cu118\n</code></pre></p>","tags":["llm"]},{"location":"blog/run-vllm-qwen3-locally/#install-vllm","title":"Install vllm","text":"<p>vllm 0.9 \u5f00\u59cb\u4e0d\u652f\u6301pytorch 2.6\u4e86\uff0c\u6240\u4ee5\u53ea\u80fd\u7528vllm 0.8.5\u3002\u4ecegithup release\u627e\u5230\u4e86\u4e8c\u8fdb\u5236\u5b89\u88c5\u5305 vllm-0.8.5.post1+cu118-cp38-abi3-manylinux1_x86_64.whl \u4e0b\u8f7d\u5230\u672c\u5730\u540e\u8fd0\u884c  uv pip install ~/vllm-0.8.5.post1+cu118-cp38-abi3-manylinux1_x86_64.whl</p>","tags":["llm"]},{"location":"blog/run-vllm-qwen3-locally/#vllm-serve-qwen3-8b-fail-runtimeerror-cuda-error-no-kernel-image-is-available-for-execution-on-the-device","title":"vllm serve Qwen3-8B fail: RuntimeError: CUDA error: no kernel image is available for execution on the device","text":"<p>\u53ef\u60dc\uff0cvllm 0.8.5 \u4e0d\u652f\u6301 pytorch-cuda-6.1, \u4e0d\u77e5\u9053\u8fd9\u8ddfpytroch \u652f\u6301 sm-6.1\u6709\u4ec0\u4e48\u533a\u522b\u3002\u597d\u5728\u53ef\u4ee5\u624b\u52a8\u7f16\u8bd1vllm\u6765\u652f\u6301 <pre><code>git clone https://github.com/vllm-project/vllm.git\ncd vllm\ngit checkout v0.8.5\nexport TORCH_CUDA_ARCH_LIST=\"6.1\"\npip install -e . --no-build-isolation\n</code></pre></p>","tags":["llm"]},{"location":"blog/run-vllm-qwen3-locally/#_3","title":"run vllm Qwen3 locally","text":"","tags":["llm"]},{"location":"blog/run-vllm-qwen3-locally/#vramvideo-ram","title":"\u8ba1\u7b97VRAM(Video RAM)","text":"<p>dtype \u662f\u53c2\u6570\u7c7b\u578b\uff0c\u6240\u9700\u7684\u5927\u5c0f\u5206\u522b\u662f * FP32  4B \u5355\u7cbe\u5ea6 * BP16  2B \u53cc\u7cbe\u5ea6 * FP16  2B \u5355\u7cbe\u5ea6 * INT8 1B * INT4 0.5B \u91cf\u5316 vllm \u53ef\u4ee5\u8fd0\u884c\u65f6\u6307\u5b9a\u91cf\u5316</p> <p>\u800c\u5927\u6a21\u578b\u7684\u53c2\u6570\u5e38\u89c1\u670932B\uff0c7B\u30027B\u7684\u5927\u6a21\u578b\uff0c\u4f7f\u7528FP32\u65f6\uff0c\u9700\u8981VRAM=47G\u3002 \u4f7f\u7528FP16\u65f6\uff0c\u53ea\u9700\u898127G\u3002</p> <p>\u6ce8\u610f\uff0c\u6a21\u578b\u7684config.torch_dtype\u662f\u53ef\u4ee5\u6539\u7684\uff0c\u6700\u5927\u8f93\u51fatoken\u4e5f\u662f\u53ef\u4ee5\u6539\u7684\u3002</p>","tags":["llm"]},{"location":"blog/run-vllm-qwen3-locally/#_4","title":"\u53c2\u8003","text":"<p>https://github.com/vllm-project/vllm/pull/4290</p> <p>pytroch 2.7 \u4e0d\u652f\u6301 6.1: https://www.reddit.com/r/LocalLLaMA/comments/1lrerwe/pytorch_27x_no_longer_supports_pascal_architecture/ vllm 0.11.5 \u624d\u80fd\u652f\u6301Qwen/Qwen3-VL-32B-Instruct\uff0c\u5426\u5219\u62a5\u9519 \"'Qwen3VLConfig' object has no attribute 'vocab_size'\" https://huggingface.co/Qwen/Qwen3-VL-32B-Instruct/discussions/3</p>","tags":["llm"]},{"location":"blog/%E5%9C%A8linux%E4%B8%8B%E4%BD%BF%E7%94%A8sdcc%E8%BF%9B%E8%A1%8C%E5%8D%95%E7%89%87%E6%9C%BA%E7%BC%96%E8%AF%91/","title":"\u5728Linux\u4e0b\u4f7f\u7528sdcc\u8fdb\u884c\u5355\u7247\u673a\u7f16\u8bd1","text":"<p>\u5468\u672b\u7814\u7a76\u4e86\u4e0b\u5355\u7247\u673a\uff0c\u672c\u6765\u51c6\u5907\u5199\u4e2a\u5b9a\u65f6\u5668\u6765\u63a7\u5236\u7535\u6247\u5f00\u5173\uff0c\u53d1\u73b0\u6bd4\u8d77\u6811\u6885\u6d3e\uff0c\u5355\u7247\u673a\u5b9e\u5728\u4e0d\u592a\u65b9\u4fbf</p>","tags":["51\u5355\u7247\u673a"]},{"location":"blog/%E5%9C%A8linux%E4%B8%8B%E4%BD%BF%E7%94%A8sdcc%E8%BF%9B%E8%A1%8C%E5%8D%95%E7%89%87%E6%9C%BA%E7%BC%96%E8%AF%91/#_1","title":"\u5f00\u53d1\u73af\u5883\u642d\u5efa","text":"<p>Windows\u5927\u5bb6\u90fd\u7528Keil, \u4e00\u7ad9\u5f0f\u6bd4\u8f83\u65b9\u4fbf\uff0c\u4f46\u8fd9\u662f\u4e2a\u6536\u8d39\u8f6f\u4ef6\u3002\u800c\u5728Linux\u4e0b\uff0c\u4f7f\u7528\u5230\u4e00\u4e9b\u7ec4\u5408\u6765\u5b9e\u73b0\u7f16\u8bd1\u548c\u70e7\u5f55</p> <ol> <li>sdcc \u5f00\u6e90\u7684\u7f16\u8bd1\u5668\uff0c\u7c7b\u4f3cgcc</li> <li>stcflash github\u4e0a\u7684\u5f00\u53d1\u8005\u5f00\u53d1\u7684\u70e7\u5f55\u811a\u672c</li> </ol> <p>sdcc \u5728Debian\u6709\u5305\u53ef\u4ee5\u76f4\u63a5\u5b89\u88c5 <pre><code># apt install sdcc\n</code></pre> \u518d clone github\u7684\u4ee3\u7801\u5230\u672c\u5730\uff0c\u9700\u8981\u4f7f\u7528root\u6743\u9650\u6267\u884c\u70e7\u5f55\u3002\u800c\u6211\u6267\u884c\u662f\u53d1\u73b0\u7f3a\u5c11python serial\u5305\uff0c\u8981\u5168\u5c40\u5b89\u88c5\u5c31\u4f7f\u7528apt\u547d\u4ee4</p> <pre><code># apt install python3-serial\n</code></pre> <p>\u8fd9\u6837\u73af\u5883\u5c31\u642d\u5efa\u597d\u4e86</p>","tags":["51\u5355\u7247\u673a"]},{"location":"blog/%E5%9C%A8linux%E4%B8%8B%E4%BD%BF%E7%94%A8sdcc%E8%BF%9B%E8%A1%8C%E5%8D%95%E7%89%87%E6%9C%BA%E7%BC%96%E8%AF%91/#_2","title":"\u7f16\u5199\u4ee3\u7801","text":"<p>\u7528c\u8bed\u8a00\u5f00\u53d1\u65f6\u8981\u5f15\u5165\u6bd4\u8f83\u7684\u5b9a\u4e49\u5934\u6587\u4ef6\uff0c\u6211\u7684\u5355\u7247\u673a\u662f\u597d\u591a\u5e74\u524d\u4e70\u7684\u56fd\u4ea7<code>stc 89C52RC</code>\uff0c \u662f\u57fa\u4e8e51\u7684\u62d3\u5c55\u7248\u672c\uff0c\u4e8e\u662f\u7528\u4e86sdcc\u7684<code>8052.h</code>\u5934\uff0c\u8def\u5f84\u5728 <pre><code>// /usr/share/sdcc/include/mcs51/8052.h\n#ifndef REG8052_H\n#define REG8052_H\n\n#include &lt;8051.h&gt;     /* load definitions for the 8051 core */\n\n#ifdef REG8051_H\n#undef REG8051_H\n#endif\n</code></pre></p> <p>\u4e0d\u8fc7\u4e0d\u9700\u8981\u6211\u4eec\u6307\u5b9a\u8def\u5f84\uff0csdcc\u4f1a\u81ea\u52a8\u5f15\u5165\u3002\u7aa5\u89c6\u5176\u5185\u5bb9\u53ef\u4ee5\u53d1\u73b0\u5b83\u5305\u542b\u4e868051\u7684\u4e1c\u897f\uff0c\u6240\u4ee5\u8bf452\u662f\u57fa\u4e8e51\u7684</p>","tags":["51\u5355\u7247\u673a"]},{"location":"blog/%E5%9C%A8linux%E4%B8%8B%E4%BD%BF%E7%94%A8sdcc%E8%BF%9B%E8%A1%8C%E5%8D%95%E7%89%87%E6%9C%BA%E7%BC%96%E8%AF%91/#51","title":"\u56de\u987e\u4e00\u4e0b51\u5355\u7247\u673a\u77e5\u8bc6","text":"<ol> <li>\u5355\u7247\u673a\u7684\u5bc4\u5b58\u5668\u521d\u59cb\u662f0, \u800c\u5f15\u811a\u521d\u59cb\u90fd\u662f\u9ad8\u70b9\u4f4d</li> <li>\u5b9a\u65f6\u5668\u548c\u8ba1\u6570\u5668\u7684\u89e6\u53d1\u4e8b\u4ef6\u90fd\u662f\u9760\u4e2d\u65ad\uff0c\u4e2d\u65ad\u6267\u884c\u5f53\u524d\uff08main\uff09\u4e2d\u7684\u51fd\u6570\u800c\u6267\u884c\u4e2d\u65ad\u54cd\u5e94\u51fd\u6570\uff0c\u8fd9\u8ddfUnix\u5185\u6838\u662f\u4e00\u6837\u7684\u3002 \u5355\u7247\u673a\u8fd8\u5177\u6709\u591a\u4e2a\u4f18\u5148\u7ea7\u7684\u4e2d\u65ad\uff0c\u53ef\u4ee5\u5d4c\u5957</li> <li>\u4e2d\u65ad\u7684\u89e6\u53d1\u9760\u8ba1\u6570\u5bc4\u5b58\u5668\uff08TLx\u548cTHx\uff09\u6ea2\u51fa\uff0c\u8fd9\u4e24\u4e2a\u90fd\u662f8\u4f4d\u5bc4\u5b58\u5668\uff0c\u6240\u4ee5\u540c\u65f6\u4f7f\u7528\u65f6\uff0c\u57282^16\u65f6\u6ea2\u51fa\u3002\u4f46\u4e5f\u6709\u53ea\u7528\u5176\u4e2d\u4e00\u4e2a\u5bc4\u5b58\u5668\u7684\u65f6\u5019\uff0c\u8fd9\u7531<code>TMOD</code>\u5bc4\u5b58\u5668\u63a7\u5236</li> </ol>","tags":["51\u5355\u7247\u673a"]},{"location":"blog/%E5%9C%A8linux%E4%B8%8B%E4%BD%BF%E7%94%A8sdcc%E8%BF%9B%E8%A1%8C%E5%8D%95%E7%89%87%E6%9C%BA%E7%BC%96%E8%AF%91/#tmod","title":"TMOD\u5bc4\u5b58\u5668","text":"<p>TMOD\u662f\u4e0d\u53ef\u6309\u4f4d\u8bbf\u95ee\u7684\u5bc4\u5b58\u5668\uff0c\u610f\u601d\u662f\u53ea\u80fd\u4e00\u6b21\u6027\u8d4b\u503c\u6240\u6709\u4f4d\u3002 TMOD\u63a7\u5236\u7740\u4e24\u4e2a\u5b9a\u65f6\u5668/\u8ba1\u6570\u56680\u548c1</p> <p></p> <ul> <li>TMOD\u9ad8\u56db\u4f4d\u7528\u4e8e\u8bbe\u7f6e\u5b9a\u65f6\u5668/\u8ba1\u6570\u56681\uff0c\u4f4e\u56db\u4f4d\u7528\u4e8e\u8bbe\u7f6e\u5b9a\u65f6\u5668/\u8ba1\u6570\u56680\uff1b</li> <li>GATE\u5bc4\u5b58\u5668\u51b3\u5b9a\u662f\u5426\u4f7f\u7528\u5916\u90e8INTx\u63a7\u5236\uff0c\u5373\u8f6f\u4ef6\u81ea\u52a8\u542f\u52a8\uff0c\u8fd8\u662f\u5916\u90e8\u542f\u52a8\uff0c\u8fd9\u91cc\u8d4b\u503c0</li> <li>GATE=1\u65f6\uff0c\u201c\u4e0e\u95e8\u201d\u7684\u8f93\u51fa\u4fe1\u53f7K\u7531INTx\u8f93\u5165\u7535\u5e73\u548cTRx\u4f4d\u7684\u72b6\u6001\u4e00\u8d77\u51b3\u5b9a(\u5373\u6b64\u65f6K=TRx\u00b7INTx)\uff0c\u5f53\u4e14\u4ec5\u5f53TRx=1,INTx=1(\u9ad8\u7535\u5e73)\u65f6\uff0c\u8ba1\u6570\u542f\u52a8\uff1b\u5426\u5219\uff0c\u8ba1\u6570\u505c\u6b62\u3002\u5f53INT0\u5f15\u811a\u4e3a\u9ad8\u5e73\u65f6\u4e14TR0\u7f6e\u4f4d\uff0cTR0=1\uff1b\u542f\u52a8\u5b9a\u65f6\u5668T0</li> <li>GATE=0\u65f6\uff0c\u201cA\u201d\u8f93\u51fa\u6052\u4e3a1\uff0c\u201cB\u201d\u7684\u503c\u7531TRx\u51b3\u5b9a\uff0c\u5f53TR0=1,\u542f\u52a8\u5b9a\u65f6\u5668/\u8ba1\u6570\u5668T0\uff0c\u5f53TR1=1\uff0c\u542f\u52a8\u5b9a\u65f6\u5668/\u8ba1\u6570\u5668T1</li> <li>CT\u4f4d\u4e3a1\u65f6\u9009\u62e9\u8ba1\u6570\u5668\u6a21\u5f0f\uff0c\u4e3a0\u65f6\u9009\u62e9\u5b9a\u65f6\u5668\u6a21\u5f0f</li> <li>M1,M0\u7528\u4e8e\u9009\u62e9\u5de5\u4f5c\u65b9\u5f0f\uff0c\u5f53M0=1,M1=0\u65f6\uff0c\u4f7f\u7528TL0\u548cTH0\u768416\u4f4d\u6765\u8ba1\u6570</li> </ul>","tags":["51\u5355\u7247\u673a"]},{"location":"blog/%E5%9C%A8linux%E4%B8%8B%E4%BD%BF%E7%94%A8sdcc%E8%BF%9B%E8%A1%8C%E5%8D%95%E7%89%87%E6%9C%BA%E7%BC%96%E8%AF%91/#tcon","title":"TCON\u5bc4\u5b58\u5668","text":"","tags":["51\u5355\u7247\u673a"]},{"location":"blog/%E5%9C%A8linux%E4%B8%8B%E4%BD%BF%E7%94%A8sdcc%E8%BF%9B%E8%A1%8C%E5%8D%95%E7%89%87%E6%9C%BA%E7%BC%96%E8%AF%91/#_3","title":"\u5b9a\u65f6\u5668\u521d\u59cb\u5316","text":"<p>\u8fd9\u91cc\u4f7f\u7528\u5b9a\u65f6\u56680 <pre><code>void Timer0Init(void) // 1\u6beb\u79d2@12.000MHz\n{\n    TMOD = 0x01; //\u8bbe\u7f6e\u5b9a\u65f6\u5668\u6a21\u5f0f 0000 0001\n    // TCON\n    TF0 = 0; //\u521d\u59cb\u5316\u6ea2\u51fa\u6807\u5fd7\n    TR0 = 1; //\u5b9a\u65f6\u56680\u5f00\u59cb\u8ba1\u65f6\n    // \u8ba1\u6570\u5668\u521d\u59cb\u503c\uff0c\u518d\u89e6\u53d1\u4e00\u6b21\u5c31\u6ea2\u51fa\u4e86\n    TH0 = 0xFF; //\u8bbe\u7f6e\u5b9a\u65f6\u521d\u503c\n    TL0 = 0xFE; //\u8bbe\u7f6e\u5b9a\u65f6\u521d\u503c\n    // \u4e2d\u65ad\u901a\u8def\n    EA = 1; \n    ET0 = 1;\n    PT0 = 0;\n}\n</code></pre></p>","tags":["51\u5355\u7247\u673a"]},{"location":"blog/%E5%9C%A8linux%E4%B8%8B%E4%BD%BF%E7%94%A8sdcc%E8%BF%9B%E8%A1%8C%E5%8D%95%E7%89%87%E6%9C%BA%E7%BC%96%E8%AF%91/#_4","title":"\u8ba1\u6570\u5668\u6a21\u5f0f","text":"<p>\u8fd9\u91cc\u4f7f\u7528\u8ba1\u6570\u56680 <pre><code>void Count0Init(void) // 1\u6beb\u79d2@12.000MHz\n{ \n    TMOD = 0x05; //\u8bbe\u7f6e\u8ba1\u6570\u5668\u6a21\u5f0f 0000 0101\n\n    // TCON\n    TF0 = 0; \n    TR0 = 1; //\u5b9a\u65f6\u56680\u5f00\u59cb\u8ba1\u65f6\n\n    // \u8ba1\u6570\u5668\u521d\u59cb\u503c\uff0c\u518d\u89e6\u53d1\u4e00\u6b21\u5c31\u6ea2\u51fa\u4e86\n    TH0 = 0xFF;  //\u8bbe\u7f6e\u5b9a\u65f6\u521d\u503c\n    TL0 = 0xFE;  //\u8bbe\u7f6e\u5b9a\u65f6\u521d\u503c\n\n    // \u4e2d\u65ad\u901a\u8def\n    EA = 1;\n    ET0 = 1;\n    PT0 = 0;\n}\n</code></pre></p>","tags":["51\u5355\u7247\u673a"]},{"location":"blog/%E5%9C%A8linux%E4%B8%8B%E4%BD%BF%E7%94%A8sdcc%E8%BF%9B%E8%A1%8C%E5%8D%95%E7%89%87%E6%9C%BA%E7%BC%96%E8%AF%91/#_5","title":"\u4e2d\u65ad\u54cd\u5e94\u51fd\u6570","text":"<p>sdcc\u548ckeil\u6709\u4e00\u4e9b\u533a\u522b\uff0c\u4e2d\u65ad\u6807\u5fd7\u7b26\u4f7f\u7528<code>__interrupt</code> <pre><code>static unsigned int T0Count = 0;\nvoid timer0_routine() __interrupt (1) {\n  T0Count++;\n  TH0 = 0xFF; //\u8bbe\u7f6e\u5b9a\u65f6\u521d\u503c\n  TL0 = 0xFE; //\u8bbe\u7f6e\u5b9a\u65f6\u521d\u503c\n  if (T0Count == 3) {\n    T0Count = 0;\n    P1_1 = 0;  // 0\u8f93\u51fa\u4f4e\u7535\u5e73\uff0c\u706f\u6ce1\u4eae\n  }\n}\n</code></pre></p>","tags":["51\u5355\u7247\u673a"]},{"location":"blog/%E5%9C%A8linux%E4%B8%8B%E4%BD%BF%E7%94%A8sdcc%E8%BF%9B%E8%A1%8C%E5%8D%95%E7%89%87%E6%9C%BA%E7%BC%96%E8%AF%91/#_6","title":"\u5b8c\u6574\u4ee3\u7801","text":"<pre><code>// main.c\n#include \"8052.h\"\n\nvoid Timer0Init(void) // 1\u6beb\u79d2@12.000MHz\n{\n  TMOD = 0x01;\n  TF0 = 0;\n  TR0 = 1;\n  TH0 = 0xFF;\n  TL0 = 0xFE;\n  EA = 1;\n  ET0 = 1;\n  PT0 = 0;\n}\n\nvoid main(void) {\n\n  Timer1Init();\n  while (1)\n    ;\n}\n\nunsigned int T0Count = 0;\nvoid timer0_routine() __interrupt(1) {\n  T0Count++;\n  TH0 = 0xFF;\n  TL0 = 0xFE;\n  if (T0Count == 3) {\n    T0Count = 0;\n    P1_1 = 0;\n  }\n}\n</code></pre>","tags":["51\u5355\u7247\u673a"]},{"location":"blog/%E5%9C%A8linux%E4%B8%8B%E4%BD%BF%E7%94%A8sdcc%E8%BF%9B%E8%A1%8C%E5%8D%95%E7%89%87%E6%9C%BA%E7%BC%96%E8%AF%91/#_7","title":"\u7f16\u8bd1\u548c\u70e7\u5f55","text":"<p>\u4ee3\u7801\u4fdd\u5b58\u4e3amain.c</p> <pre><code># \u4f7f\u7528sdcc\u7f16\u8bd1\nsdcc main.c\n\u5c06sdcc\u751f\u6210\u7684ihx\u6587\u4ef6\u8f6c\u4e3ahex\u6587\u4ef6\npackihx main.ihx  &gt; main.hex   \n</code></pre> <p>\u70e7\u5f55\u5230\u5355\u7247\u673a <pre><code>sudo python ~/github/stcflash/stcflash.py main.hex\nConnect to /dev/ttyUSB0 at baudrate 2400\nDetecting target... done\n FOSC: 11.955MHz\n Model: STC89C52RC (ver4.3C) \n ROM: 8KB\n [X] Reset stops watchdog\n [X] Internal XRAM\n [X] Normal ALE pin\n [X] Full gain oscillator\n [X] Not erase data EEPROM\n [X] Download regardless of P1\n [X] 12T mode\nBaudrate: 38400\nErasing target... done\nSize of the binary: 147\nProgramming: #################### done\nSetting options... done\n</code></pre></p>","tags":["51\u5355\u7247\u673a"]},{"location":"blog/sed%E5%92%8Cvim%E6%9B%BF%E6%8D%A2%E6%96%87%E6%9C%AC%E7%9A%84%E5%B0%8F%E5%8C%BA%E5%88%AB/","title":"sed\u548cvim\u66ff\u6362\u6587\u672c\u7684\u5c0f\u533a\u522b","text":"","tags":["linux","tool"]},{"location":"blog/sed%E5%92%8Cvim%E6%9B%BF%E6%8D%A2%E6%96%87%E6%9C%AC%E7%9A%84%E5%B0%8F%E5%8C%BA%E5%88%AB/#vimsed","title":"\u66ff\u6362\u62db\u884c\u7684\u8d26\u5355\u4e2d\u53d1\u73b0vim\u548csed\u533a\u522b","text":"<p>\u5728vim\u4e2d 1. <code>:%s/\\n/,/g</code> 2. <code>:% s/\\t,\\t,\\t,\\t,/\\r/g</code> \u7528sed: <code>cat bill.txt| sed -z 's/\\n/,/g'  | sed 's/\\t,\\t,\\t,\\t,/\\n/g'</code></p>","tags":["linux","tool"]},{"location":"blog/sed%E5%92%8Cvim%E6%9B%BF%E6%8D%A2%E6%96%87%E6%9C%AC%E7%9A%84%E5%B0%8F%E5%8C%BA%E5%88%AB/#_1","title":"\u53ef\u89c1","text":"<ol> <li>vim\u4e2d\u5339\u914d\u6362\u884c\u7b26\u7528<code>\\n</code>, \u800c\u66ff\u6362\u7528<code>\\r</code>\u3002\u66ff\u6362\u6210<code>\\n</code>\u5728vim\u4e2d\u663e\u793a\u6210<code>^@</code></li> <li>sed \u4e2d\u7684\u6362\u884c\u7b26\u7edf\u4e00\u7528<code>\\n</code>\uff0c\u8fd9\u6bd4vim\u597d\uff0c\u4f46sed \u4e2d\u4e0d\u80fd\u76f4\u63a5\u7528<code>\\n</code>\u5339\u914d\uff0c\u8fd8\u5f97\u52a0\u4e0a -z \u53c2\u6570\u3002</li> </ol>","tags":["linux","tool"]},{"location":"blog/segfault-in-dmesg/","title":"segfault in dmesg","text":"<p>\u5076\u5c14\u770b\u5230\u81ea\u5df1\u6216\u8005\u5ba2\u6237\u7684/var/log/message \u65e5\u5fd7\u51fa\u73b0segfault, \u67e5\u8be2\u4e86\u4e00\u4e0b\u76f8\u5173\u4fe1\u606f <pre><code>Apr  6 09:43:37 icm kernel: rhsm-icon[13402]: segfault at 12b0000 ip 0000003c89845c00 sp 00007ffce18396e0 error 4 in libglib-2.0.so.0.2800.8[3c89800000+115000]\n</code></pre></p>","tags":["debug"]},{"location":"blog/segfault-in-dmesg/#_1","title":"\u89e3\u91ca","text":"<ul> <li>address (after the at) - the location in memory the code is trying to access (it's likely that 10 and 11 are offsets from a pointer we expect to be set to a valid value but which is instead pointing to 0)</li> <li>ip - instruction pointer, ie. where the code which is trying to do this lives</li> <li>sp - stack pointer</li> <li>error - An error code for page faults; see below for what this means on x86. <pre><code>/*\n * Page fault error code bits:\n *\n *   bit 0 ==    0: no page found       1: protection fault\n *   bit 1 ==    0: read access         1: write access\n *   bit 2 ==    0: kernel-mode access  1: user-mode access\n *   bit 3 ==                           1: use of reserved bit detected\n *   bit 4 ==                           1: fault was an instruction fetch\n */\n</code></pre></li> </ul>","tags":["debug"]},{"location":"blog/segfault-in-dmesg/#message","title":"message\u65e5\u5fd7","text":"<p>\u4f7f\u7528<code>dmesg</code>\u6253\u5370ring buffer\u7684\u5185\u5bb9\uff0c\u5173\u4e8e\u786c\u4ef6\u548ci/o\u7684\u4fe1\u606f</p>","tags":["debug"]},{"location":"blog/segfault-in-dmesg/#coredump","title":"coredump","text":"<pre><code> A core file is an image of a process that has crashed It contains all process information pertinent to debugging: contents of hardware registers, process status, and process data. Gdb will allow you use this file to determine where your program crashed. \n</code></pre>","tags":["debug"]},{"location":"blog/segfault-in-dmesg/#_2","title":"\u590d\u73b0","text":"<pre><code>void foo(){\n    int *p = 0;\n    *p = 100;\n}\n\nint main(){\n  foo();\n}\n</code></pre> <pre><code>[ 5902.293905] a.out[6085]: segfault at 0 ip 000055c0eddca129 sp 00007ffe65372110 error 6 in a.out[55c0eddca000+1000]\n[ 5902.293916] Code: 00 c3 66 66 2e 0f 1f 84 00 00 00 00 00 0f 1f 40 00 f3 0f 1e fa e9 67 ff ff ff 55 48 89 e5 48 c7 45 f8 00 00 00 00 48 8b 45 f8 &lt;c7&gt; 00 64 00 00 00 90 5d c3 55 48 89 e5 b8 00 00 00 00 e8 d9 ff ff\n</code></pre> <pre><code>(gdb) info registers \nrax            0x0                 0\nrbx            0x55c0eddca150      94287112741200\nrcx            0x7faa085eb598      140368261592472\nrdx            0x7ffe65372228      140730596532776\nrsi            0x7ffe65372218      140730596532760\nrdi            0x1                 1\nrbp            0x7ffe65372110      0x7ffe65372110\nrsp            0x7ffe65372110      0x7ffe65372110\nr8             0x0                 0\nr9             0x7faa08621070      140368261812336\nr10            0x69682ac           110527148\nr11            0x202               514\nr12            0x55c0eddca020      94287112740896\nr13            0x0                 0\nr14            0x0                 0\nr15            0x0                 0\nrip            0x55c0eddca129      0x55c0eddca129 &lt;foo+16&gt;\neflags         0x10246             [ PF ZF IF RF ]\ncs             0x33                51\nss             0x2b                43\nds             0x0                 0\nes             0x0                 0\nfs             0x0                 0\ngs             0x0                 0\n</code></pre>","tags":["debug"]},{"location":"blog/segfault-in-dmesg/#addr2line","title":"addr2line","text":"<pre><code>addr2line -e yourSegfaultingProgram 00007f9bebcca90d\n</code></pre>","tags":["debug"]},{"location":"blog/%E5%BA%8F%E5%88%97%E5%8C%96%E5%92%8C%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/","title":"\u5e8f\u5217\u5316\u548c\u53cd\u5e8f\u5217\u5316","text":"<p>c/cpp\u4e2d\uff0c\u5e8f\u5217\u5316\u662f\u5c06\u57fa\u672c\u7c7b\u578b\u6216struct\u53d8\u4e3a\u53ef\u5b58\u50a8\u548c\u4f20\u9012\u7684\u5f62\u5f0f\uff0c\u6bd4\u5982\u5e38\u7528\u7684<code>socket send</code>\uff0c\u5c06\u6309\u534f\u8bae\u7ec4\u88c5\u7684struct\uff08pack)\u663e\u793a\u8f6c\u6362\u4e8c\u8fdb\u5236\uff08\u5e8f\u5217\u5316\uff09\u5e76\u53d1\u9001\u7ed9\u5176\u4ed6\u4e3b\u673a\u3002\u800c\u53cd\u5e8f\u5217\u5316\u662f\u5c06\u4e8c\u8fdb\u5236\u8f6c\u6210\u57fa\u672c\u7c7b\u578b\u6216struct\u3002\u53e6\u5916\u8fd8\u6709<code>fwrite/fread</code>\u5c06\u7ed3\u6784\u4f53\u4fdd\u5b58\u5230\u6587\u672c\u4e2d\u3002 \u8fd9\u79cd\u65b9\u5f0f\u9ad8\u6548\u4f46\u5bb9\u6613\u51fa\u9519\u3002 \u800c\u5176\u4ed6\u8bed\u8a00\u4e2d\u53ef\u4ee5\u4f7f\u7528xml, json\u7b49\u9ad8\u7ea7\u65b9\u5f0f</p>","tags":["seralize"]},{"location":"blog/%E5%BA%8F%E5%88%97%E5%8C%96%E5%92%8C%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/#_2","title":"\u8f6c\u6362\u65b9\u5f0f","text":"","tags":["seralize"]},{"location":"blog/%E5%BA%8F%E5%88%97%E5%8C%96%E5%92%8C%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/#_3","title":"\u5f3a\u5236\u7c7b\u578b\u8f6c\u6362","text":"<p>\u4e0a\u9762\u8bb2\u5230\u7684\u4e24\u4e2a\u51fd\u6570send\u548cfwrite,\u90fd\u662f\u5c06\u57fa\u672c\u7c7b\u578b\u6216struct\u7c7b\u578b\u5f3a\u8f6c\u4e3a\u5b57\u7b26\u4e32, \u8fd9\u79cd\u53ef\u80fd\u53d7\u4e0d\u540c\u673a\u5668\u7684\u5bf9\u9f50\u5f71\u54cd <pre><code>ssize_t send(int sockfd, const void *buf, size_t len, int flags);\n\nsize_t fwrite(const void *ptr, size_t size, size_t nmemb,\n    FILE *stream);\n</code></pre></p> <p>\u5e8f\u5217\u5316 <pre><code>struct buffer {\n  int a;\n  char b;\n  double c;\n};\n\nint main() {\n\n  struct buffer buf;\n  buf.a = 1;\n  buf.b = 'a';\n  buf.c = 2;\n\n  FILE *f = fopen(\"/tmp/buf\", \"w+\");\n  if (f == NULL) {\n    return 1;\n  }\n  fwrite(&amp;buf, sizeof(struct buffer), 1, f);\n}\n</code></pre></p> <p>\u53cd\u5e8f\u5217\u5316 <pre><code>struct buffer {\n  int a;\n  char b;\n  double c;\n};\n\nint main() {\n\n  struct buffer buf;\n\n  FILE *f = fopen(\"/tmp/buf\", \"r\");\n  if (f == NULL) {\n    return 1;\n  }\n\n  fread(&amp;buf, sizeof(struct buffer), 1, f);\n  printf(\"%d--%c--%lf--\\n\", buf.a, buf.b, buf.c);\n}\n</code></pre></p>","tags":["seralize"]},{"location":"blog/%E5%BA%8F%E5%88%97%E5%8C%96%E5%92%8C%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/#protobuf","title":"\u4f7f\u7528protobuf","text":"<pre><code>syntax = \"proto3\";\npackage serialize;\n\noption optimize_for = LITE_RUNTIME;\n\nmessage Person {\n    string name = 1;\n    int32 id = 2;\n}\n</code></pre> <pre><code>tutorial::Person Serialize(std::string name, int id, std::string email){\n    tutorial::Person person;\n    person.set_name(name);\n    person.set_id(id);\n\n    return person;\n}\n\nvoid Deserialize(tutorial::Person person){\n    std::cout &lt;&lt; person.SerializeAsString();\n}\n</code></pre>","tags":["seralize"]},{"location":"blog/%E5%BA%8F%E5%88%97%E5%8C%96%E5%92%8C%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/#optimize_for-option","title":"optimize_for option","text":"<p>optimize_for (file option): Can be set to SPEED, CODE_SIZE, or LITE_RUNTIME. This affects the C++ and Java code generators (and possibly third-party generators) in the following ways:</p> <ul> <li>SPEED (default): The protocol buffer compiler will generate code for serializing, parsing, and performing other common operations on your message types. This code is highly optimized.</li> <li>CODE_SIZE: The protocol buffer compiler will generate minimal classes and will rely on shared, reflection-based code to implement serialialization, parsing, and various other operations. The generated code will thus be much smaller than with SPEED, but operations will be slower. Classes will still implement exactly the same public API as they do in SPEED mode. This mode is most useful in apps that contain a very large number of .proto files and do not need all of them to be blindingly fast.</li> <li>LITE_RUNTIME: The protocol buffer compiler will generate classes that depend only on the \"lite\" runtime library (libprotobuf-lite instead of libprotobuf). The lite runtime is much smaller than the full library (around an order of magnitude smaller) but omits certain features like descriptors and reflection. This is particularly useful for apps running on constrained platforms like mobile phones. The compiler will still generate fast implementations of all methods as it does in SPEED mode. Generated classes will only implement the MessageLite interface in each language, which provides only a subset of the methods of the full Message interface.</li> </ul>","tags":["seralize"]},{"location":"blog/%E5%BA%8F%E5%88%97%E5%8C%96%E5%92%8C%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/#xml-json-ninja","title":"\u5176\u4ed6\u8fd8\u6709\u5982xml, json, ninja","text":"","tags":["seralize"]},{"location":"blog/%E4%BD%BF%E7%94%A8avahi%E5%B0%86%E4%BC%A0%E7%BB%9F%E6%89%93%E5%8D%B0%E6%9C%BA%E6%94%AF%E6%8C%81%E6%97%A0%E7%BA%BF%E6%89%93%E5%8D%B0/","title":"\u4f7f\u7528avahi\u5c06\u4f20\u7edf\u6253\u5370\u673a\u652f\u6301\u65e0\u7ebf\u6253\u5370","text":"<p>\u81ea\u4ece\u77e5\u9053mdns\u4e4b\u540e\uff0c\u53d1\u73b0\u5b83\u975e\u5e38\u65b9\u4fbf\uff0c\u4f8b\u5982\u53ef\u4ee5\u627e\u5230lan\u4e0b\u6709\u54ea\u4e9bftp\u670d\u52a1\uff0cssh\u670d\u52a1\u7b49\u3002\u751a\u81f3\u6211\u914d\u7f6e\u597d\u7684\u6253\u5370\u673a\u670d\u52a1\u3002</p>","tags":["mdns","printer"]},{"location":"blog/%E4%BD%BF%E7%94%A8avahi%E5%B0%86%E4%BC%A0%E7%BB%9F%E6%89%93%E5%8D%B0%E6%9C%BA%E6%94%AF%E6%8C%81%E6%97%A0%E7%BA%BF%E6%89%93%E5%8D%B0/#mdns","title":"mdns\u4ecb\u7ecd","text":"<p>\u6709\u522b\u4e8edns, mdns\u4e13\u95e8\u7528\u6765\u89e3\u6790\u94fe\u8def\u57df\u540d\uff08TLD\u4e3a*.local\uff09\uff0c \u4e14\u4e0d\u9700\u8981\u57df\u540d\u670d\u52a1\u5668\uff08nameserver\uff09\u3002  \u539f\u7406\u662f\u540c\u4e00\u4e2alan\u91cc\u7684\u4e3b\u673a\u901a\u8fc7avahi\u6216zeroconfig\u7c7b\u4f3c\u7684\u5de5\u5177\uff0c\u5411lan\u5e7f\u64ad\u81ea\u5df1\u7684ip\u4fe1\u606f\u548c\u670d\u52a1</p>","tags":["mdns","printer"]},{"location":"blog/%E4%BD%BF%E7%94%A8avahi%E5%B0%86%E4%BC%A0%E7%BB%9F%E6%89%93%E5%8D%B0%E6%9C%BA%E6%94%AF%E6%8C%81%E6%97%A0%E7%BA%BF%E6%89%93%E5%8D%B0/#avahi_1","title":"avahi \u4ecb\u7ecd","text":"<p>avahi\u662fzeroconfig\u7684\u5f00\u6e90\u5b9e\u73b0\uff0c\u5728linux\u4e0b\u8fd8\u6709systemd-resolve \u540c\u6837\u53ef\u4ee5\u5b9e\u73b0mdns\u89e3\u6790\uff0c\u4f46\u662favahi\u4f9d\u65e7\u662flinux\u9884\u88c5\u7684\u8f6f\u4ef6\u3002</p>","tags":["mdns","printer"]},{"location":"blog/%E4%BD%BF%E7%94%A8avahi%E5%B0%86%E4%BC%A0%E7%BB%9F%E6%89%93%E5%8D%B0%E6%9C%BA%E6%94%AF%E6%8C%81%E6%97%A0%E7%BA%BF%E6%89%93%E5%8D%B0/#avahi_2","title":"avahi \u914d\u7f6e","text":"<p>\u4e3b\u8981\u4fee\u6539<code>/etc/avahi/avahi-daemon.conf</code>, \u8fd9\u91cc\u4f7f\u7528\u4e86br0\u548cwlan0\u4e24\u4e2a\u7f51\u5361\uff0cavahi\u5c31\u53ef\u4ee5\u8bbf\u95ee\u4e24\u4e2a\u7f51\u7edc <pre><code>use-ipv4=yes\nallow-interfaces=br0,wlan0\n</code></pre> \u518d\u8bbe\u7f6e\u81ea\u542f\u52a8</p>","tags":["mdns","printer"]},{"location":"blog/%E4%BD%BF%E7%94%A8avahi%E5%B0%86%E4%BC%A0%E7%BB%9F%E6%89%93%E5%8D%B0%E6%9C%BA%E6%94%AF%E6%8C%81%E6%97%A0%E7%BA%BF%E6%89%93%E5%8D%B0/#nss","title":"nss \u914d\u7f6e","text":"<p>\u8981\u8ba9\u4e3b\u673a\u80fd\u89e3\u6790\u5230*.local \u57df\u540d\uff0c\u9700\u8981\u4fee\u6539\u914d\u7f6e\u6587\u4ef6<code>/etc/nsswitch.conf</code> <pre><code>- hosts: files mymachines myhostname resolve [!UNAVAIL=return] dns\n+ hosts: files mymachines myhostname mdns_minimal [NOTFOUND=return] resolve [!UNAVAIL=return] dns\n</code></pre> \u8fd9\u6837\uff0c\u5728\u4e3b\u673a\u8bf7\u6c42\u89e3\u6790\u57df\u540d\u7684\u65f6\u5019\uff0c \u4f1a\u5148\u53bb\u8bf7\u6c42avahi\u89e3\u6790\uff0c\u5982\u679cavahi\u89e3\u6790\u5931\u8d25\uff08\u8bf4\u660e\u4e0d\u662f\u4e00\u4e2alocal\u57df\u540d\uff09\u624d\u4f1a\u53bb\u67e5\u627e\u57df\u540d\u89e3\u6790\uff08dns\uff09</p>","tags":["mdns","printer"]},{"location":"blog/%E4%BD%BF%E7%94%A8avahi%E5%B0%86%E4%BC%A0%E7%BB%9F%E6%89%93%E5%8D%B0%E6%9C%BA%E6%94%AF%E6%8C%81%E6%97%A0%E7%BA%BF%E6%89%93%E5%8D%B0/#systemd-resolved","title":"\u4f7f\u7528systemd-resolved","text":"<p>\u5bf9\u4e8e\u4f7f\u7528systemd-resoved\u6765\u7ba1\u7406dns\u89e3\u6790\u65f6\uff0c\u53ef\u4ee5\u76f4\u63a5\u7528<code>sudo systemd-resolve --set-mdns=yes --interface=eth0</code>\u542f\u52a8eth0\u7aef\u53e3\u7684mdns\u5e7f\u64ad\u3002</p> <p>\u987a\u4fbf\u63d0\u4e00\u4e0b\uff0c\u7528systemd-networkd\u914d\u7f6edns\u670d\u52a1\u5668\u548c\u7528systemd-resolved\u914d\u7f6edns\u7684\u533a\u522b\uff0c\u524d\u8005\u4e3a\u6bcf\u4e2a\u4ee5\u592a\u7f51\u53e3\u5355\u72ec\u914d\u7f6e\uff0c\u800csystemd-resoved\u4f1a\u8bfb\u53d6\u6bcf\u4e2a\u4ee5\u592a\u7f51\u53e3\u914d\u7f6e\uff0c\u53e6\u5916\u8fd8\u6709\u4e00\u4e2a\u5168\u5c40\u7684dns\u914d\u7f6e\u3002</p>","tags":["mdns","printer"]},{"location":"blog/%E4%BD%BF%E7%94%A8avahi%E5%B0%86%E4%BC%A0%E7%BB%9F%E6%89%93%E5%8D%B0%E6%9C%BA%E6%94%AF%E6%8C%81%E6%97%A0%E7%BA%BF%E6%89%93%E5%8D%B0/#_1","title":"\u6d4b\u8bd5","text":"<p>\u9996\u5148\u53ef\u4ee5ping \u672c\u5730local\u57df\u540d <pre><code>~ &gt; ping hst.local                                                                                                                                                                                      \nPING hst.local(hst (fe80::3e9c:fff:fe8c:69c3%wlan0)) 56 data bytes\n64 bytes from hst (fe80::3e9c:fff:fe8c:69c3%wlan0): icmp_seq=1 ttl=64 time=0.113 ms\n64 bytes from hst (fe80::3e9c:fff:fe8c:69c3%wlan0): icmp_seq=2 ttl=64 time=0.144 ms\n</code></pre></p> <p>\u7136\u540e\u6267\u884c<code>avahi-discover-standalone</code> \u53ef\u4ee5\u67e5\u627e\u5230\u5f88\u591a*.local\u7684\u5730\u5740\uff0c\u7279\u522b\u662f\u5728\u516c\u53f8\u7f51\u7edc\u91cc</p>","tags":["mdns","printer"]},{"location":"blog/%E4%BD%BF%E7%94%A8avahi%E5%B0%86%E4%BC%A0%E7%BB%9F%E6%89%93%E5%8D%B0%E6%9C%BA%E6%94%AF%E6%8C%81%E6%97%A0%E7%BA%BF%E6%89%93%E5%8D%B0/#_2","title":"\u5e7f\u544a\u81ea\u5df1\u7684\u670d\u52a1","text":"<p>\u914d\u7f6e\u597d\u4e86avahi, \u5c31\u53ef\u4ee5\u5411\u5916\u754c\u53d1\u5e03\u81ea\u5df1\u7684\u670d\u52a1\uff0c\u8ba9\u5176\u4ed6\u4eba\u77e5\u9053\uff0c\u4e5f\u53ef\u4ee5\u9009\u62e9\u4e0d\u53d1\u5e03 \u4f8b\u5982\u8981\u5e7f\u544a\u6211\u7684ssh\u670d\u52a1, \u53ea\u9700\u8981\u5c06\u9884\u8bbe\u7684\u914d\u7f6e\u6587\u4ef6\u62f7\u8d1d\u5230avahi\u7684\u914d\u7f6e\u76ee\u5f55\u4e0b <pre><code>sudo cp /usr/share/doc/avahi/ssh.service /etc/avahi/services\n</code></pre> \u8fd9\u6837\uff0c\u522b\u4eba\u5c31\u80fd\u53d1\u73b0\u6211\u7684ssh\u670d\u52a1\u4e86</p>","tags":["mdns","printer"]},{"location":"blog/%E4%BD%BF%E7%94%A8avahi%E5%B0%86%E4%BC%A0%E7%BB%9F%E6%89%93%E5%8D%B0%E6%9C%BA%E6%94%AF%E6%8C%81%E6%97%A0%E7%BA%BF%E6%89%93%E5%8D%B0/#_3","title":"\u914d\u7f6e\u6253\u5370\u673a","text":"<p>linux\u7684\u6253\u5370\u529f\u80fd\u4f9d\u8d56CUPS\u8fd9\u4e2a\u8f6f\u4ef6\uff0c\u5148\u5b89\u88c5CUPS\uff0c\u8bbe\u7f6e\u81ea\u542f\u52a8\uff0c\u7136\u540e\u5c31\u53ef\u4ee5\u8bbf\u95eeCUPS\u7684\u7f51\u9875\u7248\u7ba1\u7406\u754c\u9762<code>http://localhost:631</code> \u5728\u8fd9\u4e2a\u7f51\u9875\u4e2d\u6dfb\u52a0\u7f51\u7edc\u6253\u5370\u673a\u6216\u8005\u672c\u5730\u6253\u5370\u673a\uff0c\u7136\u540e\u6d4b\u8bd5\u6253\u5370\u662f\u5426\u6b63\u5e38</p>","tags":["mdns","printer"]},{"location":"blog/%E4%BD%BF%E7%94%A8avahi%E5%B0%86%E4%BC%A0%E7%BB%9F%E6%89%93%E5%8D%B0%E6%9C%BA%E6%94%AF%E6%8C%81%E6%97%A0%E7%BA%BF%E6%89%93%E5%8D%B0/#_4","title":"\u6700\u540e\uff0c\u914d\u7f6e\u65e0\u7ebf\u529f\u80fd","text":"<p>\u4e0a\u4e00\u90e8\u6dfb\u52a0\u7684\u6253\u5370\u673a\u53ef\u80fd\u662f\u6709\u7ebf\u7f51\u7edc\u6253\u5370\u673a\uff0c\u4e5f\u53ef\u80fd\u662f\u4e32\u53e3\u6253\u5370\u673a\uff0c\u90fd\u4e0d\u80fd\u8ba9\u6211\u4eec\u7684\u624b\u673a\u76f4\u63a5\u4f7f\u7528\u3002  </p> <p>\u4f46\u662f\u901a\u8fc7cups + avahi \u5c31\u53ef\u4ee5\u5c06\u4f60\u7684\u6709\u7ebf\u6253\u5370\u673a\u53d8\u6210\u65e0\u7ebf\u6253\u5370\u673a\u4e86 \u9996\u5148\u5728cups\u91cc\u914d\u7f6e\uff0c\u52fe\u9009<code>Share This Printer</code>\uff0c  </p> <p>\u7136\u540e\u50cf\u521a\u624d\u6dfb\u52a0ssh\u670d\u52a1\u4e00\u6837\uff0c \u6dfb\u52a0\u6253\u5370\u670d\u52a1 \u5728<code>/etc/avahi/services/</code> \u521b\u5efa\u4e00\u4e2aservice\u540e\u7f00\u7684\u6587\u4ef6<code>airprint.service</code></p> <p><pre><code>&lt;?xml version=\"1.0\" standalone='no'?&gt;&lt;!--*-nxml-*--&gt;\n&lt;!DOCTYPE service-group SYSTEM \"avahi-service.dtd\"&gt;\n&lt;service-group&gt;\n  &lt;name&gt;Printer&lt;/name&gt;\n  &lt;service&gt;\n    &lt;type&gt;_ipp._tcp&lt;/type&gt;\n    &lt;subtype&gt;_universal._sub._ipp._tcp&lt;/subtype&gt;\n    &lt;port&gt;631&lt;/port&gt;\n    &lt;txt-record&gt;txtver=1&lt;/txt-record&gt;\n    &lt;txt-record&gt;qtotal=1&lt;/txt-record&gt;\n    &lt;txt-record&gt;rp=printers/Ricoh_MP_4055&lt;/txt-record&gt;\n    &lt;txt-record&gt;ty=Ricoh_MP_4055&lt;/txt-record&gt;\n    &lt;txt-record&gt;adminurl=http://yourip:631/printers/Ricoh_MP_4055&lt;/txt-record&gt;\n    &lt;txt-record&gt;note=Ricoh_MP_4055&lt;/txt-record&gt;\n    &lt;txt-record&gt;priority=0&lt;/txt-record&gt;\n    &lt;txt-record&gt;product=(GPL Ghostscript)&lt;/txt-record&gt;\n    &lt;txt-record&gt;printer-state=3&lt;/txt-record&gt;\n    &lt;txt-record&gt;printer-type=0x801046&lt;/txt-record&gt;\n    &lt;txt-record&gt;Transparent=T&lt;/txt-record&gt;\n    &lt;txt-record&gt;Binary=T&lt;/txt-record&gt;\n    &lt;txt-record&gt;Fax=F&lt;/txt-record&gt;\n    &lt;txt-record&gt;Color=T&lt;/txt-record&gt;\n    &lt;txt-record&gt;Duplex=T&lt;/txt-record&gt;\n    &lt;txt-record&gt;Staple=F&lt;/txt-record&gt;\n    &lt;txt-record&gt;Copies=T&lt;/txt-record&gt;\n    &lt;txt-record&gt;Collate=F&lt;/txt-record&gt;\n    &lt;txt-record&gt;Punch=F&lt;/txt-record&gt;\n    &lt;txt-record&gt;Bind=F&lt;/txt-record&gt;\n    &lt;txt-record&gt;Sort=F&lt;/txt-record&gt;\n    &lt;txt-record&gt;Scan=F&lt;/txt-record&gt;\n    &lt;txt-record&gt;pdl=application/octet-stream,application/pdf,application/postscript,image/jpeg,image/png,image/urf&lt;/txt-record&gt;\n    &lt;txt-record&gt;URF=W8,SRGB24,CP1,RS600&lt;/txt-record&gt;\n  &lt;/service&gt;\n&lt;/service-group&gt;\n</code></pre> \u6839\u636e\u60c5\u51b5\u4fee\u6539\u4e00\u4e0b\u5185\u5bb9\uff0c\u5c31\u5b8c\u6210\u4e86, \u4eb2\u6d4biphone\u53ef\u4ee5\u4f7f\u7528\u8fd9\u4e2a\u670d\u52a1\u6253\u5370</p>","tags":["mdns","printer"]},{"location":"blog/%E4%BD%BF%E7%94%A8avahi%E5%B0%86%E4%BC%A0%E7%BB%9F%E6%89%93%E5%8D%B0%E6%9C%BA%E6%94%AF%E6%8C%81%E6%97%A0%E7%BA%BF%E6%89%93%E5%8D%B0/#_5","title":"\u6ce8\u610f","text":"<p>\u4e0a\u9762\u7684\u60c5\u51b5\u5047\u8bbe\u9632\u706b\u5899\u5904\u4e8e\u5173\u95ed\u72b6\u6001\uff0c\u5982\u679c\u542f\u7528\u9632\u706b\u5899\u7684\u60c5\u51b5\u4e0b\uff0c\u9700\u8981\u5f00\u653eavahi\u3001ssh\u4ee5\u53caipp\u670d\u52a1</p> <pre><code>sudo firewall-cmd --add-service ssh ipp --permanent\nsudo firewall-cmd --add-port=5353/tcp --permanent\nsudo firewall-cmd --reload\n</code></pre>","tags":["mdns","printer"]},{"location":"blog/setup-sftp-service/","title":"setup sftp service","text":"","tags":["linux","filesystem"]},{"location":"blog/setup-sftp-service/#curlfs-sshfs","title":"curlfs \u548c sshfs \u5ba2\u6237\u7aef","text":"<p>\u5728debian\u4e0a\uff0c\u4e4b\u524d\u4e00\u76f4\u7528curlfs\u5de5\u5177\uff0c\u5c06\u8fdc\u7a0b\u76ee\u5f55mount\u5230\u672c\u5730\u76ee\u5f55\u3002\u7cfb\u7edf\u5347\u7ea7\u4e4b\u540e\u53d1\u73b0\u8fd9\u4e2a\u5305\u6ca1\u6709\u4e86\uff0c \u539f\u6765\u56e0\u4e3aftp\u4e0d\u5b89\u5168\uff0c\u6240\u4ee5\u73b0\u5728\u63a8\u8350sshfs\u3002</p>","tags":["linux","filesystem"]},{"location":"blog/setup-sftp-service/#reference","title":"reference","text":"<p>https://www.linuxtechi.com/configure-sftp-chroot-debian10/</p>","tags":["linux","filesystem"]},{"location":"blog/%E6%99%BA%E8%83%BD%E6%8C%87%E9%92%88/","title":"\u667a\u80fd\u6307\u9488","text":"<p>\u667a\u80fd\u6307\u9488\u662fc++11\u52a0\u5165\u7684\u7279\u6027\uff0c\u5305\u62ecshared_ptr\u548cunique_ptr\uff0cweak_ptr\uff0c\u4ee5\u53camake_shared\u51fd\u6570\uff0c\u4f46make_unique\u662fc++14\u624d\u51fa\u6765 \u4e0d\u8fc7c++11\u53ef\u4ee5\u901a\u8fc7\u6a21\u7248\u6765\u5b9e\u73b0make_unique</p>","tags":["cpp"]},{"location":"blog/%E6%99%BA%E8%83%BD%E6%8C%87%E9%92%88/#_2","title":"\u666e\u901a\u6307\u9488\u548c\u667a\u80fd\u6307\u9488\u7684\u533a\u522b","text":"<p>shared_ptr\u548cunique_ptr\u90fd\u662f\u5f02\u5e38\u5b89\u5168\u7684(exception-safe)\uff0c\u800c\u666e\u901a\u6307\u9488\u4e0d\u662f\uff0c\u4e3e\u4f8b\u5982\u4e0b <pre><code>void nonsafe_call(T1* t1, T2* t2);\nvoid safe_call(unique_ptr&lt;T1&gt; t1, unique_ptr&lt;T2&gt; t2);\n\nnonsafe_call(new T1, new T2);\nsafe_call(make_unique&lt;T1&gt;, make_unique&lt;T2&gt;);\n</code></pre></p>","tags":["cpp"]},{"location":"blog/%E6%99%BA%E8%83%BD%E6%8C%87%E9%92%88/#_3","title":"\u5f15\u7528\u8ba1\u6570","text":"","tags":["cpp"]},{"location":"blog/%E6%99%BA%E8%83%BD%E6%8C%87%E9%92%88/#_4","title":"\u5f53\u5f62\u53c2\u4e3a\u666e\u901a\u6307\u9488\u65f6","text":"<p>\u867d\u7136new\u662f\u5b89\u5168\u7684\uff0c\u4f1a\u5148\u7533\u8bf7\u5185\u5b58\u518d\u6784\u9020\u5bf9\u8c61t1\u3002 \u5982\u679ct1\u7684\u6784\u9020\u51fd\u6570\u629b\u5f02\u5e38\uff0c\u7533\u8bf7\u7684\u5185\u5b58\u4f1a\u81ea\u52a8\u91ca\u653e\uff0c\u4e0d\u4f1a\u5185\u5b58\u6cc4\u6f0f \u4f46\u5f53\u4e24\u4e2anew\u4f5c\u4e3a\u51fd\u6570\u53c2\u6570\u65f6\uff0c\u60c5\u51b5\u4e0d\u540c\u3002 \u56e0\u4e3a\u53c2\u6570\u5fc5\u987b\u5728\u8c03\u7528\u51fd\u6570\u524d\u51b3\u65ad\uff0c\u6240\u4ee5\u6b65\u9aa4\u5982\u4e0b <pre><code>1. \u4e3at1\u7533\u8bf7\u5185\u5b58\n2. \u6784\u9020t1\n3. \u4e3at2\u7533\u8bf7\u5185\u5b58\n4. \u6784\u9020t2\n5. \u8c03\u7528\u51fd\u6570\n</code></pre></p> <ul> <li>\u5f53\u6267\u884c\u52302\u5931\u8d25\u65f6\uff0c\u4e0d\u4f1a\u6cc4\u6f0f\uff0cnew\u4f1a\u91ca\u653et1\u7684\u5185\u5b58</li> <li>\u5f53\u6267\u884c\u52304\u5931\u8d25\u662f\uff0c\u4f1a\u6cc4\u6f0ft1\uff0c\u56e0\u4e3at1\u5df2\u7ecf\u6784\u9020\u5b8c\u6210\uff0c\u4e0d\u4f1a\u91ca\u653e\u5185\u5b58</li> </ul>","tags":["cpp"]},{"location":"blog/%E6%99%BA%E8%83%BD%E6%8C%87%E9%92%88/#_5","title":"\u5f53\u5f62\u53c2\u4e3a\u667a\u80fd\u6307\u9488\u65f6","text":"<p>\u6b65\u9aa4\u4e3a <pre><code>1. t1 = make_unique&lt;T1&gt;()\n2. t2 = make_unique&lt;T2&gt;()\n3. \u8c03\u7528\u51fd\u6570\n</code></pre> \u5982\u679c2\u5931\u8d25\uff0ct1\u7684\u5bf9\u8c61\u7531unique_ptr\u7ba1\u7406\uff0c\u5f53t1\u91ca\u653e\u65f6\uff0c\u4f1a\u91ca\u653e\u5185\u5b58\uff0c\u6240\u4ee5\u65e0\u8bbat1\u6784\u9020\u5931\u8d25\u8fd8\u662ft2\u6784\u9020\u5931\u8d25\uff0c\u90fd\u80fd\u6b63\u786e\u91ca\u653e\u5185\u5b58\uff0c\u4e0d\u4f1a\u5bfc\u81f4\u6cc4\u6f0f \u5c31\u56e0\u4e3aunique_ptr\u548cshared_ptr\u662f\u5185\u5b58\u5b89\u5168\u7684</p>","tags":["cpp"]},{"location":"blog/%E6%99%BA%E8%83%BD%E6%8C%87%E9%92%88/#_6","title":"\u4f46\u4ee5\u666e\u901a\u6307\u9488\u6784\u9020\u667a\u80fd\u6307\u9488\u7684\u65b9\u5f0f\u4e0d\u662f\u5f02\u5e38\u5b89\u5168\u7684","text":"<p>\u5373<code>foo(std::unique_ptr&lt;T1&gt;(new T1()), std::unique_ptr&lt;T2&gt;(new T2()));</code> \u4e0d\u662f\u5f02\u5e38\u5b89\u5168\u7684</p> <p>\u6b64\u65f6\u6b65\u9aa4\u53ef\u80fd\u5982\u4e0b <pre><code>1. \u4e3at1\u7533\u8bf7\u5185\u5b58\n2. \u6784\u9020t1\n3. \u4e3at2\u7533\u8bf7\u5185\u5b58\n4. \u6784\u9020t2\n5. \u6784\u9020unique_ptr&lt;T1&gt;\n6. \u6784\u9020unique_ptr&lt;T2&gt;\n7. \u8c03\u7528\u51fd\u6570\n</code></pre> \u5f53\u6b65\u9aa44\u53d1\u751f\u5f02\u5e38\u65f6\uff0ct1\u5e76\u672a\u88abunique_ptr\u7ba1\u7406\uff0c\u6240\u4ee5\u4e0d\u4f1a\u53bb\u91ca\u653et1\u7684\u5185\u5b58\uff0c\u6545\u53d1\u751f\u5185\u5b58\u6cc4\u6f0f</p>","tags":["cpp"]},{"location":"blog/%E6%99%BA%E8%83%BD%E6%8C%87%E9%92%88/#_7","title":"\u667a\u80fd\u6307\u9488\u7684\u6784\u9020","text":"<p>shared_ptr\u5bf9\u5e94\u7684\u51fd\u6570\u662fmake_shared \u4f46c++11\u4e2d\u6ca1\u6709make_unique, \u53ef\u4ee5\u4f7f\u7528\u6a21\u7248\u5b9e\u73b0\u5982\u4e0b <p><pre><code>template&lt;typename T,typename ...Args&gt;\nstd::unique_ptr&lt;T&gt; make_unique(Args&amp;&amp; ...args){\n    return std::unique_ptr&lt;T&gt;(new T(std::forward&lt;Args&gt;(args)... ));\n}\n</code></pre> \u90a3\u4e3a\u4ec0\u4e48\u8fd9\u6837\u5c31\u80fd\u5f02\u5e38\u5b89\u5168\u5462\uff1f\u56e0\u4e3a\u8c03\u7528make_uniqe\u65f6\uff0c\u53ef\u4ee5\u786e\u4fddt1\u7684\u5185\u5b58\u88abunique_ptr\u7ba1\u7406\u4e86 </p>","tags":["cpp"]},{"location":"blog/%E6%99%BA%E8%83%BD%E6%8C%87%E9%92%88/#make_sharednew","title":"make_shared\u521b\u5efa\u667a\u80fd\u6307\u9488\u548c\u7528new\u521b\u5efa\u667a\u80fd\u6307\u9488\u7684\u533a\u522b","text":"<p>\u9664\u4e86\u4e0a\u9762\u8bf4\u6240\u7684make_shared/make_unique\u662f\u5f02\u5e38\u5b89\u5168\uff0c\u800cunique_ptr(new T()) \u4e0d\u662f\u5f02\u5e38\u5b89\u5168\u5916\uff0c\u5176\u6784\u9020\u7684\u667a\u80fd\u6307\u9488\u4e5f\u4e0d\u540c   <p>\u667a\u80fd\u6307\u9488\u4e4b\u6240\u4ee5\u4f1a\u91ca\u653e\u5185\u5b58\uff0c\u662f\u56e0\u4e3a\u667a\u80fd\u6307\u9488\u672c\u8eab\u4e5f\u662f\u4e00\u4e2a\u5bf9\u8c61\uff0c\u5728\u5176\u751f\u547d\u5468\u671f\u7ed3\u675f\u540e\u4f1a\u8c03\u7528dtor, \u5e76\u5728\u90a3\u91cc\u91ca\u653e\u5185\u5b58 \u6240\u4ee5\u667a\u80fd\u6307\u9488\u7684\u5bf9\u8c61\u5185\u5b58\u5373\u5305\u542b\u4e86T\uff0c\u4e5f\u5305\u542b\u4e86\u667a\u80fd\u6307\u9488\u672c\u8eab\uff0c\u800cmake_shared() \u548c shared_ptr(new T)\u7684\u533a\u522b\u5728\u4e8e<code>\u524d\u8005\u662f\u4e24\u4e2a\u90e8\u5206\u7684\u5730\u5740\u8fde\u7eed\uff0c\u800c\u540e\u8005\u5e76\u4e0d\u4e00\u5b9a\u8fde\u7eed</code>","tags":["cpp"]},{"location":"blog/%E6%99%BA%E8%83%BD%E6%8C%87%E9%92%88/#unique_ptr","title":"unique_ptr\u7684\u533a\u522b","text":"<p>unique_ptr\u548cshared_ptr\u4e0d\u540c\uff0c\u540e\u8005\u4e3a\u4e86\u591a\u53d8\u91cf\u540c\u65f6\u62e5\u6709\u8d44\u6e90\u7684\u8bbf\u95ee\uff0c\u800cunique_ptr\u8868\u793a\u4efb\u4f55\u65f6\u523b\uff0c\u53ea\u6709\u4e00\u4e2a\u53d8\u91cf\u80fd\u8bbf\u95ee\u8d44\u6e90\u548c\u91ca\u653e\u8d44\u6e90\uff0c\u6bd4\u5982\u6253\u5f00\u7684\u6587\u4ef6\u8bbe\u5907,  \u800c\u4e14\u901a\u5e38\u4e3a\u7ba1\u7406\u7684\u8d44\u6e90\u8bbe\u7f6e\u6790\u6784\u51fd\u6570\uff0c\u6bd4\u5982\u6307\u5b9a\u6790\u6784\u65f6\u5173\u95ed\u6587\u4ef6\u548c\u8bbe\u5907</p> <p>\u5982\u4e0b\u4ee3\u7801\uff0c\u5f53fp\u6790\u6784\u65f6\uff0c\u81ea\u52a8\u5173\u95ed\u6587\u4ef6 <pre><code>// helper function for the custom deleter demo below\nvoid close_file(std::FILE* fp)\n{\n    std::fclose(fp);\n}\nusing unique_file_t = std::unique_ptr&lt;std::FILE, decltype(&amp;close_file)&gt;;\nunique_file_t fp(std::fopen(\"demo.txt\", \"r\"), &amp;close_file);\n</code></pre></p> <p>unique_ptr\u8981\u914d\u5408move\u4f7f\u7528\uff0c\u5f53move\u4e4b\u540e\uff0c\u539f\u5bf9\u8c61\u4e0d\u62e5\u6709\u6307\u9488\u8d44\u6e90</p>","tags":["cpp"]},{"location":"blog/%E6%99%BA%E8%83%BD%E6%8C%87%E9%92%88/#_8","title":"\u603b\u7ed3","text":"<p>\u4e3a\u4e86\u907f\u514d\u591a\u53c2\u6570\u51b3\u65ad\u65f6\uff0c\u5bfc\u81f4\u5df2\u7ecf\u51b3\u65ad\u7684\u53c2\u6570\u5185\u5b58\u6cc4\u6f0f\uff0c\u5e94\u5c3d\u53ef\u80fd\u4f7f\u7528\u667a\u80fd\u6307\u9488\u6765\u7ba1\u7406\u5185\u5b58</p>","tags":["cpp"]},{"location":"blog/shell-%E4%B8%AD%E6%96%87%E4%BB%B6%E6%93%8D%E4%BD%9C%E6%8E%A5%E5%8F%A3/","title":"shell \u4e2d\u6587\u4ef6\u64cd\u4f5c\u63a5\u53e3","text":"","tags":["linux","file"]},{"location":"blog/shell-%E4%B8%AD%E6%96%87%E4%BB%B6%E6%93%8D%E4%BD%9C%E6%8E%A5%E5%8F%A3/#_1","title":"\u8bfb\u884c","text":"<pre><code>while read line ;do\n#or while read -r line ;do\necho $line\ndone &lt; $1\n</code></pre> <pre><code>cat $1 | while read line ;do\necho $line\ndone\n</code></pre> <p>\u4f7f\u7528for\u65f6\uff0c\u7ed3\u679c\u7565\u6709\u4e0d\u540c, for\u4ee5\u7a7a\u683c\u4e3a\u4e00\u884c <pre><code>for line in $(cat $1) ;do\necho $line\ndone\n</code></pre></p>","tags":["linux","file"]},{"location":"blog/shell-%E4%B8%AD%E6%96%87%E4%BB%B6%E6%93%8D%E4%BD%9C%E6%8E%A5%E5%8F%A3/#reference","title":"reference","text":"<p>https://bash.cyberciti.biz/guide/Reads_from_the_file_descriptor_(fd)</p>","tags":["linux","file"]},{"location":"blog/shell-%E7%AC%94%E8%AE%B0/","title":"shell \u7b14\u8bb0","text":"<p>shell \u662funix-like\u7cfb\u7edf\u4e0b\uff0c\u7528\u6237\u4e0e\u7cfb\u7edf\u4ea4\u4e92\u7684\u5a92\u4ecb\uff0c\u7528\u6765\u89e3\u6790\u7528\u6237\u7684\u8f93\u5165\u5e76\u8c03\u7528\u7cfb\u7edf\u51fd\u6570\u3002  \u800cshell\u7684\u5b9e\u73b0\u6709\u5e38\u89c1\u7684bash,zsh,ksh\u7b49, \u4ed6\u4eec\u5b9e\u73b0\u6709\u5f88\u591a\u5dee\u522b\uff0c\u4f46bash\u6700\u4e3a\u901a\u7528</p>","tags":["shell"]},{"location":"blog/shell-%E7%AC%94%E8%AE%B0/#bash","title":"bash \u6a21\u5f0f\u62d3\u5c55","text":"","tags":["shell"]},{"location":"blog/shell-%E7%AC%94%E8%AE%B0/#bash_1","title":"bash \u5b57\u7b26\u4e32\u64cd\u4f5c","text":"","tags":["shell"]},{"location":"blog/shell-%E7%AC%94%E8%AE%B0/#bash_2","title":"bash \u6570\u7ec4\u64cd\u4f5c","text":"","tags":["shell"]},{"location":"blog/shell-%E7%AC%94%E8%AE%B0/#_1","title":"\u73af\u5883\u53d8\u91cf","text":"<p>\u6d4b\u8bd5\u7a0b\u5e8f\u5b9a\u65f6\u83b7\u53d6\u548c\u6253\u5370\u73af\u5883\u53d8\u91cf <pre><code>int main() {\n  while (1) {\n    char *env = getenv(\"TEST_ENV\");\n    printf(\"env: %s\\n\", env);\n    sleep(5);\n  }\n}\n</code></pre></p> <p>\u901a\u8fc7bash\u6765\u4fee\u6539\u73af\u5883\u53d8\u91cf <pre><code>#test.sh\nexport TEST_ENV=TEST\n./a.out\nexport TEST_ENV=NNN\n</code></pre></p> <p>\u6267\u884c<code>test.sh</code>\uff0cc\u7a0b\u5e8f\u6ca1\u6709\u66f4\u65b0\u73af\u5883\u53d8\u91cf, \u6240\u4ee5\u73af\u5883\u53d8\u91cf\u4e0d\u4f1a\u53d8\u5316\u3002</p> <pre><code>env: TEST\nenv: TEST\nenv: TEST\n</code></pre> <pre><code>#include &lt;stdio.h&gt;\n\nextern char **environ;\n\nint main() {\n  char **var;\n  for (var = environ; *var != NULL; ++var) {\n    printf(\"%s\\n\", *var);\n  }\n}\n</code></pre>","tags":["shell"]},{"location":"blog/shell-%E7%AC%94%E8%AE%B0/#set-unset","title":"set unset","text":"","tags":["shell"]},{"location":"blog/c%E7%9A%84basic_string%E4%BC%98%E5%8C%96/","title":"c++\u7684basic_string\u4f18\u5316","text":"<p>Small-string optimization is basically </p> <p><pre><code>union { \n  struct { char*, size_t, size_t; }\n  struct { char[23]; bool; } \n} \n</code></pre> - but with bit-tricks instead. When allocated, the local buffer's space is reused for size and capacity. It's not wasted. But gdb just shows both sides of the union, which can be confusing.</p>","tags":["cpp","string"]},{"location":"blog/spdlog-learning/","title":"spdlog learning","text":"<p>spdlog \u652f\u6301\u591aspdlog::logger, \u9002\u7528\u4e0e\u591a\u4e2a\u9694\u79bb\u6a21\u5757\u7684\u65e5\u5fd7\u5206\u522b\u4fdd\u5b58  </p> <p>\u800c\u4e14logger\u542b\u6709\u591a\u4e2asink\u7684vector\u3002sink\u4e0e\u6587\u4ef6\u5bf9\u5e94\uff0c\u5982\u679c\u60f3\u628a\u65e5\u5fd7\u8f93\u51fa\u5230\u591a\u4e2a\u6587\u4ef6\uff0c\u5c31\u521b\u5efa\u591a\u4e2asink <pre><code>std::vector&lt;sink_ptr&gt; sinks_;\n</code></pre></p> <p>logger\u548csink\u7684\u7ea7\u522b\u72ec\u7acb <pre><code>// logger\u7ea7\u522b\u7684\u5224\u65ad\ntemplate&lt;typename... Args&gt;\ninline void spdlog::logger::log(source_loc source, level::level_enum lvl, const char *fmt, const Args &amp;... args)\n{\n    if (!should_log(lvl))\n    {\n        return;\n    }\n</code></pre></p> <pre><code>// sink\u7ea7\u522b\u7684\u5224\u65ad\ninline void spdlog::logger::sink_it_(details::log_msg &amp;msg)\n{\n#if defined(SPDLOG_ENABLE_MESSAGE_COUNTER)\n    incr_msg_counter_(msg);\n#endif\n    for (auto &amp;sink : sinks_)\n    {\n        if (sink-&gt;should_log(msg.level))\n        {\n            sink-&gt;log(msg);\n        }\n    }\n</code></pre> <p>\u6240\u4ee5\u53ef\u4ee5\u652f\u6301\u4e0d\u540c\u7684\u7ea7\u522b\u5230\u4e0d\u540c\u7684\u6587\u4ef6\uff0c\u4f8b\u5982logger\u8bbe\u7f6e\u4e3atrace\u7ea7\u522b\uff0c sink1 \u8bbe\u7f6e\u4e3ainfo\u7ea7\u522b\uff0c sink2\u8bbe\u7f6e\u4e3atrace\u7ea7\u522b\uff0c\u8fd9\u6837\u5c31\u80fd\u521b\u5efa\u4e24\u4e2a\u65e5\u5fd7\u6587\u4ef6 <pre><code>info.log  # \u53ea\u4fdd\u5b58info\u7ea7\u522b\nfull.log  # \u4fdd\u5b58\u6240\u6709\u7ea7\u522b\uff08logger\u7ea7\u522b\u6216\u8005sink2\u7684\u7ea7\u522b\uff09\n</code></pre></p>","tags":["cpp"]},{"location":"blog/%E6%95%B0%E6%8D%AE%E5%BA%93%E4%BC%98%E5%8C%96%E6%80%BB%E7%BB%93/","title":"\u6570\u636e\u5e93\u4f18\u5316\u603b\u7ed3","text":"<p>\u8fd9\u91cc\u603b\u7ed3\u4e86\u4ece\u6570\u636e\u5e93\u8bbe\u8ba1\u548csql\u7ed3\u6784\u4e24\u4e2a\u65b9\u9762\u7684\u4f18\u5316</p>","tags":["sql"]},{"location":"blog/%E6%95%B0%E6%8D%AE%E5%BA%93%E4%BC%98%E5%8C%96%E6%80%BB%E7%BB%93/#normal-form","title":"\u6570\u636e\u5e93\u8bbe\u8ba1\u8303\u5f0f Normal Form","text":"<p>\u8303\u5f0f\u662f\u5728\u6570\u636e\u5e93\u7684\u8bbe\u8ba1\u65f6\u603b\u7ed3\u51fa\u6765\u7684\u4e00\u5957\u89c4\u8303\uff0c\u901a\u5e38\u6ee1\u8db33\u8303\u5f0f\u5c31\u8db3\u591f\u4e86\u3002\u4f46\u7531\u4e8e3\u8303\u5f0f\u4e5f\u5b58\u5728\u95ee\u9898\uff0c\u6240\u4ee5\u6709\u4e863.5\u8303\u5f0f</p> <p>\u8303\u5f0f\u4ece1\u52303\u662f\u8d8a\u6765\u8d8a\u4e25\u683c\uff0c\u6240\u4ee5\u6ee1\u8db31NF\u4e0d\u4e00\u5b9a\u6ee1\u8db32NF\uff0c\u4f46\u6ee1\u8db32NF\u5c31\u80af\u5b9a\u6ee1\u8db31NF    </p> <p>\u6ee1\u8db3\u6240\u6709\u8303\u5f0f\u7684\u8868\u6ca1\u6709\u5197\u4f59\u6570\u636e\uff0c\u4f46\u4e5f\u6709\u95ee\u9898\uff0c\u6bd4\u5982\u6548\u7387\u4e0d\u9ad8\u3002\u8fd9\u5c31\u6709\u4e86\u53cd\u8303\u5f0f\u505a\u6cd5\uff0c\u5373\u5141\u8bb8\u6570\u636e\u5197\u4f59\uff0c\u7528\u7a7a\u95f4\u6362\u65f6\u95f4</p>","tags":["sql"]},{"location":"blog/%E6%95%B0%E6%8D%AE%E5%BA%93%E4%BC%98%E5%8C%96%E6%80%BB%E7%BB%93/#1nf","title":"1NF\uff1a\u539f\u5b50\u5316\uff0c\u5355\u5143\u683c\u91cc\u7684\u503c\u4e0d\u80fd\u88ab\u5206\u5272","text":"Employee Id Employee Name Phone Number Salary 1EDU001 Alex +91 85532065  +91 85532066 60,131 1EDU002 Alex +91 85532066 75,331 1EDU003 Alex +91 85532068 63,231 1EDU004 Alex +91 85532069 70,231 1EDU005 Alex +91 85543065  +91 85543075 60,531 <p>\u53ef\u89c1\uff0c\u6709\u6761\u76ee\u7684\u7535\u8bdd\u683c\u91cc\u6709\u4e24\u4e2a\u53f7\u7801\uff0c\u662f\u53ef\u4ee5\u5206\u5272\u7684\uff0c \u6240\u4ee5\u4e0d\u6ee1\u8db31NF\u3002\u5e94\u6539\u4e3a</p> Employee Id Employee Name Phone Number Salary 1EDU001 Alex +91 85532065 60,131 1EDU001 Alex +91 85532066 60,131 1EDU002 Alex +91 85532066 75,331 1EDU003 Alex +91 85532068 63,231 1EDU004 Alex +91 85532069 70,231 1EDU005 Alex +91 85543065 60,531 1EDU005 Alex +91 85543075 60,531 <p>\u5f53\u6240\u6709\u5355\u5143\u683c\u90fd\u65e0\u6cd5\u5206\u5272\u4e86\uff0c\u5c31\u6ee1\u8db3\u4e86\u7b2c\u4e00\u8303\u5f0f</p>","tags":["sql"]},{"location":"blog/%E6%95%B0%E6%8D%AE%E5%BA%93%E4%BC%98%E5%8C%96%E6%80%BB%E7%BB%93/#2nf","title":"2NF\uff1a\u5c5e\u6027\u4e0d\u5141\u8bb8\u90e8\u5206\u4f9d\u8d56\uff08\u590d\u5408\uff09\u4e3b\u952e","text":"<p>\u6ee1\u8db32NF\u524d\u63d0\u8981\u6ee1\u8db31NF, \u8303\u5f0f2\u8981\u6c42\u975e\u4e3b\u5c5e\u6027\u5fc5\u987b\u4f9d\u8d56\u5b8c\u6574\u590d\u5408\u4e3b\u952e\u6216\u8005\u4e3b\u952e\u3002  </p> <p>\u4e0b\u8868<code>Employee Id</code>\u548c<code>Department Id</code>\u7ec4\u6210\u590d\u5408\u4e3b\u952e |Employee Id|Department Id |Office Location | |---|---|---| |1EDUO01 | ED-T1 | Pune | |1EDUO02 | ED-S2 |Bengaluru | |1EDUO03 | ED-M1 | Delhi | |1EDUO04 | ED-T3 | Mumbai | |1EDUO05 | ED-T1 | Pune |</p> <p>\u4f46<code>Office Location</code>\u53ea\u4f9d\u8d56\u4e3b\u952e\u7684<code>Employee Id</code>\u90e8\u5206\u3002\u6216\u8005\u8bf4\u53ea\u9700<code>Department Id</code>\u5c31\u80fd\u4fdd\u8bc1<code>Office Location</code>\u552f\u4e00\uff0c \u6240\u4ee5\u662f\u90e8\u5206\u4f9d\u8d56\u3002\u8fd9\u6837\u4e0d\u6ee1\u8db32NF\u4e86\uff0c\u5e94\u6539\u6210\u4e24\u4e2a\u8868</p> Employee Id Department Id 1EDUO01 ED-T1 1EDUO02 ED-S2 1EDUO03 ED-M1 1EDUO04 ED-T3 1EDUO05 ED-T1 Department Id Office Location ED-T1 Pune ED-S2 Bengaluru ED-M1 Delhi ED-T3 Mumbai","tags":["sql"]},{"location":"blog/%E6%95%B0%E6%8D%AE%E5%BA%93%E4%BC%98%E5%8C%96%E6%80%BB%E7%BB%93/#3nf","title":"3NF\uff1a \u4f9d\u8d56\u4e0d\u80fd\u4f20\u9012","text":"<p>\u6ee1\u8db33NF\u524d\u63d0\u8981\u6ee1\u8db32NF, \u8fd8\u6709\u975e\u4e3b\u5c5e\u6027\u5fc5\u987b\u4f9d\u8d56\u4e3b\u952e/\u590d\u5408\u4e3b\u952e\uff0c\u4e0d\u80fd\u4f9d\u8d56\u5176\u4ed6\u975e\u4e3b\u5c5e\u6027</p> Student Id Student name Subject Id Subject Adress 1DT1SENGO1 Alex 15CS11 SQL Goa 1DT1SENGO2 Barry 15CS13 JAVA Bengaluru 1DT15ENGO3 Clair 15CS12 C++ Delhi 1DT15ENG04 DavId 15CS13 JAVA Kochi <p>\u4e0a\u8868\u7684<code>Subject</code>\u4f9d\u8d56\u975e\u4e3b\u5c5e\u6027<code>Subject Id</code>\uff0c\u800c\u4e0d\u662f\u4f9d\u8d56<code>Student Id</code>\uff0c \u8fd9\u5c31\u4e0d\u6ee1\u8db33NF\u4e86\u3002\u5e94\u6539\u6210</p> Student Id Student name Subject Id 1DT1SENGO1 Alex 15CS11 1DT1SENGO2 Barry 15CS13 1DT15ENGO3 Clair 15CS12 1DT15ENG04 DavId 15CS13 Subject Id Subject Adress 15CS11 SQL Goa 15CS13 JAVA Bengaluru 15CS12 C++ Delhi 15CS13 JAVA Kochi","tags":["sql"]},{"location":"blog/%E6%95%B0%E6%8D%AE%E5%BA%93%E4%BC%98%E5%8C%96%E6%80%BB%E7%BB%93/#3","title":"\u4e0d\u6ee1\u8db33\u8303\u5f0f\u7684\u95ee\u9898","text":"<p>\u4e0d\u6ee1\u8db33\u8303\u5f0f\u7684\u6570\u636e\u5e93\u4f1a\u5b58\u5728\u4ee5\u4e0b\u95ee\u9898: * \u63d2\u5165\u95ee\u9898\uff1a \u63d2\u5165\u6570\u636e\u65f6\uff0c\u5982\u679c\u53ea\u6709\u90e8\u5206\u6570\u636e\uff0c\u53ef\u80fd\u5bfc\u81f4\u63d2\u5165\u5931\u8d25\uff08\u82e5\u67d0\u5217\u4e3aNOT NULL\uff09\u3002\u4e3e\u4f8b2NF\u91cc\u539f\u6765\u7684\u8868\uff0c\u82e5\u53ea\u6709<code>Department Id</code>\u548c<code>Office Location</code>\uff0c\u5c31\u65e0\u6cd5\u63d2\u5165 * \u66f4\u65b0\u95ee\u9898\uff1a \u5f53\u66f4\u65b0\u67d0\u4e2a\u5b57\u6bb5\u65f6\uff0c\u9700\u8981\u66f4\u65b0\u5176\u5b83\u5217\u3002\u4e3e\u4f8b2NF\u7684\u8868\uff0c\u5f53\u66f4\u65b0Pune\u65f6\uff0c \u7b2c1\u5217\u548c\u7b2c4\u5217\u90fd\u8981\u66f4\u65b0 * \u5220\u9664\u95ee\u9898\uff1a \u5f53\u5220\u9664\u67d0\u4e9b\u5c5e\u6027\u65f6\uff0c\u5176\u4ed6\u5c5e\u6027\u4e5f\u8981\u5220\u9664\uff0c \u4e3e\u4f8b3NF\u539f\u6765\u7684\u8868\uff0c\u5f53\u5220\u9664SQL\u8bfe\u7a0b\u65f6\uff0c\u5b66\u751fAlex\u7684\u4fe1\u606f\u4e5f\u4f1a\u4e22\u5931</p>","tags":["sql"]},{"location":"blog/%E6%95%B0%E6%8D%AE%E5%BA%93%E4%BC%98%E5%8C%96%E6%80%BB%E7%BB%93/#35nf-bcnf","title":"3.5NF\uff1a BCNF","text":"<p>3.5\u8303\u5f0f\u7528\u4e8e\u89e3\u51b33\u8303\u5f0f\u9057\u7559\u95ee\u9898 \u4f8b\u5982</p> Student Id Subject Professor 1DT15ENG01 SQL Prof. Mishra 1DT15ENG02 JAVA Prof. Anand 1DT15ENG02 C++ Prof. Kanthi 1DT15ENG03 JAVA Prof. Anand 1DT15ENG04 DBMS Prof. Lokesh <p>\u8bf4\u660e\uff1a * \u4e00\u4e2a\u5b66\u751f\u53ef\u4ee5\u767b\u8bb0\u591a\u4e2a\u79d1\u76ee * \u591a\u4e2a\u8001\u5e08\u53ef\u4ee5\u6559\u6388\u540c\u4e00\u4e2a\u79d1\u76ee * \u6bcf\u4e2a\u79d1\u76ee\u4f1a\u6709\u4e00\u4e2a\u8001\u5e08\u5206\u914d\u7ed9\u4e00\u4e2a\u5b66\u751f</p> <p>\u6240\u4ee5\u8fd9\u4e2a\u8868\u6ee1\u8db33\u8303\u5f0f\uff0c\u56e0\u4e3a<code>Student Id</code>\u548c<code>Subject</code>\u7ec4\u6210\u4e86\u590d\u5408\u4e3b\u952e\uff0c\u51b3\u5b9a\u4e86<code>Professor</code>\u3002  </p> <p>\u4f46\u662f\u4e0d\u6ee1\u8db33.5NF\uff0c\u56e0\u4e3a<code>Student Id</code>\u548c<code>Subject</code>\u7ec4\u6210\u4e86\u590d\u5408\u4e3b\u952e\uff0c\u6240\u4ee5<code>Subject</code>\u662f\u4e3b\u5c5e\u6027\uff0c \u800c\u5b58\u5728<code>Professor</code>\u4f9d\u8d56<code>Subject</code>\uff0c \u867d\u7136<code>Subject</code>\u662f\u4e3b\u5c5e\u6027\uff0c\u4f46<code>Professor</code>\u662f\u975e\u4e3b\u5c5e\u6027\uff0c\u6240\u4ee5\u4e0d\u6ee1\u8db3BCNF\u3002</p> <p>\u6b64\u8868\u5e94\u6539\u6210</p> Student Id Professor Id 1DT15ENG01 1DTPF01 1DT15ENG02 1DTPF02 1DT15ENG02 1DTPF03 Professor ID Professor Subject 1DTPF01 Prof. Mishra SQL 1DTPF02 Prof. Anand JAVA 1DTPF03 Prof. Kanthi C++","tags":["sql"]},{"location":"blog/%E6%95%B0%E6%8D%AE%E5%BA%93%E4%BC%98%E5%8C%96%E6%80%BB%E7%BB%93/#_2","title":"\u53cd\u8303\u5f0f","text":"<p>\u6ca1\u6709\u5197\u4f59\u6570\u636e\u7684\u8bbe\u8ba1\u672a\u5fc5\u662f\u597d\u8bbe\u8ba1\uff0c\u6709\u65f6\u4e3a\u4e86\u6548\u7387\uff0c\u5fc5\u987b\u964d\u4f4e\u8303\u5f0f\u6807\u51c6\uff0c\u9002\u5f53\u5141\u8bb8\u4fdd\u7559\u5197\u4f59\u6570\u636e\uff0c\u4ee5\u8fbe\u5230\u7528\u7a7a\u95f4\u6362\u65f6\u95f4\u7684\u76ee\u7684\u3002</p> <p>\u4f8b\u5982\u8ba2\u5355\u8868\u5b58\u5728<code>\u5546\u54c1</code>\uff0c<code>\u5355\u4ef7</code>\uff0c<code>\u6570\u91cf</code>\uff0c<code>\u603b\u4ef7</code>\uff0c \u8fd9\u91cc\u603b\u4ef7\u662f\u5197\u4f59\u7684\uff0c\u56e0\u4e3a\u53ef\u4ee5\u901a\u8fc7\u5355\u4ef7\u548c\u6570\u91cf\u6765\u6c42\u5f97\uff0c\u4f46\u603b\u4ef7\u7ecf\u5e38\u9700\u8981\uff0c\u6240\u4ee5\u5197\u4f59\u53ef\u4ee5\u63d0\u9ad8\u6548\u7387\u3002</p>","tags":["sql"]},{"location":"blog/%E6%95%B0%E6%8D%AE%E5%BA%93%E4%BC%98%E5%8C%96%E6%80%BB%E7%BB%93/#having","title":"HAVING \u548c\u67e5\u8be2\u8bed\u53e5\u4f18\u5148\u7ea7","text":"<p>SQL\u67e5\u8be2\u5b57\u53e5\u7c7b\u4f3cC\u8bed\u8a00\u7684\u8fd0\u7b97\u7b26\u4f18\u5148\u7ea7\uff0c \u867d\u7136\u6807\u51c6\u91cc\u6ca1\u6709\u5b9a\u4e49\u4f18\u5148\u7ea7\uff0c\u4f46\u5927\u81f4\u4e3a\u4ee5\u4e0b <pre><code>FROM &gt; WHERE &gt; SELECT &gt; GROUP BY &gt; HAVING &gt; ORDER BY\n</code></pre> \u8fd9\u4e2a\u987a\u5e8f\u53ef\u4ee5\u5e2e\u5fd9\u7406\u89e3\u67e5\u8be2\u8bed\u53e5\u662f\u5982\u4f55\u6267\u884c\u7684\uff0c\u6bd4\u5982\u56e0\u4e3aSELECT\u4f18\u5148\u7ea7\u4f4e\u4e8eFROM, \u6240\u6709\u53ea\u80fd\u5728FROM\u4e2d\u5b9a\u4e49alais\u5728SELECT\u4e2d\u4f7f\u7528\uff0c\u800c\u4e0d\u80fd\u5728SELECT\u4e2d\u5b9a\u4e49alias\u5e76\u5728FROM\u4e2d\u4f7f\u7528</p> <p>HAVING\u6307\u4ee4\u901a\u5e38\u548cGROUP\u4e00\u8d77\u7528\uff0c\u56e0\u4e3a\u4f18\u5148\u7ea7\u6bd4GROUP\u4f4e\uff0c\u6240\u4ee5HAVING\u53ef\u4ee5\u8ba1\u7b97\u51faGROUP\u7684\u503c\u5e76\u8fdb\u884c\u7b5b\u9009\u3002</p> <p><pre><code>SELECT Sno FROM Grade GROUP BY Sno HAVING COUNT(Cno) &gt; 3;\n</code></pre> \u8fd9\u4e2a\u8bed\u53e5\u7b5b\u9009\u51fa\u76f8\u540cSno\u8bb0\u5f55\u7684\u4e2a\u6570&gt;3\u7684\u96c6\u5408</p>","tags":["sql"]},{"location":"blog/%E6%95%B0%E6%8D%AE%E5%BA%93%E4%BC%98%E5%8C%96%E6%80%BB%E7%BB%93/#view","title":"VIEW\u548c\u6570\u636e\u5197\u4f59","text":"<p>View\u662f\u4e00\u79cd\u865a\u62df\u8868\uff0c\u53ef\u4ee5\u5c06\u591a\u8868\u7684\u6570\u636e\u5173\u8054\u5728\u4e00\u8d77\uff0c\u4e5f\u53ef\u4ee5\u505a\u4e00\u4e9b\u5197\u4f59\u6570\u636e\uff0c\u5982\u8ba1\u7b97\u5e73\u5747\u503c</p> <pre><code>CREATE VIEW Cl_avg_age AS SELECT Clno, AVG(Sage) AS avg_age FROM Student;\n</code></pre>","tags":["sql"]},{"location":"blog/%E6%95%B0%E6%8D%AE%E5%BA%93%E4%BC%98%E5%8C%96%E6%80%BB%E7%BB%93/#_3","title":"\u4e8b\u7269\uff0c\u5b58\u50a8\u8fc7\u7a0b\u548c\u89e6\u53d1\u5668","text":"<p>\u5b58\u50a8\u8fc7\u7a0b\u9700\u8981\u63d0\u524d\u521b\u5efa\u518d\u4f7f\u7528\u3002 \u56e0\u4e3a\u5b58\u50a8\u8fc7\u7a0b\u4e2d\u5b9a\u4e49\u53d8\u91cf\uff0c \u8f93\u5165\u8f93\u51fa\u660e\u786e\uff0c\u6240\u4ee5\u8ba9\u6570\u636e\u5e93\u64cd\u4f5c\u66f4\u5b89\u5168\u3002 <pre><code>CREATE PROCEDURE ap_returncount @Sno char(7) AS DECLARE @count int SELECT @count = Number FROM Class WHERE Clno = (SELECT Clno FROM Student WHERE Sno = @Sno) RETURN @count;\n</code></pre></p> <p>\u89e6\u53d1\u5668\u662f\u5f53\u89e6\u53d1\u6761\u4ef6\u65f6\u81ea\u52a8\u6267\u884c\u7684\u547d\u4ee4\uff0c\u5982\u5f53\u63d2\u5165\u548c\u66f4\u65b0\u6ee1\u8db3\u6761\u4ef6\u65f6\u81ea\u52a8\u6267\u884c\u4e8b\u7269\u56de\u64a4\u3002\u8fd9\u662f\u57fa\u4e8e\u4e8b\u7269\u673a\u5236\u7684\u3002 \u4e8b\u7269\u53ef\u4ee5\u4fdd\u8bc1\u591a\u4e2a\u64cd\u4f5c\u7684\u539f\u5b50\u6027\uff0c \u5f53\u83ab\u4e2a\u64cd\u4f5c\u4e0d\u6ee1\u8db3\u6761\u4ef6\u5219\u5168\u90e8<code>ROLLBACK</code>\uff0c\u56de\u64a4\u6240\u6709\u7684\u64cd\u4f5c\uff0c\u4f8b\u5982\u5178\u578b\u7684\u8f6c\u8d26\u573a\u666f\uff0c\u5fc5\u987b\u8981\u6263\u9664\u548c\u589e\u52a0\u90fd\u6210\u529f\u65f6\u624d\u80fd\u6210\u529f\u3002</p> <p>\u4f46\u4e8b\u7269\u5bfc\u81f4\u6548\u7387\u6bd4\u8f83\u4f4e\u3002</p> <pre><code>CREATE TRIGGER tri_ins_upd_student ON Student AFTER INSERT, UPDATE AS IF 40 &lt; (SELECT Number FROM Class WHERE Clno = (SELECT Clno FROM inserted )) ROLLBACK TRANSACTION;\n</code></pre>","tags":["sql"]},{"location":"blog/%E6%95%B0%E6%8D%AE%E5%BA%93%E4%BC%98%E5%8C%96%E6%80%BB%E7%BB%93/#_4","title":"\u53c2\u8003","text":"<p>https://www.edureka.co/blog/normalization-in-sql/</p>","tags":["sql"]},{"location":"blog/sql%E4%BC%98%E5%85%88%E7%BA%A7%E9%97%AE%E9%A2%98/","title":"SQL\u4f18\u5148\u7ea7\u95ee\u9898","text":"<p>\u4f8b\u5982\u6570\u5b66\u4e2d\u7684\u52a0\u51cf\u4e58\u9664\uff0c\u4ee5\u53ca\u7f16\u7a0b\u91cc\u7684\u8fd0\u7b97\u7b26\uff0c\u5728sql\u91cc\u4e5f\u6709\u4f18\u5148\u7ea7\uff0c\u4f9d\u6b21\u662f\uff1a</p> <pre><code>FROM clause\nWHERE clause\nSELECT clause\nGROUP BY clause\nHAVING clause\nORDER BY clause\n</code></pre> <p>\u4f18\u5148\u7ea7\u4f9d\u6b21\u4e0b\u964d\uff0c\u6240\u4ee5FROM\u7684\u4f18\u5148\u7ea7\u6bd4WHREE\u9ad8\uff0c\u8fd9\u6837\u4f1a\u6709\u4ec0\u4e48\u5f71\u54cd\uff1f </p>","tags":["sql"]},{"location":"blog/sql%E4%BC%98%E5%85%88%E7%BA%A7%E9%97%AE%E9%A2%98/#_1","title":"\u4f18\u5148\u7ea7\u7684\u95ee\u9898","text":"<p>\u56e0\u4e3aSELECT\u7684\u4f18\u5148\u7ea7\u6bd4WHERE\u4f4e\uff0c\u6240\u4ee5\u5728<code>SELECT</code>\u91cc\u9762\u5b9a\u4e49\u7684alias\u522b\u79f0\u5c31\u4e0d\u80fd\u5728<code>WHERE</code> \u91cc\u9762\u4f7f\u7528 \u4f46\u53ef\u4ee5\u5728<code>ORDER</code>\u91cc\u9762\u4f7f\u7528\uff0c\u56e0\u4e3aORDER \u540e\u6267\u884c  </p>","tags":["sql"]},{"location":"blog/sql%E4%BC%98%E5%85%88%E7%BA%A7%E9%97%AE%E9%A2%98/#_2","title":"\u5e38\u89c1\u95ee\u9898","text":"<pre><code>...\nGROUP BY a, b, c\nORDER BY NULL\n</code></pre> <pre><code>. . .\nGROUP BY a, b, c\nORDER BY a, b, c\n</code></pre> <p>\u5728\u4e0a\u9762\u7684\u4e24\u4e2a\u4f8b\u5b50\u91cc\u7684ORDER BY\u90fd\u4e0d\u4f1a\u6267\u884c\uff0c\u5206\u522b\u89e3\u91ca\uff1a</p> <ol> <li>\u7b2c\u4e00\u4e2a\u4f8b\u5b50\u91cc\u7684ORDER \u662f\u5220\u9664GROUP\u7684\u6392\u5e8f</li> <li>\u7b2c\u4e8c\u4e2a\u4f8b\u5b50\u7684ORDER\u662f\u91cd\u590d\u4e86GROUP\u5df2\u7ecf\u5e72\u4e86\u7684\u4e8b\u60c5</li> </ol>","tags":["sql"]},{"location":"blog/sql%E4%BC%98%E5%85%88%E7%BA%A7%E9%97%AE%E9%A2%98/#_3","title":"\u9a8c\u8bc1\u65b9\u6cd5","text":"<p>\u53ef\u4ee5\u627e\u4e2a\u5728\u7ebfSQL\u5de5\u5177\uff0c\u4f8b\u5982 <code>http://sqlfiddle.com/</code> </p> <p>\u5148\u6267\u884c\u521b\u5efa\u6570\u636e\u5e93\u547d\u4ee4  <pre><code>DROP TABLE if exists new_table;\n\nCREATE TABLE `new_table` (\n`id` int(11) NOT NULL AUTO_INCREMENT,\n`testdecimal` decimal(6,2) DEFAULT NULL,\nPRIMARY KEY (`id`));\n\nINSERT INTO `new_table` (`testdecimal`) VALUES ('1234.45');\nINSERT INTO `new_table` (`testdecimal`) VALUES ('1234.45');\n\nset @mysqlorder := '';\n\nselect @mysqlorder := CONCAT(@mysqlorder,\" SELECT \") from new_table,(select @mysqlorder := CONCAT(@mysqlorder,\" FROM \")) tt\nJOIN (select @mysqlorder := CONCAT(@mysqlorder,\" JOIN1 \")) t on ((select @mysqlorder := CONCAT(@mysqlorder,\" ON1 \")) or rand() &lt; 1)\nJOIN (select @mysqlorder := CONCAT(@mysqlorder,\" JOIN2 \")) t2 on ((select @mysqlorder := CONCAT(@mysqlorder,\" ON2 \")) or rand() &lt; 1)\nwhere ((select @mysqlorder := CONCAT(@mysqlorder,\" WHERE \")) or IF(new_table.testdecimal = 1234.45,true,false))\ngroup by (select @mysqlorder := CONCAT(@mysqlorder,\" GROUPBY \")),id\nhaving (select @mysqlorder := CONCAT(@mysqlorder,\" HAVING \"))\norder by (select @mysqlorder := CONCAT(@mysqlorder,\" ORDERBY \"));\n</code></pre></p> <p>\u5728\u6267\u884c <code>select @mysqlorder;</code> \u7ed3\u679c\u5982\u4e0b: <pre><code>@mysqlor`der\n(null)\n</code></pre></p> <p>\u53ef\u89c1\u5176\u4f18\u5148\u7ea7\u987a\u5e8f\u4e3a <pre><code>FROM JOIN1 JOIN2 WHERE ON2 ON1 ORDERBY GROUPBY SELECT WHERE ON2 ON1 ORDERBY GROUPBY SELECT HAVING HAVING\n</code></pre></p>","tags":["sql"]},{"location":"blog/static-compile-warning-if-namespace-resolving-function-used/","title":"static compile warning if namespace resolving function used","text":"<p>\u5f53\u7a0b\u5e8f\u91cc\u9762\u6709\u4f7f\u7528\u5230\u89e3\u6790\u51fd\u6570\u7684\u65f6\u5019\uff0c \u9759\u6001\u7f16\u8bd1\u7a0b\u5e8f\u4f1a\u62a5warning</p>","tags":["c","cpp","compile"]},{"location":"blog/static-compile-warning-if-namespace-resolving-function-used/#_1","title":"\u73b0\u8c61","text":"<pre><code>../../lib/libhacore.a(File.cpp.o): In function `_ZN2ha4core9gid2groupB5cxx11Ej':\n/tmp/src/ha/core/File.cpp:213: warning: Using 'getgrgid_r' in statically linked applications requires at runtime the shared libraries from the glibc version used for linking\n../../lib/libhacore.a(File.cpp.o): In function `ha::core::group2gid(std::__cxx11::basic_string&lt;char, std::char_traits&lt;char&gt;, std::allocator&lt;char&gt; &gt; const&amp;, unsigned int&amp;)':\n/tmp/src/ha/core/File.cpp:291: warning: Using 'getgrnam_r' in statically linked applications requires at runtime the shared libraries from the glibc version used for linking\n../../lib/libhacore.a(File.cpp.o): In function `ha::core::username2uid(std::__cxx11::basic_string&lt;char, std::char_traits&lt;char&gt;, std::allocator&lt;char&gt; &gt; const&amp;, unsigned int&amp;)':\n/tmp/src/ha/core/File.cpp:271: warning: Using 'getpwnam_r' in statically linked applications requires at runtime the shared libraries from the glibc version used for linking\n../../lib/libhacore.a(File.cpp.o): In function `_ZN2ha4core12uid2usernameB5cxx11Ej':\n/tmp/src/ha/core/File.cpp:194: warning: Using 'getpwuid_r' in statically linked applications requires at runtime the shared libraries from the glibc version used for linking\nCMakeFiles/hasync-exec.dir/main.cpp.o: In function `boost::asio::detail::socket_ops::getaddrinfo(char const*, char const*, addrinfo const&amp;, addrinfo**, boost::system::error_code&amp;)':\n/usr/local/include/boost/asio/detail/impl/socket_ops.ipp:3348: warning: Using 'getaddrinfo' in statically linked applications requires at runtime the shared libraries from the glibc version used for linking\n/usr/local/lib/gcc/x86_64-pc-linux-gnu/8.2.0/../../../../lib64/libcrypto.a(b_sock.o): In function `BIO_gethostbyname':\nb_sock.c:(.text+0x51): warning: Using 'gethostbyname' in statically linked applications requires at runtime the shared libraries from the glibc version used for linking\n/usr/local/lib/gcc/x86_64-pc-linux-gnu/8.2.0/../../../../lib64/libcares.a(libcares_la-ares_getaddrinfo.o): In function `ares_getaddrinfo':\nares_getaddrinfo.c:(.text+0x73f): warning: Using 'getservbyname' in statically linked applications requires at runtime the shared libraries from the glibc version used for linking\n/usr/local/lib/gcc/x86_64-pc-linux-gnu/8.2.0/../../../../lib64/libcares.a(libcares_la-ares_getnameinfo.o): In function `lookup_service.part.0.constprop.2':\nares_getnameinfo.c:(.text+0x32d): warning: Using 'getservbyport_r' in statically linked applications requires at runtime the shared libraries from the glibc version used for linking\n</code></pre>","tags":["c","cpp","compile"]},{"location":"blog/static-compile-warning-if-namespace-resolving-function-used/#_2","title":"\u7ed3\u8bba","text":"<p>\u5373\u4f7f\u9759\u6001\u94fe\u63a5glibc, glibc\u5185\u90e8\u5728\u8fd0\u884c\u65f6\u4f9d\u65e7\u8981\u8c03\u7528<code>\u52a8\u6001\u5e93</code>\uff0c\u8fd9\u4e9b\u5e93\u51fd\u6570\u591a\u4e0e\u57df\u540d\u89e3\u6790\u6709\u5173, \u6240\u4ee5\u8981\u6c42\u8fd0\u884c\u65f6\u7684\u5e93\u7248\u672c\u8981\u4e0e\u7f16\u8bd1\u65f6\u76f8\u540c\uff0c \u5f53\u7136\u57fa\u4e8e\u5bb9\u5668\u5316\u90e8\u7f72\u5c31\u4e0d\u7528\u62c5\u5fc3\u4e86  </p>","tags":["c","cpp","compile"]},{"location":"blog/c-%E5%AD%98%E5%82%A8%E5%91%A8%E6%9C%9F%E9%93%BE%E6%8E%A5%E5%92%8C%E4%BD%9C%E7%94%A8%E5%9F%9F/","title":"c++ \u5b58\u50a8\u5468\u671f\u3001\u94fe\u63a5\u548c\u4f5c\u7528\u57df","text":"","tags":["c,","cpp"]},{"location":"blog/c-%E5%AD%98%E5%82%A8%E5%91%A8%E6%9C%9F%E9%93%BE%E6%8E%A5%E5%92%8C%E4%BD%9C%E7%94%A8%E5%9F%9F/#c_1","title":"c++\u4e2d\u53d8\u91cf\u548c\u51fd\u6570\u7684\u4e09\u4e2a\u91cd\u8981\u5c5e\u6027","text":"<p>\u5b58\u50a8\u5468\u671f\u7c7b\u578b\uff1a \u6709\u5173\u53d8\u91cf\u7684\u521b\u5efa\u548c\u9500\u6bc1 \u94fe\u63a5\u7c7b\u578b\uff1a \u6709\u5173\u53d8\u91cf\u51fd\u6570\u7684\u5185\u5b58\u4f4d\u7f6e \u4f5c\u7528\u57df: \u6709\u5173\u53d8\u91cf\u51fd\u6570\u7684\u53ef\u89c1\u8303\u56f4</p> <p>\u672c\u6587\u8ba8\u8bba\u7684\u6807\u8bc6\u7b26\uff0c\u5305\u62ec\u53d8\u91cf\u548c\u51fd\u6570</p>","tags":["c,","cpp"]},{"location":"blog/c-%E5%AD%98%E5%82%A8%E5%91%A8%E6%9C%9F%E9%93%BE%E6%8E%A5%E5%92%8C%E4%BD%9C%E7%94%A8%E5%9F%9F/#_1","title":"\u5b58\u50a8\u8bf4\u660e\u7b26","text":"<p><code>\u5b58\u50a8\u8bf4\u660e\u7b26</code>\u63a7\u5236\u53d8\u91cf\u4f55\u65f6\u5206\u914d\u548c\u91ca\u653e\uff0c\u6709\u4ee5\u4e0b\u51e0\u79cd</p> <ul> <li>automatic</li> <li>thread_local</li> <li>static </li> <li>register</li> <li>mutable</li> <li>extern</li> </ul> <p>\u8bf4\u660e - automatic: \u6700\u5e38\u89c1\u7684\u5c40\u90e8\u53d8\u91cf\uff0c\u4e14\u6ca1\u6709\u58f0\u660e\u4e3astatic\u6216\u8005thread_local\uff0c\u4f4d\u4e8e\u6808\u4e0a, \u968f\u7740\u4ee3\u7801\u5757\u7684\u6267\u884c\u548c\u7ed3\u675f\u800c\u81ea\u52a8\u5206\u914d\u548c\u9500\u6bc1 - static: \u9759\u6001\u53d8\u91cf, \u5728\u7a0b\u5e8f\u542f\u52a8\u548c\u7ed3\u675f\u65f6\u521b\u5efa\u548c\u9500\u6bc1\uff0c\u4f46\u521d\u59cb\u5316\u662f\u5728\u7b2c\u4e00\u6b21\u6267\u884c\u521d\u59cb\u5316\u4ee3\u7801\u65f6\u6267\u884c - thread: \u5728\u7ebf\u7a0b\u5f00\u59cb\u548c\u7ed3\u675f\u65f6\u5206\u914d\u548c\u9500\u6bc1 - dynamic: \u6700\u5e38\u89c1\u7684\u5806\u4e0a\u7684\u53d8\u91cf, \u9700\u8981\u6267\u884cnew\u548cdelete, </p> <p>auto \u5728c++11\u4e2d\u4e0d\u662f\u58f0\u660e\u5b58\u50a8\u5468\u671f\uff0c\u800c\u662f\u7c7b\u578b\u63a8\u5bfc\u7b26, \u4f46\u8fd9\u79cd\u5b58\u50a8\u5468\u671f\u7c7b\u578b\u7684\u4f9d\u7136\u5b58\u5728\uff08\u5c40\u90e8\u53d8\u91cf\uff09  </p>","tags":["c,","cpp"]},{"location":"blog/c-%E5%AD%98%E5%82%A8%E5%91%A8%E6%9C%9F%E9%93%BE%E6%8E%A5%E5%92%8C%E4%BD%9C%E7%94%A8%E5%9F%9F/#_2","title":"\u521d\u59cb\u5316\u7684\u65f6\u673a","text":"<ul> <li>automatic: \u5fc5\u987b\u624b\u52a8\u521d\u59cb\u5316\uff0c\u6362\u53e5\u8bdd\u8bf4\u5c40\u90e8\u53d8\u91cf\u5fc5\u987b\u521d\u59cb\u5316\uff0c\u5426\u5219\u503c\u4e3a\u4e0d\u786e\u5b9a</li> <li>static: \u5728\u6267\u884c\u65f6\u521d\u59cb\u5316\uff0c\u4e14\u521d\u59cb\u5316\u4e00\u6b21\uff0c\u7279\u6b8a\u60c5\u51b5\u4e0b\u5728\u6267\u884c\u524d\u521d\u59cb\u5316</li> <li>thread: \u56e0\u4e3athread_local\u53d8\u91cf\u81ea\u5e26static\u6027\u8d28\uff0c\u6240\u4ee5\u8ba4\u4e3a\u5176\u540c\u4e8estatic</li> <li>dynamic: \u5728new\u65f6\u521d\u59cb\u5316</li> </ul>","tags":["c,","cpp"]},{"location":"blog/c-%E5%AD%98%E5%82%A8%E5%91%A8%E6%9C%9F%E9%93%BE%E6%8E%A5%E5%92%8C%E4%BD%9C%E7%94%A8%E5%9F%9F/#linkage","title":"Linkage","text":"<p>\u6807\u8bc6\u7b26\uff08\u53d8\u91cf&amp;\u51fd\u6570\uff09\u7528\u4e00\u5757\u5185\u5b58\u91cc\u7684\u503c\u6216\u8005\u51fd\u6570\u4f53\u6765\u8868\u793a\u7684\uff0c \u800clinkage\u51b3\u5b9a\u5176\u4ed6\u76f8\u540c\u7684\u6807\u8bc6\u7b26\u662f\u5426\u6307\u5411\u540c\u4e00\u5757\u5185\u5b58\u3002c/c++\u67093\u79cdlinkage, no-linkage, internal linkage\u548cexternal linkage</p> <ul> <li>no linkage \u5c40\u90e8\u53d8\u91cf\u6ca1\u6709linkage, \u6240\u4ee5\u4e24\u4e2aa\u662f\u72ec\u7acb\u7684\uff0c\u540e\u9762\u7684a\u4f1a\u8986\u76d6\u524d\u9762\u7684a\uff0c\u4e0d\u76f8\u5e72\u3002\u6b64\u65f6linkage\u4e0e\u53ef\u89c1\u57df(scope)\u7c7b\u4f3c</li> <li>internal linkage \u8868\u793a\u53ea\u80fd\u5728\u6587\u4ef6\u5185\u90e8\u8bbf\u95ee(file scope)\uff0c\u6362\u53e5\u8bdd\u5c31\u662f\u4e0d\u4f1a\u66b4\u9732\u7ed9\u94fe\u63a5\u5668\uff0c \u7528\u4fee\u9970\u7b26<code>static</code>\u58f0\u660einternal linkage\uff0c\u6240\u4ee5\u5141\u8bb8\u5728\u4e0d\u540c\u6587\u4ef6\u58f0\u660e\u4e24\u4e2a\u540d\u79f0&amp;\u7c7b\u578b\u76f8\u540c\u7684internal linkage \u6807\u8bc6\u7b26\uff0c\u4ed6\u4eec\u6307\u5411\u4e0d\u540c\u7684\u5185\u5b58\u5355\u5143\u3002 </li> <li>external linkage \u8868\u793a\u53ef\u4ee5\u5728\u7a0b\u5e8f\u6240\u6709\u5730\u65b9\u8bbf\u95ee\uff0c\u5305\u62ec\u5916\u90e8\u6587\u4ef6(global scope)\uff0c\u6240\u4ee5\u662f\u771f\u201c\u5168\u5c40\u201d\uff08scope&amp;linkage\uff09\uff0c \u6240\u6709\u6807\u8bc6\u7b26\u6307\u5411\u72ec\u4e00\u4efd\u5185\u5b58\u3002</li> </ul>","tags":["c,","cpp"]},{"location":"blog/c-%E5%AD%98%E5%82%A8%E5%91%A8%E6%9C%9F%E9%93%BE%E6%8E%A5%E5%92%8C%E4%BD%9C%E7%94%A8%E5%9F%9F/#_3","title":"\u4fee\u9970\u7b26","text":"<ul> <li>\u5168\u5c40const\u53d8\u91cf\u548c\u5168\u5c40constexpr\u53d8\u91cf\u9ed8\u8ba4\u5177\u5907internal linkage, \u518d\u52a0\u4e0a<code>static</code>\u6ca1\u6709\u5f71\u54cd</li> <li>\u5168\u5c40\u975econst\u53d8\u91cf\u9ed8\u8ba4\u662fexternal linkage\uff0c \u6545\u518d\u52a0\u4e0aextern\u6ca1\u6709\u5f71\u54cd\u3002\u5728\u5176\u4ed6\u6587\u4ef6\u4f7f\u7528<code>extern</code>\u58f0\u660e\u8fd9\u4e2a\u53d8\u91cf\uff0c\u5c31\u80fd\u4f7f\u7528\u6307\u5411\u540c\u4e00\u5185\u5b58\u7684\u53d8\u91cf</li> <li>\u51fd\u6570\u9ed8\u8ba4external linkage\uff0c\u6545\u518d\u52a0\u4e0aextern\u6ca1\u6709\u5f71\u54cd\u3002 \u5728\u5176\u4ed6\u6587\u4ef6\u4f7f\u7528<code>extern</code>\u58f0\u660e\u8fd9\u4e2a\u51fd\u6570\uff08\u53ef\u7701\uff09\uff0c\u5c31\u80fd\u4f7f\u7528\u6307\u5411\u540c\u4e00\u5185\u5b58\u7684\u51fd\u6570</li> <li>\u4f7f\u7528extern\u4fee\u9970\u5168\u5c40const\u53d8\u91cf\u548cconstexpr\u53d8\u91cf\u53ef\u4ee5\u4f7f\u8d77\u5177\u5907external linkage</li> </ul> <p>\u53ef\u89c1<code>static</code>\u548c<code>extern</code>\u5373\u8868\u793a\u5b58\u50a8\u5468\u671f\uff0c\u53c8\u8868\u793alinkage\uff0c static\u76f8\u5bf9\u7b80\u5355\uff0cextern\u5219\u6bd4\u8f83\u590d\u6742\uff0c\u5982\u4ee5\u4e0b\u60c5\u51b5 <pre><code>int g_x = 1; // \u5b9a\u4e49\u6709\u521d\u59cb\u5316\u7684\u5168\u5c40\u53d8\u91cf\uff08\u53ef\u52a0\u53ef\u4e0d\u52a0extern\uff09\nint g_x; // \u5b9a\u4e49\u6ca1\u6709\u521d\u59cb\u5316\u7684\u5168\u5c40\u53d8\u91cf\uff08\u4e0d\u53ef\u52a0extern\uff09\uff0c\u53ef\u9009\u521d\u59cb\u5316\nextern int g_x; // \u524d\u7f6e\u58f0\u660e\u4e00\u4e2a\u5168\u5c40\u53d8\u91cf\uff0c\u4e0d\u53ef\u521d\u59cb\u5316\n\nextern const int g_y { 1 }; // \u5b9a\u4e49\u5168\u5c40\u5e38\u91cf\uff0cconst\u5fc5\u987b\u521d\u59cb\u5316\nextern const int g_y; // \u524d\u7f6e\u58f0\u660e\u5168\u5c40\u5e38\u91cf\uff0c\u4e0d\u53ef\u521d\u59cb\u5316\n</code></pre></p> <p>\u6240\u4ee5\u82e5\u662f\u5b9a\u4e49\u672a\u521d\u59cb\u5316\u7684\u5168\u5c40\u53d8\u91cf\uff0c\u4e0d\u80fd\u52a0extern\uff0c\u4e0d\u7136\u5c31\u6210\u4e86\u524d\u7f6e\u58f0\u660e\u4e86\u3002</p>","tags":["c,","cpp"]},{"location":"blog/c-%E5%AD%98%E5%82%A8%E5%91%A8%E6%9C%9F%E9%93%BE%E6%8E%A5%E5%92%8C%E4%BD%9C%E7%94%A8%E5%9F%9F/#constexpr","title":"constexpr \u7279\u6b8a\u60c5\u51b5","text":"<p>\u867d\u7136\u901a\u8fc7\u7ed9constexpr\u6dfb\u52a0<code>extern</code>\u4fee\u9970\u7b26\u6765\u8ba9\u5176\u5177\u5907external\u5c5e\u6027\uff0c\u4f46\u4e0d\u80fd\u5728\u5176\u4ed6\u6587\u4ef6\u524d\u7f6e\u58f0\u660e\u3002\u56e0\u4e3aconstexpr\u662f\u5728\u7f16\u8bd1\u671f\u66ff\u6362\u7684\uff0c\u7f16\u8bd1\u5668\uff08compile)\u7684\u53ef\u89c1\u57df\u9650\u5b9a\u5728\u6587\u4ef6\u5185\uff0c\u6240\u4ee5\u7f16\u8bd1\u671f\u65e0\u6cd5\u77e5\u9053constexpr\u7684\u503c\uff0c\u6240\u4ee5\u5728\u7f16\u8bd1\u671f\u65e0\u6cd5\u83b7\u53d6\u5230\u5176\u5185\u5b58\u5355\u5143\u7684\u503c\uff0c \u4e5f\u5c31\u65e0\u6cd5\u5728\u5176\u4ed6\u6587\u4ef6\u8fdb\u884c\u58f0\u660e\uff0c\u53ea\u80fd\u5b9a\u4e49\u3002</p>","tags":["c,","cpp"]},{"location":"blog/c-%E5%AD%98%E5%82%A8%E5%91%A8%E6%9C%9F%E9%93%BE%E6%8E%A5%E5%92%8C%E4%BD%9C%E7%94%A8%E5%9F%9F/#file-scopeglobal-scope","title":"file scope\u548cglobal scope","text":"<p>\u5c40\u90e8\u53d8\u91cf\u7684scope\u3001no-linkage\u4ee5\u53caduration\u76f8\u540c\uff0c\u4ece<code>{</code>\u5f00\u59cb\u5230<code>}</code>\u7ed3\u675f\u3002 \u7406\u8bba\u4e0aglobal scope\u6db5\u76d6\u4e86file scope\u3002\u800clinkage\u6765\u89c4\u5b9a\u5176\u662f\u5426\u80fd\u5728\u5176\u4ed6\u6587\u4ef6\u91cc\u4f7f\u7528\u3002</p>","tags":["c,","cpp"]},{"location":"blog/c-%E5%AD%98%E5%82%A8%E5%91%A8%E6%9C%9F%E9%93%BE%E6%8E%A5%E5%92%8C%E4%BD%9C%E7%94%A8%E5%9F%9F/#local-class","title":"local class","text":"<p>local class \u4e0d\u5141\u8bb8\u6709static data member</p>","tags":["c,","cpp"]},{"location":"blog/c-%E5%AD%98%E5%82%A8%E5%91%A8%E6%9C%9F%E9%93%BE%E6%8E%A5%E5%92%8C%E4%BD%9C%E7%94%A8%E5%9F%9F/#_4","title":"\u53c2\u8003","text":"<p>https://en.cppreference.com/w/cpp/language/storage_duration</p>","tags":["c,","cpp"]},{"location":"blog/streaming-h264-with-rtp/","title":"streaming h264 with rtp","text":"<p>\u8fd9\u91cc\u8bb0\u5f55\u4e86\u4f7f\u7528ffmpeg\u6765\u53d1\u9001h264\u7684rtp\u6d41\uff0c\u4e3b\u8981\u95ee\u9898\u662f\u5904\u7406pps\u548csps\u7684\u53d1\u9001\uff0c\u770b\u4e86\u975e\u5e38\u591a\u7684\u6587\u6863\u548c\u4f8b\u5b50\u5305\u62ecgptchat\uff0c\u76f4\u5230\u7528gdb\u8ddfffmpeg\u624d\u627e\u5230\u89e3\u51b3\u529e\u6cd5\u3002</p>","tags":["ffmpeg","rtp","\u97f3\u89c6\u9891"]},{"location":"blog/streaming-h264-with-rtp/#_1","title":"\u80cc\u666f","text":"<p>\u516c\u53f8\u7684\u6709\u4e2a\u53d1\u9001\u89c6\u9891\u5f69\u94c3\u7684\u4e1a\u52a1\uff0c\u9700\u8981\u5411\u7ec8\u7aef\u53d1\u9001h264\u3002\u5f00\u59cb\u60f3\u6cd5\u662f\u521b\u5efaffmpeg\u8fdb\u7a0b\u6765\u53d1\u9001\uff0c\u4e0d\u8fc7\u53d1\u73b0\u8fdb\u7a0b\u592a\u597d\u8d44\u6e90\u5e76\u53d1\u4e0a\u4e0d\u53bb\u3002\u540e\u6765\u7528\u5199\u4ee3\u7801\u6765\u591a\u7ebf\u7a0b\u53d1\u9001\u3002</p>","tags":["ffmpeg","rtp","\u97f3\u89c6\u9891"]},{"location":"blog/streaming-h264-with-rtp/#sdp","title":"sdp\u534f\u5546\u8f6c\u7801\u95ee\u9898","text":"<p>sdp\u534f\u5546\u7ed3\u679c\u4f1a\u6709\u4e0d\u540c\u7684\u5206\u8fa8\u7387\u3001\u7b49\u7ea7\u3001\u8d28\u91cf\u4e4b\u7c7b\u7684\u53c2\u6570(pps/sps)\uff0c\u4e3a\u4e86\u907f\u514d\u8f6c\u7801\uff0c\u63d0\u524d\u5236\u4f5c\u4e86\u4e0d\u540c\u53c2\u6570\u7684\u89c6\u9891\u3002\u4e0d\u8fc7\u540e\u6765\u53d1\u73b0\u53ea\u8981\u6b63\u786e\u53d1\u9001pps/sps\uff0c\u7ec8\u7aef\u90fd\u80fd\u6b63\u786e\u89e3\u7801\uff0c\u4e0d\u662f\u5fc5\u987b\u6309sdp\u91cc\u7684\u89c6\u9891\u53c2\u6570\u3002</p>","tags":["ffmpeg","rtp","\u97f3\u89c6\u9891"]},{"location":"blog/streaming-h264-with-rtp/#ffmpeg","title":"\u7528ffmpeg\u53d1\u9001","text":"<p>\u5f00\u59cb\u76f4\u63a5\u4f7f\u7528\u547d\u4ee4ffmpeg\u53d1\u9001\uff0c\u53d1\u73b0\u7ec8\u7aef\u4e0d\u80fd\u89e3\u7801\u3002\u5bf9\u6bd4\u6b63\u5e38\u7684rtp\u6d41\u53d1\u73b0\u7f3a\u5c11\u4e86pps/sps\u3002 <pre><code>ffmpeg -i video.mp4 -an -c:v copy -f rtp rtp://ip:port\n</code></pre> \u4e00\u756a\u641c\u7d22\u53d1\u73b0ffmpeg\u5c06pps/sps\u7b49\u53c2\u6570\u5199\u5230sdp\u4e2d(out-of-band)\uff0c\u8fd8\u7528base64\u7f16\u7801\u4e86\u3002 <pre><code>a=fmtp:96 packetization-mode=1; sprop-parameter-sets=Z2QAKKzRAHgCJ+XAWoCAgKAAAAMAIAAAB4HjBiJA,aOvvLA==; profile-level-id=640028\n</code></pre></p> <p>ffplay\u7b49\u64ad\u653e\u8f6f\u4ef6\u4f1a\u89e3\u6790sdp\uff0c\u8f7d\u5165pps/sps\uff0c\u6240\u4ee5\u6b63\u786e\u89e3\u7801\uff0c\u4f46\u662fsip\u573a\u666f\u4e0b\u53ea\u80fd\u901a\u8fc7rtp\u6765\u53d1\u9001sps/pps(in-band)\u3002 \u540e\u6765\u53d1\u73b0\u7528ffmpeg\u7684'bit stream filter'\u80fd\u89e3\u51b3\u95ee\u9898</p> <pre><code>ffmpeg -i video.mp4 -an -c:v copy -bsf h264_mp4toannexb -f rtp rtp://ip:port\n</code></pre> <p>\u5373\u4f7f\u4e0d\u8f6c\u7801\uff0c\u4f7f\u7528ffmpeg\u8fdb\u7a0b\u53d1\u9001\u89c6\u9891\uff0c\u5728\u4e24\u6838\u7684\u7cfb\u7edf\u4e2d\u5927\u6982\u53ea\u80fd\u53d1\u9001\u5341\u51e0\u8def\u3002</p>","tags":["ffmpeg","rtp","\u97f3\u89c6\u9891"]},{"location":"blog/streaming-h264-with-rtp/#_2","title":"\u4ee3\u7801\u5b9e\u73b0\u53d1\u9001","text":"<p>\u57fa\u4e8effmpeg\u7684\u793a\u4f8b\u4ee3\u7801'doc/example/remux.c', \u5c06\u539f\u6765\u5199\u6587\u4ef6\u6539\u4e3artp\u5373\u53ef\u3002\u56e0\u4e3a\u8fd8\u6ca1\u6709\u7528\u5230'h264_mp4toannexb'\uff0c\u8fd8\u4e0d\u4f1a\u53d1\u9001pps\u548csps\u3002</p>","tags":["ffmpeg","rtp","\u97f3\u89c6\u9891"]},{"location":"blog/streaming-h264-with-rtp/#bsf","title":"\u5173\u952e\u95ee\u9898\u5c31\u662f\u5982\u4f55\u4f7f\u7528\u8fd9\u4e2absf","text":"<p>\u7f51\u4e0a\u770b\u5230\u7684\u4f8b\u5b50\u5305\u62ec\u7528gptchat\u751f\u6210\u7684\u4f8b\u5b50\uff0c\u90fd\u662f\u7c7b\u4f3c\u4e0b\u9762\u7684\u6b65\u9aa4\u3002</p> <pre><code># \u641c\u7d22bsf\nav_bsf_get_by_name(\"h264_mp4toannexb\")\n# \u521b\u5efabsf\u7684\u4e0a\u4e0b\u6587\nav_bsf_alloc(bsf, &amp;bsf_ctx)\n# \u4ece\u8f93\u5165\u7684format\u4e0a\u4e0b\u6587\u4e2d\u590d\u5236\u7f16\u7801\u53c2\u6570\navcodec_parameters_copy(bsf_ctx-&gt;par_in, input_ctx-&gt;streams[video_stream_idx]-&gt;codecpar)\n# \u521d\u59cb\u5316bsf\u4e0a\u4e0b\u6587\nav_bsf_init(bsf_ctx)\n# \u8bfb\u5165packet\nav_read_frame(input_ctx, &amp;pkt)\n# \u9001\u5230bsf\u4e2d\u5904\u7406\nav_bsf_send_packet(bsf_ctx, pkt)\n# \u53d6\u51fa\u5904\u7406\u540e\u7684pkt\nav_bsf_receive_packet(bsf_ctx, pkt)\n# \u53d1\u9001rtp\n</code></pre> <p>\u6293\u5305\u53d1\u73b0\u8fd8\u662f\u6ca1\u6709\u53d1\u9001PPS/SPS, \u800c\u4e14\u7b2c\u4e00\u4e2aNALU\u662fSEI\uff0c\u5e76\u4e14\u662f\u574f\u7684(Malformed)\u3002\u8c03\u8bd5\u53d1\u73b0bsf\u786e\u5b9e\u6210\u529f\u5c06SEI\u4eceAVCC\u8f6c\u6362\u6210\u4e86AnnexB\u5f62\u5f0f\uff0c\u4e5f\u5728SEI\u540e\u8ffd\u52a0\u4e86PPS\u548cSPS\u3002 <pre><code>(gdb) x/150bx pkt-&gt;data\n0x5555556da310: 0x00    0x00    0x00    0x01    0x06    0x05    0x2e    0xdc\n0x5555556da318: 0x45    0xe9    0xbd    0xe6    0xd9    0x48    0xb7    0x96\n0x5555556da320: 0x2c    0xd8    0x20    0xd9    0x23    0xee    0xef    0x78\n0x5555556da328: 0x32    0x36    0x34    0x20    0x2d    0x20    0x63    0x6f\n0x5555556da330: 0x72    0x65    0x20    0x31    0x35    0x35    0x20    0x72\n0x5555556da338: 0x32    0x39    0x30    0x31    0x20    0x37    0x64    0x30\n0x5555556da340: 0x66    0x66    0x32    0x32    0x00    0x80    0x00    0x00\n0x5555556da348: 0x00    0x01    0x67    0x64    0x00    0x28    0xac    0xd1\n0x5555556da350: 0x00    0x78    0x02    0x27    0xe5    0xc0    0x5a    0x80\n0x5555556da358: 0x80    0x80    0xa0    0x00    0x00    0x03    0x00    0x20\n0x5555556da360: 0x00    0x00    0x07    0x81    0xe3    0x06    0x22    0x40\n0x5555556da368: 0x00    0x00    0x00    0x01    0x68    0xeb    0xef    0x2c\n0x5555556da370: 0x00    0x00    0x01    0x65    0x88    0x84    0x02    0xff\n0x5555556da378: 0x91    0x3c    0x4a    0x51    0x5b    0xfd    0x02    0x3f\n0x5555556da380: 0xc1    0x67    0x8d    0xc0    0x94    0x98    0xee    0x7d\n0x5555556da388: 0x43    0x23    0xc0    0x4f    0xf7    0x56    0x37    0xfc\n0x5555556da390: 0xf1    0xf3    0xd3    0x83    0x03    0xa9    0x6d    0xd2\n0x5555556da398: 0x07    0xcf    0x19    0xa2    0x1e    0x29    0x64    0xfe\n0x5555556da3a0: 0x1f    0x8e    0xd6    0x71    0x5f    0x33\n</code></pre> <code>0x00 0x00 0x00 0x01</code>\u662fannexb\u683c\u5f0f\u7684\u8d77\u59cb\u7801\uff0c\u7b2c\u4e00\u4e2aNALU\u662f0x06(SEI)\uff0c\u7b2c\u4e8c\u4e2aNALU\u662f0x07(SPS)\uff0c\u7b2c\u4e09\u4e2a\u662f0x08(PPS)\u3002\u95ee\u9898\u51fa\u5728rtp\u6253\u5305\u7684<code>ff_rtp_send_h264_hevc</code>\u3002\u8fd9\u91cc\u5224\u65ad\u51fa<code>s-&gt;nal_length_size</code>\u4e0d\u662f0\u800c\u662f4, \u6240\u4ee5\u8fd8\u662f\u4ee5AVCC\u683c\u5f0f\u7684\u9996\u56db\u4e2a\u5b57\u8282\u4ee3\u8868\u957f\u5ea6\u6765\u89e3\u6790pkt\uff0c\u800c\u8fd9\u662fpkt\u662fannexB\u683c\u5f0f\u4e86\uff0c\u524d\u56db\u4e2a\u5b57\u8282\u5c31\u662f0x00, 0x00, 0x00, 0x01\u3002\u6240\u4ee5\u6253\u5305\u9519\u8bef\u3002 \u95ee\u9898\u600e\u4e48\u4f7frtp\u6309annexB\u6765\u6253\u5305\uff0c\u4e3a\u4ec0\u4e48<code>nal_length_size</code>\u662f4\u4e0d\u662f0\u3002</p> <pre><code>void ff_rtp_send_h264_hevc(AVFormatContext *s1, const uint8_t *buf1, int size)\n{\n    const uint8_t *r, *end = buf1 + size;\n    RTPMuxContext *s = s1-&gt;priv_data;\n\n    s-&gt;timestamp = s-&gt;cur_timestamp;\n    s-&gt;buf_ptr   = s-&gt;buf;\n    if (s-&gt;nal_length_size)\n        r = ff_avc_mp4_find_startcode(buf1, end, s-&gt;nal_length_size) ? buf1 : end;\n    else\n        r = ff_avc_find_startcode(buf1, end);\n</code></pre> <p>\u627e\u5230\u521d\u59cb\u5316rtp\u7684\u521d\u59cb\u5316\u51fd\u6570<code>rtp_write_header</code>\uff0c\u53d1\u73b0\u8bbe\u7f6e<code>nal_length_size</code>\u7684\u5730\u65b9\uff0c\u539f\u6765\u5224\u65adextradata\uff0c\u5982\u679c\u7b2c\u4e00\u4e2a\u5b57\u8282\u662f1,\u5219\u6309avcc\u6253\u5305\u3002 <pre><code>    case AV_CODEC_ID_H264:\n        /* check for H.264 MP4 syntax */\n        if (st-&gt;codecpar-&gt;extradata_size &gt; 4 &amp;&amp; st-&gt;codecpar-&gt;extradata[0] == 1) {\n            s-&gt;nal_length_size = (st-&gt;codecpar-&gt;extradata[4] &amp; 0x03) + 1;\n        }\n        break;\n</code></pre> \u800c\u5f53\u524d\u7684extradata\u662f\u7c7b\u4f3cavcc\u7684\uff08\u53c8\u4e0d\u540c\u4e8eAVCC, \u56e0\u4e3a\u591a\u4e00\u4e2aheader)\uff0c\u7b2c\u4e00\u4e2a\u5b57\u8282\u7b49\u4e8e1\uff0c\u800c\u901a\u8fc7\u8c03\u8bd5ffmpeg_g\u5230\u8fd9\u91cc\u65f6\uff0cextradata\u662fannexB\u683c\u5f0f\uff0c\u5373\u99964\u4e2a\u5b57\u8282\u662f0x00,0x00,0x00,0x01\u3002\u5173\u4e8eextradata\u683c\u5f0f\u7684\u95ee\u9898\uff0c\u4ece\u5f00\u59cb\u6211\u5c31\u53d1\u73b0\u521a\u521d\u59cb\u5316\u65f6\uff0cextradata\u5c31\u662f0x01\u5f00\u5934\uff0c\u90a3\u4e48\u95ee\u9898ffmpeg_g\u7684extradata\u4ec0\u4e48\u65f6\u5019\u53d8\u7684\uff0c\u518d\u6b21\u8c03\u8bd5\u53d1\u73b0\uff0cbsf\u521d\u59cb\u5316\u8ddf\u4e0a\u9762\u7684\u4e0d\u540c\u3002\u5728ffmpeg_g\u4e2dbsf\u521d\u59cb\u5316\u5728fftools/ffmpeg_mux.c\u6587\u4ef6\u4e2d: <pre><code># fftools/ffmpeg_mux.c\nstatic int bsf_init(MuxStream *ms)\n{\n    OutputStream *ost = &amp;ms-&gt;ost;\n    AVBSFContext *ctx = ms-&gt;bsf_ctx;\n    int ret;\n\n    if (!ctx)\n        return avcodec_parameters_copy(ost-&gt;st-&gt;codecpar, ost-&gt;par_in);\n\n    ret = avcodec_parameters_copy(ctx-&gt;par_in, ost-&gt;par_in);\n    if (ret &lt; 0)\n        return ret;\n\n    ctx-&gt;time_base_in = ost-&gt;st-&gt;time_base;\n\n    ret = av_bsf_init(ctx);\n    if (ret &lt; 0) {\n        av_log(ms, AV_LOG_ERROR, \"Error initializing bitstream filter: %s\\n\",\n               ctx-&gt;filter-&gt;name);\n        return ret;\n    }\n\n    ret = avcodec_parameters_copy(ost-&gt;st-&gt;codecpar, ctx-&gt;par_out);\n    if (ret &lt; 0)\n        return ret;\n    ost-&gt;st-&gt;time_base = ctx-&gt;time_base_out;\n\n    ms-&gt;bsf_pkt = av_packet_alloc();\n    if (!ms-&gt;bsf_pkt)\n        return AVERROR(ENOMEM);\n\n    return 0;\n}\n</code></pre> \u53d1\u73b0\uff0cffmpeg\u7684bsf\u521d\u59cb\u5316\u591a\u4e00\u4e2a\u6b65\u9aa4\uff0c\u5c06bsf\u7684par_out\u62f7\u8d1d\u5230\u8f93\u51faAVstream\u4e2d\u3002\u800c\u8fd9par_out\u4e2d\u7684extradata\u5c31\u662f\u6211\u4eec\u8981\u7684annexB\u683c\u5f0f\uff01 <pre><code>ret = avcodec_parameters_copy(ost-&gt;st-&gt;codecpar, ctx-&gt;par_out);\n</code></pre></p> <p>\u95ee\u9898\u627e\u5230\u7b54\u6848\u4e86\uff0c1\u662f\u521d\u59cb\u5316rtp muxer\u524d\u5148\u521d\u59cb\u5316bsf\uff0c2\u662f\u521d\u59cb\u5316bsf\u540e\u5c06par_out\u62f7\u8d1d\u56dertp muxer\uff0c\u518d\u521d\u59cb\u5316rtp muxer\u3002</p>","tags":["ffmpeg","rtp","\u97f3\u89c6\u9891"]},{"location":"blog/streaming-h264-with-rtp/#_3","title":"\u6b63\u786e\u4f8b\u5b50","text":"<p>\u57fa\u4e8effmpeg\u7684doc/example/remux.c \u5220\u9664\u4e86\u9519\u8bef\u5904\u7406\u3002\u53ea\u5173\u5fc3h264\uff0c\u6240\u4ee5\u8f93\u5165\u8f93\u51fa\u90fd\u53ea\u5904\u7406index=0\u7684\u5305\u3002 <pre><code>int main(int argc, char **argv) {\n  const AVOutputFormat *ofmt = NULL;\n  AVFormatContext *ifmt_ctx = NULL, *ofmt_ctx = NULL;\n  AVPacket *pkt = NULL;\n  const char *in_filename, *out_filename;\n  int ret = 0;\n  in_filename = \"video.mp4\";\n  out_filename = \"rtp://127.0.0.1:10020\";\n  pkt = av_packet_alloc();\n  ret = avformat_open_input(&amp;ifmt_ctx, in_filename, 0, 0);\n  ret = avformat_find_stream_info(ifmt_ctx, 0);\n  av_dump_format(ifmt_ctx, 0, in_filename, 0);\n\n  // \u521b\u5efa\u8f93\u51fartp\u4e0a\u4e0b\u6587\uff0c\u4e0d\u521d\u59cb\u5316\n  avformat_alloc_output_context2(&amp;ofmt_ctx, NULL, \"rtp\", out_filename);\n  // \u521d\u59cb\u5316bsf\n  const AVBitStreamFilter *bsf_stream_filter =\n      av_bsf_get_by_name(\"h264_mp4toannexb\");\n  AVBSFContext *bsf_ctx = NULL;\n  ret = av_bsf_alloc(bsf_stream_filter, &amp;bsf_ctx);\n  ret =\n      avcodec_parameters_copy(bsf_ctx-&gt;par_in, ifmt_ctx-&gt;streams[0]-&gt;codecpar);\n  ret = av_bsf_init(bsf_ctx);\n\n  ofmt = ofmt_ctx-&gt;oformat;\n  AVStream *out_stream = avformat_new_stream(ofmt_ctx, NULL);\n  // \u5173\u952e\u5728\u8fd9\uff01\uff01 \u539f\u6765\u662f\u4eceifmt_ctx\u7684stream\u4e2d\u62f7\u8d1dcodecpar\uff0c\u6539\u6210\u4ecebsf\u4e2d\u62f7\u8d1d\n  // ret = avcodec_parameters_copy(out_stream-&gt;codecpar, in_codecpar);\n  ret = avcodec_parameters_copy(out_stream-&gt;codecpar, bsf_ctx-&gt;par_out);\n  out_stream-&gt;codecpar-&gt;codec_tag = 0;\n  av_dump_format(ofmt_ctx, 0, out_filename, 1);\n  if (!(ofmt-&gt;flags &amp; AVFMT_NOFILE)) {\n    ret = avio_open(&amp;ofmt_ctx-&gt;pb, out_filename, AVIO_FLAG_WRITE);\n  }\n  // \u521d\u59cb\u5316bsf\u540e\u518d\u521d\u59cb\u5316rtp\n  ret = avformat_write_header(ofmt_ctx, NULL);\n\n  while (1) {\n    AVStream *in_stream, *out_stream;\n    ret = av_read_frame(ifmt_ctx, pkt);\n    if (pkt-&gt;stream_index != 0) {\n      continue;\n    }\n    in_stream = ifmt_ctx-&gt;streams[pkt-&gt;stream_index];\n    out_stream = ofmt_ctx-&gt;streams[pkt-&gt;stream_index];\n    log_packet(ifmt_ctx, pkt, \"in\");\n\n    av_bsf_send_packet(bsf_ctx, pkt);\n    av_bsf_receive_packet(bsf_ctx, pkt);\n    /* copy packet */\n    av_packet_rescale_ts(pkt, in_stream-&gt;time_base, out_stream-&gt;time_base);\n    pkt-&gt;pos = -1;\n    log_packet(ofmt_ctx, pkt, \"out\");\n    ret = av_interleaved_write_frame(ofmt_ctx, pkt);\n  }\n\n  av_write_trailer(ofmt_ctx);\n}\n</code></pre></p>","tags":["ffmpeg","rtp","\u97f3\u89c6\u9891"]},{"location":"blog/streaming-h264-with-rtp/#h264_mp4toannexb","title":"h264_mp4toannexb","text":"<p>\u8fd9\u4e2absf\u5c06\u4ecemp4\u6587\u4ef6\u4e2d\u8bfb\u53d6\u7684avcc\u683c\u5f0f\u7684packet\u8f6c\u6362\u6210annexb\u683c\u5f0f\u7684packet\u3002\u8c03\u8bd5\u53d1\u73b0\u7b2c\u4e00\u4e2a\u8bfb\u51fa\u6765\u7684\u5305\u662fSEI\u4e00\u4e2aI\u5e27\uff0c\u901a\u8fc7bsf\u5904\u7406\u540e\uff0c\u4f1a\u5728SEI\u540e\u9762\u8ffd\u52a0\u4e0aPPS\u548cSPS\u4fe1\u606f\u3002\u800c\u8bfb\u53d6mp4\u6587\u4ef6\u65f6\uff0csps/pps\u5728extradata\u4e2d\u3002</p>","tags":["ffmpeg","rtp","\u97f3\u89c6\u9891"]},{"location":"blog/streaming-h264-with-rtp/#_4","title":"\u76f8\u5173\u77e5\u8bc6","text":"<p>\u8fd9\u4e9b\u77e5\u8bc6\u53cd\u590d\u770b\u6765\u770b\u53bb\uff0c\u603b\u4e5f\u4e0d\u80fd\u8d2f\u7a7f\u8d77\u6765\uff0c\u76f4\u5230\u95ee\u9898\u89e3\u51b3\u624d\u7b97\u660e\u767d\u3002</p>","tags":["ffmpeg","rtp","\u97f3\u89c6\u9891"]},{"location":"blog/streaming-h264-with-rtp/#nalu","title":"NALU","text":"<p>NALU\u662f\u771f\u6b63\u7528\u6765\u4fdd\u5b58h264\u89c6\u9891\u4fe1\u606f\u7684\uff0c\u5305\u62ecI\u5e27\uff0cP/B\u5e27\uff0cPPS\uff0cSEI\uff0cSPS\u7b49\u3002NALU\u7531\u4e24\u90e8\u5206\u7ec4\u6210\uff1a\u5934\uff081\u5b57\u8282\uff09\u548cpayload\uff0c\u5934\u4e2d\u5305\u542bnalu\u7684\u7c7b\u578b\u3002h264\u89c4\u8303\u53ea\u5b9a\u4e49\u4e86NALU\u672c\u8eab\u5355\u5143\uff0c\u4f46\u6ca1\u6709\u5b9a\u4e49\u600e\u4e48\u4fdd\u5b58NALU\u5355\u5143\uff0c\u6240\u4ee5\u6709\u4e86\u4e24\u79cd\u683c\u5f0f\u4fdd\u5b58NALU\uff0cAVCC\u548cAnnexB\u3002</p>","tags":["ffmpeg","rtp","\u97f3\u89c6\u9891"]},{"location":"blog/streaming-h264-with-rtp/#nalu_1","title":"NALU\u7c7b\u578b","text":"<p>NAL unit type\u7684\u503c\u548c\u8bf4\u660e\uff0c\u7c7b\u578b\u540e\u9762\u8ddfpayload\u3002\u8be6\u7ec6\u53c2\u89c1\u5728Rec. ITU-T H.264\u6587\u4ef6\u768463\u9875\uff0c\u8fd9\u91cc\u5c55\u793a\u5e38\u7528\u7684 * 5,Coded slice of an IDR picture (I\u5e27) * 6,Supplemental enhancement information (SEI) * 7,Sequence parameter set (SPS)  * 8,Picture parameter set (PPS) * 24,Single-Time Aggregation Packet(STAP-A)</p> <p>\u4ece\u6293\u5305\u770b\u5230SPS\u7b97\u4e0apayload\u7684\u957f\u5ea6\u4e3a30\uff0cPPS\u7b97\u4e0apayload\u7684\u957f\u5ea6\u4e3a4\u3002\u4e0d\u77e5\u9053\u957f\u5ea6\u662f\u4e0d\u662f\u56fa\u5b9a\u7684\u3002</p>","tags":["ffmpeg","rtp","\u97f3\u89c6\u9891"]},{"location":"blog/streaming-h264-with-rtp/#stap-a","title":"STAP-A","text":"<p>STAP-A\u662f\u591a\u4e2aNALU\u7684\u805a\u5408(Aggregation)\uff0c\u5373\u8fd9\u4e2aNALU\u7684payload\u91cc\u662f\u591a\u4e2aNALU\u3002STAP-A\u7c7b\u578b\u7684NAL\u7528\u6765\u53d1\u9001PPS/SPS/SEI\u7b49\u591a\u79cd\u805a\u5408\u3002\u56e0\u4e3a\u8fd9\u4e9b\u5355\u5143\u90fd\u5f88\u5c0f\u3002STRAP-A\u7c7b\u578b\u7684header\u4e5f\u662f\u4e00\u4e2a\u5b57\u8282\uff0c\u4f46\u662fpayload\u91cc\u9762\u6709\u591a\u4e2aNALU\uff0c\u5e76\u4e14\u6bcf\u4e2aNALU\u524d\u9762\u75282\u5b57\u8282\u6765\u8868\u793a\u8fd9\u4e2aNALU\u7684\u5927\u5c0f\u3002 <pre><code>|STAP-A header|NALU-1 size|NALU-1|NALU-2 size|NALU-2|\n</code></pre></p> <p>NALU-1\u4e2d\u53c8\u6709header\u548cpayload\u3002</p>","tags":["ffmpeg","rtp","\u97f3\u89c6\u9891"]},{"location":"blog/streaming-h264-with-rtp/#avccannexb","title":"AVCC\u548cAnnexB","text":"<p>\u4e0a\u9762\u8bf4\u4e86\u89c4\u8303\u6ca1\u6709\u5b9a\u4e49\u600e\u4e48\u4fdd\u5b58NALU\uff0c\u6240\u4ee5\u6709\u4e86\u8fd9\u4e24\u4e2a\u683c\u5f0f\uff0c\u4ed6\u4eec\u4e24\u662f\u5e73\u7b49\u5173\u7cfb\uff0c\u53ea\u6709\u4fdd\u5b58\u7684\u683c\u5f0f\u4e0d\u540c\u800c\u5df2\u3002AVCC\u7528\u6765\u4fdd\u5b58\uff0cannexB\u7528\u6765\u6d41\u4f20\u8f93\u3002 * AVCC\u75281~4\u4e2a\u5b57\u8282\u6765\u8868\u793aNALU\u7684\u957f\u5ea6\uff0c\u957f\u5ea6\u540e\u9762\u662fNALU\u3002\u8bfb\u53d6\u65b9\u6cd5\u662f\u5148\u8bfb\u957f\u5ea6\uff0c\u518d\u8bfb\u53d6NALU\u3002\u518d\u8bfb\u4e0b\u4e00\u4e2a\u957f\u5ea6\uff0c\u518d\u8bfb\u4e0b\u4e00\u4e2aNALU... * \u800cannexb\u7528<code>0x00,0x00,0x00,0x01</code>\u6216\u8005<code>0x00,0x00,0x01</code>\u7684\u8d77\u59cb\u7801(start code)\u6765\u5206\u9694\u4e0d\u540c\u7684NALU\uff0c\u6240\u4ee5\u65b9\u6cd5\u662f\u5148\u8bfb\u8d77\u59cb\u7801\uff0c\u518d\u4e00\u76f4\u8bfb\uff0c\u76f4\u5230\u53d1\u73b0\u4e0b\u4e00\u4e2a\u8d77\u59cb\u7801\uff0c\u8868\u793a\u8fd9\u4e2aNALU\u7ed3\u675f\uff0c\u4e0b\u4e00\u4e2aNALU\u5f00\u59cb\u3002</p> <p>ffmpeg\u4f7f\u7528\u4e2d\u53d1\u73b0\uff0cAVCC\u4e00\u822c\u75284\u5b57\u8282\u8868\u793aNALU\u7684\u957f\u5ea6\uff0c\u5177\u4f53\u591a\u5c11\u5b57\u8282\uff0c\u5728ffmpeg\u7684extradata\u4e2d\u6709\u5b9a\u4e49\u3002annexB\u4e5f\u662f\u75284\u5b57\u8282\u7684\u8d77\u59cb\u7801\uff0c\u4e5f\u5c31\u662f0x00,0x00,0x00,0x01\u3002</p>","tags":["ffmpeg","rtp","\u97f3\u89c6\u9891"]},{"location":"blog/streaming-h264-with-rtp/#fragmentation-units-fus","title":"Fragmentation Units (FUs) \u5206\u7247","text":"<p>FU\u5c31\u662f\u7f51\u7edc\u5206\u7247\uff0c\u56e0\u4e3aI\u5e27\u662f\u4e00\u4e2a\u5b8c\u6574\u7684\u56fe\u7247\uff0c\u6240\u4ee5\u975e\u5e38\u5927\uff0c\u4e3a\u4e86\u4fdd\u8bc1udp\u4e0d\u4e22\u5305\uff0c\u6240\u4ee5\u8981\u5206\u6b21\u53d1\u9001\u3002 \u7b2c\u4e00\u4e2a\u5206\u7247\u7684FU\u7684\u5934\u8bbe\u7f6e\u4e86Start bit\uff0c \u6700\u540e\u4e00\u4e2a\u5206\u7247\u7684FU\u5934\u8bbe\u7f6e\u4e86END bit\u3002\u5206\u7247\u662f\u5728rtp muxer\u4e2d\u5b8c\u6210\uff0c\u6ce8\u610fffmpeg\u4e2d\u4e00\u4e2apacket\u53ef\u4ee5\u5305\u542b\u591a\u4e2a\u97f3\u9891\u5e27\uff0c\u4f46\u662f\u53ea\u5305\u542b\u4e00\u4e2a\u5e27\uff0c\u76f4\u5230\u53d1\u9001rtp\u4e4b\u524d\uff0c\u4e00\u4e2apacket\u603b\u662f\u5b8c\u6574\u7684\u4e00\u5e27\u89c6\u9891\uff08I/P/B\uff09\u3002 \u5bf9\u4e8e\u6bd4\u8f83\u5c0f\u7684packet\uff0c\u4f8b\u5982\u805a\u5408\u4e86PPS/SPS\u7b49\u4fe1\u606f\u7684STAP-A\u5305\uff0c\u4e0d\u9700\u8981\u5206\u7247\u3002</p>","tags":["ffmpeg","rtp","\u97f3\u89c6\u9891"]},{"location":"blog/streaming-h264-with-rtp/#extradata","title":"extradata","text":"<p>\u4e0a\u9762\u5f88\u591a\u6b21\u63d0\u5230ffmpeg\u7684extradata, \u5c31\u662fAVCodecParameters.extradata\uff0c\u5b83\u7684\u957f\u5ea6\u662fAVCodecParameters.extradata_size\u3002\u5728\u8bfb\u53d6mp4\u6587\u4ef6\u7684\u65f6\u5019\uff0cffmpeg\u4f1a\u81ea\u52a8\u586b\u5145\uff0c\u5728\u89e3\u7801rtp\u7684\u65f6\u5019\u53ef\u80fd\u5c31\u9700\u8981\u624b\u52a8\u586b\u5145\u4e86\u3002extradata\u7684\u6bd4\u7279\u4f4d\u5982\u4e0b\uff0c\u9996\u5148\u662f6\u5b57\u8282\u7684\u5934\uff0c\u7136\u540e\u662f\u591a\u4e2aSPS\u7c7b\u578b\u7684NALU\uff082\u5b57\u8282\u7684\u957f\u5ea6\u5206\u5272\u591a\u4e2aNALU\uff09\uff0c\u518d\u7136\u540e\u662fPPS\u7c7b\u578b\u7684NALU\u4e2a\u6570\uff0c\u6700\u540e\u662fPPS\u7c7b\u578b\u7684\u591a\u4e2aNALU(2\u5b57\u8282\u7684\u957f\u5ea6\u5206\u5272\u591a\u4e2aNALU\uff09\u3002 <pre><code>bits    \n8   version ( always 0x01 )\n8   avc profile ( sps[0][1] )\n8   avc compatibility ( sps[0][2] )\n8   avc level ( sps[0][3] )\n6   reserved ( all bits on )\n2   NALULengthSizeMinusOne\n3   reserved ( all bits on )\n5   number of SPS NALUs (usually 1)\n\nrepeated once per SPS:\n  16         SPS size\n  variable   SPS NALU data\n\n8   number of PPS NALUs (usually 1)\n\nrepeated once per PPS:\n  16       PPS size\n  variable PPS NALU data\n</code></pre></p> <p>\u91cc\u9762\u5305\u542b\u4e86\u4e00\u4e2a\u6216\u591a\u4e2aPPS/SPS(NALU)\uff0c\u4f46\u4fdd\u5b58\u7684\u683c\u5f0f\uff0c\u65e2\u4e0d\u662fAVCC\u4e5f\u4e0d\u662fAnnexB\u3002\u56e0\u4e3a\u4e0a\u9762\u53ef\u77e5AVCC\u75281<sub>4\u4e2a\u5b57\u8282\u8868\u793aNALU\u7684\u957f\u5ea6\uff0cAnnexB\u75283</sub>4\u5b57\u8282\u7684\u8d77\u59cb\u7801\uff0c\u800cextradata\u662f\u6709\u4e00\u4e2a6\u5b57\u8282\u7684header\uff0c\u91cc\u9762\u6709\u4e2a\u5b57\u6bb5\u53eb<code>NALULengthSizeMinusOne</code>\u5c31\u662f\u5b9a\u4e49\u4e86AVCC\u4f7f\u7528\u591a\u5c11\u4e2a\u5b57\u8282\u6765\u8868\u793aNALU\u7684\u957f\u5ea6\u3002\u5982\u679c<code>NALULengthSizeMinusOne</code>\u7b49\u4e8e0\uff0c\u90a3\u4e48AVCC\u75281\u5b57\u8282\u8868\u793aNALU\u7684\u957f\u5ea6\u3002\u901a\u5e38\u5c31\u662f\u75284\u5b57\u8282\u3002</p>","tags":["ffmpeg","rtp","\u97f3\u89c6\u9891"]},{"location":"blog/streaming-h264-with-rtp/#extradata_1","title":"extradata\u4f8b\u5b50","text":"<pre><code>(gdb) x /150bx fmt_ctx-&gt;streams[0]-&gt;codecpar-&gt;extradata\n0x55555571d9c0: 0x01    0x64    0x00    0x28    0xff    0xe1    0x00    0x1e\n0x55555571d9c8: 0x67    0x64    0x00    0x28    0xac    0xd1    0x00    0x78\n0x55555571d9d0: 0x02    0x27    0xe5    0xc0    0x5a    0x80    0x80    0x80\n0x55555571d9d8: 0xa0    0x00    0x00    0x03    0x00    0x20    0x00    0x00\n0x55555571d9e0: 0x07    0x81    0xe3    0x06    0x22    0x40    0x01    0x00\n0x55555571d9e8: 0x04    0x68    0xeb    0xef    0x2c    0x00    0x00    0x00\n0x55555571d9f0: 0x00    0x00    0x00    0x00    0x00    0x00    0x00    0x00\n0x55555571d9f8: 0x00    0x00    0x00    0x00    0x00    0x00    0x00    0x00\n0x55555571da00: 0x00    0x00    0x00    0x00    0x00    0x00    0x00    0x00\n0x55555571da08: 0x00    0x00    0x00    0x00    0x00    0x00    0x00    0x00\n0x55555571da10: 0x00    0x00    0x00    0x00    0x00    0x00    0x00    0x00\n0x55555571da18: 0x00    0x00    0x00    0x00    0x00    0x00    0x00    0x00\n0x55555571da20: 0x00    0x00    0x00    0x00    0x00    0x00    0x00    0x00\n0x55555571da28: 0x00    0x00    0x00    0x00    0x00    0x00    0x00    0x00\n0x55555571da30: 0x00    0x00    0x00    0x00    0x00    0x00    0x00    0x00\n0x55555571da38: 0xc1    0x00    0x00    0x00    0x00    0x00    0x00    0x00\n0x55555571da40: 0x9d    0xad    0x00    0x00    0x50    0x55    0x00    0x00\n0x55555571da48: 0xfa    0x19    0xc4    0x92    0x40    0xa0    0xdc    0xba\n0x55555571da50: 0x00    0x00    0x00    0x00    0x00    0x00\n</code></pre> <ul> <li>\u7b2c5\u5b57\u82820xff,\u4e8c\u8fdb\u5236\u4e3a:1111 1111, \u540e2\u4f4d\u8868\u793a<code>NALULengthSizeMinusOne</code>=3\uff0c\u6240\u4ee5ffmpeg\u75284\u5b57\u8282\u8868\u793aNALU\u7684\u5927\u5c0f\uff08AVCC\u683c\u5f0f\uff09\u3002</li> <li>\u7b2c6\u5b57\u82820xe1,\u4e8c\u8fdb\u5236\u4e3a:1110 0001\uff0c\u540e5\u4f4d\u8868\u793aSPS\u7684\u4e2a\u6570=1,\u6240\u4ee5\u53ea\u6709\u4e00\u4e2aSPS\u3002</li> <li>\u7b2c7\uff0c8\u5b57\u8282\u8868\u793aSPS\u7684\u957f\u5ea6\uff0c0x00\uff0c0x1e\uff0c\u4e8c\u8fdb\u5236\u4e3a:0000 0000, 0001 1110\uff0c\u6240\u4ee5SPS\u957f\u5ea6\u4e3a30\u3002</li> <li>\u8df3\u8fc730\u4e2a\u5b57\u8282\uff0c0x01\uff0c\u4e8c\u8fdb\u5236\u4e3a:0000 0001, \u8868\u793a\u67091\u4e2aPPS\u3002</li> <li>\u540e\u9762\u76842\u4e2a\u5b57\u8282\uff0c0x00,0x04,\u4e8c\u8fdb\u5236\u4e3a:0000,0004,\u8868\u793aPPS\u7684\u957f\u5ea6\u4e3a4\u4e2a\u5b57\u8282\u3002</li> </ul>","tags":["ffmpeg","rtp","\u97f3\u89c6\u9891"]},{"location":"blog/streaming-h264-with-rtp/#nalu_2","title":"NALU\u5934\u7684\u89e3\u6790","text":"<p>NALU\u5934\u662f1\u5b57\u8282\uff0c\u7b2c\u4e00\u4f4dF bit, \u540e\u4e24\u4f4dNRI bit, \u540e\u4e94\u4f4d\u8868\u793aNALU\u7684type\u3002</p> <p>SPS\u7684\u5934\u662f0x67\uff0c\u800c\u8fdb\u5236\u4e3a: 01100111\uff0c\u6240\u4ee5type\u503c\u6b63\u597d\u662f7\u3002 PPS\u7684\u5934\u662f0x68\uff0c\u800c\u8fdb\u5236\u4e3a: 01101000\uff0c\u6240\u4ee5type\u503c\u6b63\u597d\u662f8\u3002</p> <p>\u5bf9\u6bd4wireshark\u89e3\u6790\u7ed3\u679c\u53ef\u4ee5\u786e\u8ba4\u4e0a\u9762\u7684\u7406\u89e3\u6b63\u786e\uff0c\u53ef\u89c1extradata\u5c31\u662f6\u4e2a\u5b57\u8282\u7684header\u52a0\u591a\u4e2aAVCC\u683c\u5f0f\u7684NALU\u3002</p>","tags":["ffmpeg","rtp","\u97f3\u89c6\u9891"]},{"location":"blog/streaming-h264-with-rtp/#extradata_2","title":"\u521b\u5efaextradata","text":"<p>rtp\u89e3\u7801\u65f6\uff0c\u9700\u8981\u624b\u52a8\u751f\u6210extradata\u3002\u521b\u5efaAVCC\u683c\u5f0f\u7684extradata <pre><code>write(0x1);  // version\nwrite(sps[0].data[1]); // profile\nwrite(sps[0].data[2]); // compatibility\nwrite(sps[0].data[3]); // level\nwrite(0xFC | 3); // reserved (6 bits), NULA length size - 1 (2 bits)\nwrite(0xE0 | 1); // reserved (3 bits), num of SPS (5 bits)\nwrite_word(sps[0].size); // 2 bytes for length of SPS\nfor(size_t i=0 ; i &lt; sps[0].size ; ++i)\n  write(sps[0].data[i]); // data of SPS\n\nwrite(&amp;b, pps.size());  // num of PPS\nfor(size_t i=0 ; i &lt; pps.size() ; ++i) {\n  write_word(pps[i].size);  // 2 bytes for length of PPS\n  for(size_t j=0 ; j &lt; pps[i].size ; ++j)\n    write(pps[i].data[j]);  // data of PPS\n}\n</code></pre></p> <p>\u521b\u5efaannexB\u683c\u5f0f\u7684extradata <pre><code>write(0x00)\nwrite(0x00)\nwrite(0x00)\nwrite(0x01)\nfor each byte b in SPS\n  write(b)\n\nfor each PPS p in PPS_array\n  write(0x00)\n  write(0x00)\n  write(0x00)\n  write(0x01)\n  for each byte b in p\n    write(b)\n</code></pre></p>","tags":["ffmpeg","rtp","\u97f3\u89c6\u9891"]},{"location":"blog/streaming-h264-with-rtp/#wireshark","title":"wireshark\u89e3\u6790","text":"<p>\u4ecewiresshark\u5bf9\u6bd4\u7528bsf\u548c\u4e0d\u7528bsf\u7684\u6293\u5305\u53d1\u73b0\uff0cSEI\u5305\u7684\u5185\u5bb9\u6ca1\u6709\u53d8\u5316\uff0c\u662f\u4e0d\u662f\u53ef\u4ee5\u4e0d\u9700\u8981\u8f6c\u6210annexb\uff0c\u76f4\u63a5\u5c06PPS/SPS\u76f4\u63a5\u62f7\u8d1d\u5230packet\u4e2d\u53d1\u51fa\u53bb\u5462\uff1f</p>","tags":["ffmpeg","rtp","\u97f3\u89c6\u9891"]},{"location":"blog/streaming-h264-with-rtp/#_5","title":"\u53c2\u8003","text":"<p>https://membrane.stream/learn/h264/3 https://github.com/cisco/openh264/issues/2501#issuecomment-231340268 https://stackoverflow.com/questions/17667002/how-to-add-sps-pps-read-from-mp4-file-information-to-every-idr-frame https://stackoverflow.com/questions/24884827/possible-locations-for-sequence-picture-parameter-sets-for-h-264-stream https://aviadr1.blogspot.com/2010/05/h264-extradata-partially-explained-for.html</p>","tags":["ffmpeg","rtp","\u97f3\u89c6\u9891"]},{"location":"blog/linux%E5%AD%90%E8%BF%9B%E7%A8%8B%E4%BD%BF%E7%94%A8%E6%96%B9%E6%B3%95/","title":"linux\u5b50\u8fdb\u7a0b\u4f7f\u7528\u65b9\u6cd5","text":"<p>Linux\u7684exec(3)\u662f\u4e00\u7cfb\u5217\u51fd\u6570\u3002\u4e4b\u524d\u603b\u662f\u7a00\u91cc\u7cca\u6d82\u5730\u7528\uff0c\u8fd9\u6b21\u641e\u6e05\u695a\u4e86\u3002 <pre><code>       #include &lt;unistd.h&gt;\n\n       extern char **environ;\n\n       int execl(const char *pathname, const char *arg, ...\n                       /*, (char *) NULL */);\n       int execlp(const char *file, const char *arg, ...\n                       /*, (char *) NULL */);\n       int execle(const char *pathname, const char *arg, ...\n                       /*, (char *) NULL, char *const envp[] */);\n       int execv(const char *pathname, char *const argv[]);\n       int execvp(const char *file, char *const argv[]);\n       int execvpe(const char *file, char *const argv[], char *const envp[]);\n</code></pre></p>","tags":["linux","fork","exec"]},{"location":"blog/linux%E5%AD%90%E8%BF%9B%E7%A8%8B%E4%BD%BF%E7%94%A8%E6%96%B9%E6%B3%95/#_1","title":"\u89c4\u5f8b","text":"<p>\u8fd96\u4e2a\u51fd\u6570\u53ef\u4ee5\u5206\u4e3a\u4e24\u7ec4'execl\u7ec4'\u548c'execv\u7ec4'\u3002 \u540e\u7f00p\u8868\u793a\u4ece$PATH\u4e2d\u67e5\u627e\u7a0b\u5e8f\uff0c \u540e\u7f00e\u8868\u793a\u6700\u540e\u4e00\u4e2a\u53c2\u6570\u662f\u6570\u7ec4\uff0c\u91cc\u9762\u662f\u73af\u5883\u53d8\u91cf\u3002</p>","tags":["linux","fork","exec"]},{"location":"blog/linux%E5%AD%90%E8%BF%9B%E7%A8%8B%E4%BD%BF%E7%94%A8%E6%96%B9%E6%B3%95/#_2","title":"\u9a8c\u8bc1","text":"<p>\u8fd9\u91cc\u901a\u8fc7c\u8bed\u8a00\u548cpython\u8c03\u7528\u547d\u4ee4<code>cat hello.txt</code>\uff0c \u9a8c\u8bc1\u6bcf\u4e2a\u51fd\u6570\u3002</p> <p><pre><code>#include &lt;unistd.h&gt;\n\nint main(){\n  int pid=-1;\n  pid=fork();\n  if(pid == 0)\n  execl(\"/usr/bin/cat\", \"cat\", \"hello-execl.txt\", NULL);\n\n  pid=fork();\n  if(pid == 0)\n  execlp(\"cat\", \"cat\", \"hello-execlp.txt\", NULL);\n\n  pid=fork();\n  if(pid == 0)\n  execle(\"/usr/bin/cat\", \"cat\", \"hello-execle.txt\", NULL, (char*[]){NULL});\n\n  pid=fork();\n  if(pid == 0)\n  execv(\"/usr/bin/cat\",  (char*[]){\"cat\", \"hello-execv.txt\", NULL});\n\n  pid=fork();\n  if(pid == 0)\n  execvp(\"cat\",  (char*[]){\"cat\", \"hello-execvp.txt\", NULL});\n\n  pid=fork();\n  if(pid == 0)\n  execve(\"/usr/bin/cat\",  (char*[]){\"cat\", \"hello-execve.txt\", NULL}, (char*[]){NULL});\n}\n</code></pre> \u6ce8\u610f\u5f53\u4f7f\u7528\u9009\u9879\u53c2\u6570\u65f6\uff0c\u9009\u9879\u548c\u53c2\u6570\u9700\u8981\u5206\u5f00\u6210\u4e24\u4e2a\u5b57\u7b26\u4e32\u3002\u4f8b\u5982<code>grep -n 10 \"target\" file</code>\u547d\u4ee4\uff0c \u8c03\u7528\u65b9\u6cd5\u662f <pre><code>execlp(\"grep\", \"grep\", \"-n\", \"10\",  \"target\", \"file\", NULL);\n</code></pre></p> <p>\u4f7f\u7528\u73af\u5883\u53d8\u91cf\uff0c\u8981\u7528sh\u6765\u62d3\u5c55ENV1\u7b26\u53f7</p> <pre><code>execle(\"/usr/bin/sh\", \"sh\",\"-c\" ,\"echo $ENV1\", NULL, (char*[]){\"ENV1=HELLO\", NULL});\n</code></pre> <p>python \u7684os\u5e93\u7684\u65b9\u6cd5\u66f4\u5168\uff0c\u4e14\u4e0d\u9700\u8981\u5e26NULL <pre><code>&gt;&gt;&gt; [method for method in dir(os) if method.startswith(\"exec\")]\n['execl', 'execle', 'execlp', 'execlpe', 'execv', 'execve', 'execvp', 'execvpe']\n</code></pre></p> <p>\u5b9e\u73b0<code>cat hello.txt</code> <pre><code>import os\nos.execlp(\"cat\", \"cat\", \"hello.txt\")\n</code></pre></p> <p>\u4f7f\u7528\u73af\u5883\u53d8\u91cf, \u540c\u6837\u8981\u7528sh\u6765\u62d3\u5c55ENV1\u7b26\u53f7 <pre><code>import os\n\nenv = os.environ.copy()\nenv[\"ENV1\"]=\"hello\"\nos.execlpe(\"sh\", \"sh\", \"-c\", \"echo $ENV1\", env)\n</code></pre></p>","tags":["linux","fork","exec"]},{"location":"blog/linux%E5%AD%90%E8%BF%9B%E7%A8%8B%E4%BD%BF%E7%94%A8%E6%96%B9%E6%B3%95/#_3","title":"\u5b9e\u7528\u66ff\u4ee3\u65b9\u6cd5","text":"<p>exec\u65cf\u7684\u51fd\u6570\u90fd\u4f1a\u66ff\u6362\u5f53\u524d\u8fdb\u7a0b\u7684\u5806\u6808\uff0c\u6240\u4ee5\u9700\u8981\u7528fork\u751f\u6210\u65b0\u7684\u8fdb\u7a0b\u3002\u66f4\u65b9\u4fbf\u7684\u65b9\u6cd5\u662f\u5728c\u4e2d\u7528system, python\u4e2d\u7528subprocess</p>","tags":["linux","fork","exec"]},{"location":"blog/system-calls-method/","title":"system calls method","text":"<p>\u4e4b\u524d\u5b66\u6c47\u7f16\u53d1\u73b0\u6559\u6750\u548c\u5b9e\u9645\u7684\u6709\u51fa\u5165\uff0c \u4e66\u4e0a\u5199\u7684int, \u4f46\u662f\u6c47\u7f16\u4e0d\u901a\u8fc7\uff0c\u800cgcc \u53cd\u6c47\u7f16\u7684\u7ed3\u679c\u662f\u8c03\u7528syscall\u3002 \u539f\u6765\u8fd9\u662f\u4e24\u79cd\u65b9\u5f0f\u8c03\u7528\u65b9\u5f0f\u5373\uff1a int  0x80 \u548c syscall  </p> <p>\u9664\u6b64\u4e4b\u5916\u8fd8\u6709\u4e00\u4e2a\u540d\u8bcd\u662fvdso,  \u5f88\u591aelf\u6587\u4ef6\u4f1a\u94fe\u63a5\u8fd9\u4e2avdso\u5e93</p> <pre><code>ldd a.out                                                                                                                                                                                                                   \u221a 19:03:30 \n    linux-vdso.so.1 (0x00007fffb3de0000)\n    libc.so.6 =&gt; /usr/lib/libc.so.6 (0x00007f5b48d4a000)\n    /lib64/ld-linux-x86-64.so.2 =&gt; /usr/lib64/ld-linux-x86-64.so.2 (0x00007f5b48f36000)\n</code></pre>","tags":["linux","api"]},{"location":"blog/system-calls-method/#_1","title":"\u8bcd\u6c47\u8bf4\u660e","text":"<p><code>int 0x80</code> \u537380\u4e2d\u65ad\uff0c \u662f\u6700\u8001\u7684\u7cfb\u7edf\u51fd\u6570\u8c03\u7528\u65b9\u5f0f <code>syscall/sysret</code> \u662famd64 \u5236\u5b9a\u7684\u6807\u51c6\uff0c \u4e5f\u662f\u76ee\u524d\u7684x86 64\u4f4d\u7684\u6807\u51c6\uff0c\u5373<code>amd64</code> <code>sysenter/syssysexit</code> \u662finter\u5236\u5b9a\u7684x86 64\u4f4d\u6807\u51c6\uff0c \u76ee\u524d\u5df2\u88ab\u653e\u5f03 <code>vdso</code> \u662flinux\u5185\u6838\u865a\u62df\u51fa\u7684so, \u5b9e\u73b0\u4e86int 80 \u548c syscall\uff0c\u8c03\u7528\u65b9\u5f0f\u4e3a <code>vsyscall</code></p>","tags":["linux","api"]},{"location":"blog/system-calls-method/#_2","title":"\u7cfb\u7edf\u51fd\u6570\u8c03\u7528\u8def\u5f84","text":"<p>\u7cfb\u7edf\u8c03\u7528\u591a\u88ab\u5c01\u88c5\u6210\u5e93\u51fd\u6570\u63d0\u4f9b\u7ed9\u5e94\u7528\u7a0b\u5e8f\u8c03\u7528\uff0c\u5e94\u7528\u7a0b\u5e8f\u8c03\u7528\u5e93\u51fd\u6570\u540e\uff0c\u7531 glibc \u5e93\u8d1f\u8d23\u8fdb\u5165\u5185\u6838\u8c03\u7528\u7cfb\u7edf\u8c03\u7528\u51fd\u6570\u3002 \u5373<code>\u7528\u6237\u51fd\u6570-&gt; glibc -&gt; \u7cfb\u7edf\u8c03\u7528</code></p>","tags":["linux","api"]},{"location":"blog/system-calls-method/#int-0x80","title":"int 0x80","text":"<p>int \u5373\u662finterrupt \u4e2d\u65ad\uff0c 0x80\u662fIDT\u4e0a\u6ce8\u518c\u7684\u4e2d\u65ad\u5411\u91cf\uff0c \u6bcf\u4e2a\u7f16\u53f7\u5bf9\u5e94\u4e00\u4e2a\u5904\u7406\u51fd\u6570handle\uff0c linux\u76840x80\u7684handle\u5373\u662f\u5185\u6838\uff0c\u5373\u7cfb\u7edf\u8c03\u7528\u3002 \u6240\u4ee5\u4e0d\u540c\u7684\u7cfb\u7edf\u8bbe\u7f6e\u76840x80\u7684handle\u53ef\u80fd\u4e0d\u540c</p> <p>\u8c03\u7528\u65b9\u5f0f\uff1a\u9996\u5148\u662f\u5c06\u53c2\u6570\u590d\u5236\u5230\u5bc4\u5b58\u5668\uff0c \u53c2\u6570\u5305\u62ec\u7cfb\u7edf\u8c03\u7528\u7f16\u53f7\u548c\u4f20\u5165\u53c2\u6570\uff0c\u7136\u540e\u6267\u884c init  0x80  \u4f8b\u5982\uff0c\u4ee5\u4e0b\u7684\u8fdb\u7a0b\u9000\u51fa\u7684\u7cfb\u7edf\u8c03\u7528 <pre><code>.data\n    s:\n        .ascii \"hello world\\n\"\n        len = . - s\n.text\n    .global _start\n    _start:\n\n        movl $4, %eax   /* write system call number */\n        movl $1, %ebx   /* stdout */\n        movl $s, %ecx   /* the data to print */\n        movl $len, %edx /* length of the buffer */\n        int $0x80\n\n        movl $1, %eax   /* \u9000\u51fa\u7684\u7cfb\u7edf\u8c03\u7528\u7f16\u53f7 */\n        movl $0, %ebx   /* exit status */\n        int $0x80\n</code></pre></p>","tags":["linux","api"]},{"location":"blog/system-calls-method/#vdos","title":"vdos","text":"<p>vdos\u5373 linux-vdso.so.1\uff0c \u51e0\u4e4e\u5f88\u591aelf \u90fd\u4f1a\u94fe\u63a5\u8fd9\u4e2a\u5e93\uff0c\u4f46\u5176\u5b9e\u4ed6\u5e76\u4e0d\u662f\u771f\u5b9e\u5b58\u5728\u7684so\u6587\u4ef6\uff0c \u800c\u662f\u7531\u5185\u6838\u865a\u62df\u7684\u6587\u4ef6\uff0c\u518d\u6620\u5c04\u5230\u7528\u6237\u7684\u8fdb\u7a0b\u6765\u8c03\u7528\u3002</p> <p>vdos  \u662f\u5bf9\u4ee5\u4e0b\u51e0\u4e2a\u51fd\u6570\u7684\u5b9e\u73b0\uff0c\u79f0\u4f5c\u5feb\u901f\u8c03\u7528</p> <pre><code>#define __NR_gettimeofday 96 //0x60\n#define __NR_time 201 //0xc9\n#define __NR_clock_gettime 228 //0xE4\n#define __NR_getcpu 309 //0x135\n</code></pre>","tags":["linux","api"]},{"location":"blog/system-calls-method/#_3","title":"\u5bf9\u6bd4","text":"<p>\u6240\u4ee5\u4ee5\u4e0a\u603b\u7ed3\u5176\u5b9e\u5c313\u79cd\u65b9\u5f0f\uff0c int \uff0csyscall/sysret \uff0c vdso</p> <p>int 0x80 \u65b9\u5f0f\u5f88\u6162\uff0c\u6240\u4ee5\u51fa\u73b0\u4e86syscall \u5373\u5feb\u901f\u8c03\u7528</p> <p>\u6267\u884c\u533a\u522b <pre><code>\u5728 x86 \u4fdd\u62a4\u6a21\u5f0f\u4e2d\uff0c\u5904\u7406 INT \u4e2d\u65ad\u6307\u4ee4\u65f6\uff0cCPU \u9996\u5148\u4ece\u4e2d\u65ad\u63cf\u8ff0\u8868 IDT \u53d6\u51fa\u5bf9\u5e94\u7684\u95e8\u63cf\u8ff0\u7b26\uff0c\u5224\u65ad\u95e8\u63cf\u8ff0\u7b26\u7684\u79cd\u7c7b\uff0c\u7136\u540e\u68c0\u67e5\u95e8\u63cf\u8ff0\u7b26\u7684\u7ea7\u522b DPL \u548c INT \u6307\u4ee4\u8c03\u7528\u8005\u7684\u7ea7\u522b CPL\uff0c\u5f53 CPL&lt;=DPL \u4e5f\u5c31\u662f\u8bf4 INT \u8c03\u7528\u8005\u7ea7\u522b\u9ad8\u4e8e\u63cf\u8ff0\u7b26\u6307\u5b9a\u7ea7\u522b\u65f6\uff0c\u624d\u80fd\u6210\u529f\u8c03\u7528\uff0c\u6700\u540e\u518d\u6839\u636e\u63cf\u8ff0\u7b26\u7684\u5185\u5bb9\uff0c\u8fdb\u884c\u538b\u6808\u3001\u8df3\u8f6c\u3001\u6743\u9650\u7ea7\u522b\u63d0\u5347\u3002\u5185\u6838\u4ee3\u7801\u6267\u884c\u5b8c\u6bd5\u4e4b\u540e\uff0c\u8c03\u7528 IRET \u6307\u4ee4\u8fd4\u56de\uff0cIRET \u6307\u4ee4\u6062\u590d\u7528\u6237\u6808\uff0c\u5e76\u8df3\u8f6c\u4f1a\u4f4e\u7ea7\u522b\u7684\u4ee3\u7801\u3002\n\n\u5176\u5b9e\uff0c\u5728\u53d1\u751f\u7cfb\u7edf\u8c03\u7528\uff0c\u7531 Ring3 \u8fdb\u5165 Ring0 \u7684\u8fd9\u4e2a\u8fc7\u7a0b\u6d6a\u8d39\u4e86\u4e0d\u5c11\u7684 CPU \u5468\u671f\uff0c\u4f8b\u5982\uff0c\u7cfb\u7edf\u8c03\u7528\u5fc5\u7136\u9700\u8981\u7531 Ring3 \u8fdb\u5165 Ring0\uff08\u7531\u5185\u6838\u8c03\u7528 INT \u6307\u4ee4\u7684\u65b9\u5f0f\u9664\u5916\uff0c\u8fd9\u591a\u534a\u5c5e\u4e8e Hacker \u7684\u5185\u6838\u6a21\u5757\u6240\u4e3a\uff09\uff0c\u6743\u9650\u63d0\u5347\u4e4b\u524d\u548c\u4e4b\u540e\u7684\u7ea7\u522b\u662f\u56fa\u5b9a\u7684\uff0cCPL \u80af\u5b9a\u662f 3\uff0c\u800c INT 80 \u7684 DPL \u80af\u5b9a\u4e5f\u662f 3\uff0c\u8fd9\u6837 CPU \u68c0\u67e5\u95e8\u63cf\u8ff0\u7b26\u7684 DPL \u548c\u8c03\u7528\u8005\u7684 CPL \u5c31\u662f\u5b8c\u5168\u6ca1\u5fc5\u8981\u3002\u6b63\u662f\u7531\u4e8e\u5982\u6b64\uff0cIntel x86 CPU \u4ece PII 300\uff08Family 6\uff0cModel 3\uff0cStepping 3\uff09\u4e4b\u540e\uff0c\u5f00\u59cb\u652f\u6301\u65b0\u7684\u7cfb\u7edf\u8c03\u7528\u6307\u4ee4 sysenter/sysexit\u3002sysenter \u6307\u4ee4\u7528\u4e8e\u7531 Ring3 \u8fdb\u5165 Ring0\uff0cSYSEXIT \u6307\u4ee4\u7528\u4e8e\u7531 Ring0 \u8fd4\u56de Ring3\u3002\u7531\u4e8e\u6ca1\u6709\u7279\u6743\u7ea7\u522b\u68c0\u67e5\u7684\u5904\u7406\uff0c\u4e5f\u6ca1\u6709\u538b\u6808\u7684\u64cd\u4f5c\uff0c\u6240\u4ee5\u6267\u884c\u901f\u5ea6\u6bd4 INT n/IRET \u5feb\u4e86\u4e0d\u5c11\u3002\n</code></pre></p> <p>\u8fd4\u56de\u7684\u533a\u522b <pre><code>\u5728 Intel \u7684\u624b\u518c\u4e2d\uff0c\u8fd8\u63d0\u5230\u4e86 sysenter/sysexit \u548c int n/iret \u6307\u4ee4\u7684\u4e00\u4e2a\u533a\u522b\uff0c\u90a3\u5c31\u662f sysenter/sysexit \u6307\u4ee4\u5e76\u4e0d\u6210\u5bf9\uff0csysenter \u6307\u4ee4\u5e76\u4e0d\u4f1a\u628a SYSEXIT \u6240\u9700\u7684\u8fd4\u56de\u5730\u5740\u538b\u6808\uff0csysexit \u8fd4\u56de\u7684\u5730\u5740\u5e76\u4e0d\u4e00\u5b9a\u662f sysenter \u6307\u4ee4\u7684\u4e0b\u4e00\u4e2a\u6307\u4ee4\u5730\u5740\u3002\u8c03\u7528 sysenter/sysexit \u6307\u4ee4\u5730\u5740\u7684\u8df3\u8f6c\u662f\u901a\u8fc7\u8bbe\u7f6e\u4e00\u7ec4\u7279\u6b8a\u5bc4\u5b58\u5668\u5b9e\u73b0\u7684\u3002\n</code></pre></p> <p>vdos\u7684\u5c40\u9650\uff08syscall\uff09 <pre><code>\u800c\"\u5feb\u901f\u7cfb\u7edf\u8c03\u7528\u6307\u4ee4\"\u6bd4\u8d77\u4e2d\u65ad\u65b9\u5f0f\u7684\u7cfb\u7edf\u8c03\u7528\u65b9\u5f0f\uff0c\u8fd8\u5b58\u5728\u4e00\u5b9a\u5c40\u9650\uff0c\u4f8b\u5982\u65e0\u6cd5\u5728\u4e00\u4e2a\u7cfb\u7edf\u8c03\u7528\u5904\u7406\u8fc7\u7a0b\u4e2d\u518d\u901a\u8fc7\"\u5feb\u901f\u7cfb\u7edf\u8c03\u7528\u6307\u4ee4\"\u8c03\u7528\u522b\u7684\u7cfb\u7edf\u8c03\u7528\u3002\u56e0\u6b64\uff0c\u5e76\u4e0d\u4e00\u5b9a\u6bcf\u4e2a\u7cfb\u7edf\u8c03\u7528\u90fd\u9700\u8981\u901a\u8fc7\"\u5feb\u901f\u7cfb\u7edf\u8c03\u7528\u6307\u4ee4\"\u6765\u5b9e\u73b0\u3002\u6bd4\u5982\uff0c\u5bf9\u4e8e\u590d\u6742\u7684\u7cfb\u7edf\u8c03\u7528\u4f8b\u5982 fork\uff0c\u4e24\u79cd\u7cfb\u7edf\u8c03\u7528\u65b9\u5f0f\u7684\u65f6\u95f4\u5dee\u548c\u7cfb\u7edf\u8c03\u7528\u672c\u8eab\u8fd0\u884c\u6d88\u8017\u7684\u65f6\u95f4\u6765\u6bd4\uff0c\u53ef\u4ee5\u5ffd\u7565\u4e0d\u8ba1\uff0c\u6b64\u5904\u91c7\u53d6\"\u5feb\u901f\u7cfb\u7edf\u8c03\u7528\u6307\u4ee4\"\u65b9\u5f0f\u6ca1\u6709\u4ec0\u4e48\u5fc5\u8981\u3002\u800c\u771f\u6b63\u5e94\u8be5\u4f7f\u7528\"\u5feb\u901f\u7cfb\u7edf\u8c03\u7528\u6307\u4ee4\"\u65b9\u5f0f\u7684\uff0c\u662f\u90a3\u4e9b\u672c\u8eab\u8fd0\u884c\u65f6\u95f4\u5f88\u77ed\uff0c\u5bf9\u65f6\u95f4\u7cbe\u786e\u6027\u8981\u6c42\u9ad8\u7684\u7cfb\u7edf\u8c03\u7528\uff0c\u4f8b\u5982 getuid\u3001gettimeofday \u7b49\u7b49\u3002\n</code></pre></p>","tags":["linux","api"]},{"location":"blog/system-calls-method/#_4","title":"\u6700\u540e\u603b\u7ed3","text":"<p>int \u662f\u6700\u8001\u7684\u65b9\u5f0f\uff0c\u76ee\u524d\u7528amd64\u7684 syscall \u65b9\u5f0f\uff0c \u800cvdso\u662f\u57fa\u4e8esyscall\u5b9e\u73b0\u7684\u5feb\u901f\u8c03\u7528\u3002 \u53ea\u6709\u5728\u8c03\u7528clock_gettime\u3001gettimeofday\u3001getcpu\u3001time\u8fd9\u4e9b\u7cfb\u7edf\u8c03\u7528\u65f6\uff0c\u624d\u4f1a\u4f7f\u7528vdso\uff0c\u5176\u4ed6\u7cfb\u7edf\u8c03\u7528\u662f\u901a\u8fc7syscall\u5b9e\u73b0\u7684</p>","tags":["linux","api"]},{"location":"blog/%E5%88%9B%E5%BB%BA-systemd-%E6%9C%8D%E5%8A%A1/","title":"\u521b\u5efa systemd \u670d\u52a1","text":"<p>\u8bf4\u4e00\u4e2a\u8001\u8bdd\uff0c \u73b0\u5728systemd\u4f5c\u4e3alinux\u7684\u542f\u52a8\u7ba1\u7406\u548c\u670d\u52a1\u7ba1\u7406\u5df2\u7ecf\u8d8a\u6765\u8d8a\u91cd\u8981\u4e86\uff0c \u4e0a\u5468\u8003\u8bd5\u4e5f\u9047\u5230\u7528systemd \u6765\u7ba1\u7406\u5bb9\u5668\uff0c\u8fd9\u91cc\u8bb0\u5f55\u4e00\u4e0b\u5982\u4f55\u7f16\u5199systemd\u670d\u52a1</p>","tags":["linux","systemd"]},{"location":"blog/%E5%88%9B%E5%BB%BA-systemd-%E6%9C%8D%E5%8A%A1/#systemd_1","title":"\u5173\u4e8esystemd","text":"<p>systemd\u662f\u53ea\u80fd\u8fd0\u884c\u5728Linux\u4e0a\u7684init, \u4e5f\u5c31\u662f\u542f\u52a8\u540e\u770b\u5230\u76841\u53f7\u8fdb\u7a0b\u3002 \u9664\u4e86\u542f\u52a8\uff0c systemd\u8fd8\u7ba1\u7406\u7740\u5f88\u591a\u4e1c\u897f\uff0c\u4f8b\u5982\u7f51\u7edc\uff08systemd-networkd\uff09\uff0c \u57df\u540d\u89e3\u6790\uff08systemd-resolved\uff09\uff0c\u4e3a\u670d\u52a1\u521b\u5efasocket(systemd.socket) \u6587\u4ef6\u7cfb\u7edf\u6302\u8f7d\uff0c\u8fd8\u6709\u7cfb\u7edf\u548c\u7528\u6237\u7684\u670d\u52a1 systemd\u592a\u5927\uff0c\u8bf4\u4e0d\u5b8c\uff0c\u9700\u8981\u67e5\u770b\u5404\u79cd\u6587\u6863</p>","tags":["linux","systemd"]},{"location":"blog/%E5%88%9B%E5%BB%BA-systemd-%E6%9C%8D%E5%8A%A1/#systemd_2","title":"systemd \u7684\u4e24\u79cd\u4f7f\u7528\u6a21\u5f0f","text":"<p>systemd \u5206\u4e3asystem\u7ea7\u522b\u548cuser\u7ea7\u522b\uff0c \u5bf9\u5e94\u7684unit\u6587\u4ef6\u5206\u522b\u5728/etc/systemd/ \u548c \uff5e/.config/systemd/\u4e0b\uff0c \u524d\u8005\u662f\u7cfb\u7edf\u7ea7\u522b\uff0c\u540e\u8005\u662f\u7528\u6237\u7ea7\u522b\u3002 \u7528\u6237\u53ea\u80fd\u8fd0\u884c\u81ea\u5df1\u8bbe\u7f6e\u7684\u670d\u52a1</p> <p><pre><code>systemctl start system_service.service\n</code></pre> \u800c\u666e\u901a\u7528\u6237\u53ea\u80fd\u6267\u884c <pre><code>systemctl --user user_service.service\n</code></pre></p> <p>\u8fd9\u4e2aname\u5c31\u662f\u6587\u4ef6\u540d\u79f0\uff0c\u4f8b\u5982\u5fc5\u987b'/etc/systemd/system/'\u4e0b\u5b58\u5728'system_service.service'\u6587\u4ef6\uff0c\u5728\u80fd\u6267\u884c\u7b2c\u4e00\u6761\u7684\u547d\u4ee4\u3001 \u5fc5\u987b\u5728 '~/.config/systemd/user/'\u4e0b\u5b58\u5728'user_service.service'\u5728\u80fd\u6267\u884c\u7b2c\u4e8c\u6761\u547d\u4ee4</p>","tags":["linux","systemd"]},{"location":"blog/%E5%88%9B%E5%BB%BA-systemd-%E6%9C%8D%E5%8A%A1/#_1","title":"\u7cfb\u7edf\u670d\u52a1\u4ee5\u5176\u4ed6\u7528\u6237\u8fd0\u884c\u670d\u52a1","text":"<p>\u7cfb\u7edf\u7ea7\u522b\u7684\u670d\u52a1\u9ed8\u8ba4\u4f1a\u4ee5root\u6765\u8fd0\u884c\u670d\u52a1\uff0c\u4f46\u662f\u4e5f\u53ef\u4ee5\u8bbe\u7f6e\u4ee5\u5176\u4ed6\u7528\u6237\u6765\u8fd0\u884c\u6765\u6700\u5c0f\u5316\u6743\u9650\uff0c\u4f8b\u5982\u97f3\u89c6\u9891\u670d\u52a1\u3002\u4e5f\u53ef\u4ee5\u4ee5\u67d0\u4e2a\u7528\u6237\u6765\u6267\u884c\uff0c\u90a3\u4e48service unit \u6587\u4ef6\u5c31\u53d8\u4e3a'system_service@user.service'</p> <pre><code># system_service@user.service\n[Unit]\nDescription=Watchman for user %i\nAfter=remote-fs.target\nConflicts=shutdown.target\n\n[Service]\nExecStart=/usr/local/bin/watchman --foreground --inetd\nExecStop=pkill -u %i -x watchman\nRestart=on-failure\nUser=%i\nGroup=users\nStandardInput=socket\nStandardOutput=syslog\nSyslogIdentifier=watchman-%i\n\n[Install]\nWantedBy=multi-user.target\n</code></pre> <p>\u4e0a\u9762\u7684\u670d\u52a1\u4ee5\u4e0b\u9762\u7684socket \u5355\u5143\u542f\u52a8\uff0c \u524d\u63d0\u8981\u8fd9\u4e2a\u670d\u52a1\u5b9e\u73b0\u63a5\u6536socket,\u901a\u8fc7<code>sd_listen_fds(3)</code> <pre><code># system_service@user.socket\n\n[Unit]\nDescription=Watchman socket for user %i\n\n[Socket]\nListenStream=/var/facebook/watchman/%i-state/sock\nAccept=false\nSocketMode=0664\nSocketUser=%i\nSocketGroup=othergroup\n\n[Install]\nWantedBy=sockets.target\n</code></pre></p>","tags":["linux","systemd"]},{"location":"blog/%E5%88%9B%E5%BB%BA-systemd-%E6%9C%8D%E5%8A%A1/#_2","title":"\u666e\u901a\u7528\u6237\u8fd0\u884c\u670d\u52a1","text":"<p>\u6ce8\u610f\uff0c \u666e\u901a\u7528\u6237\u56e0\u4e3a\u53ea\u4f1a\u4ee5\u81ea\u5df1\u7684\u8eab\u4efd\u542f\u52a8\uff0c\u6240\u4ee5\u4e0d\u80fd\u60f3\u7cfb\u7edf\u670d\u52a1\u90a3\u6837\u6307\u5b9a'User/Group' <pre><code>[Unit]\nDescription=tun2socks for vpn\n#Requires=ssh_to_alpha.service\n\n[Service]\nType=simple\nExecStart=/usr/bin/badvpn-tun2socks \n\n[Install]\nWantedBy=default.target\n</code></pre></p> <p>\u82e5\u5e0c\u671b\u8fd9\u4e2a\u7528\u6237\u81ea\u5b9a\u4e49\u670d\u52a1\u80fd\u81ea\u542f\u52a8\uff0c WantedBy\u9700\u8981\u8bbe\u7f6e\u6210'default.target'</p>","tags":["linux","systemd"]},{"location":"blog/%E5%88%9B%E5%BB%BA-systemd-%E6%9C%8D%E5%8A%A1/#unit-file","title":"\u81ea\u52a8\u521b\u5efaunit-file","text":"<p>\u4ee5\u4e0b\u547d\u4ee4\u53ef\u4ee5\u81ea\u52a8\u5728\u5bf9\u5e94\u76ee\u5f55\u521b\u5efa*.service\u6587\u4ef6 <pre><code>systemctl --user --force --full edit test.service \n</code></pre></p>","tags":["linux","systemd"]},{"location":"blog/tailscale-%E4%BD%BF%E7%94%A8%E8%AE%B0%E5%BD%95/","title":"tailscale \u4f7f\u7528\u8bb0\u5f55","text":"<p>tailscale \u514d\u8d39\u6700\u5927\u63d0\u4f9b10\u4e2a\u8282\u70b9\uff0c\u8db3\u591f\u4e2a\u4eba\u4f7f\u7528\u3002\u5728\u5982\u4eca\u5927\u5185\u7f51\u7684\u65f6\u4ee3\uff0c\u975e\u5e38\u65b9\u4fbf\u7ec4\u5efa\u5b50\u7f51\uff0c\u5b9e\u73b0\u5bb6\u4e2d\u548c\u516c\u53f8\u4e92\u8054\u4e92\u901a\u3002</p>","tags":["tailcale","pve"]},{"location":"blog/tailscale-%E4%BD%BF%E7%94%A8%E8%AE%B0%E5%BD%95/#derp","title":"\u6dfb\u52a0DERP\u8282\u70b9","text":"<p>\u5982\u679c\u4e24\u4e2a\u8282\u70b9\u6709\u4e00\u4e2a\u6709\u516c\u7f51IP, \u6216\u8005\u80fd\u6253\u6d1e\uff08NAT1. NAT2\uff09\uff0c\u90a3\u4e48\u4e24\u4e2a\u8282\u70b9\u53ef\u4ee5\u76f4\u8fde\uff0c\u901f\u5ea6\u5f88\u5feb\u3002\u5426\u5219\u8981\u901a\u8fc7DERP\u8282\u70b9\u8f6c\u53d1\uff0c\u4f46\u662ftailscale\u5728\u5927\u9646\u6ca1\u6709DERP\u8282\u70b9\uff0cHK\u7684DERP\u8282\u70b9\u90fd\u6709300+\u7684\u5ef6\u8fdf\uff0c\u5b8c\u5168\u6ca1\u6cd5\u7528\u3002 \u6240\u4ee5\u53ea\u80fd\u81ea\u5df1\u642d\u5efa\u6216\u79df\u8d41\u4e00\u4e2a\u5728\u5927\u9646\u7684\u79c1\u4eba\u642d\u5efa\u7684\u8282\u70b9\u3002</p>","tags":["tailcale","pve"]},{"location":"blog/tailscale-%E4%BD%BF%E7%94%A8%E8%AE%B0%E5%BD%95/#_1","title":"\u51fa\u53e3\u8282\u70b9","text":"<p>\u51fa\u53e3\u8282\u70b9A\u662f\u6d41\u91cf\u53ef\u4ee5\u4ece\u8fd9\u4e2a\u8282\u70b9\u51fa\u53bb\uff0c\u6bd4\u5982\u8282\u70b9B\u53ef\u4ee5\u4eceA\u67e5\u8be2IP\u5730\u5740\u65f6\uff0c\u663e\u793a\u7684ip\u662f\u8282\u70b9A\u7684\u516c\u7f51ip \u800c\u4e0d\u662fB\u7684\u3002</p>","tags":["tailcale","pve"]},{"location":"blog/tailscale-%E4%BD%BF%E7%94%A8%E8%AE%B0%E5%BD%95/#_2","title":"\u8f6c\u53d1\u5230\u51fa\u53e3\u8282\u70b9","text":"<p>\u5728B\u8282\u70b9\u4e0a\u8bbe\u7f6e\u6d41\u91cf\u90fd\u4ece\u8282\u70b9A\u51fa\u53bb tailscale up --exit-node=","tags":["tailcale","pve"]},{"location":"blog/tailscale-%E4%BD%BF%E7%94%A8%E8%AE%B0%E5%BD%95/#_3","title":"\u6dfb\u52a0\u8f6c\u53d1\u4f8b\u5916","text":"<p>\u542f\u52a8\u8f6c\u53d1\u540e\uff0c\u6240\u6709\u6d41\u91cf\u90fd\u4f1a\u4ece\u51fa\u53e3\u8282\u70b9\u8d70\u3002\u5982\u679c\u5355\u673a\u5c31\u6ca1\u4e8b\uff0c\u4f46\u662f\u5c40\u57df\u7f51\u591a\u53f0\u7535\u8111\u9700\u8981\u4ea4\u4e92\uff0c\u4f8b\u5982\u4ece\u5c40\u57df\u7f51\u4e3b\u673aC\u8bbf\u95ee\u4e3b\u673aB, \u7531\u4e8e\u4e3b\u673aB\u7684\u6d41\u91cf\u90fd\u4ece\u8282\u70b9A\u51fa\u53bb\u4e86\uff0c\u4f1a\u5bfc\u81f4\u4e3b\u673aC\u6536\u4e0d\u5230\u8bf7\u6c42\u7b54\u590d\u3002\u7ed3\u679c\u662fC \u65e0\u6cd5ping B, C\u4e5f\u4e0d\u80fdssh\u767b\u5f55B\u3002 \u6240\u4ee5\u8981\u6dfb\u52a0\u4f8b\u5916</p> <p>\u5c06\u6765\u81ea\u672c\u5730\u5c40\u57df\u7f51\u4e3b\u673aC\u7684\u6d41\u91cf\u4e0d\u88ab\u8f6c\u53d1\u5230\u51fa\u53e3\u8282\u70b9\u3002\u4f8b\u5982\u8def\u7531\u5668\u7684\u5b50\u7f51\u662f192.168.10.0/24\uff0c\u4e3b\u673aC\u662f192.168.10.111, \u672c\u673aip\u662f192.168.10.100 <pre><code># ip rule add to &lt;your-local-network&gt; lookup main\nip rule add to 192.168.10.111/32 lookup main\n</code></pre></p>","tags":["tailcale","pve"]},{"location":"blog/%E5%8F%B3%E5%80%BC-%E4%B8%B4%E6%97%B6%E5%8F%98%E9%87%8F%E4%B8%8E%E5%BC%95%E7%94%A8/","title":"\u53f3\u503c, \u4e34\u65f6\u53d8\u91cf\u4e0e\u5f15\u7528","text":"<p>\u6211\u4eec\u8bf4\u7684\u4e34\u65f6\u53d8\u91cf\u901a\u5e38\u662f\u6307\u5728\u8bed\u53e5\u5757\u91cc\u5b9a\u4e49\u7684\u77ed\u6682\u751f\u547d\u5468\u671f\u7684\u5c40\u90e8\u53d8\u91cf, \u5176\u5b58\u50a8\u5468\u671f\u4e3a'auto'\uff0c\u4f46\u8fd9\u91cc\u8ba8\u8bba\u7684\u662fc++\u4e2d'temporary object', \u662f\u5728\u8001\u7248\u672cc++\u4e2d \u800c\u8bed\u53e5\u5757\u91cc\u5b9a\u4e49\u7684\u53d8\u91cf\u4ee5\u53ca\u975e\u5f15\u7528\u7c7b\u578b\u53c2\u6570\uff0c\u5e76\u4e0d\u5c5e\u4e8e\u8fd9\u91cc\u7684\u4e34\u65f6\u53d8\u91cf  </p> <p>c++\u4e2d\u7684\u4e34\u65f6\u53d8\u91cf\u51fa\u73b0\u60c5\u51b5\uff1a * litteral\u5e38\u91cf, \u59821 * \u7c7b\u578b\u8f6c\u6362   // \u8d4b\u503c\u8bed\u53e5\u7ed3\u675f\u540e\uff0c\u81ea\u52a8\u9500\u6bc1 * \u51fd\u6570\u8fd4\u56de\u503c // \u8d4b\u503c\u8bed\u53e5\u7ed3\u675f\u540e\uff0c\u81ea\u52a8\u9500\u6bc1 * \u8868\u8fbe\u5f0f\u7684\u503c </p> <p>\u800c\u4e34\u65f6\u53d8\u91cf\u7684\u5b9a\u4e49\u5c31\u662f<code>\u7f16\u8bd1\u5668\u81ea\u52a8\u521b\u5efa\u548c\u9500\u6bc1\u7684\u6ca1\u6709\u540d\u5b57\u7684\u53d8\u91cf</code>, \u4e5f\u65e0\u6cd5\u53d6\u5730\u5740\u3002\u5e76\u4e14\u89c4\u5b9a\uff1a - \u5e38\u91cf\u7c7b\u578b\u7684\u5f15\u7528\uff08<code>reference to const</code>\uff09\u53ef\u4ee5\u7ed1\u5b9a\u5230\u4e34\u65f6\u53d8\u91cf - \u975e\u5e38\u91cf\u7c7b\u578b\u7684\u5f15\u7528\uff08<code>reference to non-const</code>\uff09\u7c7b\u578b\u4e0d\u80fd\u7ed1\u5b9a\u5230\u4e34\u65f6\u53d8\u91cf</p> <p>\u8fd9\u4e2a\u89c4\u5b9a\u7684\u539f\u56e0\u662f\uff1a \u56e0\u4e3a\u4e0a\u9762\u8bf4\u7684<code>\u7f16\u8bd1\u5668\u81ea\u52a8\u521b\u5efa\u548c\u9500\u6bc1</code>\uff0c\u6240\u4ee5\u53bb\u4fee\u6539\u4e00\u4e2a\u4f1a\u9500\u6bc1\u53d8\u91cf\u662f<code>\u6ca1\u6709\u610f\u4e49\u7684</code></p>","tags":["cpp"]},{"location":"blog/%E5%8F%B3%E5%80%BC-%E4%B8%B4%E6%97%B6%E5%8F%98%E9%87%8F%E4%B8%8E%E5%BC%95%E7%94%A8/#_2","title":"\u4ec0\u4e48\u65f6\u5019\u7f16\u8bd1\u5668\u8981\u9700\u8981\u521b\u5efa\u4e34\u65f6\u53d8\u91cf","text":"\u521b\u5efa\u539f\u56e0 \u9500\u6bc1\u65f6\u673a Result of expression evaluation All temporaries created as a result of expression evaluation are destroyed at the end of the expression statement (that is, at the semicolon), or at the end of the controlling expressions for for, if, while, do, and switch statements. Initializing const references If an initializer is not an l-value of the same type as the reference being initialized, a temporary of the underlying object type is created and initialized with the initialization expression. This temporary object is destroyed immediately after the reference object to which it is bound is destroyed. <p>\u4e3b\u8981\u662f\u4ee5\u4e0b\u4e24\u4e2a\u5730\u65b9\u4f1a\u9700\u8981\u4e34\u65f6\u53d8\u91cf\uff1a * \u51fd\u6570\u63a5\u53d7\u5f15\u7528\u7c7b\u578b\u53c2\u6570\u7684\u65f6\u5019 * \u51fd\u6570\u8fd4\u56de\u7684\u65f6\u5019 * \u7c7b\u578b\u8f6c\u6362\u7684\u65f6\u5019</p> <p>\u4e3e\u4f8b\uff1a</p> <p>\u51fd\u6570\u53c2\u6570 <pre><code>void foo(const int &amp;arg){}\nfoo(1);  // \u6b64\u65f6\u521b\u5efa\u4e86\u4e34\u65f6\u53d8\u91cf\uff0c\u53ef\u4ee5\u60f3\u8c61\u6210'foo(int _tmp(i));' \u800c\u4e14\u8fd9\u4e2a_tmp \u4e0d\u80fd\u88ab\u4fee\u6539\n</code></pre></p> <p>\u51fd\u6570\u8fd4\u56de\u503c <pre><code>int foo(){return 1;}\nint i=foo(); // \u6b64\u65f6\u521b\u5efa\u4e86\u4e34\u65f6\u53d8\u91cf\uff0c int _tmp = foo(); int i = _tmp;\n</code></pre></p> <p>\u7c7b\u578b\u8f6c\u6362 <pre><code>int i = 1;\ndouble d = i; // double _tmp = i; double d = _tmp;\n</code></pre></p>","tags":["cpp"]},{"location":"blog/%E5%8F%B3%E5%80%BC-%E4%B8%B4%E6%97%B6%E5%8F%98%E9%87%8F%E4%B8%8E%E5%BC%95%E7%94%A8/#_3","title":"\u5355\u72ec\u8ba8\u8bba\u8fd9\u4e9b\u4f3c\u4e4e\u610f\u4e49\u4e0d\u5927\uff0c \u4f46\u662f\u5728\u5b9e\u9645\u7f16\u5199\u4ee3\u7801\u7684\u65f6\u5019\uff0c\u53ef\u80fd\u4f1a\u6709\u7591\u60d1","text":"<p>\u4f8b\u5982\u5982\u4f55\u89e3\u91ca <pre><code>const int&amp; cr = 1; // ok\nint &amp;r = 1; // ng\n</code></pre> \u8fd9\u91cc\u8d4b\u503c\u548c\u51fd\u6570\u4f20\u53c2\u4e00\u6837\uff0c \u56e0\u4e3a1\u662f\u5e38\u6570\uff0c\u8fd9\u91cc\u4e3a\u5e38\u91cf<code>1</code>\u521b\u5efa\u4e34\u65f6\u53d8\u91cf\uff0c \u800c\u53ea\u6709<code>reference to const</code> \u624d\u80fd\u7ed1\u5b9a\u5230\u4e34\u65f6\u53d8\u91cf\u4e0a</p> <p>\u8fd8\u6709\u89e3\u91ca\u4e00\u4e2a\u7ecf\u5e38\u88ab\u5f15\u7528\u7684\u4f8b\u5b50 <pre><code>void foo(int &amp;arg){}\nint i = 1; foo(i); // ok\ndouble d = 1.0; foo(d); // ng\n</code></pre></p> <p><pre><code>void foo(const int &amp;arg){}\nint i = 1; foo(i); // ok\ndouble d = 1.0; foo(d); // ok\n</code></pre> \u8fd9\u91cc\u867d\u7136i\u548cd\u90fd\u4e0d\u662f\u5e38\u91cf\uff08\u4e0d\u4f1a\u521b\u5efa\u4e34\u65f6\u53d8\u91cf\uff09\uff0c \u4f46\u662f\u56e0\u4e3a\u7c7b\u578b\u4e0d\u540c\uff0c \u53d1\u751f\u4e86\u7c7b\u578b\u8f6c\u6362\uff0c\u521b\u5efa\u4e86\u4e34\u65f6\u53d8\u91cf\u3002\u540c\u6837\u5730\uff0c\u53ea\u6709<code>reference to const</code> \u624d\u80fd\u7ed1\u5b9a\u5230\u4e34\u65f6\u53d8\u91cf\u4e0a</p>","tags":["cpp"]},{"location":"blog/linux-%E6%96%87%E6%9C%AC%E5%A4%84%E7%90%86%E4%B8%89%E5%89%91%E5%AE%A2/","title":"Linux \u6587\u672c\u5904\u7406\u4e09\u5251\u5ba2","text":"<p>grep awk sed</p>","tags":["linux","tool"]},{"location":"blog/linux-%E6%96%87%E6%9C%AC%E5%A4%84%E7%90%86%E4%B8%89%E5%89%91%E5%AE%A2/#sed-vmstatcsv","title":"sed \u5c06vmstat\u7684\u8f93\u51fa\u8f6c\u6210csv","text":"<p>vmstat\u7684\u8f93\u51fa\u5982\u4e0b\uff0c\u7a7a\u683c\u5206\u5272\u7684\u3002sed\u547d\u4ee4<code>sed 's/^  *//;s/  */,/g'  vmstat.dat &gt; vmstat.02.csv</code>\u505a\u4e86\u4e24\u4ef6\u4e8b\uff1a 1. \u5c06\u884c\u9996\u7684\u7a7a\u683c\u53bb\u6389 2. \u5c06\u5176\u4ed6\u7a7a\u683c\u8f6c\u6210','\u7b26\u5408csv\u7684\u683c\u5f0f</p> <p>\u591a\u4e2ased\u547d\u4ee4\u7528';'\u5206\u9694\uff0c\u4e14\u5171\u7528/g\u547d\u4ee4</p> <p><pre><code>procs -----------memory---------- ---swap-- -----io---- -system-- -------cpu-------\n r  b   swpd   free   buff  cache   si   so    bi    bo   in   cs us sy id wa st gu\n 1  0 999208 3603968 353020 8258580    0    0    22   166 1016    2  4  1 94  0  0  0\n</code></pre> \u5904\u7406\u540e <pre><code>procs,-----------memory----------,---swap--,-----io----,-system--,-------cpu-------\nr,b,swpd,free,buff,cache,si,so,bi,bo,in,cs,us,sy,id,wa,st,gu\n1,0,999208,3603968,353020,8258580,0,0,22,166,1016,2,4,1,94,0,0,0\n</code></pre></p>","tags":["linux","tool"]},{"location":"blog/linux-%E6%96%87%E6%9C%AC%E5%A4%84%E7%90%86%E4%B8%89%E5%89%91%E5%AE%A2/#awk","title":"awk \u904d\u5386","text":"<p>\u6211\u4e4b\u524d\u7684awk\u901a\u5e38\u7528\u6765\u6253\u5370\u67d0\u4e00\u5217\u7684\u5185\u5bb9\uff0c\u4f8b\u5982<code>cat vmstat.dat | awk -F' ' '{print $1}'</code> \u6253\u5370$1\u7b2c\u4e00\u5217, -F\u8bbe\u5b9a\u5206\u9694\u7b26\u3002\u9664\u6b64\u4e4b\u5916\u8fd8\u80fd\u904d\u5386\u67e5\u627e\u3002 \u4f8b\u5982\u67e5\u627e'TARGET' <pre><code>awk '{for(i=1;i&lt;=NF;i++)if($i==\"TARGET\"){print \"TARGET located at row: \" NR \" col: \" i }}' \n</code></pre></p> <p>\u8fd9\u91ccNR\u8868\u793a\u5f53\u524d\u7684<code>\u884c</code>\uff0c NF\u4ee3\u8868\u5f53\u524d\u7684<code>\u5217</code>\u3002 NR\u8fd8\u53ef\u4ee5\u7528\u6765\u6307\u5b9a\u8981\u5904\u7406\u7684\u884c\u53f7\uff0c\u4f8b\u5982vmstat\u4e2d\u6709\u4e24\u4e2aheader\u3002\u4f8b\u5982 1. \u53ea\u6253\u5370\u7b2c\u4e8c\u884c\u7684\u547d\u4ee4\u662f<code>awk '(NR==2){print $0}'</code> 2. \u8981\u77e5\u9053'id'\u5728\u54ea\u4e00\u5217\uff0c\u5219\u904d\u5386\u7b2c\u4e8c\u884c\u7684\u6bcf\u4e00\u5217\u6570\u636e <code>awk '(NR==2){for(i=1;i&lt;NF;i++) if($i==\"id\"){print i}'</code> \u4f1a\u6253\u5370'15' 3. \u8981\u6253\u5370id\u8fd9\u5217\u7684\u7b2c\u4e00\u884c\u7684\u503c, <code>awk '(NR==2){for(i=1;i&lt;NF;i++) if($i==\"id\"){getline; print $i}'</code> \u4f1a\u6253\u5370'94'</p> <p>\u8981\u6253\u5370id\u8fd9\u5217\u7684\u7b2cN\u884c\u7684\u503c\u65f6\uff0c\u5c31\u5faa\u73af\u8c03\u7528getline N\u6b21\u3002</p>","tags":["linux","tool"]},{"location":"blog/linux-%E6%96%87%E6%9C%AC%E5%A4%84%E7%90%86%E4%B8%89%E5%89%91%E5%AE%A2/#python-openpyxl-excel","title":"\u4f7f\u7528python\u5e93 openpyxl \u5904\u7406excel","text":"<p>\u4f53\u9a8c\u4e86 openpyxl, \u63a5\u53e3\u8bbe\u8ba1\u975e\u5e38\u81ea\u7136\uff0c \u529f\u80fd\u4e5f\u975e\u5e38\u5168\uff0c \u5305\u62ec\u5408\u5e76\u683c\u5b50\u3001\u5b57\u4f53\u3001\u989c\u8272\u3002\u5178\u578b\u7528\u6cd5\u5982\u4e0b <pre><code>import openpyxl\n\n\nworkbook = openpyxl.load_workbook('output.xlsx')\nprint(workbook.sheetnames)\n\nsheet = workbook['Sheet']\nprint(sheet.max_row) #\u603b\u884c\u6570\nprint(sheet.max_column) #\u603b\u5217\u6570\nprint(sheet.dimensions) #\u5de6\u4e0a\u89d2:\u53f3\u4e0b\u89d2\n\ncell1 = sheet['A1']\nprint(cell1.row) #1\nprint(cell1.column) #A\nprint(cell1.coordinate) #A1\n\n# \u5355\u5143\u683c\u7684\u5185\u5bb9\nprint(cell1.value)\n\n# \u904d\u5386\n#\u5148\u884c\u540e\u5217\nfor row in sheet.iter_rows():\n  for c in row:\n    print(f\"[{c.row}][{c.column}] = {c.value}\")\n\n#\u5148\u5217\u540e\u884c\nfor col in sheet.iter_cols():\n  for r in col:\n    print(f\"[{r.row}][{r.column}] = {r.value}\")\n\n# \u4fdd\u5b58\nworkbook.save('test.xlsx')\n</code></pre></p>","tags":["linux","tool"]},{"location":"blog/linux-%E6%96%87%E6%9C%AC%E5%A4%84%E7%90%86%E4%B8%89%E5%89%91%E5%AE%A2/#_1","title":"\u63d2\u5165\u56fe\u7247","text":"<p>openpyxl\u8fd8\u80fd\u63d2\u5165\u56fe\u7247\uff0c\u611f\u89c9\u975e\u5e38\u68d2</p> <p><pre><code>from openpyxl import Workbook\nfrom openpyxl.drawing.image import Image\n\nwb = Workbook()\nws = wb.active\nws['A1'] = 'You should see three logos below'\n\n# create an image\nimg = Image('logo.png')\n\n# add to worksheet and anchor next to cells\nws.add_image(img, 'A1')\nwb.save('logo.xlsx')\n</code></pre> https://openpyxl.readthedocs.io/en/stable/images.html</p>","tags":["linux","tool"]},{"location":"blog/linux-%E6%96%87%E6%9C%AC%E5%A4%84%E7%90%86%E4%B8%89%E5%89%91%E5%AE%A2/#xlwings","title":"xlwings","text":"<p>Currently, xlwings can only run as a remote interpreter on Linux, see: https://docs.xlwings.org/en/stable/remote_interpreter.html There are plans to add read/write capabilities, but for now you have to use one of OpenPyXL, XlsxWriter, or pyxlsb,</p>","tags":["linux","tool"]},{"location":"blog/linux-%E6%96%87%E6%9C%AC%E5%A4%84%E7%90%86%E4%B8%89%E5%89%91%E5%AE%A2/#libreoffice","title":"Libreoffice","text":"<p>\u7c7b\u6bd4Excel\u4f7f\u7528vba\u6765\u7f16\u7a0b\uff0cLibreoffice sheet\u4f7f\u7528Basic\uff0c\u540c\u65f6\u4e5f\u652f\u6301 python</p> <p>\u5728chatgpt\u5e2e\u52a9\u4e0b\u5199\u4e86\u4e2aurl\u8f6c\u56fe\u7247\u7684BASIC\u811a\u672c <pre><code>REM  *****  BASIC  *****\nOption Explicit\n\nSub InsertAndResizeImages()                \n    Dim oSheet As Object\n    DIM oCell as Object \n    Dim oGraphic As Object\n    Dim i As Long\n    Dim imageURL As String\n    Dim oSize As New com.sun.star.awt.Size\n      Dim oColumns as Object\n      Dim oRows As Object\n\n\n    oSheet = ThisComponent.CurrentController.getActiveSheet()\n\n    oColumns = oSheet.getColumns()\n    oColumns.getByIndex(0).Width = 3200\n\n\n    i = 160\n    Do\n\n        oCell = oSheet.getCellByPosition(0, i)\n        oRows = oSheet.getRows()\n        oRows.getByIndex(i).Height = 3200\n\n        imageURL = oCell.String\n        If imageURL = \"\" Then Exit Do\n        'Debug.Print oCell.String\n        'MsgBox imageURL\n\n        On Error GoTo NextImage\n        oGraphic = ThisComponent.createInstance(\"com.sun.star.drawing.GraphicObjectShape\") \n        oGraphic.GraphicURL = imageURL\n        oGraphic.Position = oCell.Position\n\n        oSheet.DrawPage.add(oGraphic)\n\n        oSize.Width = 3200\n        oSize.Height = 3200\n        oGraphic.Size = oSize\n\n        Wait 500  ' Pauses for 0.5 seconds\n\n    Exit Do\nNextImage:\n        i = i + 1\n    Loop\n\nEnd Sub\n</code></pre></p>","tags":["linux","tool"]},{"location":"blog/linux-%E6%96%87%E6%9C%AC%E5%A4%84%E7%90%86%E4%B8%89%E5%89%91%E5%AE%A2/#libreoffice-python","title":"libreoffice \u4e5f\u652f\u6301 python","text":"<p>libreoffice \u7684UNO API\u662f\u72ec\u7acb\u4e8e\u7f16\u7a0b\u8bed\u8a00\u7684\uff0cBASIC\u53ef\u4ee5\u76f4\u63a5\u7528 <code>ThisComponent</code>\uff0c\u800cpython\u9700\u8981\u901a\u8fc7'XSCRIPTCONTEXT'\u6765\u7528\uff0c\u83b7\u53d6sheet\u7684BOOK\u5bf9\u8c61\u65b9\u6cd5\u662f<code>doc = XSCRIPTCONTEXT.getDocument()</code></p> <p>\u6709\u4e2aBasic\u548cPython\u7684\u5bf9\u6bd4\u5199\u6cd5\uff0c\u603b\u7ed3\u662f\u5f88\u76f8\u4f3c\u3002\u7528python\u91cd\u5199BASIC\u4ee3\u7801\u5c31\u662f</p> <pre><code>def insert_and_resize_images():\n    from com.sun.star.awt import Size\n    import time\n\n    doc = XSCRIPTCONTEXT.getDocument()\n    sheet = doc.CurrentController.ActiveSheet\n\n    columns = sheet.getColumns()\n    columns.getByIndex(0).Width = 3200\n\n    i = 160\n    while True:\n        cell = sheet.getCellByPosition(0, i)\n        rows = sheet.getRows()\n        rows.getByIndex(i).Height = 3200\n\n        image_url = cell.String\n        if image_url == \"\":\n            break\n\n        try:\n            graphic = doc.createInstance(\"com.sun.star.drawing.GraphicObjectShape\")\n            graphic.GraphicURL = image_url\n            graphic.Position = cell.Position\n\n            sheet.DrawPage.add(graphic)\n\n            size = Size()\n            size.Width = 3200\n            size.Height = 3200\n            graphic.Size = size\n\n            time.sleep(0.5)  # 0.5 seconds pause\n\n        except:\n            pass  # Continue on error\n\n        i += 1\n</code></pre> <p>\u65e0\u8bba\u662fexcel\u7684xlwings\u8fd8\u662flibreoffice sheet\u7684pyUNO, \u90fd\u4e0d\u80fd\u72ec\u7acb\u4f7f\u7528\uff0c\u90fd\u8981\u5b89\u88c5\u5957\u4ef6\u3002 </p>","tags":["linux","tool"]},{"location":"blog/udp-%E7%9A%84%E7%AB%AF%E5%8F%A3%E5%A4%8D%E7%94%A8%E5%AE%9E%E7%8E%B0%E8%B4%9F%E8%BD%BD%E5%9D%87%E8%A1%A1/","title":"udp \u7684\u7aef\u53e3\u590d\u7528\u5b9e\u73b0\u8d1f\u8f7d\u5747\u8861","text":"","tags":["socket","udp","socketopt"]},{"location":"blog/udp-%E7%9A%84%E7%AB%AF%E5%8F%A3%E5%A4%8D%E7%94%A8%E5%AE%9E%E7%8E%B0%E8%B4%9F%E8%BD%BD%E5%9D%87%E8%A1%A1/#_1","title":"\u524d\u8a00","text":"<p>\u5076\u5c14\u770b\u5230 python 3.9 \u7684release note \u91cc\u9762\u63d0\u5230\u4e00\u4e2abug <pre><code>asyncio\u00b6\n\n\u51fa\u4e8e\u91cd\u8981\u7684\u5b89\u5168\u6027\u8003\u91cf\uff0casyncio.loop.create_datagram_endpoint() \u7684 reuse_address \u5f62\u53c2\u4e0d\u518d\u88ab\u652f\u6301\u3002 \u8fd9\u662f\u7531 UDP \u4e2d\u7684\u5957\u63a5\u5b57\u9009\u9879 SO_REUSEADDR \u7684\u884c\u4e3a\u5bfc\u81f4\u7684\u3002 \u66f4\u591a\u7ec6\u8282\u8bf7\u53c2\u9605 loop.create_datagram_endpoint() \u7684\u6587\u6863\u3002 \uff08\u7531 Kyle Stanley, Antoine Pitrou \u548c Yury Selivanov \u5728 bpo-37228 \u4e2d\u8d21\u732e\u3002\u3002\uff09\n</code></pre> \u610f\u601d\u662ftcp\u7684socket option:SO_REUSEADDR\u4e0d\u9002\u7528\u4e8eudp\uff1a \u5728tcp\u4e2d\u8fd9\u4e2a\u9009\u9879\u8868\u793a\u7acb\u5373\u56de\u6536\u7aef\u53e3\uff0c\u51cf\u5c11 time_wait \u7684\u65f6\u95f4\u3002\u800c\u5728udp\u4e2d\uff0c\u8fd9\u4e2a\u9009\u9879\u8868\u793a\u591a\u4e2asocket\u53ef\u4ee5\u7ed1\u5b9a\u4e00\u4e2a\u7aef\u53e3\uff0c \u7531\u5185\u6838\u6765\u5206\u53d1\u8bf7\u6c42\u3002</p> <p>\u6240\u4ee5\u770b\u5230\u6b64\u529f\u80fd\uff0c\u81ea\u5df1\u8bd5\u4e86\u4e00\u4e0b\uff0c\u786e\u5b9e\u5982\u6b64\uff0c \u987a\u4fbf\u56de\u987e\u4e00\u4e0b\u77e5\u8bc6</p>","tags":["socket","udp","socketopt"]},{"location":"blog/udp-%E7%9A%84%E7%AB%AF%E5%8F%A3%E5%A4%8D%E7%94%A8%E5%AE%9E%E7%8E%B0%E8%B4%9F%E8%BD%BD%E5%9D%87%E8%A1%A1/#_2","title":"\u4e3b\u8981\u4ee3\u7801","text":"<pre><code>    struct sockaddr_in addr;\n    addr.sin_family = AF_INET;\n    addr.sin_port = htons(8888);\n    inet_pton(AF_INET,\"127.0.0.1\",(void*)&amp;addr.sin_addr);\n    // inet_pton \u652f\u6301ipv4\u548cipv6,\u662f\u6bd4\u8f83\u65b0\u7684\u8f6c\u6362\u51fd\u6570\n\n    sfd = socket(AF_INET, SOCK_DGRAM, IPPROTO_UDP);\n    if(sfd == -1)\n    {\n        perror(\"socket\");\n        exit(1);\n    }\n    int val = 1;\n    if(0 != setsockopt(sfd, SOL_SOCKET, SO_REUSEPORT,&amp;val, sizeof(val))){\n        perror(\"setsockopt\");\n        exit(1);\n    }\n    /* sockaddr \u548c sockaddr_in \u6709\u4ec0\u4e48\u533a\u522b\uff1f\n       struct sockaddr {  \n        sa_family_t sin_family;//\u5730\u5740\u65cf\n\u3000\u3000      char sa_data[14]; //14\u5b57\u8282\uff0c\u5305\u542b\u5957\u63a5\u5b57\u4e2d\u7684\u76ee\u6807\u5730\u5740\u548c\u7aef\u53e3\u4fe1\u606f               \n\u3000\u3000    }; \n\u3000\u3000    struct sockaddr_in {\n\u3000\u3000      sa_family_t sin_family;//\u5730\u5740\u65cf\n\u3000\u3000      uint16_t sin_port;\n\u3000\u3000      struct in_addr sin_addr;    // 32 \u4f4d\u5730\u5740\n\u3000\u3000      char    sin_zero[8];    // reserve\n\u3000\u3000    };\n\u3000\u3000    struct in_addr {\n\u3000\u3000      In_addr_t   s_addr;  //32\u4f4d\n\u3000\u3000    };\n\u3000\u3000    \n\u3000\u3000    sockaddr_in \u548c sockaddr \u957f\u5ea6\u76f8\u540c\uff0c\u90fd sin_family + 14 \u4e2a\u5b57\u8282\uff0c\u4f46\u662f\u524d\u8005\u663e\u5f0f\u5212\u5206\u4e86\n\u3000\u3000 */ \n    if(bind(sfd, (struct  sockaddr*) &amp;addr, sizeof(addr)) != 0)\n    {\n        perror(\"bind\");\n        exit(1);\n    }\n</code></pre>","tags":["socket","udp","socketopt"]},{"location":"blog/udp-%E7%9A%84%E7%AB%AF%E5%8F%A3%E5%A4%8D%E7%94%A8%E5%AE%9E%E7%8E%B0%E8%B4%9F%E8%BD%BD%E5%9D%87%E8%A1%A1/#_3","title":"\u6548\u679c","text":"<p>\u5148\u542f\u52a8\u4e24\u4e2a\u670d\u52a1\u7aef\uff0c\u518d\u4f7f\u7528ncat \u6765\u6a21\u62df\u8bf7\u6c42, </p> <pre><code>ncat -uv 0.0.0.0 8888\n</code></pre> <p>\u542f\u52a8ncat\u65f6\uff0c\u7cfb\u7edf\u4f1a\u5206\u914d\u7ed9\u4e00\u4e2a\u670d\u52a1\u7aef\u5904\u7406\u3002 \u4f46\u662f\u91cd\u542fncat\u65f6\uff0c \u4f1a\u5207\u6362\u5230\u53e6\u4e00\u4e2a\u670d\u52a1\u7aef\u5904\u7406</p>","tags":["socket","udp","socketopt"]},{"location":"blog/udp-%E6%9F%A5%E7%9C%8B%E7%BB%9F%E8%AE%A1%E7%9A%84%E6%96%B9%E6%B3%95/","title":"udp \u67e5\u770b\u7edf\u8ba1\u7684\u65b9\u6cd5","text":"<ul> <li>/proc/net/snmp</li> <li>/proc/net/udp</li> </ul> <p>\u9664\u6b64\u4e4b\u5916\uff0c\u8fd8\u6709\u901a\u5e38\u4f7f\u7528netstat/ss \u6765\u67e5\u770b\u53d1\u9001\u961f\u5217\u548c\u63a5\u6536\u961f\u5217\u7684\u7f13\u51b2\u533a\u5360\u7528\u3002</p>","tags":["debug","linux"]},{"location":"blog/udp-%E6%9F%A5%E7%9C%8B%E7%BB%9F%E8%AE%A1%E7%9A%84%E6%96%B9%E6%B3%95/#procnetsnmp","title":"/proc/net/snmp","text":"<p><pre><code>cat /proc/net/snmp | grep Udp\\:\n</code></pre> \u8f93\u51fa\u683c\u5f0f Udp: InDatagrams NoPorts InErrors OutDatagrams RcvbufErrors SndbufErrors</p> <ul> <li>InDatagrams recvmsg\u8c03\u7528\u65f6\uff0c\u503c\u4f1a\u589e\u52a0\u3002</li> <li>NoPorts \u53d1\u9001\u5230\u6ca1\u6709\u76d1\u542c\u7684\u7aef\u53e3\uff0c\u503c\u4f1a\u589e\u52a0</li> <li>InErrors \u6ca1\u6709\u5185\u5b58\uff0c\u6216\u8005checksum\u5931\u8d25</li> <li>OutDatagrams \u6210\u529f\u53d1\u9001\u5230IP\u5c42\uff0c\u6ce8\u610f\u8fd9\u4e0d\u4ee3\u8868\u5305\u6210\u529f\u53d1\u9001\u51fa\u53bb\u4e86\uff0c\u56e0\u4e3a\u5728IP\u5c42\u53ef\u80fd\u6709\u9519\u8bef\uff0c\u6bd4\u5982\u8def\u7531\u9519\u8bef\uff0c\u4f1a\u5bfc\u81f4IP\u5c42\u7684OutNoRoutes\u503c\u589e\u52a0</li> </ul>","tags":["debug","linux"]},{"location":"blog/udp-%E6%9F%A5%E7%9C%8B%E7%BB%9F%E8%AE%A1%E7%9A%84%E6%96%B9%E6%B3%95/#procnetudp","title":"/proc/net/udp","text":"<p><pre><code>cat /proc/net/udp\n</code></pre> \u8f93\u51fa\u683c\u5f0f   sl  local_address rem_address   st tx_queue rx_queue tr tm-&gt;when retrnsmt   uid  timeout inode ref pointer drops</p> <ul> <li>sl hash slot for the socket</li> <li>local_address 16\u8fdb\u5236\u7684ip.\u7aef\u53e3</li> <li>st socket state</li> <li>tx_queue \u53d1\u9001\u961f\u5217\u7684\u5185\u5b58\u5927\u5c0f</li> <li>rx_queue \u63a5\u6536\u961f\u5217\u7684\u5185\u5b58\u5927\u5c0f</li> <li>inode socket\u5bf9\u5e94\u7684inode\uff0c\u53ef\u4ee5\u5224\u65ad\u54ea\u4e2a\u8fdb\u7a0b\u6253\u5f00\u4e86\u8fd9\u4e2asocket</li> <li>drops \u53ea\u8bb0\u5f55\u4e86\u63a5\u6536\u65b9\u5411\u88ab\u4e22\u6389\u7684\u5305\uff0c\u4e0d\u5305\u62ec\u53d1\u9001\u65b9\u5411\u4e22\u6389\u7684\u5305\u3002</li> </ul>","tags":["debug","linux"]},{"location":"blog/udp-%E6%9F%A5%E7%9C%8B%E7%BB%9F%E8%AE%A1%E7%9A%84%E6%96%B9%E6%B3%95/#_1","title":"\u53c2\u8003","text":"<p>https://blog.packagecloud.io/monitoring-tuning-linux-networking-stack-sending-data/#monitoring-udp-protocol-layer-statistics</p>","tags":["debug","linux"]},{"location":"blog/%E4%BD%BF%E7%94%A8systemd-resolved%E7%9A%84mdns/","title":"\u4f7f\u7528systemd-resolved\u7684mdns","text":"<p>\u4e4b\u524d\u7684\u535a\u5ba2\u4e2d\u4f7f\u7528\u4e86avahi\u6765\u5e7f\u64ad\u672c\u673a\u7684hostname\u548c\u670d\u52a1\uff0c\u8fd9\u5bf9\u4e8e\u6253\u5370\u673a\u548c\u5176\u4ed6\u65e0\u5c4f\u8bbe\u5907\u975e\u5e38\u91cd\u8981\u3002\u800c\u8f83\u65b0\u7248\u672cLinux\u53d1\u884c\u7248\u4e2dsystemd-networkd+systemd-resolved\u540c\u6837\u80fd\u5b9e\u73b0\u6b64\u529f\u80fd</p>","tags":["mdns","network"]},{"location":"blog/%E4%BD%BF%E7%94%A8systemd-resolved%E7%9A%84mdns/#network-manager","title":"Network Manager","text":"<p>\u76ee\u524d\u4e0d\u5c11\u53d1\u884c\u7248\u9ed8\u8ba4\u7684\u7f51\u7edc\u7ba1\u7406\u5de5\u5177\u662fNetworkManager, \u9700\u8981\u5148\u5c06\u5176\u5173\u95ed\u548c\u5378\u8f7d\uff0c\u5b89\u88c5systemd-networkd\u5305</p>","tags":["mdns","network"]},{"location":"blog/%E4%BD%BF%E7%94%A8systemd-resolved%E7%9A%84mdns/#systemd-networkd","title":"\u914d\u7f6esystemd-networkd","text":"<p>networkd \u4e2d\u53ef\u4ee5\u914d\u7f6e\u7f51\u6865\uff0ctun\u7b49\u8bbe\u5907\uff0c\u4e5f\u53ef\u4ee5\u76f4\u63a5\u5728\u5176\u4e2d\u914d\u7f6edns\u548cdhcp\u7b49\uff0c\u5728\u5176\u4e2d\u52a0\u5165MulticastDNS=yes\u548cMulticast=yes\u6765\u542f\u7528mDns <pre><code>[Match]\nName=eth0\n\n[Network]\nAddress=192.168.4.42/24\nDNS=114.114.114.114\nGataway=192.168.4.1\nMulticastDNS=yes\n\n[Link]\nMulticast=yes\n</code></pre></p>","tags":["mdns","network"]},{"location":"blog/%E4%BD%BF%E7%94%A8systemd-resolved%E7%9A%84mdns/#systemd-resolved","title":"\u914d\u7f6esystemd-resolved","text":"<p>systemd-resolved\u529f\u80fd\u7c7b\u4f3c\u4e0ednsmasq, \u4ed6\u4f1a\u7ee7\u627fsystemd-networkd\u4e2d\u7684dns\u4fe1\u606f\uff0c\u4e5f\u4f1a\u8bfb\u53d6hostname\u7528\u6765\u5e7f\u64ad\uff0c\u4e00\u822c\u4e0d\u7528\u4fee\u6539\u4efb\u4f55\u914d\u7f6e\uff0c\u4e4b\u9700\u8981\u5c06\u5176stub\u6587\u4ef6\u94fe\u63a5\u5230/etc/resov.conf, \u8fd9\u6837\u8ba9\u7cfb\u7edf\u7684dns\u8bf7\u6c42\u53d1\u5230systemd-resolved</p> <pre><code># ln -sf /run/systemd/resolve/stub-resolv.conf /etc/resolv.conf\n# ls -l /etc/resolv.conf\nlrwxrwxrwx. 1 root root 37 May 22 22:03 /etc/resolv.conf -&gt; /run/systemd/resolve/stub-resolv.conf\n</code></pre>","tags":["mdns","network"]},{"location":"blog/%E4%BD%BF%E7%94%A8systemd-resolved%E7%9A%84mdns/#_1","title":"\u786e\u8ba4\u6548\u679c","text":"<p>\u901a\u8fc7<code>resolvectl status</code>\u547d\u4ee4\u53ef\u4ee5\u67e5\u770bresolve\u914d\u7f6e\uff0c\u5982\u4e0b\u5168\u5c40\u7684MulticastDNS\u662f\u542f\u7528\u7684\uff0c\u800cnetworkd\u4e2d\u7684\u914d\u7f6e\u662fper link\u7684\uff0c\u4e5f\u5904\u4e8e\u542f\u7528\u72b6\u6001\uff0cScopes\u91cc\u663e\u793a\u4e86mDNS,\u8bf4\u660e\u5176\u542f\u7528\u4e86  </p> <pre><code>      Current Scopes: DNS LLMNR/IPv4 LLMNR/IPv6 mDNS/IPv4 mDNS/IPv6\n</code></pre> <pre><code>[root@netpanc ~]# resolvectl status\nGlobal\n       LLMNR setting: yes\nMulticastDNS setting: yes\n  DNSOverTLS setting: no\n      DNSSEC setting: allow-downgrade\n    DNSSEC supported: yes\n          DNSSEC NTA: 10.in-addr.arpa\n                      16.172.in-addr.arpa\n                      168.192.in-addr.arpa\n                      17.172.in-addr.arpa\n                      18.172.in-addr.arpa\n                      19.172.in-addr.arpa\n                      20.172.in-addr.arpa\n                      21.172.in-addr.arpa\n                      22.172.in-addr.arpa\n                      23.172.in-addr.arpa\n                      24.172.in-addr.arpa\n                      25.172.in-addr.arpa\n                      26.172.in-addr.arpa\n                      27.172.in-addr.arpa\n                      28.172.in-addr.arpa\n                      29.172.in-addr.arpa\n                      30.172.in-addr.arpa\n                      31.172.in-addr.arpa\n                      corp\n                      d.f.ip6.arpa\n                      home\n                      internal\n                      intranet\n                      lan\n                      local\n                      private\n                      test\n\nLink 2 (eth0)\n      Current Scopes: DNS LLMNR/IPv4 LLMNR/IPv6 mDNS/IPv4 mDNS/IPv6\n       LLMNR setting: yes\nMulticastDNS setting: yes\n  DNSOverTLS setting: no\n      DNSSEC setting: allow-downgrade\n    DNSSEC supported: yes\n  Current DNS Server: 114.114.114.114\n         DNS Servers: 114.114.114.114\n</code></pre> <p>\u5728\u5176\u4ed6\u8bbe\u5907\u4e0aping\u53ef\u4ee5\u6210\u529f</p> <pre><code>PING netpanc.local (192.168.4.43) 56(84) bytes of data.\n64 bytes from netpanc.local (192.168.4.43): icmp_seq=1 ttl=64 time=0.350 ms\n64 bytes from netpanc.local (192.168.4.43): icmp_seq=2 ttl=64 time=0.799 ms\n64 bytes from netpanc.local (192.168.4.43): icmp_seq=3 ttl=64 time=0.733 ms\n</code></pre>","tags":["mdns","network"]},{"location":"blog/%E4%BD%BF%E7%94%A8systemd-resolved%E7%9A%84mdns/#_2","title":"\u53c2\u8003","text":"<p>https://wiki.archlinux.org/title/Systemd-resolved#mDNS</p>","tags":["mdns","network"]},{"location":"blog/virtio-nic-configure-multi-queue/","title":"virtio nic configure multi-queue","text":"<p>virtio\u865a\u62df\u51fa\u6765\u7684\u7f51\u5361\u9ed8\u8ba4\u662f\u5355\u961f\u5217\u7684\uff0cip link \u663e\u793a\u5982\u4e0b\u3002 \u591a\u6838\u7cfb\u7edf\u4e0b\uff0c\u5355\u961f\u5217\u8981\u8981\u963b\u585e\u6536\u53d1\uff0c \u5f71\u54cd\u6027\u80fd\uff0c \u591a\u961f\u5217\u53ef\u4ee5\u5e76\u53d1\uff0c\u5185\u6838\u4e5f\u652f\u6301\uff08TUN/TAP\uff09\u3002\u8fd9\u91cc\u8bb0\u5f55\u5f00\u542f\u591a\u961f\u5217\u7684\u65b9\u5f0f\u3002 \u56e0\u4e3avirtio\u7684\u9650\u5236\uff0c\u961f\u5217\u6700\u5927256\u4e2a\u3002 <pre><code>2: enp1s0: &lt;BROADCAST,MULTICAST,UP,LOWER_UP&gt; mtu 1500 qdisc fq_codel state UP mode DEFAULT group default qlen 1000\n    link/ether 52:54:00:16:b5:50 brd ff:ff:ff:ff:ff:ff\n</code></pre></p>","tags":["virtio"]},{"location":"blog/virtio-nic-configure-multi-queue/#libvirt-virsh-xml","title":"libvirt \u6216\u8005 virsh \u4fee\u6539\u7f51\u5361xml\u6587\u4ef6","text":"<pre><code>&lt;interface type='network'&gt; \n      &lt;source network='default'/&gt; \n      &lt;model type='virtio'/&gt; \n+     &lt;driver name='vhost' queues='N'/&gt; \n&lt;/interface&gt; \n</code></pre>","tags":["virtio"]},{"location":"blog/virtio-nic-configure-multi-queue/#qemu","title":"qemu","text":"<pre><code>qemu-kvm -netdev tap,id=hn0,queues=N -device virtio-net-pci,netdev=hn0,vectors=2M+2 ...\n</code></pre>","tags":["virtio"]},{"location":"blog/virtio-nic-configure-multi-queue/#openstack","title":"openstack","text":"<pre><code>openstack image set &lt;IMG_ID&gt; --property hw_vif_multiqueue_enabled=true\n</code></pre>","tags":["virtio"]},{"location":"blog/virtio-nic-configure-multi-queue/#_1","title":"\u9a8c\u8bc1","text":"<p>ip link \u7684\u8f93\u51fa\u591a\u4e86mq <pre><code>$ ip link\n2: enp1s0: &lt;BROADCAST,MULTICAST,UP,LOWER_UP&gt; mtu 1500 qdisc mq state UP mode DEFAULT group default qlen 1000    \n\n$ ethtool -l enp1s0\nChannel parameters for enp1s0:\nPre-set maximums:\nRX:             0\nTX:             0\nOther:          0\nCombined:       256\nCurrent hardware settings:\nRX:             0\nTX:             0\nOther:          0\nCombined:       40\n</code></pre></p>","tags":["virtio"]},{"location":"blog/virtio-nic-configure-multi-queue/#_2","title":"\u53c2\u8003","text":"<p>https://docs.paloaltonetworks.com/vm-series/10-1/vm-series-deployment/set-up-the-vm-series-firewall-on-kvm/performance-tuning-of-the-vm-series-for-kvm/enable-multi-queue-support-for-nics-on-kvm https://cloud.vk.com/docs/en/computing/iaas/how-to-guides/vm-multiqueue https://www.linux-kvm.org/page/Multiqueue</p>","tags":["virtio"]},{"location":"blog/%E4%B8%BB%E8%A6%81%E6%94%B6%E9%9B%86%E4%B8%80%E4%BA%9B%E5%B8%B8%E8%A7%81%E7%BC%BA%E9%99%B7%E5%92%8C%E5%8A%A0%E5%9B%BA%E6%96%B9%E6%B3%95/","title":"\u4e3b\u8981\u6536\u96c6\u4e00\u4e9b\u5e38\u89c1\u7f3a\u9677\u548c\u52a0\u56fa\u65b9\u6cd5","text":"","tags":["safety"]},{"location":"blog/%E4%B8%BB%E8%A6%81%E6%94%B6%E9%9B%86%E4%B8%80%E4%BA%9B%E5%B8%B8%E8%A7%81%E7%BC%BA%E9%99%B7%E5%92%8C%E5%8A%A0%E5%9B%BA%E6%96%B9%E6%B3%95/#javascript","title":"javascript","text":"<ol> <li>xss\u6f0f\u6d1e\uff1a \u5728\u8f93\u5165\u6846\u6ce8\u5165\u4ee3\u7801\u5982 <code>&lt;script&gt; alert(1)&lt;/script&gt;</code>  \u89e3\u51b3\u529e\u6cd5\u662f\u6821\u9a8c\u8f93\u5165</li> </ol>","tags":["safety"]},{"location":"blog/cmake-%E4%BD%BF%E7%94%A8%E7%AC%AC%E4%B8%89%E6%96%B9%E5%BA%93/","title":"cmake \u4f7f\u7528\u7b2c\u4e09\u65b9\u5e93","text":"<p>\u5728\u9879\u76ee\u4e2d\u94fe\u63a5\u7b2c\u4e09\u65b9\u5e93\u7684\u65b9\u6cd5\u90fd\u662f'target_include_directories' \u548c 'target_link_library', \u524d\u63d0\u5f15\u5165\u7b2c\u4e09\u65b9\u5305. \u800c\u67e5\u627e\u53ef\u4ee5\u4f7f\u7528<code>find_package</code></p>","tags":["cmake"]},{"location":"blog/cmake-%E4%BD%BF%E7%94%A8%E7%AC%AC%E4%B8%89%E6%96%B9%E5%BA%93/#find_package","title":"find_package\u627e\u5305","text":"<p>find_package\u5206\u4e3aModule\u548cConfig\u4e24\u79cd\u65b9\u5f0f</p>","tags":["cmake"]},{"location":"blog/cmake-%E4%BD%BF%E7%94%A8%E7%AC%AC%E4%B8%89%E6%96%B9%E5%BA%93/#module","title":"Module\u65b9\u5f0f","text":"<p>find_package\u5148\u5728'/usr/share/cmake/Modules/Find/'\u4e0b\u6dfb\u52a0FindXXX.cmake\u6587\u4ef6\uff0c\u4ee5\u53ca\u81ea\u5b9a\u4e49\u8def\u5f84(CMAKE_MODULE_PATH)\u4e0b\u67e5\u627e \u7136\u540e\u5728\u9879\u76ee\u7684CMakeList.txt\u4e2d\u4f7f\u7528find_package(), \u7136\u540e\u53ef\u4ee5\u5728\u94fe\u63a5\u7684\u65f6\u5019\u4f7f\u7528\u7b2c\u4e09\u65b9\u5e93</p> <pre><code>find_package()\n</code></pre>","tags":["cmake"]},{"location":"blog/cmake-%E4%BD%BF%E7%94%A8%E7%AC%AC%E4%B8%89%E6%96%B9%E5%BA%93/#config","title":"Config\u6a21\u5f0f","text":"<p>\u5f53find_package\u627e\u4e0d\u5230FindXXX.cmake\u6587\u4ef6\uff0c\u5219\u4f1a\u627e - Config.cmake - -config.cmake <p>\u5982\u679c\u7b2c\u4e09\u65b9\u9879\u76ee\u652f\u6301cmake, \u90a3\u4e48\u5148\u901a\u8fc7cmake\u7f16\u8bd1\u548c\u5b89\u88c5\u5230\u73af\u5883\u6216\u8005docker\u73af\u5883\uff0c\u8fd9\u65f6\u4f1a\u5728'/usr/lib/cmake//'\u4e0b\u6dfb\u52a0\u4e0a\u8ff0\u6587\u4ef6","tags":["cmake"]},{"location":"blog/cmake-%E4%BD%BF%E7%94%A8%E7%AC%AC%E4%B8%89%E6%96%B9%E5%BA%93/#findxxxcmake","title":"\u5b89\u88c5FindXXX.cmake\u6587\u4ef6","text":"<p>\u5f53\u6ca1\u6709FindXXX.cmake\u65f6\uff0c\u53ef\u4ee5\u4f7f\u7528\u5b89\u88c5\u5305\u7ba1\u7406\u5de5\u5177\u5b89\u88c5cmake-extra\u5305, \u53ef\u80fd\u627e\u5230\u9700\u8981\u7684 <pre><code>$ pacman -S extra-cmake-modules\n</code></pre></p> <p>\u7136\u540e\u6267\u884c\u4e0b\u9762\u7684\u547d\u4ee4\uff0c\u53ef\u4ee5\u770b\u5230\u5927\u91cf\u7684'Find*.cmake'\u6587\u4ef6 <pre><code>ls /usr/share/cmake-3.20/Modules/\n</code></pre></p>","tags":["cmake"]},{"location":"blog/cmake-%E4%BD%BF%E7%94%A8%E7%AC%AC%E4%B8%89%E6%96%B9%E5%BA%93/#findxxxcmake_1","title":"\u81ea\u5b9a\u4e49FindXXX.cmake\u6587\u4ef6","text":"<p>\u5982\u679c\u4e0a\u8ff0\u65b9\u5f0f\u90fd\u4e0d\u884c\uff0c\u90a3\u4e48\u9700\u8981\u81ea\u5df1\u5199FindXXX.cmake\uff0c\u653e\u5230CMAKE_MODULE_PATH\u4e0b \u4f8b\u5982\u5728\u9879\u76ee\u6839\u76ee\u5f55\u521b\u5efa\u6587\u4ef6\u5939<code>cmake_module</code>, \u518d\u4f7f\u7528<code>set(CMAKE_MODULE_PATH ${CMAKE_SOURCE_DIR}/cmake_module)</code>\u6765\u6307\u5b9amodule\u7684\u8def\u5f84  \u6700\u540e\u5728'cmake_module'\u4e0b\u521b\u5efaFindXXX.cmake\u7ed3\u5c3e\u7684\u6587\u4ef6\uff0c\u8fd9\u4e2a\u6587\u4ef6\u7528\u6765\u5199\u627eheader\u548clib\u89c4\u5219, \u5185\u5bb9\u5927\u81f4\u4e3a</p> <pre><code>find_path(Grpc_INCLUDE_DIR grpc++/grpc++.h)\nmark_as_advanced(Grpc_INCLUDE_DIR)\n\nfind_library(Grpc++_LIBRARY NAMES grpc++ grpc++-1-dll)\nmark_as_advanced(Grpc++_LIBRARY)\n</code></pre> <p>\u6709\u8fd9\u4e2a\u6587\u4ef6\u4e4b\u540e\uff0c\u53ef\u4ee5\u5728\u9879\u76ee\u7684cmake\u4e2d\u76f4\u63a5\u4f7f\u7528<code>find_package()</code></p>","tags":["cmake"]},{"location":"blog/cmake-%E4%BD%BF%E7%94%A8%E7%AC%AC%E4%B8%89%E6%96%B9%E5%BA%93/#_1","title":"\u6e90\u4ee3\u7801\u7f16\u8bd1\u94fe\u63a5","text":"<p>\u5c06\u7b2c\u4e09\u65b9\u5e93\u6e90\u7801\u653e\u5230\u9879\u76ee\u6307\u5b9a\u76ee\u5f55\u5982third</p> <ol> <li>\u653e\u5230third\u76ee\u5f55\u5e76\u53ef\u4ee5\u4f7f\u7528<code>git submodule</code>\u7ba1\u7406</li> <li>\u5728thrid\u76ee\u5f55\u6dfb\u52a0CMakeList.txt\uff0c\u5728\u5176\u4e2d\u6dfb\u52a0\u76ee\u6807\uff0c\u5df2\u5907\u5728\u9879\u76ee\u4e2d\u94fe\u63a5 <pre><code># for gsl-lite target\nadd_library(gsl-lite INTERFACE)\ntarget_include_directories(gsl-lite SYSTEM INTERFACE ${CMAKE_CURRENT_SOURCE_DIR}/gsl-lite/include)\n</code></pre></li> </ol>","tags":["cmake"]},{"location":"blog/cmake-%E4%BD%BF%E7%94%A8%E7%AC%AC%E4%B8%89%E6%96%B9%E5%BA%93/#fetchcontent","title":"FetchContent \u81ea\u52a8\u6e90\u4ee3\u7801\u94fe\u63a5","text":"<p>cmake3.11\u4e4b\u540e\uff0c\u53ef\u4ee5\u4f7f\u7528\u8fd9\u4e2a\u529e\u6cd5\u6765\u81ea\u52a8\u62c9\u53d6\u7f51\u4e0a\u7684\u5e93\uff0c\u5e76\u53ef\u4ee5\u76f4\u63a5\u5728\u81ea\u5df1\u7684\u9879\u76ee\u4e2d\u4f7f\u7528</p> <pre><code># NOTE: This example uses cmake version 3.14 (FetchContent_MakeAvailable).\n# Since it streamlines the FetchContent process\ncmake_minimum_required(VERSION 3.14)\n\ninclude(FetchContent)\n\n# In this example we are picking a specific tag.\n# You can also pick a specific commit, if you need to.\nFetchContent_Declare(GSL\n    GIT_REPOSITORY \"https://github.com/microsoft/GSL\"\n    GIT_TAG \"v3.1.0\"\n)\n\nFetchContent_MakeAvailable(GSL)\n\n# Now you can link against the GSL interface library\nadd_executable(foobar)\n\n# Link against the interface library (IE header only library)\ntarget_link_libraries(foobar PRIVATE GSL)\n</code></pre>","tags":["cmake"]},{"location":"blog/cmake-%E4%BD%BF%E7%94%A8%E7%AC%AC%E4%B8%89%E6%96%B9%E5%BA%93/#cmakeopenssl","title":"cmake\u4f7f\u7528openssl\u5b58\u5728\u95ee\u9898","text":"<p>\u56e0\u4e3aopenssl\u4e0d\u7528cmake,\u4e5f\u5c31\u6ca1\u6709.cmake\u6587\u4ef6, \u5bfc\u81f4\u9879\u76ee\u914d\u7f6e\u5931\u8d25  <pre><code> Could NOT find OpenSSL, try to set the path to OpenSSL root folder in the\n  system variable OPENSSL_ROOT_DIR (missing: OPENSSL_LIBRARIES\n  OPENSSL_INCLUDE_DIR)\n</code></pre> \u540e\u9762\u53d1\u73b0\u5b83\u662f\u4f7f\u7528package_config\u65b9\u5f0f <pre><code>#/usr/local/lib/pkgconfig/openssl.pc\nprefix=/usr\nexec_prefix=${prefix}\nlibdir=${exec_prefix}/lib\nincludedir=${prefix}/include\n\nName: OpenSSL\nDescription: Secure Sockets Layer and cryptography libraries and tools\nVersion: 1.1.1k\nRequires: libssl libcrypto\n</code></pre></p> <p>\u8fd9\u79cd\u60c5\u51b5\u9664\u4e86\u901a\u8fc7cmake_module\u6765\u89e3\u51b3\u4e4b\u5916\uff0c\u8fd8\u53ef\u4ee5\u901a\u8fc7\u6307\u5b9apc\u6587\u4ef6\u7684\u8def\u5f84 <pre><code>cmake -DOPENSSL_ROOT_DIR=/usr/local/ \n</code></pre></p>","tags":["cmake"]},{"location":"blog/cmake-%E4%BD%BF%E7%94%A8%E7%AC%AC%E4%B8%89%E6%96%B9%E5%BA%93/#externalproject_add","title":"ExternalProject_Add","text":"<p>\u8fd9\u4e2a\u4e0d\u5e38\u7528</p>","tags":["cmake"]},{"location":"blog/cmake-%E4%BD%BF%E7%94%A8%E7%AC%AC%E4%B8%89%E6%96%B9%E5%BA%93/#find_package-find_library","title":"find_package \u548c find_library \u533a\u522b","text":"<p>find_library \u662fcmake\u7684\u5e95\u5c42\u65b9\u6cd5\uff0c\u5728find_path\u6307\u5b9a\u7684\u76ee\u5f55\u4e0b\u67e5\u627e\u5e93\u6587\u4ef6  \u800cfind_package \u4f7f\u7528\u4e86find_library\u7684\u6765\u627e\u5e93\u6587\u4ef6\uff0c\u800c\u4e14find_package\u5728\u627e\u5230\u76ee\u6807\u540e\uff0c\u4f1a\u5b9a\u4e49\u4e00\u4e9b\u53d8\u91cf\uff0c\u5982\u4e0b\u9762\u7684'Findlibproxy.cmake'\u6587\u4ef6\u5934</p> <pre><code># - Try to find libproxy\n# Once done this will define\n#\n#  LIBPROXY_FOUND - system has libproxy\n#  LIBPROXY_INCLUDE_DIR - the libproxy include directory\n#  LIBPROXY_LIBRARIES - libproxy library\n#\n# Copyright (c) 2010, Dominique Leuenberger\n#\n# Redistribution and use is allowed according the license terms\n# of libproxy, which this file is integrated part of.\n\n# Find proxy.h and the corresponding library (libproxy.so)\nFIND_PATH(LIBPROXY_INCLUDE_DIR proxy.h )\nFIND_LIBRARY(LIBPROXY_LIBRARIES NAMES proxy )\n</code></pre> <p>\u5f53\u627e\u5230libproxy.so\u7684\u65f6\u5019\uff0cLIBPROXY_FOUND\u88ab\u8bbe\u7f6e\u4e3aTRUE\u7b49</p>","tags":["cmake"]},{"location":"blog/weechat-%E4%BD%BF%E7%94%A8%E6%96%B9%E6%B3%95/","title":"weechat \u4f7f\u7528\u65b9\u6cd5","text":"<p>weechat \u662f\u4e00\u4e2airc\u5ba2\u6237\u7aef\uff0c \u5728\u7ec8\u7aef\u4e2d\u8fd0\u884c\uff0c\u4e0d\u9700\u8981gui\u684c\u9762\uff0c\u975e\u5e38\u65b9\u4fbf\u3002 \u8fd9\u91cc\u8bb0\u5f55\u914d\u7f6e\u65b9\u6cd5</p> <p>\u4e3b\u8981\u53c2\u8003\u94fe\u63a5</p>","tags":["tool","irc"]},{"location":"blog/weechat-%E4%BD%BF%E7%94%A8%E6%96%B9%E6%B3%95/#weechat_1","title":"\u5b89\u88c5\u548c\u8fd0\u884cweechat","text":"<p>\u5b89\u88c5\u540e\uff0c\u76f4\u63a5\u5728\u7ec8\u7aef\u8fd0\u884c<code>weechat</code>\uff0c\u5c31\u80fd\u8fdb\u5165weechat</p>","tags":["tool","irc"]},{"location":"blog/weechat-%E4%BD%BF%E7%94%A8%E6%96%B9%E6%B3%95/#_1","title":"\u914d\u7f6e","text":"","tags":["tool","irc"]},{"location":"blog/weechat-%E4%BD%BF%E7%94%A8%E6%96%B9%E6%B3%95/#server","title":"\u6dfb\u52a0server","text":"<p>irc\u6709\u5f88\u591aserver, \u5e38\u7528\u7684\u662ffreenode\u3002 \u53e6\u5916\u6709darkscience\u3002 \u6dfb\u52a0\u65b9\u6cd5\u5982\u4e0b\uff0c\u53e6\u5916weechat\u91cc\u9762\u547d\u4ee4\u90fd\u662f\u4ee5'/' \u5f00\u5934\uff0c\u8fd8\u80fd\u4f7f\u7528tab\u8865\u5168 <pre><code>/server add freenode chat.freenode.net/6697 -ssl\n</code></pre> irc \u9664\u4e86\u6709\u5f88\u591a\u670d\u52a1\u5668url, \u6bcf\u4e2aurl \u8fd8\u6709\u591a\u4e2a\u7aef\u53e3\u4f9b\u94fe\u63a5\uff0c\u6bd4\u59826697</p>","tags":["tool","irc"]},{"location":"blog/weechat-%E4%BD%BF%E7%94%A8%E6%96%B9%E6%B3%95/#_2","title":"\u8bbe\u7f6e\u6635\u79f0","text":"<p>\u6635\u79f0\u9ed8\u8ba4\u662flinux\u7cfb\u7edf\u7684\u7528\u6237\u540d\uff0c\u6635\u79f0\u7528\u6765\u5728\u804a\u5929\u4e2d\u663e\u793a\u540d\u79f0 <pre><code>/nick mynickname\n</code></pre> **\u6ce8\u610f\uff1a \u624b\u52a8\u4fee\u6539\u6635\u79f0\u4e0d\u662f\u7b80\u5355\u7684\u4e8b\u60c5\uff0c\u7279\u522b\u662f\u5f53\u5df2\u7ecf\u8fde\u63a5serer\u65f6\u3002 \u6bd4\u8f83\u65b9\u4fbf\u7684\u529e\u6cd5\u5c31\u662f\u76f4\u63a5\u6539\u914d\u7f6e\u6587\u4ef6 <pre><code># \uff5e/.weechat/irc.conf\nnicks = \"malloy,malloy1,malloy2\"\n</code></pre> \u5e26\u540e\u7f00\u7684\u6635\u79f0\u7528\u6765\u5f53malloy\u5360\u7528\u65f6\u7684\u5907\u7528\uff0c\u6bd4\u5982\u7f51\u7edc\u91cd\u8fde\u65f6\u6635\u79f0\u6709\u51b2\u7a81\u5c31\u9700\u8981\u5907\u7528\u6635\u79f0</p>","tags":["tool","irc"]},{"location":"blog/weechat-%E4%BD%BF%E7%94%A8%E6%96%B9%E6%B3%95/#_3","title":"\u6ce8\u518c\u6635\u79f0","text":"<p>\u56e0\u4e3a\u6709\u5f88\u591a\u804a\u5929\u5ba4\u8981\u6c42\u6ce8\u518c\u540e\u624d\u80fd\u8fdb\u5165\uff0c\u6240\u4ee5\u5148\u8981\u4f7f\u7528\u90ae\u7bb1\u6ce8\u518c <pre><code>/msg nickserv register userpassword example@email\n</code></pre></p> <p>\u7136\u540eirc \u4f1a\u63d0\u793a\u67e5\u6536\u90ae\u4ef6\uff0c\u5728\u90ae\u4ef6\u91cc\u9762\u63d0\u793a\u4f60\u5728irc\u8f93\u5165\u547d\u4ee4\u5b8c\u6210\u6ce8\u518c</p>","tags":["tool","irc"]},{"location":"blog/weechat-%E4%BD%BF%E7%94%A8%E6%96%B9%E6%B3%95/#_4","title":"\u52a0\u5165\u804a\u5929\u5ba4","text":"<p>\u804a\u5929\u5ba4\u90fd\u662f\u4ee5#\u5f00\u5934\uff0c\u4f8b\u5982\u6211\u4f7f\u7528\u7684 '#archlinuxcn' <pre><code>/join #weechat\n</code></pre></p>","tags":["tool","irc"]},{"location":"blog/weechat-%E4%BD%BF%E7%94%A8%E6%96%B9%E6%B3%95/#_5","title":"\u9000\u51fa\u804a\u5929\u5ba4","text":"<p><pre><code>/parted \"leave message\"\n</code></pre> \u6216\u8005 <pre><code>/close\n</code></pre></p>","tags":["tool","irc"]},{"location":"blog/weechat-%E4%BD%BF%E7%94%A8%E6%96%B9%E6%B3%95/#_6","title":"\u81ea\u52a8\u8bbe\u7f6e","text":"<p>\u8bbe\u7f6e\u6253\u5f00weechat\u65f6\uff0c\u81ea\u52a8\u767b\u9646\u548c\u81ea\u52a8\u8fdb\u5165\u804a\u5929\u5ba4</p> <pre><code>/set irc.server.freenode.autoconnect on\n/set irc.server.networkname.autojoin \"#channel1,#channel2\"\n</code></pre>","tags":["tool","irc"]},{"location":"blog/weechat-%E4%BD%BF%E7%94%A8%E6%96%B9%E6%B3%95/#_7","title":"\u754c\u9762\u8bbe\u7f6e","text":"<p>\u5148\u4ecb\u7ecdweechat\u7684\u5404\u540d\u79f0\u5bf9\u5e94\u547d\u4ee4 :  \u804a\u5929\u5ba4\u79f0\u4e3abuffer, \u5207\u6362\u804a\u5929\u5ba4\u547d\u4ee4 <code>/buffer n</code> \u6700\u5de6\u8fb9\u7684\u804a\u5929\u5217\u8868\u662fbufferlist bar \u8fdb\u5165buffer\u540e\uff0c\u6700\u53f3\u8fb9\u7684\u662fnicklist bar\uff0c\u4e00\u4e2a\u804a\u5929\u5ba4\u754c\u9762\u53eb\u505awindow\uff0c \u6240\u4ee5\u4e0b\u9762\u7684\u547d\u4ee4\u8bbe\u7f6e\u5c31\u4e0e /bar /windows \u6709\u5173</p> <p>\u9690\u85cf\u548c\u663e\u793abufferlist <pre><code>/bar hiden bufferlist \n/bar show bufferlist\n/bar toggle bufferlist\n</code></pre> \u5206\u5c4f\u663e\u793a\u6240\u6709\u804a\u5929\u5ba4\uff0c\u6c34\u5e73\u5206\u5c4fsplith,\u7ad6\u76f4\u5206\u5c4f splitev <pre><code>/window splitv \n</code></pre> \u7a97\u53e3\u5207\u6362 <pre><code>/window +1\n/window -1\n</code></pre> \u7a97\u53e3\u5408\u5e76 <pre><code>/window merge\n</code></pre></p>","tags":["tool","irc"]},{"location":"blog/weechat-%E4%BD%BF%E7%94%A8%E6%96%B9%E6%B3%95/#_8","title":"\u5b89\u5168\u8bbe\u7f6e","text":"<ol> <li>\u4e0a\u9762\u6dfb\u52a0\u670d\u52a1\u5668\u65f6\uff0c\u5df2\u7ecf\u914d\u7f6e\u4e86ssl\u9009\u9879\uff0c\u5c31\u8868\u793a\u4f7f\u7528\u901a\u8baf\u52a0\u5bc6\u4e86\uff0c\u4f46irc\u7684\u804a\u5929\u8bb0\u5f55\u4e00\u822c\u662f\u5bf9\u5916\u516c\u5f00\u7684  </li> <li>\u8bbe\u7f6eweechat\u5f00\u542f\u5bc6\u7801\uff0c \u8fdb\u5165weechat\u524d\u9a8c\u5bc6 <pre><code>/secure passphrase superSecretPassphrase\n</code></pre></li> </ol>","tags":["tool","irc"]},{"location":"blog/weechat-%E4%BD%BF%E7%94%A8%E6%96%B9%E6%B3%95/#_9","title":"\u81ea\u52a8\u5316\u8bbe\u7f6e\u548c\u9274\u6743","text":"<p>\u6ce8\u518c\u597d\u6635\u79f0\u4e4b\u540e\uff0c\u914d\u7f6e\u81ea\u52a8\u5316\u767b\u9646\uff0c\u800c\u4e0d\u9700\u8981\u624b\u52a8\u6267\u884c\u547d\u4ee4</p> <p>\u8bbe\u7f6eirc\u767b\u9646\u6635\u79f0\uff0c\u4f5c\u4e3aidentify\u7684\u53c2\u6570\uff0c\u52a1\u5fc5\u8981\u8ddfregister\u7684\u4fdd\u6301\u4e00\u81f4 <pre><code>/secure set networkname_nickname password\n</code></pre> \u8bbe\u7f6eirc\u767b\u9646\u5bc6\u7801\uff0c\u4f5c\u4e3aidentify\u7684\u53c2\u6570\uff0c\u52a1\u5fc5\u8981\u8ddfregister\u7684\u5bc6\u7801\u4fdd\u6301\u4e00\u81f4 <pre><code>/secure set networkname_password password\n</code></pre></p> <p>\u8bbe\u7f6eweechat\u542f\u52a8\u65f6\u81ea\u52a8\u767b\u9646\u670d\u52a1\u5668\uff0c\u4ee5\u53ca\u81ea\u52a8\u52a0\u5165channel <pre><code>/set irc.server.libera.autoconnect on\n/set irc.server.libera.autojoin \"#archlinux-cn,#c,#c++\"\n</code></pre> \u4ee5\u53ca\u81ea\u52a8\u9a8c\u5bc6 <pre><code>/set irc.server.networkname.command \"/msg nickserv identify ${sec.data.networkname_nickname} ${sec.data.network_password}\"\n</code></pre> \u5176\u5b9e\u663e\u800c\u6613\u89c1\u5730\uff0c<code>sec.data.networkname_nickname</code>\u548c<code>sec.data.network_password</code> \u90fd\u53ea\u662f\u4fdd\u5b58\u5728sec.data\u91cc\u7684\u53d8\u91cf\uff0c\u5176\u5b9e\u53ef\u4ee5\u4e24\u4e2a\u53d8\u91cf\u5408\u6210\u4e00\u6761\u4e5f\u6ca1\u95ee\u9898</p>","tags":["tool","irc"]},{"location":"blog/weechat-%E4%BD%BF%E7%94%A8%E6%96%B9%E6%B3%95/#_10","title":"\u66f4\u591a\u529f\u80fd","text":"<p>weechat\u6709\u5f88\u591a\u62d3\u5c55\u63d2\u4ef6\uff0c\u53ef\u4ee5\u5b8c\u6210\u5f88\u591a\u4e8b\u60c5\uff0c\u6bd4\u5982\u81ea\u52a8\u56de\u590d\uff0c\u8fdc\u7a0b\u63a7\u5236\uff0c\u8fde\u63a5telegram\u7b49, \u53c2\u8003</p>","tags":["tool","irc"]},{"location":"blog/%E9%9A%8F%E8%BA%ABwifi%E5%B7%A5%E5%85%B7%E5%88%B7%E6%9C%BA/","title":"\u968f\u8eabwifi\u5de5\u5177\u5237\u673a","text":"<p>\u672c\u6587\u8bb0\u5f55\u4e86\u6dd8\u5b9d\u5356\u7684\u968f\u8eabwifi\u5237\u673a\u6210Debian\uff0c\u8fd8\u80fd\u6536\u53d1\u77ed\u4fe1\u3002\u8fd8\u6709\u6551\u7816\u7684\u8270\u8f9b\u8fc7\u7a0b\uff0c\u4e0d\u8fc7\u7ed3\u5c40\u7f8e\u6ee1\u3002</p>","tags":["debian","tool"]},{"location":"blog/%E9%9A%8F%E8%BA%ABwifi%E5%B7%A5%E5%85%B7%E5%88%B7%E6%9C%BA/#_1","title":"\u4f9d\u8d56","text":"<ul> <li>edl\u5907\u4efd\u6062\u590d\u5de5\u5177\uff0chttps://github.com/bkerler/edl, \u4e0b\u8f7d\u6e90\u4ee3\u7801\u540e\u6267\u884c<code>git submodule update --init --recursive</code>\u548c <code>pip install -r requirements.txt</code></li> <li>openstick\u7f16\u8bd1\u597d\u7684debian https://github.com/OpenStick/OpenStick\u3002 \u5728release\u9875\u9762\u4e0b\u8f7d base.zip, debian.zip, firmware-ufi001c.zip\uff0cboot-ufi001c.img</li> <li>apt \u5b89\u88c5 adb fastboot</li> </ul>","tags":["debian","tool"]},{"location":"blog/%E9%9A%8F%E8%BA%ABwifi%E5%B7%A5%E5%85%B7%E5%88%B7%E6%9C%BA/#_2","title":"\u5207\u5361","text":"<p>\u521a\u63a5\u89e6\u65f6\u770b\u7f51\u4e0a\u7684\u90fd\u662f\u5728\u540e\u53f0\u9875\u9762\u5207\u5361\uff0c\u4f46\u662f\u5237\u673a\u4e86\u6ca1\u6709\u540e\u53f0\u9875\u9762\u5982\u4f55\u5207\u5361\u5462\uff1f \u4e3a\u4e86\u5207\u5361\u53c8\u91cd\u5237\u5b89\u5353\uff0c\u5bfc\u81f4\u53d8\u7816\u4e86\u3002\u53c2\u8003\u7f51\u4e0a\u8d44\u6599\u53d1\u73b0\uff0cDebian\u4e0b\u53ef\u4ee5\u76f4\u63a5\u5207\u3002 <pre><code>debian\u9ed8\u8ba4\u5361\u69fd\u4f4d1:\n\necho 1 &gt; /sys/class/leds/sim:sel/brightness\necho 0 &gt; /sys/class/leds/sim:en/brightness\necho 0 &gt; /sys/class/leds/sim:sel2/brightness\necho 0 &gt; /sys/class/leds/sim:en2/brightnessR\nmodprobe -r qcom-q6v5-mss\nmodprobe qcom-q6v5-mss\nsystemctl restart rmtfs\nsystemctl restart dbus-org.freedesktop.ModemManager1.service\n\nesim\u69fd\u4f4d3:\n\necho 0 &gt; /sys/class/leds/sim:sel/brightness\necho 0 &gt; /sys/class/leds/sim:en/brightness\necho 1 &gt; /sys/class/leds/sim:sel2/brightness\necho 0 &gt; /sys/class/leds/sim:en2/brightness\nmodprobe -r qcom-q6v5-mss\nmodprobe qcom-q6v5-mss\nsystemctl restart rmtfs\nsystemctl restart dbus-org.freedesktop.ModemManager1.service\n\n\u5176\u4ed6\u4e24\u4e2a\u69fd\u4f4d\n\n\u69fd\u4f4d2:\n\necho 0 &gt; /sys/class/leds/sim:sel/brightness\necho 1 &gt; /sys/class/leds/sim:en/brightness\necho 0 &gt; /sys/class/leds/sim:sel2/brightness\necho 0 &gt; /sys/class/leds/sim:en2/brightness\nmodprobe -r qcom-q6v5-mss\nmodprobe qcom-q6v5-mss\nsystemctl restart rmtfs\nsystemctl restart dbus-org.freedesktop.ModemManager1.service\n\n\u69fd\u4f4d4:\necho 0 &gt; /sys/class/leds/sim:sel/brightness\necho 0 &gt; /sys/class/leds/sim:en/brightness\necho 0 &gt; /sys/class/leds/sim:sel2/brightness\necho 1 &gt; /sys/class/leds/sim:en2/brightness\nmodprobe -r qcom-q6v5-mss\nmodprobe qcom-q6v5-mss\nsystemctl restart rmtfs\nsystemctl restart dbus-org.freedesktop.ModemManager1.service\n\n\u6709\u4e9b\u68d2\u5b50esim\u69fd\u4f4d\u4e0d\u4e00\u6837\u69fd\u4f4d3\u4e0d\u884c\u81ea\u884c\u8bd5\u8bd5\u69fd\u4f4d2 4\n</code></pre> https://github.com/OpenStick/OpenStick/issues/49#issuecomment-1568202001</p>","tags":["debian","tool"]},{"location":"blog/%E9%9A%8F%E8%BA%ABwifi%E5%B7%A5%E5%85%B7%E5%88%B7%E6%9C%BA/#_3","title":"\u5237\u673a","text":"<p>\u5148\u4f7f\u7528edl\u5168\u91cf\u5907\u4efd\uff0c\u65b9\u6cd5\u5728\u6700\u4e0b\u9762\u3002\u5148\u5237base\u5305\uff0c\u89e3\u538bbase.zip\u540e\u6267\u884c\u91cc\u9762\u7684<code>flash.sh</code>\u3002\u7136\u540e\u5237debian\u5305\uff0c\u89e3\u538bdebian.zip\u540e\u6267\u884c\u91cc\u9762\u7684<code>flash.sh</code>\u3002\u8fd9\u65f6\u8fdb\u5165\u7cfb\u7edf\u53d1\u73b0\u53ef\u80fd\u51fa\u73b0\u95ee\u9898\uff08\u6211\u4e5f\u6ca1\u660e\u663e\u611f\u89c9\u5230\u95ee\u9898\uff09\uff0c\u56e0\u4e3a\u4ed6\u4eec\u662fufi001b\u7684\u3002 \u6240\u4ee5\u518d\u5237\u9002\u914dufi001c\u7684\u5305\uff0c\u89e3\u538bfirmware-ufi001c.zip\u3002 <pre><code>cd firmware-ufi001c\nadb push ./* /lib/firmware\nadb reboot bootloader\nfastboot flash boot boot-ufi001c.img\nfastboot reboot\n</code></pre> \u4f46\u662f\u5728\u5237ufi001c\u7684\u5305\u4e4b\u524d\u6211\u80fd\u627e\u5230modem\u7f51\u7edc\uff0c\u5237\u5b8c\u5c31\u6ca1\u4e86\uff0c\u6240\u4ee5\u6709\u4e86\u4e0b\u9762\u57fa\u5e26\u6062\u590d\u7684\u6b65\u9aa4\u3002</p>","tags":["debian","tool"]},{"location":"blog/%E9%9A%8F%E8%BA%ABwifi%E5%B7%A5%E5%85%B7%E5%88%B7%E6%9C%BA/#_4","title":"\u57fa\u5e26","text":"<p>\u57fa\u5e26\u6587\u4ef6\u5728\u968f\u8eabwifi\u7684modem\u5206\u533a\uff0c\u5148\u7528edl\u5907\u4efdmodem\u5206\u533a\u3002\u5f53\u7136\u4e0b\u9762\u4ecb\u7ecd\u4e86edl\u5168\u91cf\u5907\u4efd\uff0c\u8df3\u8fc7\u4e86userdata\uff0c\u4f30\u8ba1\u662froot\u548chome\u76ee\u5f55\u3002</p>","tags":["debian","tool"]},{"location":"blog/%E9%9A%8F%E8%BA%ABwifi%E5%B7%A5%E5%85%B7%E5%88%B7%E6%9C%BA/#_5","title":"\u6062\u590d\u57fa\u5e26\u6587\u4ef6","text":"<p>\u6211\u5728\u5b89\u88c5debian\u7cfb\u7edf\u65f6\uff0c\u53d1\u73b0\u79fb\u52a8\u7f51\u7edc\u4e0d\u53ef\u7528\uff0c\u4e8e\u662f\u53c2\u8003\u7f51\u4e0a\u8bf4\u7684\uff0c\u5c06\u539f\u59cb\u57fa\u5e26\u6062\u590d\u540e\u6b63\u5e38\u3002 \u57fa\u5e26\u6587\u4ef6\u540d\u4e3a\"modem.bin\", edl\u5168\u91cf\u5907\u4efd\u540e\u5728dumps\u76ee\u5f55\u4e0b\u3002\u76f4\u63a5mount\u8be5\u6587\u4ef6\uff0c\u7136\u540e\u5c06modem.*\u548cmba.mbn\u53d6\u51fa\u6765\uff0c\u5f53\u53d1\u73b0\u5237\u673a\u540e\u53d1\u73b0\u79fb\u52a8\u7f51\u7edc\u4e0d\u80fd\u4f7f\u7528\u65f6\uff0c\u91cd\u65b0\u62f7\u56de\u53bb\u5c31\u80fd\u7528\u4e86\u3002 <pre><code>sudo mount modem.bin /mnt\n</code></pre> \u590d\u5236\u5230firmware-ufi001c\u76ee\u5f55\uff0c\u8986\u76d6\u4e4b\u524d\u7684\u6587\u4ef6\u3002 <pre><code>cp /mnt/modem.* .\ncp /mnt/mba.mbn .\n</code></pre></p> <p>\u518d\u6b21\u62f7\u8d1d\u5230wifi\u68d2\u5b50\u7684/lib/firmware\u76ee\u5f55, \u914d\u5408\u518d\u5237\u4e00\u6b21\u9002\u914d001C\u7684boot\u6587\u4ef6\u3002 <pre><code>adb push ./* /lib/firmware\nadb reboot bootloader\nfastboot flash boot boot-ufi001c.img\nfastboot reboot #\u91cd\u542f\n</code></pre></p> <p>\u7136\u540e\u5c31\u80fd\u627e\u5230modem\u7f51\u5361\u4e86\u3002</p>","tags":["debian","tool"]},{"location":"blog/%E9%9A%8F%E8%BA%ABwifi%E5%B7%A5%E5%85%B7%E5%88%B7%E6%9C%BA/#modem","title":"\u91cd\u542fmodem","text":"<p>\u6709\u65f6\u91cd\u5237\u4e86firmware\uff0c\u8fd8\u662f\u51fa\u73b0\u6ca1\u6709modem\u7f51\u5361\u7684\u60c5\u51b5\uff0c\u4e5f\u5c31\u662f<code>mmcli -m 0</code>\u63d0\u793a\u627e\u4e0d\u5230modem\u8bbe\u5907\u7684\u65f6\u5019\uff0c\u9700\u8981\u6267\u884c\u4e0b\u9762\u7684\u547d\u4ee4\u3002\u6216\u8005\u76f4\u63a5\u7b49\u4e00\u4f1a\u91cd\u542fModemManager <pre><code>systemctl stop ModemManager\nqmicli -d /dev/wwan0qmi0 --uim-sim-power-off=1 &amp;&amp; qmicli -d /dev/wwan0qmi0 --uim-sim-power-on=1\nsystemctl start ModemManager\n</code></pre></p>","tags":["debian","tool"]},{"location":"blog/%E9%9A%8F%E8%BA%ABwifi%E5%B7%A5%E5%85%B7%E5%88%B7%E6%9C%BA/#_6","title":"\u77ed\u4fe1\u6536\u53d1\u548c\u8f6c\u53d1\u90ae\u4ef6","text":"<p>\u4e0b\u8f7d\u4e24\u4e2apython\u6587\u4ef6\uff0c\u5730\u5740 https://gitee.com/jiu-xiao/ufi-message\u3002\u914d\u7f6esmtp.py\u4e2d\u7684\u90ae\u7bb1\u4fe1\u606f\uff0c\u6211\u4f7f\u7528\u7684QQ\u90ae\u7bb1\u767b\u5f55\uff0c\u7136\u540e\u8f6c\u53d1\u5230\u53e6\u4e00\u4e2a\u90ae\u7bb1\u3002\u5f00\u59cb\u53d1\u9001\u4e0d\u6210\u529f\uff0c\u4fee\u6539\u540e\u80fd\u53d1\u9001\u4e86\uff0c\u5185\u5bb9\u5982\u4e0b\u3002 <pre><code>#!python3\n\nmy_sender='@qq.com'\nmy_user='@hotmail.com'\nserver_address='smtp.qq.com'\nserver_port=465\nserver_passwd='' #\u586b\u5199qq\u90ae\u7bb1\u6388\u6743\u7801\n\n\nimport smtplib\nfrom email.mime.text import MIMEText\nfrom email.utils import formataddr\nimport datetime\nimport time\n\ndef mail(text):\n    msg=MIMEText(text,'plain','utf-8')\n    msg['From']=formataddr([\"\u968f\u8eabWifi\",my_sender])\n    msg['To']=formataddr([my_user,my_user])\n    msg['Subject']=\"\u8f6c\u53d1 \"+time.strftime(\"%H:%%M:%S %m/%d\")\n\n    server=smtplib.SMTP_SSL(server_address,server_port)\n\n    server.login(my_sender,server_passwd)\n    server.auth_plain()\n    server.sendmail(my_sender,[my_user,],msg.as_string())\n    server.quit()\n</code></pre></p> <p>\u7136\u540e\u5c31\u80fd\u5199\u8fdbcrontab\u81ea\u52a8\u8dd1\u4e86\u3002</p>","tags":["debian","tool"]},{"location":"blog/%E9%9A%8F%E8%BA%ABwifi%E5%B7%A5%E5%85%B7%E5%88%B7%E6%9C%BA/#_7","title":"\u6551\u7816","text":"","tags":["debian","tool"]},{"location":"blog/%E9%9A%8F%E8%BA%ABwifi%E5%B7%A5%E5%85%B7%E5%88%B7%E6%9C%BA/#edl","title":"edl\u4f7f\u7528","text":"<p>github\u4e0a\u7684\u5f00\u6e90\u5de5\u5177\uff0c\u53ef\u4ee5\u66ff\u4ee3Windows\u90a3\u4e9b\u9ad8\u901a\u5de5\u5177\uff0cMiko\uff0c\u661f\u6d77\u5565\u7684\u3002\u662f\u6211\u8fd9Linux\u7528\u6237\u7684\u798f\u97f3\uff0c\u5e76\u4e14\u7b80\u5355\uff0cwindows\u5e38\u5e38\u5931\u8d25\u3002 \u4f7f\u7528edl\u5de5\u5177\u4e4b\u524d\u8981\u5148\u91cd\u542f\u5230edl\u4e5f\u5c31\u662f9008\u6a21\u5f0f\uff0c\u4f7f\u7528\u547d\u4ee4<code>adb reboot edl</code>\uff0c\u4e0d\u9700\u8981\u6309RST\u952e\u3002</p> <p>\u5907\u4efd\uff1a\u63a8\u8350\u7b2c\u4e00\u79cd\u65b9\u5f0f\uff0c\u7b2c\u4e8c\u79cd\u65b9\u5f0f\u751f\u6210\u7684\u4e00\u4e2a\u6587\u4ef6\u5237\u5230\u53e6\u4e00\u4e2a\u8bbe\u5907\u5931\u8d25\uff0c\u4f46\u662f\u53ef\u4ee5\u5237MiKo\u5bfc\u51fa\u7684\u5355\u6587\u4ef6\u3002 <pre><code>edl rl dumps --skip=userdata --genxml\nor\nedl rf flash.bin #\u5355\u6587\u4ef6\n</code></pre></p> <p>\u6062\u590d: <pre><code>edl qfil rawprogram0.xml patch0.xml .\n</code></pre></p>","tags":["debian","tool"]},{"location":"blog/%E9%9A%8F%E8%BA%ABwifi%E5%B7%A5%E5%85%B7%E5%88%B7%E6%9C%BA/#_8","title":"\u6062\u590d\u5206\u533a","text":"<p>\u5237\u4e86debian\u540e\uff0c\u5206\u533a\u4f1a\u53d8\uff0c\u8fd9\u6837\u5bfc\u81f4\u6709\u4e9b\u5206\u533a\u4e0d\u5b58\u5728\u6240\u4ee5\u65e0\u6cd5\u5237\u56de\u53bb\u3002\u8fd9\u91cc\u4ecb\u7ecd\u4e0b\u6062\u590d\u5206\u533a\u7684\u65b9\u6cd5\u3002\u4e0d\u8fc7\u4e0a\u9762\u7684edl\u6062\u590d\u5e94\u8be5\u4e0d\u9700\u8981\u8fd9\u4e2a\u64cd\u4f5c\u3002</p> <p>\u5907\u4efd\u5206\u533a <pre><code>./edl gpt . --genxml\n</code></pre> \u5907\u4efd\u540e\u6709\u4e24\u4e2a\u6587\u4ef6\uff0c\u6062\u590d\u65f6\u53ea\u7528gpt_main0.bin\u6587\u4ef6\uff0c\u6062\u590d\u5206\u533a\u547d\u4ee4 <pre><code>./edl w gpt gpt_main0.bin\n</code></pre> \u6253\u5370\u5206\u533a\u6765\u9a8c\u8bc1\u4e0b</p> <pre><code>./edl printgpt\n</code></pre>","tags":["debian","tool"]},{"location":"blog/%E9%9A%8F%E8%BA%ABwifi%E5%B7%A5%E5%85%B7%E5%88%B7%E6%9C%BA/#_9","title":"\u53c2\u8003","text":"<p>https://forum.openwrt.org/t/uf896-qualcomm-msm8916-lte-router-384mib-ram-2-4gib-flash-android-openwrt/131712/160 https://www.kancloud.cn/handsomehacker/openstick/2636505</p>","tags":["debian","tool"]},{"location":"blog/wpa%E7%AE%A1%E7%90%86wifi%E6%8E%A5%E5%8F%A3/","title":"\u7528 wpasupplicant \u7ba1\u7406wifi\u8fde\u63a5","text":"<p>\u7528\u6811\u8393\u6d3e\u7ba1\u7406wifi\u8fde\u63a5\u7684\u65b9\u6cd5\u6709 \uff1a * \u901a\u8fc7\u914d\u7f6e\u6587\u4ef6/etc/wpa_supplicant/wpa_supplicant.conf * raspi-config * \u5176\u5b83\u5de5\u5177iwctl nmtui\u7b49</p> <p>\u540e\u6765\u53d1\u73b0\u914d\u7f6e\u6587\u4ef6\u7ba1\u7406wifi\u7684\u4f18\u5148\u7ea7\u4e0d\u751f\u6548\uff0c\u4e0d\u80fd\u9009\u62e9\u7f51\u7edc\uff0c\u5f53\u7136\u53ef\u4ee5\u7528nmtui\u5f88\u65b9\u4fbf\uff0c\u4e0d\u8fc7\u8981\u5b89\u88c5\u65b0\u5305\u3002\u540e\u6765\u53d1\u73b0\u4e86wpa_cli\u5de5\u5177\u5f88\u65b9\u4fbf\uff0c\u6765\u81ea\u5b89\u88c5\u5305wpasupplicant</p>","tags":["raspberryPi"]},{"location":"blog/wpa%E7%AE%A1%E7%90%86wifi%E6%8E%A5%E5%8F%A3/#wpa_cli","title":"wpa_cli","text":"<p>\u5148\u8981\u9009\u62e9\u7f51\u7edc\u63a5\u53e3\uff0c\u6811\u8393\u6d3e\u5c31\u662fwlan0\u3002 * \u67e5\u770b\u53ef\u7528\u7f51\u7edc <code>wpa_cli -i wlan0 list_networks</code>  \u8fd9\u4e2a\u547d\u4ee4\u4f1a\u6253\u5370\u53ef\u7528\u7f51\u7edc\u7684id\u548c\u540d\u79f0 * \u9009\u62e9\u67d0\u4e2a\u7f51\u7edc wpa_cli -i wlan0 select_networks &lt;\u7f51\u7edcid&gt;</p> <pre><code>wpa_cli \u8fd8\u6709\u4ea4\u4e92\u6a21\u5f0f\n</code></pre>","tags":["raspberryPi"]},{"location":"blog/wpa%E7%AE%A1%E7%90%86wifi%E6%8E%A5%E5%8F%A3/#_1","title":"\u53c2\u8003","text":"<p>https://superuser.com/a/759153</p>","tags":["raspberryPi"]},{"location":"blog/yt-dlp-downloads-qq-mv/","title":"\u4f7f\u7528yt-dlp\u5de5\u5177\u4e0b\u8f7dQQ\u97f3\u4e50\u7684MV","text":"","tags":["yt-dlp","tool"]},{"location":"blog/yt-dlp-downloads-qq-mv/#m3u8","title":"\u83b7\u53d6m3u8\u6587\u4ef6","text":"<ul> <li>Right click -&gt; Inspect -&gt; Network tab.</li> <li>Enter m3u in the filter box.</li> <li>Refresh the page, then click play on the video.</li> <li>Several results will pop up in the network tab, in this case 15Mps.m3u8 was the 4k version. There's lower quality (10/5Mps) ones as well.</li> <li>Right click on the 15Mps.m3u8 line, copy the url.</li> </ul>","tags":["yt-dlp","tool"]},{"location":"blog/yt-dlp-downloads-qq-mv/#_1","title":"\u4e0b\u8f7d","text":"<pre><code>yt-dlp  https://apd-e884a42ebcb1819c8e185bdd22d6b32d.v.smtcdns.com/mv.music.tc.qq.com/AI85i7JvkmyF4poFqhirDtuEnNIwyQjQKiMDd0TFbAjw/6371017979FE2EAD13F0216756673D8F64FF084085A30F1293F38C7A31471243BB1F9358EDD23833D48FCB2D2AC4B515ZZqqmusic_default/qmmv_0b6biyaaeaaapqaa3pcdpjrfirqaajdaaasa.f9944.m3u8\n</code></pre>","tags":["yt-dlp","tool"]},{"location":"blog/yt-dlp-downloads-qq-mv/#_2","title":"\u63d0\u53d6\u97f3\u9891","text":"<p><code>-ss 14s</code> \u8df3\u8fc7\u4e86MV\u5f00\u5934\u7684\u5267\u60c5 <pre><code>ffmpeg -i video_audio.mp4  -map 0:1 -ss 14s   -c:a copy  audio.m4a\n</code></pre> \u4f7f\u7528mediainfo\u67e5\u770b\u97f3\u9891\u8d28\u91cf\uff0c\u6bd4\u7279\u7387192kbps\uff0c\u5bf9\u6bd4\u5176\u5b83\u97f3\u4e50\u6587\u4ef6\uff0c\u538b\u7f29\u7387\u633a\u9ad8\u7684\u3002 <pre><code>mediainfo output.m4a | grep \"Bit rate\" \nBit rate mode                            : Constant\nBit rate                                 : 192 kb/s\n</code></pre></p>","tags":["yt-dlp","tool"]},{"location":"blog/yt-dlp-downloads-qq-mv/#_3","title":"\u53c2\u8003","text":"<p>https://www.reddit.com/r/DataHoarder/comments/1ab8812/how_to_download_blob_embedded_video_on_a_website/</p>","tags":["yt-dlp","tool"]},{"location":"blog/archive/2025/","title":"2025","text":""},{"location":"blog/archive/2024/","title":"2024","text":""},{"location":"blog/archive/2023/","title":"2023","text":""},{"location":"blog/archive/2022/","title":"2022","text":""},{"location":"blog/archive/2021/","title":"2021","text":""},{"location":"blog/archive/2020/","title":"2020","text":""},{"location":"blog/archive/2019/","title":"2019","text":""},{"location":"blog/page/2/","title":"Recent Blog","text":""},{"location":"blog/page/3/","title":"Recent Blog","text":""},{"location":"blog/page/4/","title":"Recent Blog","text":""},{"location":"blog/page/5/","title":"Recent Blog","text":""},{"location":"blog/page/6/","title":"Recent Blog","text":""},{"location":"blog/page/7/","title":"Recent Blog","text":""},{"location":"blog/page/8/","title":"Recent Blog","text":""},{"location":"blog/page/9/","title":"Recent Blog","text":""},{"location":"blog/page/10/","title":"Recent Blog","text":""},{"location":"blog/page/11/","title":"Recent Blog","text":""},{"location":"blog/page/12/","title":"Recent Blog","text":""},{"location":"blog/page/13/","title":"Recent Blog","text":""},{"location":"blog/archive/2025/page/2/","title":"2025","text":""},{"location":"blog/archive/2025/page/3/","title":"2025","text":""},{"location":"blog/archive/2024/page/2/","title":"2024","text":""},{"location":"blog/archive/2023/page/2/","title":"2023","text":""},{"location":"blog/archive/2022/page/2/","title":"2022","text":""},{"location":"blog/archive/2021/page/2/","title":"2021","text":""},{"location":"blog/archive/2021/page/3/","title":"2021","text":""},{"location":"blog/archive/2021/page/4/","title":"2021","text":""},{"location":"blog/archive/2020/page/2/","title":"2020","text":""},{"location":"blog/archive/2020/page/3/","title":"2020","text":""}]}